{"config":{"lang":["ja"],"separator":"[\\uff0c\\u3002]+","pipeline":["trimmer","stemmer"]},"docs":[{"location":"container/docker/install/","title":"\u5b89\u88c5 docker","text":"CentOS <pre><code>yum remove -y docker\nyum install -y docker-ce\n</code></pre> Ubuntu <pre><code>sudo apt-get install -y docker-ce\n</code></pre>"},{"location":"container/kubernetes/cka/","title":"CKA \u5fc3\u5f97","text":""},{"location":"container/kubernetes/cka/#1-ckackad","title":"1. CKA\u3001CKAD\u8003\u8bd5\u7ecf\u9a8c","text":"<p>CKA: Kubernetes\u7ba1\u7406\u5458\u8ba4\u8bc1\uff08CKA\uff09\u65e8\u5728\u786e\u4fdd\u8ba4\u8bc1\u6301\u6709\u8005\u5177\u5907\u5c65\u884cKubernetes\u7ba1\u7406\u5458\u804c\u8d23\u7684\u6280\u80fd\uff0c\u77e5\u8bc6\u548c\u80fd\u529b\u3002 CKA\u8ba4\u8bc1\u53ef\u5e2e\u52a9\u7ecf\u8fc7\u8ba4\u8bc1\u7684\u7ba1\u7406\u5458\u5728\u5c31\u4e1a\u5e02\u573a\u4e2d\u5feb\u901f\u5efa\u7acb\u81ea\u5df1\u7684\u4fe1\u8a89\u548c\u4ef7\u503c\uff0c\u5e76\u80fd\u5e2e\u52a9\u516c\u53f8\u66f4\u5feb\u5730\u96c7\u7528\u9ad8\u8d28\u91cf\u7684\u56e2\u961f\u6765\u652f\u6301\u4ed6\u4eec\u7684\u53d1\u5c55  </p> <p>\u5982\u679c\u4f01\u4e1a\u60f3\u8981\u7533\u8bf7KCSP\u6761\u4ef6\u4e4b\u4e00\u662f\uff1a\u81f3\u5c11\u9700\u8981\u4e09\u540d\u5458\u5de5\u62e5\u6709CKA\u8ba4\u8bc1  </p> <p>CKAD: Kubernetes\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u8ba4\u8bc1\uff08CKAD\uff09\u65e8\u5728\u786e\u4fddCKAD\u5177\u5907\u5c65\u884cKubernetes\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u804c\u8d23\u7684\u6280\u80fd\uff0c\u77e5\u8bc6\u548c\u80fd\u529b\u3002 \u7ecf\u8fc7\u8ba4\u8bc1\u7684Kubernetes Application Developer\u53ef\u4ee5\u5b9a\u4e49\u5e94\u7528\u7a0b\u5e8f\u8d44\u6e90\u5e76\u4f7f\u7528\u6838\u5fc3\u539f\u8bed\u6765\u6784\u5efa\uff0c\u76d1\u89c6\u548c\u6392\u9664Kubernetes\u4e2d\u53ef\u4f38\u7f29\u5e94\u7528\u7a0b\u5e8f\u548c\u5de5\u5177\u7684\u6545\u969c  </p> <p>\u8fd9\u91cc\u4e3b\u8981\u548c\u5927\u5bb6\u5206\u4eab\u4e00\u4e0b\u8003\u8bd5\u62a5\u540d\u4f18\u60e0\u3001\u5982\u4f55\u5907\u8003\u548c\u8003\u8bd5\u6ce8\u610f\u4e8b\u9879  </p>"},{"location":"container/kubernetes/cka/#2","title":"2. \u8003\u8bd5\u62a5\u540d","text":""},{"location":"container/kubernetes/cka/#21","title":"2.1 \u62a5\u540d\u5730\u5740","text":"<ul> <li>\u82f1\u6587\u76d1\u8003\u5b98</li> <li>CKA</li> <li>CKAD</li> <li>\u4e2d\u6587\u76d1\u8003\u5b98</li> <li>CKA-CN</li> <li>CKAD-CN</li> </ul> <p>\u82f1\u6587\u76d1\u8003\u548c\u4e2d\u6587\u76d1\u8003\u6700\u5927\u533a\u522b\uff1a</p> <ul> <li>\u4e2d\u6587\u76d1\u8003\u8003\u8bd5\u53ef\u4ee5\u4f7f\u7528\u652f\u4ed8\u5b9d\u652f\u4ed8\uff0c\u4e0d\u9700\u8981\u7f8e\u5143\u4fe1\u7528\u5361</li> <li>\u4e2d\u6587\u76d1\u8003\u7684\u8003\u5b98\u4f1a\u4e2d\u6587</li> </ul> <p>\u62a5\u540d\u6210\u529f\u4e4b\u540e\uff0c\u53ef\u572812\u4e2a\u6708\u4e4b\u5185\u8fdb\u884c\u8003\u8bd5\uff0c\u8003\u8bd5\u4e0d\u8fc7\u6709\u4e00\u6b21\u8865\u8003\u673a\u4f1a\u3002</p>"},{"location":"container/kubernetes/cka/#22","title":"2.2 \u8003\u8bd5\u8005\u8eab\u4efd\u8ba4\u8bc1\u8bc1\u4ef6","text":"<ul> <li>\u62a4\u7167 / \u6e2f\u6fb3\u901a\u884c\u8bc1</li> </ul> <p>\u5982\u679c\u4f7f\u7528\u62a4\u7167 / \u6e2f\u6fb3\u901a\u884c\u8bc1\u4f5c\u4e3a\u8eab\u4efd\u9a8c\u8bc1\uff0c\u8003\u8bd5\u8005\u59d3\u540d\u9700\u8981\u586b\u5199\u540d\u5b57\u62fc\u97f3\uff08\u4e0e\u8bc1\u4ef6\u4e00\u81f4\uff09</p> <ul> <li>\u5c45\u6c11\u8eab\u4efd\u8bc1</li> </ul> <p>\u5982\u679c\u6ca1\u6709\u62a4\u7167\u3001\u6e2f\u6fb3\u901a\u884c\u8bc1\u4e4b\u7c7b\u7684\u5e26\u540d\u5b57\u62fc\u97f3\u7684\u8bc1\u4ef6\uff0c\u4f7f\u7528\u8eab\u4efd\u8bc1\u8003\u8bd5\u4e5f\u53ef\u4ee5\uff08\u6709\u5c0f\u4f19\u4f34\u5728\u4e2d\u6587\u76d1\u8003<code>CKA-CN</code>\u9a8c\u8bc1\u8fc7\u4f7f\u7528\u8eab\u4efd\u8bc1\u8003\u8bd5\uff0c \u82f1\u6587\u76d1\u8003\u6ca1\u8bd5\u8fc7\uff09\uff0c\u82e5\u4f7f\u7528\u8eab\u4efd\u8bc1\u6765\u9a8c\u8bc1\u8eab\u4efd\uff0c\u9009\u62e9\u8003\u573a\u65f6\u586b\u5199\u8003\u8bd5\u8005\u59d3\u540d\u9700\u8981\u586b\u5199**\u4e2d\u6587\u59d3\u540d**\uff08\u4e0e\u8bc1\u4ef6\u4e00\u81f4\uff09</p>"},{"location":"container/kubernetes/cka/#23","title":"2.3 \u83b7\u53d6\u8bc1\u4e66\u6761\u4ef6","text":"<p>CKA\uff1a74\u5206\u6216\u4ee5\u4e0a\u53ef\u4ee5\u83b7\u5f97\u8bc1\u4e66 (\u6700\u65b0\u89c4\u5b9a\u5df2\u7ecf\u6539\u621066\u5206)</p> <p>CKA\uff1a66\u5206\u6216\u4ee5\u4e0a\u53ef\u4ee5\u83b7\u5f97\u8bc1\u4e66, \u8be6\u89c1\u5b98\u65b9\u8bf4\u660e</p> <p>CKAD\uff1a66\u5206\u6216\u4ee5\u4e0a\u53ef\u4ee5\u83b7\u5f97\u8bc1\u4e66  </p>"},{"location":"container/kubernetes/cka/#24","title":"2.4 \u56fd\u5185\u73b0\u573a\u8003\u70b9","text":"<p>\u5982\u679c\u4f60\u6ca1\u6709\u5408\u9002\u7684\u8003\u8bd5\u73af\u5883\uff0c\u53ef\u4ee5\u8003\u8651\u5230\u73b0\u573a\u8003\u70b9\u53bb\u8003\u8bd5\uff0c\u6211\u6ca1\u53bb\u8fc7\u73b0\u573a\u8003\u70b9\uff0c\u5177\u4f53\u8bf7\u54a8\u8be2\u8bf4\u660e\u91cc\u9762\u7684\u8003\u70b9\u7535\u8bdd</p> <p>\u56fd\u5185\u8003\u70b9\u8bf4\u660e</p> <p>\u76ee\u524d[2021-03-18]\u67e5\u770b https://training.linuxfoundation.cn/ \u5df2\u7ecf\u627e\u4e0d\u5230\u7ebf\u4e0b\u8003\u8bd5\u8bf4\u660e\uff08\u4f30\u8ba1\u662f\u7531\u4e8e\u65b0\u51a0\u75ab\u60c5\u7684\u539f\u56e0\uff09  </p>"},{"location":"container/kubernetes/cka/#25","title":"2.5 \u62a5\u540d\u4f18\u60e0","text":"<p>\u6bcf\u5e74 Cyber Monday \u7684\u4f18\u60e0\u529b\u5ea6\u662f\u6700\u5927\u7684\uff0c\u5927\u6982\u62535\u6298\u5de6\u53f3\uff08Cyber Monday\uff1a\u7f51\u7edc\u661f\u671f\u4e00\uff0c\u4e5f\u5c31\u662f\u9ed1\u4e94\u540e\u7684\u7b2c\u4e00\u4e2a\u661f\u671f\u4e00\uff0c\u8fd9\u4e00\u5929\u901a\u5e38\u572811\u6708\u5e9512\u6708\u521d\u8fd9\u6837\uff09\uff0c\u4e70\u8bfe\u7a0b\u9001\u8003\u8bd5\u62a5\u540d\u8d44\u683c\u3002\u6211\u5f53\u65f6\u5728\u7f51\u7edc\u661f\u671f\u4e00\u4e70\u4e86 CKA+CKAD \u7684\u8bfe\u7a0b\uff08\u9001\u8003\u8bd5\u8d44\u683c\uff09\u5171\u82b1\u8d39349\u7f8e\u91d1\uff0c\u7b97\u8d77\u6765\u62535\u6298\u5de6\u53f3\u8fd9\u6837\u5b50\u3002</p> <p>\u5e73\u65f6\u6ca1\u6709\u5fc5\u8981\u5355\u72ec\u8d2d\u4e70\u8fd9\u4e2a\u8bfe\u7a0b\uff0c\u6709\u6d3b\u52a8\u9001\u8003\u8bd5\u8d44\u683c\u65f6\u53ef\u4ee5\u4e70\uff0c\u5373\u76f8\u5f53\u4e8e\u4e3a\u4e86\u4e70\u8003\u8bd5\u8d44\u683c\u800c\u4e0d\u662f\u4e70\u8bfe\u7a0b\u3002</p> <p>\u8d2d\u4e70\u4f18\u60e0\u6d3b\u52a8\u4e2d\u8bfe\u7a0b\u540e\u4f1a\u5c06\u8003\u8bd5\u62a5\u540d\u4f18\u60e0\u7801\uff08\u4f18\u60e0100%\uff0c\u5c31\u662f\u4e0d\u7528\u518d\u4ed8\u8d39\u4e86\uff0c\u62b5\u6d88300\u7f8e\u5143\u7684\u8003\u8bd5\u62a5\u540d\u8d39\u3002\u73b0\u5728\u62a5\u540d\u8d39\u5df2\u7ecf\u6da8\u5230375\u7f8e\u5143\u4e86\uff09\u53d1\u5230\u90ae\u7bb1\uff0c\u62a5\u540d\u4f18\u60e0\u7801\u6709\u6548\u671f\u4e3a\u4e00\u4e2a\u6708\uff0c\u4f7f\u7528\u4f18\u60e0\u7801\u62a5\u540d\u4e4b\u540e12\u4e2a\u6708\u5185\u8fdb\u884c\u8003\u8bd5\u3002</p> <p>\u5982\u4e0b\u56fe\uff0c\u6700\u4e0b\u9762\u90a3\u4e2a349\u7f8e\u91d1\u7684\u8ba2\u5355\u662f\u8d2d\u4e70CKA+CKAD\u7684\u8bfe\u7a0b\u5957\u9910\uff0c\u56fe\u4e2d\u4e0a\u9762\u4e24\u4e2a0\u5143\u8ba2\u5355\uff08CKA\u548cCKAD\u8003\u8bd5\u62a5\u540d\u8ba2\u5355\uff09\u662f\u7528\u8d2d\u4e70\u8bfe\u7a0b\u9001\u7684\u4f18\u60e0\u7801\u4e70\u7684\u3002</p> <p></p> <p>\u5f80\u5e74 Cyber Monday \u6d3b\u52a8\u622a\u56fe\uff1a</p> <p> </p> <p>\u5982\u679c\u4f60\u7b49\u4e0d\u53caCyber Monday\uff0c\u53ef\u4ee5\u627e\u4e00\u4e0b\u56fd\u5185\u57f9\u8bad\u673a\u6784\uff0c\u53ef\u80fd\u4ed6\u4eec\u624b\u4e0a\u6709\u4f18\u60e0\u62a5\u540d\u8d44\u683c\u3002</p> <p>\u6216\u8005\u5728\u8fd9\u91cc\u67e5\u770b\u4e00\u4e0b\u4f18\u60e0\u7801\uff0c\u4e0d\u540c\u65f6\u5019\u770b\u6298\u6263\u4e0d\u4e00\u6837\uff0c\u6709\u65f6\u5019\u662f9\u6298\uff0c\u6709\u65f6\u5019\u662f85\u6298\uff0c\u5982\u4e0b\u56fe\u6240\u793a\uff1a</p> <p> </p>"},{"location":"container/kubernetes/cka/#3","title":"3. \u5907\u8003","text":"<p>\u8003\u8bd5\u65f6\u4f60\u53ef\u4ee5\u6253\u5f00\u4e24\u4e2a\u6d4f\u89c8\u5668 Tab\uff0c\u4e00\u4e2a\u662f\u8003\u8bd5\u7a97\u53e3\uff0c\u4e00\u4e2a\u7528\u6765\u67e5\u9605\u5b98\u65b9\u6587\u6863\uff08\u4ec5\u5141\u8bb8\u8bbf\u95ee https://kubernetes.io/docs/\u3001https://github.com/kubernetes/ \u548chttps://kubernetes.io/blog/\uff09</p> <p>\u6ce8\u610f\uff1a\u5728\u5b98\u65b9\u6587\u6863\u641c\u7d22\u65f6\uff0c\u7ed3\u679c\u6709\u53ef\u80fd\u5e76\u4e0d\u662f\u5728 https://kubernetes.io/docs/ \u548c https://kubernetes.io/blog/ \u5b50\u57df\u4e0b\uff0c\u4e0d\u80fd\u5728\u8003\u8bd5\u4e2d\u70b9\u5f00</p> <p>\u8003\u8bd5\u5185\u5bb9\u76f8\u5bf9\u7b80\u5355\uff0c\u5176\u5b9e\u5c31\u662f\u8003<code>kubectl</code>\u7528\u6cd5\uff0c\u8003<code>yaml</code> \u8003\u8bd5\u4e3b\u8981\u662f\u8003\u5bdf\u5bf9\u5404\u79cd K8s \u8d44\u6e90\u7684\u4e86\u89e3\uff0c\u4f1a\u4f7f\u7528\u5404\u79cd\u8d44\u6e90\uff0c\u5e73\u65f6\u7ec3\u4e60\u591a\u6ce8\u91cd kubectl \u4f7f\u7528\u6280\u5de7\uff0c\u591a\u719f\u6089\u5b98\u65b9\u6587\u6863\uff08\u8003\u8bd5\u65f6\u53ef\u67e5\u5b98\u65b9\u6587\u6863\u76f4\u63a5\u590d\u5236\u4e00\u4e9b\u590d\u6742\u7684 yaml \u6765\u4fee\u6539\u4f7f\u7528\uff09  </p> <p>\u8003\u9898\u4f8b\u5b50\uff1a</p> <ul> <li>\u521b\u5efa\u4e00\u4e2a nginx pod \uff08\u5bf9\uff0c\u90e8\u5206\u9898\u76ee\u5c31\u662f\u8fd9\u4e48\u7b80\u5355\uff09</li> <li>\u521b\u5efa\u4e00\u4e2a configmap \u5e76\u6302\u8f7d\u5230\u6307\u5b9a pod \u4e0a</li> <li>\u521b\u5efa\u591a\u5bb9\u5668 pod \uff08\u9898\u76ee\u6307\u5b9a\u5305\u542b\u54ea\u4e9b\u955c\u50cf\uff0c\u4f8b\u5982 nginx\u3001redis \u7b49\uff09</li> <li>\u521b\u5efa\u4e00\u4e2a pv</li> <li>\u521b\u5efa\u4e00\u4e2a pvc \u5e76\u7ed1\u5b9a</li> <li>\u6392\u67e5\u4e00\u4e0b node \u8282\u70b9\u4e3a\u5565NotReady\u4e86\uff0c\u53bb\u5230 node \u4e00\u770b\uff0ckubelet\u6ca1\u542f\u52a8\uff0c\u542f\u52a8\u5b8c\u4e8b</li> <li>\u4f7f\u7528 kubeadm \u521b\u5efa\u4e00\u4e2a\u96c6\u7fa4  </li> </ul> <p>\u5c31\u4e0a\u9762\u8fd9\u51e0\u9898\u5c31\u80fd\u62ff\u4e09\u56db\u5341\u5206\u4e86</p> <p>\u8fd9\u4e2a\u8003\u8bd5\u771f\u7684\u662f\u6bd4\u8f83\u7b80\u5355\u90a3\u79cd\uff0c\u53ea\u8981\u8ba4\u771f\u7ec3\u4e60<code>CKA\u7ec3\u4e60</code>\uff0c\u62ff66\u5206\u4ee5\u4e0a\u6ca1\u5565\u96be\u5ea6  </p> <p>CKA\u7ec3\u4e60:</p> <ul> <li>https://github.com/stretchcloud/cka-lab-practice \uff08\u8fd9\u4e2a\u5df2\u7ecf\u86ee\u4e45\u6ca1\u66f4\u65b0\u4e86\uff0c\u867d\u7136\u8003\u5c97\u6709\u4e00\u4e9b\u53d8\u52a8\uff0c\u4f46\u662f\u7ec3\u4e60\u8fd8\u662f\u9002\u7528\u7684\uff09</li> <li>https://github.com/David-VTUK/CKA-StudyGuide</li> </ul> <p>CKAD\u7ec3\u4e60:</p> <ul> <li>https://github.com/dgkanatsios/CKAD-exercises</li> </ul> <p>\u5728\u7ec3\u4e60\u65f6\u9700\u8981\u6ce8\u610f\uff0c\u4e0d\u80fd\u76f4\u63a5\u770b\u7ec3\u4e60\u91cc\u9762\u7684\u7b54\u6848\uff0c\u5fc5\u987b\u4ece\u5b98\u65b9\u6587\u6863\u67e5\u627e\u7b54\u6848\uff0c\u52a0\u6df1\u5bf9\u5b98\u65b9\u6587\u6863\u7684\u719f\u6089\u7a0b\u5ea6\uff0c\u53ef\u4ee5\u5c06\u7ec3\u4e60\u4e2d\u4f7f\u7528\u5230\u7684\u5b98\u65b9\u6587\u6863\u4fdd\u5b58\u5230\u6d4f\u89c8\u5668\u6536\u85cf\u5939\uff0c\u65b9\u4fbf\u8003\u751f\u65f6\u76f4\u63a5\u70b9\u5f00\u6765\u590d\u5236 yaml</p> <p>\u9664\u4e86\u4e0a\u9762\u7684\u7ec3\u4e60\u9898\uff0c\u8fd8\u9700\u8981\u719f\u6089\u4e86\u4f7f\u7528kubeadm\u521b\u5efa\u96c6\u7fa4\u3001\u5347\u7ea7\u96c6\u7fa4</p> <p>\u5728\u7ebf\u7ec3\u4e60\u73af\u5883\uff1a</p> <ul> <li>katacoda</li> <li>play-with-k8s</li> </ul> <p>\u5efa\u8bae\u5927\u5bb6\u4efb\u4e00\u5728\u7ebfK8s\u73af\u5883\u91cc\u7ec3\u4e60\u4e00\u6b21\uff0c\u4e3b\u8981\u662f\u719f\u6089\u4e00\u4e0bweb\u7ec8\u7aef  </p>"},{"location":"container/kubernetes/cka/#4","title":"4. \u8003\u524d\u68c0\u67e5\u53ca\u8003\u8bd5\u73af\u5883","text":"<ul> <li>\u8003\u8bd5\u5f62\u5f0f: \u5728\u7ebf\u76d1\u8003\uff0c\u9700\u8981\u5171\u4eab\u684c\u9762\u548c\u6444\u50cf\u5934  </li> <li>\u8003\u8bd5\u73af\u5883: \u5728\u4e00\u4e2a\u5bc6\u95ed\u7a7a\u95f4\uff0c\u4f8b\u5982\u4e66\u623f\u3001\u5367\u5ba4\u3001\u4f1a\u8bae\u5ba4\u7b49\uff0c\u7535\u8111\u5c4f\u5e55\u4e0d\u80fd\u5bf9\u7740\u7a97\u6237\uff0c\u623f\u95f4\u91cc\u9664\u4e86\u8003\u751f\u4e0d\u80fd\u5b58\u5728\u7b2c\u4e8c\u4e2a\u4eba\uff0c\u8003\u8bd5\u7684\u684c\u9762\u4e0d\u80fd\u653e\u5176\u5b83\u4e1c\u897f\uff0c\u6c34\u676f\u4e5f\u4e0d\u884c  </li> <li>\u8003\u8bd5\u65f6\u95f4: CKA\u3001CKAD\u5747\u4e3a\u4e24\u5c0f\u65f6</li> <li>\u9009\u62e9\u8003\u8bd5\u65f6\u95f4: \u62a5\u540d\u6210\u529f\u4e4b\u540e\u53ef\u4ee5\u572812\u4e2a\u6708\u4e4b\u5185\u8fdb\u884c\u8003\u8bd5\uff0c\u8003\u8bd5\u4e4b\u524d\u9700\u8981\u9009\u62e9\u8003\u8bd5\u65f6\u95f4\uff0c\u9009\u62e9\u8003\u8bd5\u65f6\u95f4\u7684\u65f6\u5019\u8bb0\u5f97\u5148\u9009\u62e9\u5317\u4eac\u65f6\u533a\uff0c\u9ed8\u8ba4\u662f0\u65f6\u533a\u65f6\u95f4\u3002</li> <li>\u7535\u8111\u8981\u6c42: \u53ef\u4ee5\u5728\u8fd9\u91ccWebDelivery Compatibility Check\u68c0\u6d4b\u81ea\u5df1\u7684\u7535\u8111\u73af\u5883\u548c\u7f51\u7edc\u901f\u5ea6\u7b49</li> </ul> <p>\u68c0\u67e5\u6d4b\u8bd5\u524d\u5148\u70b9\u51fb\u201cInstall Extension\u201d\uff0c\u5b89\u88c5chrome\u63d2\u4ef6\uff0c\u8fd9\u4e2a\u63d2\u4ef6\u662f\u8003\u8bd5\u65f6\u7528\u6765\u5171\u4eab\u5c4f\u5e55\u548c\u6444\u50cf\u5934\u7684\uff0c\u5b89\u88c5\u8fc7\u7a0b\u9700\u8981\u722c\u5899\uff0c\u8003\u8bd5\u8fc7\u7a0b\u4e0d\u9700\u8981\u722c\u5899  </p> <p></p> <ul> <li>\u8003\u8bd5\u524d\u8003\u5b98\u68c0\u67e5:</li> <li>\u8003\u8bd5\u53ef\u4ee5\u63d0\u524d15\u5206\u949f\u8fdb\u5165\u8003\u8bd5\u754c\u9762</li> <li>\u8003\u5b98\u4f1a\u5728\u7f51\u9875\u4e2d\u7684\u804a\u5929\u7a97\u53e3\u53d1\u9001\u6d88\u606f\u7684\u548c\u4f60\u4ea4\u6d41\uff08\u6ca1\u6709\u8bed\u97f3\u4ea4\u6d41\uff0c\u53ea\u6709\u6587\u5b57\u4ea4\u6d41\uff09</li> <li>\u770b\u4e0d\u61c2\u8003\u5b98\u53d1\u7684\u82f1\u6587\u600e\u4e48\u529e\uff1a\u53ef\u4ee5\u5728chrome\u6d4f\u89c8\u5668\u53f3\u952e\u7ffb\u8bd1</li> <li>\u8003\u5b98\u4f1a\u8ba9\u4f60\u5171\u4eab\u6444\u50cf\u5934\uff0c\u5171\u4eab\u684c\u9762</li> <li>\u8003\u5b98\u4f1a\u8ba9\u4f60\u51fa\u793a\u80fd\u786e\u8ba4\u4f60\u8eab\u4efdID\u7684\u8bc1\u4ef6\uff0c\u6211\u5f53\u65f6\u7528\u7684\u662f\u7f57\u6280C310\u6444\u50cf\u5934\uff08\u5efa\u8bae\u5927\u9009\u7528\u53ef\u7528\u5bf9\u7126\u7684\u6444\u50cf\u5934\uff09\uff0c\u65e0\u6cd5\u5bf9\u7126\uff0c\u62a4\u7167\u770b\u4e0a\u53bb\u6a21\u7cca\u5230\u4e0d\u884c\uff0c\u540e\u6765\u8003\u5b98\u53eb\u6211\u7ed9\u62a4\u7167\u6253\u5149\u8fd8\u662f\u4e0d\u884c\u3002\u6700\u540e\u8003\u5b98\u53eb\u6211\u6253\u5f00\u624b\u673a\uff0c\u7528\u624b\u673a\u76f8\u673a\u5f53\u4f5c\u653e\u5927\u955c\u7528\uff0c\u8fd9\u6837\u624d\u80fd\u770b\u6e05\u695a\u3002\uff08\u6211\u8003CKAD\u7684\u65f6\u5019\uff0c\u6211\u62a4\u7167\u8fd8\u6ca1\u4e3e\u7a33\uff0c\u8003\u5b98\u5c31\u8bf4\u53ef\u4ee5\u4e86\uff0c\u5e94\u8be5\u662f\u8003\u8fc7CKA\uff0c\u4ed6\u4eec\u7cfb\u7edf\u91cc\u9762\u5df2\u7ecf\u6709\u6211\u7684\u4fe1\u606f\u4e86\uff0c\u5c31\u968f\u4fbf\u7784\u4e86\u4e00\u773c\u800c\u5df2\uff09</li> <li>\u8003\u5b98\u4f1a\u8ba9\u4f60\u7528\u6444\u50cf\u5934\u73af\u89c6\u623f\u95f4\u4e00\u5468\uff0c\u786e\u8ba4\u4f60\u7684\u8003\u8bd5\u73af\u5883\uff08\u5f53\u65f6\u6211\u623f\u95f4\u95e8\u5f00\u4e86\u4e00\u4e2a\u5c0f\u7f1d\u4e5f\u8981\u6c42\u6211\u53bb\u628a\u95e8\u5173\u597d\uff0c\u8fd8\u662f\u6bd4\u8f83\u4e25\u683c\u7684\uff09</li> <li>\u8003\u5b98\u4f1a\u8ba9\u4f60\u7528\u6444\u50cf\u5934\u770b\u4f60\u7684\u6574\u4e2a\u684c\u9762\u548c\u684c\u5b50\u5e95\u4e0b</li> <li>\u8003\u5b98\u4f1a\u8ba9\u4f60\u518d\u6b21\u70b9\u4e00\u4e0b\u684c\u9762\u5171\u4eab\uff0c\u7136\u540e\u4f60\u53eb\u4f60\u70b9\u51fb\u53d6\u6d88\uff0c\u7136\u540e\u5c31\u5f00\u59cb\u8fdb\u5165\u8003\u8bd5\u4e86</li> <li>\u8003\u8bd5\u7684\u754c\u9762:</li> <li>\u5de6\u8fb9\u662f\u9898\u76ee</li> <li>\u53f3\u8fb9\u662f\u7ec8\u7aef</li> <li>\u7ec8\u7aef\u4e0a\u9762\u662f\u5171\u4eab\u6444\u50cf\u5934\u3001\u5171\u4eab\u5c4f\u5e55\u3001\u8003\u8bd5\u4fe1\u606f\u7b49\u6309\u94ae\uff08\u53ef\u4ee5\u5524\u51fa\u8bb0\u4e8b\u672c\uff09</li> <li>\u8003\u8bd5\u8fc7\u7a0b:</li> <li>\u8003\u8bd5\u8ba1\u65f6\uff1a\u6309\u7167\u4f60\u5b9e\u9645\u5f00\u59cb\u65f6\u95f4\u5f00\u59cb\u8ba1\u65f6\uff08\u8fdb\u5165\u6709\u9898\u76ee\u7684\u8003\u8bd5\u754c\u9762\u5f00\u59cb\u8ba1\u7b97\uff09\u3002\u6bd4\u5982\u4f60\u7ea6\u7684\u662f\u4e0b\u5348\u4e24\u70b9\u5f00\u59cb\u8003\u8bd5\uff0c\u4f46\u662f\u8003\u5b98\u68c0\u67e5\u82b1\u4e86\u6bd4\u8f83\u957f\u7684\u65f6\u95f4\uff0c\u5230\u4e24\u70b9\u534a\u624d\u8bf4\u53ef\u4ee5\u8fdb\u5165\u8003\u8bd5\uff0c\u90a3\u4e48\u4f60\u7684\u8003\u8bd5\u662f\u4ece\u4e24\u70b9\u534a\u5f00\u59cb\u7b97\u8d77  </li> <li>\u8003\u8bd5\u9898\u76ee\u6709\u597d\u51e0\u79cd\u8bed\u8a00\u7684\u7ffb\u8bd1\uff08\u5305\u542b\u4e86\u4e2d\u6587\u7ffb\u8bd1\uff09\uff0c\u9898\u76ee\u91cc\u7684\u5173\u952e\u8bcd\u90fd\u662f\u6807\u7ea2\u7684\uff0c\u6bd4\u5982pod name\u7b49\u7b49\uff0c\u5efa\u8bae\u770b\u82f1\u6587\u7248\u7684\u9898\u76ee\uff0c\u4e2d\u6587\u7ffb\u8bd1\u611f\u89c9\u662f\u673a\u7ffb\u7684\uff0c\u8bfb\u7740\u6709\u70b9\u522b\u626d</li> <li>\u8003\u8bd5\u7ed3\u675f\u524d15\u5206\u949f\u8003\u5b98\u4f1a\u53d1\u6d88\u606f\u63d0\u793a\u4f60\u8003\u8bd5\u8fd8\u5269\u4e0b15\u5206\u949f\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u770b\u8003\u5b98\u5fc3\u60c5\u628a\uff0c\u6211\u8003CKA\u7684\u65f6\u5019\u6ca1\u63d0\u793a\u4e86\uff0c\u8003CKAD\u7684\u65f6\u5019\u63d0\u793a\u4e86  </li> <li>\u8003\u8bd5\u65f6\u95f4\u5230\uff0c\u8003\u5b98\u4f1a\u53d1\u6d88\u606f\u63d0\u9192\u4f60\uff0c\u53eb\u4f60\u9000\u51fa\u8003\u8bd5  </li> </ul>"},{"location":"container/kubernetes/cka/#5","title":"5. \u8003\u8bd5\u5fc3\u5f97","text":"<ul> <li>\u8003\u8bd5\u96be\u5ea6</li> </ul> <p>\u603b\u7684\u6765\u8bf4CKA\u8003\u8bd5\u8fd8\u662f\u76f8\u5bf9\u7b80\u5355\u7684\uff0c\u5982\u679c\u4f60\u6709K8s\u751f\u4ea7\u73af\u5883\u7ef4\u62a4\u4f7f\u7528\u7ecf\u9a8c\uff0c\u5927\u53ef\u4ee5\u76f4\u63a5\u8003\u8bd5\uff0c\u8fc7\u7ebf\u662f\u6ca1\u95ee\u9898\u7684\uff1bCKAD\u96be\u5ea6\u4e5f\u4e0d\u5927\uff0c\u9898\u91cf\u8f83CKA\u5927\uff0c\u9700\u8981\u6ce8\u610f\u6bcf\u9053\u9898\u7684\u65f6\u95f4\u5206\u914d</p> <ul> <li>kubectl\u81ea\u52a8\u8865\u5168</li> </ul> <p>\u6ce8\u610f\u4f7f\u7528kubectl\u81ea\u52a8\u8865\u5168\uff0c\u8003\u8bd5\u73af\u5883\u9ed8\u8ba4\u5df2\u7ecf\u914d\u7f6e\u4e86kubectl\u81ea\u52a8\u8865\u5168\uff0c\u65e0\u9700\u8003\u751f\u53e6\u884c\u914d\u7f6e\uff0c\u4f46\u662f\u8fd9\u8fd8\u4e0d\u591f\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 <code>k</code> \u4ee3\u66ff <code>kubectl</code> kubectl Cheat Sheet</p> <pre><code>alias k=kubectl\ncomplete -F __start_kubectl k\n</code></pre> <ul> <li>\u4f7f\u7528\u8003\u8bd5\u73af\u5883\u63d0\u4f9b\u7684\u8bb0\u4e8b\u672c</li> </ul> <p>\u4f7f\u7528\u8bb0\u4e8b\u672c\uff0c\u8003\u8bd5\u8fc7\u7a0b\u4e2d\uff0c\u6700\u597d\u5c06\u4f7f\u7528\u8fc7\u7684\u547d\u4ee4\u8bb0\u5f55\u5230\u8bb0\u4e8b\u672c\uff0c\u540e\u9762\u7684\u9898\u76ee\u53ef\u4ee5\u7a0d\u5fae\u6539\u52a8\u518d\u4f7f\u7528\uff08\u7279\u522b\u662f\u521b\u5efapod\u7684\u547d\u4ee4\uff0c\u4f30\u8ba1\u8981\u4f7f\u7528\u4e03\u516b\u6b21\u5427\uff09</p> <ul> <li>\u4f7f\u7528 <code>--dry-run</code> \u751f\u6210 yaml</li> </ul> <p>\u4f7f\u7528 <code>--dry-run</code> \u53c2\u6570\u6765\u751f\u6210\u4e00\u4e2a\u57fa\u7840\u7684 yaml\uff0c\u518d\u6309\u7167\u9898\u76ee\u8981\u6c42\u4fee\u6539\u8fd9\u4e2a\u57fa\u7840 yaml \u6587\u4ef6\uff0c\u4e0d\u8981\u7eaf\u624b\u5199 yaml\u3002\u5982\u679c\u9898\u76ee\u65e0\u7279\u6b8a\u8981\u6c42\uff0c\u80fd kubectl \u547d\u4ee4\u5b8c\u6210\u7684\u5c31\u4e0d\u8981\u4f7f\u7528 yaml \u6587\u4ef6\uff0c\u8fd9\u4e2a\u6bd4\u8f83\u6d6a\u8d39\u65f6\u95f4\u3002</p> <ul> <li>\u6d4f\u89c8\u5668\u6536\u85cf\u5939</li> </ul> <p>\u5c06\u4e0a\u9762\u5907\u8003\u4e2d\u7684 github \u4ed3\u5e93\u7ec3\u4e60\u9898\u4e2d\u63d0\u5230\u7684\u5b98\u65b9\u6587\u6863\u4fdd\u5b58\u5230\u6d4f\u89c8\u5668\u6536\u85cf\u5939\uff0c\u8fd9\u6837\u505a\u7684\u76ee\u7684\u662f\u5728\u6d4f\u89c8\u5668\u5730\u5740\u680f\u8f93\u5165\u5173\u952e\u8bcd\uff0c\u5c31\u4f1a\u5f39\u51fa\u6536\u85cf\u597d\u7684\u5b98\u65b9\u6587\u6863\u5730\u5740\uff0c\u5c31\u53ef\u4ee5\u76f4\u8fbe\u5bf9\u5e94\u7684\u6587\u6863\uff0c\u4e0d\u9700\u8981\u5728\u5b98\u65b9\u6587\u6863\u4e0a\u518d\u4e00\u6b21\u641c\u7d22</p> <ul> <li>vim\u7f16\u8f91\u5668</li> </ul> <p>vim\u7f16\u8f91\u5668\u8981\u6c42\u4e0d\u9ad8\uff0c\u4f46\u662f\u4f60\u81f3\u5c11\u8981\u77e5\u9053\u5982\u4f55\u8fdb\u5165\u7f16\u8f91\u6a21\u5f0f\uff0c\u5982\u4f55\u4fdd\u5b58\u6587\u6863\uff0c\u590d\u5236\u7c98\u8d34\u4e4b\u7c7b\u7684\u5feb\u6377\u952e\u8bb0\u4e0d\u8bb0\u90fd\u884c\uff0c\u53ef\u4ee5\u53f3\u952e\u590d\u5236\u7c98\u8d34</p> <ul> <li>web\u7ec8\u7aef\u4e2d\u7684\u590d\u5236\u7c98\u8d34</li> </ul> <p>web\u7ec8\u7aef\u4e2d\u65e0\u6cd5\u4f7f\u7528Ctrl+C\u3001Ctrl+V\uff08\u8003\u8bd5\u63d0\u4f9b\u7684\u8bb0\u4e8b\u672c\u53ef\u4ee5\u4f7f\u7528\uff09\uff0c\u4f7f\u7528Ctrl + Insert\uff0cShift + Insert\u4ee3\u66ff\uff0cweb \u7ec8\u7aef\u4e2d\u4e5f\u53ef\u4ee5\u4f7f\u7528\u53f3\u952e\u590d\u5236\u7c98\u8d34</p>"},{"location":"container/kubernetes/install-k8s/","title":"\u5b89\u88c5 k8s","text":""},{"location":"container/kubernetes/install-k8s/#_1","title":"\u5b89\u88c5\u73af\u5883","text":"Hostname IP CPU Memory \u7cfb\u7edf\u7248\u672c Firewalld Selinux Docker Version Kubernetes Version kube1.localhost 192.168.10.11 4 vCPU 4 G CentOS 7.9 Minimal disable permissive 19.03.14-3 1.19.7 kube2.localhost 192.168.10.12 4 vCPU 4 G CentOS 7.9 Minimal disable permissive 19.03.14-3 1.19.7 kube3.localhost 192.168.10.13 4 vCPU 4 G CentOS 7.9 Minimal disable permissive 19.03.14-3 1.19.7"},{"location":"container/kubernetes/install-k8s/#_2","title":"\u521d\u59cb\u5316","text":"<pre><code># \u5173\u95ed\u9632\u706b\u5899\nsystemctl stop firewalld\nsystemctl disable firewalld\n\n# \u5173\u95ed selinux\nsed -i '/SELINUX/ s|enforcing|permissive|' /etc/selinux/config\nsetenforce 0\n\n# \u5173\u95ed swap\nswapoff -a\nsed -ri '/swap/ s|.*|#&amp;|g' /etc/fstab\n\n# \u6dfb\u52a0 dns \u8bb0\u5f55\ncat &gt;&gt; /etc/hosts &lt;&lt;-EOF\n192.168.10.11 kube1.localhost\n192.168.10.12 kube2.localhost\n192.168.10.13 kube3.localhost\nEOF\n\n# \u5f00\u542f\u8f6c\u53d1\u529f\u80fd\nsed -i '/net.ipv4.ip_forward/d' /etc/sysctl.conf\nsed -i '/net.ipv4.tcp_tw_reuse/d' /etc/sysctl.conf\nsed -i \"/net.ipv6.conf.all.disable_ipv6/d\" /etc/sysctl.conf\nsed -i \"/net.ipv6.conf.default.disable_ipv6/d\" /etc/sysctl.conf\nsed -i \"/net.ipv6.conf.lo.disable_ipv6/d\" /etc/sysctl.conf\nsed -i \"/net.ipv6.conf.all.forwarding/d\" /etc/sysctl.conf\nsed -i '/net.netfilter.nf_conntrack_max/d' /etc/sysctl.conf\nsed -i '/net.bridge.bridge-nf-call-iptables/d' /etc/sysctl.conf\nsed -i '/net.bridge.bridge-nf-call-ip6tables/d' /etc/sysctl.conf\necho \"net.ipv4.ip_forward = 1\" &gt;&gt; /etc/sysctl.conf\necho \"net.ipv4.tcp_tw_reuse = 1\" &gt;&gt; /etc/sysctl.conf\necho \"net.ipv6.conf.all.disable_ipv6 = 1\" &gt;&gt; /etc/sysctl.conf\necho \"net.ipv6.conf.default.disable_ipv6 = 1\" &gt;&gt; /etc/sysctl.conf\necho \"net.ipv6.conf.lo.disable_ipv6 = 1\" &gt;&gt; /etc/sysctl.conf\necho \"net.ipv6.conf.all.forwarding = 1\"  &gt;&gt; /etc/sysctl.conf\necho \"net.netfilter.nf_conntrack_max = 2310720\" &gt;&gt; /etc/sysctl.conf\necho \"net.bridge.bridge-nf-call-iptables = 1\" &gt;&gt; /etc/sysctl.conf\necho \"net.bridge.bridge-nf-call-ip6tables = 1\" &gt;&gt; /etc/sysctl.conf\nsysctl -p\n\n# \u540c\u6b65\u65f6\u95f4\nyum install -y chronyd systemd-timesyncd\nchronyc sources\nsed -i '/^NTP/d' /etc/systemd/timesyncd.conf\necho 'NTP=ntp.aliyun.com' &gt;&gt; /etc/systemd/timesyncd.conf\ntimedatectl set-ntp true\ntimedatectl set-timezone Asia/Shanghai\nsystemctl enable chronyd --now\nsystemctl enable systemd-timesyncd --now\ntimedatectl status\n\n# \u5f00\u542f journal \u65e5\u5fd7\u6301\u4e45\u5316\nmkdir /var/log/journal\nmkdir /etc/systemd/journald.conf.d\ncat &gt; /etc/systemd/journald.conf.d/99-prophet.conf &lt;&lt;EOF\n[Journal]\n# \u6301\u4e45\u5316\u4fdd\u5b58\u5230\u78c1\u76d8\nStorage=persistent\n# \u538b\u7f29\u5386\u53f2\u65e5\u5fd7\nCompress=yes\nSyncIntervalSec=5m\nRateLimitInterval=30s\nRateLimitBurst=1000\n# \u6700\u5927\u5360\u7528\u7a7a\u95f4 10G\nSystemMaxUse=10G\n# \u5355\u65e5\u5fd7\u6587\u4ef6\u6700\u5927 200M\nSystemMaxFileSize=200M\n# \u65e5\u5fd7\u4fdd\u5b58\u65f6\u95f4 2 \u5468\nMaxRetentionSec=2week\n# \u4e0d\u5c06\u65e5\u5fd7\u8f6c\u53d1\u5230 syslog\nForwardToSyslog=no\nEOF\nsystemctl restart systemd-journald\n\n# \u5f00\u542f IPVS\nyum install -y ipvsadm ipset\nsystemctl enable ipvsadm\ncat &gt; /etc/sysconfig/modules/ipvs.modules &lt;&lt;EOF\n#!/bin/bash\nmodprobe -- ip_vs\nmodprobe -- ip_vs_rr\nmodprobe -- ip_vs_wrr\nmodprobe -- ip_vs_sh\nmodprobe -- nf_conntrack\nEOF\nchmod 755 /etc/sysconfig/modules/ipvs.modules\nbash /etc/sysconfig/modules/ipvs.modules\nlsmod | grep -e ip_vs -e nf_conntrack\n</code></pre>"},{"location":"container/kubernetes/install-k8s/#docker","title":"\u5b89\u88c5 Docker","text":"<pre><code>cat &gt; /etc/yum.repos.d/docker-ce.repo &lt;&lt;-EOF\n[docker-ce-stable]\nname=Docker CE Stable - \\$basearch\nbaseurl=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/\\$releasever/\\$basearch/stable\nenabled=1\ngpgcheck=0\ngpgkey=https://mirrors.tuna.tsinghua.edu.cn/docker-ce/linux/centos/gpg\nEOF\nyum makecache\nyum install -y docker-ce-19.03.14-3.el7.x86_64\nsystemctl enable --now docker\ncat &gt; /etc/docker/daemon.json &lt;&lt;EOF\n{\n  \"registry-mirrors\": [\n      \"https://u4kqosl2.mirror.aliyuncs.com\",\n      \"https://mirror.baidubce.com\",\n      \"https://dockerhub.azk8s.cn\"\n    ],\n  \"exec-opts\": [\"native.cgroupdriver=systemd\"],\n  \"log-driver\": \"json-file\",\n  \"log-opts\": {\n    \"max-size\": \"100m\"\n  }\n}\nEOF\nsystemctl restart docker\n</code></pre>"},{"location":"container/kubernetes/install-k8s/#k8s_1","title":"\u5b89\u88c5 k8s \u73af\u5883","text":"<pre><code>cat &gt; /etc/yum.repos.d/kubernetes.repo &lt;&lt;-EOF\n[kubernetes]\nname=Tsinghua Kubernetes Repo\nbaseurl=https://mirrors.tuna.tsinghua.edu.cn/kubernetes/yum/repos/kubernetes-el\\$releasever-\\$basearch\nenabled=1\ngpgcheck=0\nEOF\nyum makecache\nyum remove -y kubelet kubeadm kubectl\nyum install -y kubelet-1.19.7 kubeadm-1.19.7 kubectl-1.19.7\nsystemctl enable --now kubelet\n</code></pre>"},{"location":"container/kubernetes/install-k8s/#master","title":"\u521d\u59cb\u5316 Master \u8282\u70b9","text":"<pre><code>kubernetesVersion=1.19.0\nimageRepository=registry.aliyuncs.com/k8sxio\nAPISERVER_NAME=192.168.10.11\nserviceSubnet=10.96.0.0/16\npodSubnet=10.244.0.1/16\ncat &lt;&lt;EOF &gt; ./kubeadm-config.yaml\napiVersion: kubeadm.k8s.io/v1beta2\nkind: ClusterConfiguration\nkubernetesVersion: v${kubernetesVersion}\nimageRepository: ${imageRepository}\n# localAPIEndpoint:\ncontrolPlaneEndpoint: \"${APISERVER_NAME}:6443\"\nnetworking:\n  serviceSubnet: \"${serviceSubnet}\"\n  podSubnet: \"${podSubnet}\"\n  dnsDomain: \"cluster.local\"\n---\napiVersion: kubeproxy.config.k8s.io/v1alpha1\nkind: KubeProxyConfiguration\nmode: ipvs\nEOF\n\nkubeadm config images pull --config kubeadm-config.yaml\n\nkubeadm init --config=kubeadm-config.yaml --upload-certs | tee kubeadm-config.log\n\nmkdir -p $HOME/.kube\nsudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config\nsudo chown $(id -u):$(id -g) $HOME/.kube/config\necho '' &gt;&gt; $HOME/.bashrc\necho 'source &lt;(kubectl completion bash)' &gt;&gt; $HOME/.bashrc\necho 'source &lt;(kubeadm completion bash)' &gt;&gt; $HOME/.bashrc\nsource $HOME/.bashrc\n\n# \u5b89\u88c5 Calico \u63d2\u4ef6\ncurl -O https://docs.projectcalico.org/manifests/calico.yaml\nkubectl apply -f calico.yaml\n</code></pre>"},{"location":"container/kubernetes/install-k8s/#node","title":"\u52a0\u5165 node \u8282\u70b9","text":"<ul> <li>\u4f7f\u7528\u4ee4\u724c\u52a0\u5165</li> </ul> <pre><code>kubeadm join 192.168.10.11:6443 --token 29ncpn.0z5m8tojxkbntkqz \\\n  --discovery-token-ca-cert-hash sha256:c3980f02ec3fd63c2b89ab59b06ee9a01442fc682e14c6770862b0eb3e707cf9\n</code></pre> <ul> <li>\u751f\u6210\u65b0\u4ee4\u724c</li> </ul> <pre><code>kubeadm token create --print-join-command #\u6253\u5370\u65b0\u4ee4\u724c\nkubeadm token create --ttl 0 --print-join-command #\u521b\u5efa\u4e2a\u6c38\u4e0d\u8fc7\u671f\u7684\u4ee4\u724c\n</code></pre>"},{"location":"container/kubernetes/install-metrics-server-for-k8s/","title":"\u5b89\u88c5 metrics-server","text":"<p>\u5148\u5b89\u88c5 metrics-server \uff0c\u8fd9\u6837\u5c31\u80fd\u76d1\u63a7\u5230pod\u3002node\u7684\u8d44\u6e90\u60c5\u51b5\uff08\u9ed8\u8ba4\u53ea\u6709cpu\u3001memory\u7684\u8d44\u6e90\u5ba1\u8ba1\u4fe1\u606f\u54df\uff0c\u66f4\u4e13\u4e1a\u7684\u8bdd\u9700\u8981\u5bf9\u63a5 Prometheus\uff09</p> <pre><code>cat &gt; metrics-server.yaml &lt;&lt;-EOF\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: system:aggregated-metrics-reader\n  labels:\n    rbac.authorization.k8s.io/aggregate-to-view: \"true\"\n    rbac.authorization.k8s.io/aggregate-to-edit: \"true\"\n    rbac.authorization.k8s.io/aggregate-to-admin: \"true\"\nrules:\n- apiGroups: [\"metrics.k8s.io\"]\n  resources: [\"pods\", \"nodes\"]\n  verbs: [\"get\", \"list\", \"watch\"]\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: metrics-server:system:auth-delegator\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: system:auth-delegator\nsubjects:\n- kind: ServiceAccount\n  name: metrics-server\n  namespace: kube-system\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: RoleBinding\nmetadata:\n  name: metrics-server-auth-reader\n  namespace: kube-system\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: Role\n  name: extension-apiserver-authentication-reader\nsubjects:\n- kind: ServiceAccount\n  name: metrics-server\n  namespace: kube-system\n---\napiVersion: apiregistration.k8s.io/v1beta1\nkind: APIService\nmetadata:\n  name: v1beta1.metrics.k8s.io\nspec:\n  service:\n    name: metrics-server\n    namespace: kube-system\n  group: metrics.k8s.io\n  version: v1beta1\n  insecureSkipTLSVerify: true\n  groupPriorityMinimum: 100\n  versionPriority: 100\n---\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: metrics-server\n  namespace: kube-system\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: metrics-server\n  namespace: kube-system\n  labels:\n    k8s-app: metrics-server\nspec:\n  selector:\n    matchLabels:\n      k8s-app: metrics-server\n  template:\n    metadata:\n      name: metrics-server\n      labels:\n        k8s-app: metrics-server\n    spec:\n      serviceAccountName: metrics-server\n      volumes:\n      # mount in tmp so we can safely use from-scratch images and/or read-only containers\n      - name: tmp-dir\n        emptyDir: {}\n      containers:\n      - name: metrics-server\n        image: mirrorgooglecontainers/metrics-server-amd64:v0.3.6\n        imagePullPolicy: IfNotPresent\n        args:\n          - --cert-dir=/tmp\n          - --secure-port=4443\n          - --kubelet-insecure-tls\n          - --kubelet-preferred-address-types=InternalIP,ExternalIP,Hostname\n        ports:\n        - name: main-port\n          containerPort: 4443\n          protocol: TCP\n        securityContext:\n          readOnlyRootFilesystem: true\n          runAsNonRoot: true\n          runAsUser: 1000\n        volumeMounts:\n        - name: tmp-dir\n          mountPath: /tmp\n      nodeSelector:\n        kubernetes.io/os: linux\n        kubernetes.io/arch: \"amd64\"\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: metrics-server\n  namespace: kube-system\n  labels:\n    kubernetes.io/name: \"Metrics-server\"\n    kubernetes.io/cluster-service: \"true\"\nspec:\n  selector:\n    k8s-app: metrics-server\n  ports:\n  - port: 443\n    protocol: TCP\n    targetPort: main-port\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: system:metrics-server\nrules:\n- apiGroups:\n  - \"\"\n  resources:\n  - pods\n  - nodes\n  - nodes/stats\n  - namespaces\n  - configmaps\n  verbs:\n  - get\n  - list\n  - watch\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: system:metrics-server\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: system:metrics-server\nsubjects:\n- kind: ServiceAccount\n  name: metrics-server\n  namespace: kube-system\nEOF\n\nkubectl apply -f metrics-server.yaml\n\nkubectl top node\nkubectl top pods -A\n</code></pre>"},{"location":"container/kubernetes/introduction-to-kubernetes/","title":"Kubernetes \u4ecb\u7ecd","text":"<p>Kubernetes \u662f\u7528\u4e8e\u81ea\u52a8\u90e8\u7f72\uff0c\u6269\u5c55\u548c\u7ba1\u7406\u5bb9\u5668\u5316\u5e94\u7528\u7a0b\u5e8f\u7684\u5f00\u6e90\u7cfb\u7edf\u3002</p> <p>\u5b83\u5c06\u7ec4\u6210\u5e94\u7528\u7a0b\u5e8f\u7684\u5bb9\u5668\u7ec4\u5408\u6210\u903b\u8f91\u5355\u5143\uff0c\u4ee5\u4fbf\u4e8e\u7ba1\u7406\u548c\u670d\u52a1\u53d1\u73b0\u3002Kubernetes \u6e90\u81ea Google 15 \u5e74\u751f\u4ea7\u73af\u5883\u7684\u8fd0\u7ef4\u7ecf\u9a8c\uff0c\u540c\u65f6\u51dd\u805a\u4e86\u793e\u533a\u7684\u6700\u4f73\u521b\u610f\u548c\u5b9e\u8df5\u3002</p>"},{"location":"container/kubernetes/introduction-to-kubernetes/#kubernetes_1","title":"Kubernetes \u7279\u6027","text":""},{"location":"container/kubernetes/introduction-to-kubernetes/#_1","title":"\u81ea\u52a8\u5316\u4e0a\u7ebf\u548c\u56de\u6eda","text":"<p>Kubernetes \u4f1a\u5206\u6b65\u9aa4\u5730\u5c06\u9488\u5bf9\u5e94\u7528\u6216\u5176\u914d\u7f6e\u7684\u66f4\u6539\u4e0a\u7ebf\uff0c\u540c\u65f6\u76d1\u89c6\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u72b6\u51b5\u4ee5\u786e\u4fdd\u4f60\u4e0d\u4f1a\u540c\u65f6\u7ec8\u6b62\u6240\u6709\u5b9e\u4f8b\u3002\u5982\u679c\u51fa\u73b0\u95ee\u9898\uff0cKubernetes \u4f1a\u4e3a\u4f60\u56de\u6eda\u6240\u4f5c\u66f4\u6539\u3002\u4f60\u5e94\u8be5\u5145\u5206\u5229\u7528\u4e0d\u65ad\u6210\u957f\u7684\u90e8\u7f72\u65b9\u6848\u751f\u6001\u7cfb\u7edf\u3002</p>"},{"location":"container/kubernetes/introduction-to-kubernetes/#_2","title":"\u670d\u52a1\u53d1\u73b0\u4e0e\u8d1f\u8f7d\u5747\u8861","text":"<p>\u65e0\u9700\u4fee\u6539\u4f60\u7684\u5e94\u7528\u7a0b\u5e8f\u5373\u53ef\u4f7f\u7528\u964c\u751f\u7684\u670d\u52a1\u53d1\u73b0\u673a\u5236\u3002Kubernetes \u4e3a\u5bb9\u5668\u63d0\u4f9b\u4e86\u81ea\u5df1\u7684 IP \u5730\u5740\u548c\u4e00\u4e2a DNS \u540d\u79f0\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u5b83\u4eec\u4e4b\u95f4\u5b9e\u73b0\u8d1f\u8f7d\u5747\u8861\u3002</p>"},{"location":"container/kubernetes/introduction-to-kubernetes/#_3","title":"\u5b58\u50a8\u7f16\u6392","text":"<p>\u81ea\u52a8\u6302\u8f7d\u6240\u9009\u5b58\u50a8\u7cfb\u7edf\uff0c\u5305\u62ec\u672c\u5730\u5b58\u50a8\u3001\u8bf8\u5982 GCP \u6216 AWS \u4e4b\u7c7b\u516c\u6709\u4e91\u63d0\u4f9b\u5546\u6240\u63d0\u4f9b\u7684\u5b58\u50a8\u6216\u8005\u8bf8\u5982 NFS\u3001iSCSI\u3001Gluster\u3001Ceph\u3001Cinder \u6216 Flocker \u8fd9\u7c7b\u7f51\u7edc\u5b58\u50a8\u7cfb\u7edf\u3002</p>"},{"location":"container/kubernetes/introduction-to-kubernetes/#secret","title":"Secret \u548c\u914d\u7f6e\u7ba1\u7406","text":"<p>\u90e8\u7f72\u548c\u66f4\u65b0 Secrets \u548c\u5e94\u7528\u7a0b\u5e8f\u7684\u914d\u7f6e\u800c\u4e0d\u5fc5\u91cd\u65b0\u6784\u5efa\u5bb9\u5668\u955c\u50cf\uff0c\u4e14 \u4e0d\u5fc5\u5c06\u8f6f\u4ef6\u5806\u6808\u914d\u7f6e\u4e2d\u7684\u79d8\u5bc6\u4fe1\u606f\u66b4\u9732\u51fa\u6765\u3002</p>"},{"location":"container/kubernetes/introduction-to-kubernetes/#_4","title":"\u81ea\u52a8\u88c5\u7bb1","text":"<p>\u6839\u636e\u8d44\u6e90\u9700\u6c42\u548c\u5176\u4ed6\u7ea6\u675f\u81ea\u52a8\u653e\u7f6e\u5bb9\u5668\uff0c\u540c\u65f6\u907f\u514d\u5f71\u54cd\u53ef\u7528\u6027\u3002\u5c06\u5173\u952e\u6027\u5de5\u4f5c\u8d1f\u8f7d\u548c\u5c3d\u529b\u800c\u4e3a\u6027\u8d28\u7684\u670d\u52a1\u5de5\u4f5c\u8d1f\u8f7d\u8fdb\u884c\u6df7\u5408\u653e\u7f6e\uff0c\u4ee5\u63d0\u9ad8\u8d44\u6e90\u5229\u7528\u7387\u5e76\u8282\u7701\u66f4\u591a\u8d44\u6e90\u3002</p>"},{"location":"container/kubernetes/introduction-to-kubernetes/#_5","title":"\u6279\u91cf\u6267\u884c","text":"<p>\u9664\u4e86\u670d\u52a1\u4e4b\u5916\uff0cKubernetes \u8fd8\u53ef\u4ee5\u7ba1\u7406\u4f60\u7684\u6279\u5904\u7406\u548c CI \u5de5\u4f5c\u8d1f\u8f7d\uff0c\u5728\u671f\u671b\u65f6\u66ff\u6362\u6389\u5931\u6548\u7684\u5bb9\u5668\u3002</p>"},{"location":"container/kubernetes/introduction-to-kubernetes/#ipv4ipv6","title":"IPv4/IPv6 \u53cc\u534f\u8bae\u6808","text":"<p>\u4e3a Pod \u548c Service \u5206\u914d IPv4 \u548c IPv6 \u5730\u5740</p>"},{"location":"container/kubernetes/introduction-to-kubernetes/#_6","title":"\u6c34\u5e73\u6269\u7f29","text":"<p>\u4f7f\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u547d\u4ee4\u3001\u4e00\u4e2a UI \u6216\u57fa\u4e8e CPU \u4f7f\u7528\u60c5\u51b5\u81ea\u52a8\u5bf9\u5e94\u7528\u7a0b\u5e8f\u8fdb\u884c\u6269\u7f29\u3002</p>"},{"location":"container/kubernetes/introduction-to-kubernetes/#_7","title":"\u81ea\u6211\u4fee\u590d","text":"<p>\u91cd\u65b0\u542f\u52a8\u5931\u8d25\u7684\u5bb9\u5668\uff0c\u5728\u8282\u70b9\u6b7b\u4ea1\u65f6\u66ff\u6362\u5e76\u91cd\u65b0\u8c03\u5ea6\u5bb9\u5668\uff0c\u6740\u6b7b\u4e0d\u54cd\u5e94\u7528\u6237\u5b9a\u4e49\u7684\u5065\u5eb7\u68c0\u67e5\u7684\u5bb9\u5668\uff0c\u5e76\u4e14\u5728\u5b83\u4eec\u51c6\u5907\u597d\u670d\u52a1\u4e4b\u524d\u4e0d\u4f1a\u5c06\u5b83\u4eec\u516c\u5e03\u7ed9\u5ba2\u6237\u7aef\u3002</p>"},{"location":"container/kubernetes/introduction-to-kubernetes/#_8","title":"\u4e3a\u6269\u5c55\u6027\u8bbe\u8ba1","text":"<p>\u65e0\u9700\u66f4\u6539\u4e0a\u6e38\u6e90\u7801\u5373\u53ef\u6269\u5c55\u4f60\u7684 Kubernetes \u96c6\u7fa4\u3002</p>"},{"location":"container/kubernetes/setup-nfs-as-k8s-default-sc/","title":"\u914d\u7f6e NFS \u670d\u52a1\u5668","text":"<pre><code>yum install -y nfs-utils\necho \"/nfs/data/ *(insecure,rw,sync,no_root_squash)\" &gt; /etc/exports\n# echo /nfs/data  172.26.248.0/20(rw,no_root_squash)\" &gt; /etc/exports\n\nmkdir -p /nfs/data\nsystemctl enable --now rpcbind\nsystemctl enable --now nfs-server\nexportfs -r\n#\u68c0\u67e5\u914d\u7f6e\u662f\u5426\u751f\u6548\nexportfs\n# \u8f93\u51fa\u7ed3\u679c\u5982\u4e0b\u6240\u793a\n/nfs/data &lt;world&gt;\n</code></pre>"},{"location":"container/kubernetes/setup-nfs-as-k8s-default-sc/#nfs-client","title":"\u642d\u5efa NFS Client","text":"<p>\u670d\u52a1\u5668\u7aef\u9632\u706b\u5899\u5f00\u653e111\u3001662\u3001875\u3001892\u30012049\u7684 tcp / udp \u5141\u8bb8\uff0c\u5426\u5219\u8fdc\u7aef\u5ba2\u6237\u65e0\u6cd5\u8fde\u63a5\u3002</p> <ul> <li>\u5b89\u88c5\u5ba2\u6237\u7aef\u5de5\u5177</li> </ul> <pre><code>yum install -y nfs-utils\n</code></pre> <ul> <li>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u68c0\u67e5 nfs \u670d\u52a1\u5668\u7aef\u662f\u5426\u6709\u8bbe\u7f6e\u5171\u4eab\u76ee\u5f55</li> </ul> <pre><code>showmount -e 192.168.10.11\n</code></pre> <ul> <li>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u6302\u8f7d nfs \u670d\u52a1\u5668\u4e0a\u7684\u5171\u4eab\u76ee\u5f55\u5230\u672c\u673a\u8def\u5f84 /root/nfsmount</li> </ul> <pre><code>mkdir /root/nfsmount\nmount -t nfs 192.168.10.11:/nfs/data /root/nfsmount\necho \"hello nfs server\" &gt; /root/nfsmount/index.html\n</code></pre>"},{"location":"container/kubernetes/setup-nfs-as-k8s-default-sc/#pod-nfs","title":"\u6d4b\u8bd5 Pod \u6302\u8f7d NFS","text":"<pre><code>NFS_IP=192.168.10.11\ncat &gt; ./nfs_mount.yaml &lt;&lt;-EOF\napiVersion: v1\nkind: Pod\nmetadata:\n  name: vol-nfs\n  namespace: default\nspec:\n  volumes:\n  - name: html\n    nfs:\n      path: /nfs/data\n      server: $NFS_IP\n  containers:\n  - name: myapp\n    image: nginx\n    volumeMounts:\n    - name: html\n      mountPath: /usr/share/nginx/html/\nEOF\n\nkubectl apply -f ./nfs_mount.yaml\n</code></pre> <ul> <li>\u5728 nfs \u670d\u52a1\u5668\u4e0a\u9a8c\u8bc1\u6587\u4ef6\u5199\u5165\u6210\u529f</li> </ul> <pre><code>kubectl exec -it vol-nfs -- curl localhost\n</code></pre>"},{"location":"container/kubernetes/setup-nfs-as-k8s-default-sc/#_1","title":"\u8bbe\u7f6e\u52a8\u6001\u4f9b\u5e94","text":"<p>\u521b\u5efa provisioner\uff08NFS\u73af\u5883\u524d\u9762\u5df2\u7ecf\u642d\u597d\uff09</p> \u5b57\u6bb5\u540d\u79f0 \u586b\u5165\u5185\u5bb9 \u5907\u6ce8 \u540d\u79f0 nfs-storage \u81ea\u5b9a\u4e49\u5b58\u50a8\u7c7b\u540d\u79f0 NFS Server 192.168.10.11 NFS\u670d\u52a1\u7684IP\u5730\u5740 NFS Path /nfs/data NFS\u670d\u52a1\u6240\u5171\u4eab\u7684\u8def\u5f84 <ul> <li>\u521b\u5efa\u6388\u6743</li> </ul> <pre><code>cat &gt; nfs-client-provisioner-rbac.yaml &lt;&lt;-EOF\napiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: nfs-client-provisioner\n  # replace with namespace where provisioner is deployed\n  namespace: kube-system\n---\nkind: ClusterRole\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: nfs-client-provisioner-runner\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"persistentvolumes\"]\n    verbs: [\"get\", \"list\", \"watch\", \"create\", \"delete\"]\n  - apiGroups: [\"\"]\n    resources: [\"persistentvolumeclaims\"]\n    verbs: [\"get\", \"list\", \"watch\", \"update\"]\n  - apiGroups: [\"storage.k8s.io\"]\n    resources: [\"storageclasses\"]\n    verbs: [\"get\", \"list\", \"watch\"]\n  - apiGroups: [\"\"]\n    resources: [\"events\"]\n    verbs: [\"create\", \"update\", \"patch\"]\n---\nkind: ClusterRoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: run-nfs-client-provisioner\nsubjects:\n  - kind: ServiceAccount\n    name: nfs-client-provisioner\n    # replace with namespace where provisioner is deployed\n    namespace: kube-system\nroleRef:\n  kind: ClusterRole\n  name: nfs-client-provisioner-runner\n  apiGroup: rbac.authorization.k8s.io\n---\nkind: Role\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: leader-locking-nfs-client-provisioner\n  # replace with namespace where provisioner is deployed\n  namespace: kube-system\nrules:\n  - apiGroups: [\"\"]\n    resources: [\"endpoints\"]\n    verbs: [\"get\", \"list\", \"watch\", \"create\", \"update\", \"patch\"]\n---\nkind: RoleBinding\napiVersion: rbac.authorization.k8s.io/v1\nmetadata:\n  name: leader-locking-nfs-client-provisioner\n  # replace with namespace where provisioner is deployed\n  namespace: kube-system\nsubjects:\n  - kind: ServiceAccount\n    name: nfs-client-provisioner\n    # replace with namespace where provisioner is deployed\n    namespace: kube-system\nroleRef:\n  kind: Role\n  name: leader-locking-nfs-client-provisioner\n  apiGroup: rbac.authorization.k8s.io\nEOF\n\nkubectl apply -f nfs-client-provisioner-rbac.yaml\n</code></pre> <ul> <li>\u521b\u5efa Deployment</li> </ul> <pre><code>NFS_IP=192.168.10.11\ncat &gt; nfs-client-provisioner-deployment.yaml &lt;&lt;-EOF\nkind: Deployment\napiVersion: apps/v1\nmetadata:\n  name: nfs-client-provisioner\n  namespace: kube-system\nspec:\n  replicas: 1\n  strategy:\n    type: Recreate\n  selector:\n    matchLabels:\n      app: nfs-client-provisioner\n  template:\n    metadata:\n      labels:\n        app: nfs-client-provisioner\n    spec:\n      serviceAccountName: nfs-client-provisioner\n      containers:\n        - name: nfs-client-provisioner\n          image: quay.mirrors.ustc.edu.cn/external_storage/nfs-client-provisioner:latest\n          volumeMounts:\n            - name: nfs-client-root\n              mountPath: /persistentvolumes\n          env:\n            - name: PROVISIONER_NAME\n              value: storage.pri/nfs       # \u6839\u636e\u81ea\u5df1\u7684\u540d\u79f0\u6765\u4fee\u6539\uff0c\u4e0e storageclass.yaml \u4e2d\u7684 provisioner \u540d\u5b57\u4e00\u81f4\n            - name: NFS_SERVER\n              value: $NFS_IP               # NFS\u670d\u52a1\u5668\u6240\u5728\u7684 ip\n            - name: NFS_PATH\n              value: /nfs/data             # \u5171\u4eab\u5b58\u50a8\u76ee\u5f55\n      volumes:\n        - name: nfs-client-root\n          nfs:\n            server: $NFS_IP                # NFS\u670d\u52a1\u5668\u6240\u5728\u7684 ip\n            path: /nfs/data                # \u5171\u4eab\u5b58\u50a8\u76ee\u5f55\nEOF\n\nkubectl apply -f nfs-client-provisioner-deployment.yaml\n</code></pre> <p><code>quay.io/external_storage/nfs-client-provisioner:latest</code>\u8fd9\u4e2a\u955c\u50cf\u4e2d volume \u7684mountPath \u9ed8\u8ba4\u4e3a<code>/persistentvolumes</code>\uff0c\u4e0d\u80fd\u4fee\u6539\uff0c\u5426\u5219\u8fd0\u884c\u65f6\u4f1a\u62a5\u9519\u3002</p> <ul> <li>\u521b\u5efa storageclass</li> </ul> <pre><code>cat &gt; nfs-client-provisioner-storageclass.yaml &lt;&lt;-EOF\napiVersion: storage.k8s.io/v1\nkind: StorageClass\nmetadata:\n  name: storage-nfs\nprovisioner: storage.pri/nfs\nreclaimPolicy: Retain\nEOF\n\nkubectl apply -f nfs-client-provisioner-storageclass.yaml\n</code></pre> <p>Tip</p> <p>\u6269\u5c55\"reclaim policy\"\u6709\u4e09\u79cd\u65b9\u5f0f\uff1aRetain\u3001Recycle\u3001Deleted\u3002</p> <ul> <li><code>Retain</code>: \u4fdd\u62a4\u88abPVC\u91ca\u653e\u7684PV\u53ca\u5176\u4e0a\u6570\u636e\uff0c\u5e76\u5c06PV\u72b6\u6001\u6539\u6210\"released\"\uff0c\u4e0d\u5c06\u88ab\u5176\u5b83 PVC \u7ed1\u5b9a\u3002\u96c6\u7fa4\u7ba1\u7406\u5458\u624b\u52a8\u901a\u8fc7\u5982\u4e0b\u6b65\u9aa4\u91ca\u653e\u5b58\u50a8\u8d44\u6e90\uff1a<ul> <li>\u624b\u52a8\u5220\u9664 PV\uff0c\u4f46\u4e0e\u5176\u76f8\u5173\u7684\u540e\u7aef\u5b58\u50a8\u8d44\u6e90\u5982\uff08AWS EBS, GCE PD, Azure Disk, or Cinder volume\uff09\u4ecd\u7136\u5b58\u5728\u3002</li> <li>\u624b\u52a8\u6e05\u7a7a\u540e\u7aef\u5b58\u50a8 volume \u4e0a\u7684\u6570\u636e\u3002</li> <li>\u624b\u52a8\u5220\u9664\u540e\u7aef\u5b58\u50a8 volume\uff0c\u6216\u8005\u91cd\u590d\u4f7f\u7528\u540e\u7aef volume\uff0c\u4e3a\u5176\u521b\u5efa\u65b0\u7684 PV\u3002</li> </ul> </li> <li><code>Delete</code>: \u5220\u9664\u88ab PVC \u91ca\u653e\u7684PV\u53ca\u5176\u540e\u7aef\u5b58\u50a8 volume\u3002\u5bf9\u4e8e\u52a8\u6001 PV \u5176\"reclaim policy\"\u7ee7\u627f\u81ea\u5176\"storage class\"\uff0c\u9ed8\u8ba4\u662f Delete\u3002\u96c6\u7fa4\u7ba1\u7406\u5458\u8d1f\u8d23\u5c06\"storage class\"\u7684\"reclaim policy\"\u8bbe\u7f6e\u6210\u7528\u6237\u671f\u671b\u7684\u5f62\u5f0f\uff0c\u5426\u5219\u9700\u8981\u7528\u6237\u624b\u52a8\u4e3a\u521b\u5efa\u540e\u7684\u52a8\u6001PV\u7f16\u8f91\"reclaim policy\"</li> <li><code>Recycle</code>: \u4fdd\u7559 PV\uff0c\u4f46\u6e05\u7a7a\u5176\u4e0a\u6570\u636e\uff0c\u5df2\u5e9f\u5f03</li> </ul>"},{"location":"container/kubernetes/setup-nfs-as-k8s-default-sc/#sc","title":"\u6539\u53d8\u9ed8\u8ba4 sc","text":"<ul> <li>\u67e5\u770b\u9ed8\u8ba4\u5b58\u50a8\u7c7b\u578b</li> </ul> <pre><code>kubectl get storageclass\n</code></pre> <ul> <li>\u6807\u8bb0\u9ed8\u8ba4 StorageClass \u4e3a\u975e\u9ed8\u8ba4</li> </ul> <pre><code>kubectl patch storageclass standard -p '{\"metadata\": {\"annotations\":{\"storageclass.kubernetes.io/is-default-class\":\"false\"}}}'\n</code></pre> <ul> <li>\u6807\u8bb0\u4e00\u4e2a StorageClass \u4e3a\u9ed8\u8ba4</li> </ul> <pre><code>kubectl patch storageclass storage-nfs -p '{\"metadata\": {\"annotations\":{\"storageclass.kubernetes.io/is-default-class\":\"true\"}}}'\n</code></pre>"},{"location":"container/kubernetes/setup-nfs-as-k8s-default-sc/#nfs_1","title":"\u9a8c\u8bc1 nfs \u52a8\u6001\u4f9b\u5e94","text":""},{"location":"container/kubernetes/setup-nfs-as-k8s-default-sc/#pvc","title":"\u521b\u5efa pvc","text":"<pre><code>cat &gt; nfs-pvc.yaml &lt;&lt;-EOF\napiVersion: v1\nkind: PersistentVolumeClaim\nmetadata:\n  name: pvc-claim-01\n # annotations:\n #   volume.beta.kubernetes.io/storage-class: \"storage-nfs\"\nspec:\n  storageClassName: storage-nfs  #\u8fd9\u4e2aclass\u4e00\u5b9a\u6ce8\u610f\u8981\u548csc\u7684\u540d\u5b57\u4e00\u6837\n  accessModes:\n    - ReadWriteMany\n  resources:\n    requests:\n      storage: 1Mi\nEOF\n\nkubectl apply -f nfs-pvc.yaml\n</code></pre>"},{"location":"container/kubernetes/setup-nfs-as-k8s-default-sc/#pvc_1","title":"\u4f7f\u7528 pvc","text":"<pre><code>cat &gt; nfs-test-pod.yaml &lt;&lt;-EOF\nkind: Pod\napiVersion: v1\nmetadata:\n  name: test-pod\nspec:\n  containers:\n  - name: test-pod\n    image: nginx\n    volumeMounts:\n      - name: nfs-pvc\n        mountPath: /usr/share/nginx/html/\n  restartPolicy: \"Never\"\n  volumes:\n    - name: nfs-pvc\n      persistentVolumeClaim:\n        claimName: pvc-claim-01\nEOF\n\nkubectl apply -f nfs-test-pod.yaml\nll /nfs/data/\n</code></pre>"},{"location":"interview/nginx/","title":"Nginx \u9762\u8bd5\u9898","text":""},{"location":"interview/nginx/#1-nginx","title":"1. \u4ec0\u4e48\u662f Nginx\uff1f","text":"<p>Nginx \u662f\u4e00\u4e2a \u8f7b\u91cf\u7ea7 / \u9ad8\u6027\u80fd\u7684\u53cd\u5411\u4ee3\u7406 Web \u670d\u52a1\u5668\uff0c\u7528\u4e8e HTTP\u3001HTTPS\u3001SMTP\u3001POP3 \u548c IMAP \u534f\u8bae\u3002\u4ed6\u5b9e\u73b0\u975e\u5e38\u9ad8\u6548\u7684\u53cd\u5411\u4ee3\u7406\u3001\u8d1f\u8f7d\u5e73\u8861\uff0c\u4ed6\u53ef\u4ee5\u5904\u7406 2-3 \u4e07\u5e76\u53d1\u8fde\u63a5\u6570\uff0c\u5b98\u65b9\u76d1\u6d4b\u80fd\u652f\u6301 5 \u4e07\u5e76\u53d1\uff0c\u73b0\u5728\u4e2d\u56fd\u4f7f\u7528 nginx \u7f51\u7ad9\u7528\u6237\u6709\u5f88\u591a\uff0c\u4f8b\u5982\uff1a\u65b0\u6d6a\u3001\u7f51\u6613\u3001 \u817e\u8baf\u7b49\u3002</p>"},{"location":"interview/nginx/#2-nginx","title":"2. Nginx \u6709\u54ea\u4e9b\u4f18\u70b9\uff1f","text":"<p>\u8de8\u5e73\u53f0\u3001\u914d\u7f6e\u7b80\u5355\u3002</p> <p>\u975e\u963b\u585e\u3001\u9ad8\u5e76\u53d1\u8fde\u63a5\uff1a\u5904\u7406 2-3 \u4e07\u5e76\u53d1\u8fde\u63a5\u6570\uff0c\u5b98\u65b9\u76d1\u6d4b\u80fd\u652f\u6301 5 \u4e07\u5e76\u53d1\u3002</p> <p>\u5185\u5b58\u6d88\u8017</p> <p>\u5c0f\uff1a\u5f00\u542f 10 \u4e2a Nginx \u624d\u5360 150M \u5185\u5b58\u3002</p> <p>\u6210\u672c\u4f4e\u5ec9\uff0c\u4e14\u5f00\u6e90\u3002</p> <p>\u7a33\u5b9a\u6027\u9ad8\uff0c\u5b95\u673a\u7684\u6982\u7387\u975e\u5e38\u5c0f\u3002</p> <p>\u5185\u7f6e\u7684\u5065\u5eb7\u68c0\u67e5\u529f\u80fd\uff1a\u5982\u679c\u6709\u4e00\u4e2a\u670d\u52a1\u5668\u5b95\u673a\uff0c\u4f1a\u505a\u4e00\u4e2a\u5065\u5eb7\u68c0\u67e5\uff0c\u518d\u53d1\u9001\u7684\u8bf7\u6c42\u5c31\u4e0d\u4f1a\u53d1\u9001\u5230\u5b95\u673a\u7684\u670d\u52a1\u5668\u4e86\u3002\u91cd\u65b0\u5c06\u8bf7\u6c42\u63d0\u4ea4\u5230\u5176\u4ed6\u7684\u8282\u70b9\u4e0a</p>"},{"location":"interview/nginx/#3-nginx","title":"3. Nginx \u5e94\u7528\u573a\u666f\uff1f","text":"<p>http \u670d\u52a1\u5668\u3002Nginx \u662f\u4e00\u4e2a http \u670d\u52a1\u53ef\u4ee5\u72ec\u7acb\u63d0\u4f9b http \u670d\u52a1\u3002\u53ef\u4ee5\u505a\u7f51\u9875\u9759\u6001\u670d\u52a1\u5668\u3002</p> <p>\u865a\u62df\u4e3b\u673a\u3002\u53ef\u4ee5\u5b9e\u73b0\u5728\u4e00\u53f0\u670d\u52a1\u5668\u865a\u62df\u51fa\u591a\u4e2a\u7f51\u7ad9\uff0c\u4f8b\u5982\u4e2a\u4eba\u7f51\u7ad9\u4f7f\u7528\u7684\u865a\u62df\u673a\u3002</p> <p>\u53cd\u5411\u4ee3\u7406\uff0c\u8d1f\u8f7d\u5747\u8861\u3002\u5f53\u7f51\u7ad9\u7684\u8bbf\u95ee\u91cf\u8fbe\u5230\u4e00\u5b9a\u7a0b\u5ea6\u540e\uff0c\u5355\u53f0\u670d\u52a1\u5668\u4e0d\u80fd\u6ee1\u8db3\u7528\u6237\u7684\u8bf7\u6c42\u65f6\uff0c\u9700\u8981\u7528\u591a\u53f0\u670d\u52a1\u5668\u96c6\u7fa4\u53ef\u4ee5\u4f7f\u7528 nginx \u505a\u53cd\u5411\u4ee3\u7406\u3002\u5e76\u4e14\u591a\u53f0\u670d\u52a1\u5668\u53ef\u4ee5\u5e73\u5747\u5206\u62c5\u8d1f\u8f7d\uff0c\u4e0d\u4f1a\u5e94\u4e3a\u67d0\u53f0\u670d\u52a1\u5668\u8d1f\u8f7d\u9ad8\u5b95\u673a\u800c\u67d0\u53f0\u670d\u52a1\u5668\u95f2\u7f6e\u7684\u60c5\u51b5\u3002</p> <p>nginz \u4e2d\u4e5f\u53ef\u4ee5\u914d\u7f6e\u5b89\u5168\u7ba1\u7406\u3001\u6bd4\u5982\u53ef\u4ee5\u4f7f\u7528 Nginx \u642d\u5efa API \u63a5\u53e3\u7f51\u5173, \u5bf9\u6bcf\u4e2a\u63a5\u53e3\u670d\u52a1\u8fdb\u884c\u62e6\u622a\u3002</p>"},{"location":"interview/nginx/#4-nginx","title":"4. Nginx \u600e\u4e48\u5904\u7406\u8bf7\u6c42\u7684\uff1f","text":"<pre><code>server { # \u7b2c\u4e00\u4e2aServer\u533a\u5757\u5f00\u59cb\uff0c\u8868\u793a\u4e00\u4e2a\u72ec\u7acb\u7684\u865a\u62df\u4e3b\u673a\u7ad9\u70b9\n   listen       80\uff1b# \u63d0\u4f9b\u670d\u52a1\u7684\u7aef\u53e3\uff0c\u9ed8\u8ba480\n   server_name localhost; # \u63d0\u4f9b\u670d\u52a1\u7684\u57df\u540d\u4e3b\u673a\u540d\n   location / { # \u7b2c\u4e00\u4e2alocation\u533a\u5757\u5f00\u59cb\n     root   html; # \u7ad9\u70b9\u7684\u6839\u76ee\u5f55\uff0c\u76f8\u5f53\u4e8eNginx\u7684\u5b89\u88c5\u76ee\u5f55\n     index  index.html index.html; # \u9ed8\u8ba4\u7684\u9996\u9875\u6587\u4ef6\uff0c\u591a\u4e2a\u7528\u7a7a\u683c\u5206\u5f00\n} # \u7b2c\u4e00\u4e2alocation\u533a\u5757\u7ed3\u679c\n</code></pre> <p>\u9996\u5148\uff0cNginx \u5728\u542f\u52a8\u65f6\uff0c\u4f1a\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\uff0c\u5f97\u5230\u9700\u8981\u76d1\u542c\u7684\u7aef\u53e3\u4e0e IP \u5730\u5740\uff0c\u7136\u540e\u5728 Nginx \u7684 Master \u8fdb\u7a0b\u91cc\u9762\u5148\u521d\u59cb\u5316\u597d\u8fd9\u4e2a\u76d1\u63a7\u7684 Socket(\u521b\u5efa S ocket\uff0c\u8bbe\u7f6e addr\u3001reuse \u7b49\u9009\u9879\uff0c\u7ed1\u5b9a\u5230\u6307\u5b9a\u7684 ip \u5730\u5740\u7aef\u53e3\uff0c\u518d listen \u76d1\u542c)\u3002</p> <p>\u7136\u540e\uff0c\u518d fork(\u4e00\u4e2a\u73b0\u6709\u8fdb\u7a0b\u53ef\u4ee5\u8c03\u7528 fork \u51fd\u6570\u521b\u5efa\u4e00\u4e2a\u65b0\u8fdb\u7a0b\u3002\u7531 fork \u521b\u5efa\u7684\u65b0\u8fdb\u7a0b\u88ab\u79f0\u4e3a\u5b50\u8fdb\u7a0b) \u51fa\u591a\u4e2a\u5b50\u8fdb\u7a0b\u51fa\u6765\u3002</p> <p>\u4e4b\u540e\uff0c\u5b50\u8fdb\u7a0b\u4f1a\u7ade\u4e89 accept \u65b0\u7684\u8fde\u63a5\u3002\u6b64\u65f6\uff0c\u5ba2\u6237\u7aef\u5c31\u53ef\u4ee5\u5411 nginx \u53d1\u8d77\u8fde\u63a5\u4e86\u3002\u5f53\u5ba2\u6237\u7aef\u4e0e nginx \u8fdb\u884c\u4e09\u6b21\u63e1\u624b\uff0c\u4e0e nginx \u5efa\u7acb\u597d\u4e00\u4e2a\u8fde\u63a5\u540e\u3002\u6b64\u65f6\uff0c\u67d0\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u4f1a accept \u6210\u529f\uff0c\u5f97\u5230\u8fd9\u4e2a\u5efa\u7acb\u597d\u7684\u8fde\u63a5\u7684 Socket \uff0c\u7136\u540e\u521b\u5efa nginx \u5bf9\u8fde\u63a5\u7684\u5c01\u88c5\uff0c\u5373 ngx_connection_t \u7ed3\u6784\u4f53\u3002</p> <p>\u63a5\u7740\uff0c\u8bbe\u7f6e\u8bfb\u5199\u4e8b\u4ef6\u5904\u7406\u51fd\u6570\uff0c\u5e76\u6dfb\u52a0\u8bfb\u5199\u4e8b\u4ef6\u6765\u4e0e\u5ba2\u6237\u7aef\u8fdb\u884c\u6570\u636e\u7684\u4ea4\u6362\u3002</p> <p>\u6700\u540e\uff0cNginx \u6216\u5ba2\u6237\u7aef\u6765\u4e3b\u52a8\u5173\u6389\u8fde\u63a5\uff0c\u5230\u6b64\uff0c\u4e00\u4e2a\u8fde\u63a5\u5c31\u5bff\u7ec8\u6b63\u5bdd\u4e86\u3002</p>"},{"location":"interview/nginx/#5-nginx","title":"5. Nginx \u662f\u5982\u4f55\u5b9e\u73b0\u9ad8\u5e76\u53d1\u7684\uff1f","text":"<p>\u201c\u5982\u679c\u4e00\u4e2a server \u91c7\u7528\u4e00\u4e2a\u8fdb\u7a0b (\u6216\u8005\u7ebf\u7a0b) \u8d1f\u8d23\u4e00\u4e2a request \u7684\u65b9\u5f0f\uff0c\u90a3\u4e48\u8fdb\u7a0b\u6570\u5c31\u662f\u5e76\u53d1\u6570\u3002\u90a3\u4e48\u663e\u800c\u6613\u89c1\u7684\uff0c\u5c31\u662f\u4f1a\u6709\u5f88\u591a\u8fdb\u7a0b\u5728\u7b49\u5f85\u4e2d\u3002\u7b49\u4ec0\u4e48\uff1f\u6700\u591a\u7684\u5e94\u8be5\u662f\u7b49\u5f85\u7f51\u7edc\u4f20\u8f93\u3002 \u201c\u800c Nginx \u7684\u5f02\u6b65\u975e\u963b\u585e\u5de5\u4f5c\u65b9\u5f0f\u6b63\u662f\u5229\u7528\u4e86\u8fd9\u70b9\u7b49\u5f85\u7684\u65f6\u95f4\u3002\u5728\u9700\u8981\u7b49\u5f85\u7684\u65f6\u5019\uff0c\u8fd9\u4e9b\u8fdb\u7a0b\u5c31\u7a7a\u95f2\u51fa\u6765\u5f85\u547d\u4e86\u3002\u56e0\u6b64\u8868\u73b0\u4e3a\u5c11\u6570\u51e0\u4e2a\u8fdb\u7a0b\u5c31\u89e3\u51b3\u4e86\u5927\u91cf\u7684\u5e76\u53d1\u95ee\u9898\u3002 \u201cNginx \u662f\u5982\u4f55\u5229\u7528\u7684\u5462\uff0c\u7b80\u5355\u6765\u8bf4\uff1a\u540c\u6837\u7684 4 \u4e2a\u8fdb\u7a0b\uff0c\u5982\u679c\u91c7\u7528\u4e00\u4e2a\u8fdb\u7a0b\u8d1f\u8d23\u4e00\u4e2a request \u7684\u65b9\u5f0f\uff0c\u90a3\u4e48\uff0c\u540c\u65f6\u8fdb\u6765 4 \u4e2a request \u4e4b\u540e\uff0c\u6bcf\u4e2a\u8fdb\u7a0b\u5c31\u8d1f\u8d23\u5176\u4e2d\u4e00\u4e2a\uff0c\u76f4\u81f3\u4f1a\u8bdd\u5173\u95ed\u3002\u671f\u95f4\uff0c\u5982\u679c\u6709\u7b2c 5 \u4e2a request \u8fdb\u6765\u4e86\u3002\u5c31\u65e0\u6cd5\u53ca\u65f6\u53cd\u5e94\u4e86\uff0c\u56e0\u4e3a 4 \u4e2a\u8fdb\u7a0b\u90fd\u6ca1\u5e72\u5b8c\u6d3b\u5462\uff0c\u56e0\u6b64\uff0c\u4e00\u822c\u6709\u4e2a\u8c03\u5ea6\u8fdb\u7a0b\uff0c\u6bcf\u5f53\u65b0\u8fdb\u6765\u4e86\u4e00\u4e2a request \uff0c\u5c31\u65b0\u5f00\u4e2a\u8fdb\u7a0b\u6765\u5904\u7406\u3002 \u56de\u60f3\u4e0b\uff0cBIO \u662f\u4e0d\u662f\u5b58\u5728\u9171\u7d2b\u7684\u95ee\u9898\uff1f</p> <p>\u201cNginx \u4e0d\u8fd9\u6837\uff0c\u6bcf\u8fdb\u6765\u4e00\u4e2a request \uff0c\u4f1a\u6709\u4e00\u4e2a worker \u8fdb\u7a0b\u53bb\u5904\u7406\u3002\u4f46\u4e0d\u662f\u5168\u7a0b\u7684\u5904\u7406\uff0c\u5904\u7406\u5230\u4ec0\u4e48\u7a0b\u5ea6\u5462\uff1f\u5904\u7406\u5230\u53ef\u80fd\u53d1\u751f\u963b\u585e\u7684\u5730\u65b9\uff0c\u6bd4\u5982\u5411\u4e0a\u6e38\uff08\u540e\u7aef\uff09\u670d\u52a1\u5668\u8f6c\u53d1 request \uff0c\u5e76\u7b49\u5f85\u8bf7\u6c42\u8fd4\u56de\u3002\u90a3\u4e48\uff0c\u8fd9\u4e2a\u5904\u7406\u7684 worker \u4e0d\u4f1a\u8fd9\u4e48\u50bb\u7b49\u7740\uff0c\u4ed6\u4f1a\u5728\u53d1\u9001\u5b8c\u8bf7\u6c42\u540e\uff0c\u6ce8\u518c\u4e00\u4e2a\u4e8b\u4ef6\uff1a\u201c\u5982\u679c upstream \u8fd4\u56de\u4e86\uff0c\u544a\u8bc9\u6211\u4e00\u58f0\uff0c\u6211\u518d\u63a5\u7740\u5e72\u201d\u3002\u4e8e\u662f\u4ed6\u5c31\u4f11\u606f\u53bb\u4e86\u3002\u6b64\u65f6\uff0c\u5982\u679c\u518d\u6709 request \u8fdb\u6765\uff0c\u4ed6\u5c31\u53ef\u4ee5\u5f88\u5feb\u518d\u6309\u8fd9\u79cd\u65b9\u5f0f\u5904\u7406\u3002\u800c\u4e00\u65e6\u4e0a\u6e38\u670d\u52a1\u5668\u8fd4\u56de\u4e86\uff0c\u5c31\u4f1a\u89e6\u53d1\u8fd9\u4e2a\u4e8b\u4ef6\uff0cworker \u624d\u4f1a\u6765\u63a5\u624b\uff0c\u8fd9\u4e2a request \u624d\u4f1a\u63a5\u7740\u5f80\u4e0b\u8d70\u3002 \u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u8bf4\uff0cNginx \u57fa\u4e8e\u4e8b\u4ef6\u6a21\u578b\u3002</p> <p>\u7531\u4e8e web server \u7684\u5de5\u4f5c\u6027\u8d28\u51b3\u5b9a\u4e86\u6bcf\u4e2a request \u7684\u5927\u90e8\u4efd\u751f\u547d\u90fd\u662f\u5728\u7f51\u7edc\u4f20\u8f93\u4e2d\uff0c\u5b9e\u9645\u4e0a\u82b1\u8d39\u5728 server \u673a\u5668\u4e0a\u7684\u65f6\u95f4\u7247\u4e0d\u591a\u3002\u8fd9\u662f\u51e0\u4e2a\u8fdb\u7a0b\u5c31\u89e3\u51b3\u9ad8\u5e76\u53d1\u7684\u79d8\u5bc6\u6240\u5728\u3002\u5373\uff1a</p> <p>webserver \u521a\u597d\u5c5e\u4e8e\u7f51\u7edc IO \u5bc6\u96c6\u578b\u5e94\u7528\uff0c\u4e0d\u7b97\u662f\u8ba1\u7b97\u5bc6\u96c6\u578b\u3002</p> <p>\u5f02\u6b65\uff0c\u975e\u963b\u585e\uff0c\u4f7f\u7528 epoll \uff0c\u548c\u5927\u91cf\u7ec6\u8282\u5904\u7684\u4f18\u5316\u3002\u4e5f\u6b63\u662f Nginx \u4e4b\u6240\u4ee5\u7136\u7684\u6280\u672f\u57fa\u77f3\u3002</p>"},{"location":"interview/nginx/#6","title":"6. \u4ec0\u4e48\u662f\u6b63\u5411\u4ee3\u7406\uff1f","text":"<p>\u201c\u4e00\u4e2a\u4f4d\u4e8e\u5ba2\u6237\u7aef\u548c\u539f\u59cb\u670d\u52a1\u5668 (origin server) \u4e4b\u95f4\u7684\u670d\u52a1\u5668\uff0c\u4e3a\u4e86\u4ece\u539f\u59cb\u670d\u52a1\u5668\u53d6\u5f97\u5185\u5bb9\uff0c\u5ba2\u6237\u7aef\u5411\u4ee3\u7406\u53d1\u9001\u4e00\u4e2a\u8bf7\u6c42\u5e76\u6307\u5b9a\u76ee\u6807(\u539f\u59cb\u670d\u52a1\u5668)\uff0c\u7136\u540e\u4ee3\u7406\u5411\u539f\u59cb\u670d\u52a1\u5668\u8f6c\u4ea4\u8bf7\u6c42\u5e76\u5c06\u83b7\u5f97\u7684\u5185\u5bb9\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002 \u5ba2\u6237\u7aef\u624d\u80fd\u4f7f\u7528\u6b63\u5411\u4ee3\u7406\u3002\u6b63\u5411\u4ee3\u7406\u603b\u7ed3\u5c31\u4e00\u53e5\u8bdd\uff1a\u4ee3\u7406\u7aef\u4ee3\u7406\u7684\u662f\u5ba2\u6237\u7aef\u3002\u4f8b\u5982\u8bf4\uff1a\u6211\u4eec\u4f7f\u7528\u7684 OpenVPN \u7b49\u7b49\u3002</p>"},{"location":"interview/nginx/#7","title":"7. \u4ec0\u4e48\u662f\u53cd\u5411\u4ee3\u7406\uff1f","text":"<p>\u53cd\u5411\u4ee3\u7406\uff08Reverse Proxy\uff09\u65b9\u5f0f\uff0c\u662f\u6307\u4ee5\u4ee3\u7406\u670d\u52a1\u5668\u6765\u63a5\u53d7 Internet \u4e0a\u7684\u8fde\u63a5\u8bf7\u6c42\uff0c\u7136\u540e\u5c06\u8bf7\u6c42\uff0c\u53d1\u7ed9\u5185\u90e8\u7f51\u7edc\u4e0a\u7684\u670d\u52a1\u5668\u5e76\u5c06\u4ece\u670d\u52a1\u5668\u4e0a\u5f97\u5230\u7684\u7ed3\u679c\u8fd4\u56de\u7ed9 Internet \u4e0a\u8bf7\u6c42\u8fde\u63a5\u7684\u5ba2\u6237\u7aef\uff0c\u6b64\u65f6\u4ee3\u7406\u670d\u52a1\u5668\u5bf9\u5916\u5c31\u8868\u73b0\u4e3a\u4e00\u4e2a\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u3002</p> <p>\u201c\u53cd\u5411\u4ee3\u7406\u603b\u7ed3\u5c31\u4e00\u53e5\u8bdd\uff1a\u4ee3\u7406\u7aef\u4ee3\u7406\u7684\u662f\u670d\u52a1\u7aef\u3002</p>"},{"location":"interview/nginx/#8","title":"8. \u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u7684\u4f18\u70b9\u662f\u4ec0\u4e48?","text":"<p>\u201c\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\u53ef\u4ee5\u9690\u85cf\u6e90\u670d\u52a1\u5668\u7684\u5b58\u5728\u548c\u7279\u5f81\u3002\u5b83\u5145\u5f53\u4e92\u8054\u7f51\u4e91\u548c web \u670d\u52a1\u5668\u4e4b\u95f4\u7684\u4e2d\u95f4\u5c42\u3002\u8fd9\u5bf9\u4e8e\u5b89\u5168\u65b9\u9762\u6765\u8bf4\u662f\u5f88\u597d\u7684\uff0c\u7279\u522b\u662f\u5f53\u60a8\u4f7f\u7528 web \u6258\u7ba1\u670d\u52a1\u65f6\u3002</p>"},{"location":"interview/nginx/#9-nginx","title":"9. Nginx \u76ee\u5f55\u7ed3\u6784\u6709\u54ea\u4e9b\uff1f","text":"<pre><code>tree /usr/local/nginx\n/usr/local/nginx\n\u251c\u2500\u2500 client_body_temp\n\u251c\u2500\u2500 conf # Nginx\u6240\u6709\u914d\u7f6e\u6587\u4ef6\u7684\u76ee\u5f55\n\u2502 \u251c\u2500\u2500 fastcgi.conf # fastcgi\u76f8\u5173\u53c2\u6570\u7684\u914d\u7f6e\u6587\u4ef6\n\u2502 \u251c\u2500\u2500 fastcgi.conf.default         # fastcgi.conf\u7684\u539f\u59cb\u5907\u4efd\u6587\u4ef6\n\u2502 \u251c\u2500\u2500 fastcgi_params # fastcgi\u7684\u53c2\u6570\u6587\u4ef6\n\u2502 \u251c\u2500\u2500 fastcgi_params.default       \n\u2502 \u251c\u2500\u2500 koi-utf\n\u2502 \u251c\u2500\u2500 koi-win\n\u2502 \u251c\u2500\u2500 mime.types # \u5a92\u4f53\u7c7b\u578b\n\u2502 \u251c\u2500\u2500 mime.types.default\n\u2502 \u251c\u2500\u2500 nginx.conf # Nginx\u4e3b\u914d\u7f6e\u6587\u4ef6\n\u2502 \u251c\u2500\u2500 nginx.conf.default\n\u2502 \u251c\u2500\u2500 scgi_params # scgi\u76f8\u5173\u53c2\u6570\u6587\u4ef6\n\u2502 \u251c\u2500\u2500 scgi_params.default  \n\u2502 \u251c\u2500\u2500 uwsgi_params # uwsgi\u76f8\u5173\u53c2\u6570\u6587\u4ef6\n\u2502 \u251c\u2500\u2500 uwsgi_params.default\n\u2502 \u2514\u2500\u2500 win-utf\n\u251c\u2500\u2500 fastcgi_temp # fastcgi\u4e34\u65f6\u6570\u636e\u76ee\u5f55\n\u251c\u2500\u2500 html # Nginx\u9ed8\u8ba4\u7ad9\u70b9\u76ee\u5f55\n\u2502 \u251c\u2500\u2500 50x.html # \u9519\u8bef\u9875\u9762\u4f18\u96c5\u66ff\u4ee3\u663e\u793a\u6587\u4ef6\uff0c\u4f8b\u5982\u5f53\u51fa\u73b0502\u9519\u8bef\u65f6\u4f1a\u8c03\u7528\u6b64\u9875\u9762\n\u2502 \u2514\u2500\u2500 index.html # \u9ed8\u8ba4\u7684\u9996\u9875\u6587\u4ef6\n\u251c\u2500\u2500 logs # Nginx\u65e5\u5fd7\u76ee\u5f55\n\u2502 \u251c\u2500\u2500 access.log # \u8bbf\u95ee\u65e5\u5fd7\u6587\u4ef6\n\u2502 \u251c\u2500\u2500 error.log # \u9519\u8bef\u65e5\u5fd7\u6587\u4ef6\n\u2502 \u2514\u2500\u2500 nginx.pid # pid\u6587\u4ef6\uff0cNginx\u8fdb\u7a0b\u542f\u52a8\u540e\uff0c\u4f1a\u628a\u6240\u6709\u8fdb\u7a0b\u7684ID\u53f7\u5199\u5230\u6b64\u6587\u4ef6\n\u251c\u2500\u2500 proxy_temp # \u4e34\u65f6\u76ee\u5f55\n\u251c\u2500\u2500 sbin # Nginx\u547d\u4ee4\u76ee\u5f55\n\u2502 \u2514\u2500\u2500 nginx # Nginx\u7684\u542f\u52a8\u547d\u4ee4\n\u251c\u2500\u2500 scgi_temp # \u4e34\u65f6\u76ee\u5f55\n\u2514\u2500\u2500 uwsgi_temp # \u4e34\u65f6\u76ee\u5f55\n</code></pre>"},{"location":"interview/nginx/#10-nginx-nginxconf","title":"10. Nginx \u914d\u7f6e\u6587\u4ef6 nginx.conf \u6709\u54ea\u4e9b\u5c5e\u6027\u6a21\u5757?","text":"<pre><code>worker_processes  1\uff1b# worker\u8fdb\u7a0b\u7684\u6570\u91cf\nevents { # \u4e8b\u4ef6\u533a\u5757\u5f00\u59cb\n    worker_connections  1024\uff1b# \u6bcf\u4e2aworker\u8fdb\u7a0b\u652f\u6301\u7684\u6700\u5927\u8fde\u63a5\u6570\n} # \u4e8b\u4ef6\u533a\u5757\u7ed3\u675f\nhttp { # HTTP\u533a\u5757\u5f00\u59cb\n    include       mime.types\uff1b# Nginx\u652f\u6301\u7684\u5a92\u4f53\u7c7b\u578b\u5e93\u6587\u4ef6\n    default_type application/octet-stream\uff1b# \u9ed8\u8ba4\u7684\u5a92\u4f53\u7c7b\u578b\n    sendfile on\uff1b# \u5f00\u542f\u9ad8\u6548\u4f20\u8f93\u6a21\u5f0f\n    keepalive_timeout 65\uff1b# \u8fde\u63a5\u8d85\u65f6\n    server { # \u7b2c\u4e00\u4e2aServer\u533a\u5757\u5f00\u59cb\uff0c\u8868\u793a\u4e00\u4e2a\u72ec\u7acb\u7684\u865a\u62df\u4e3b\u673a\u7ad9\u70b9\n        listen       80\uff1b# \u63d0\u4f9b\u670d\u52a1\u7684\u7aef\u53e3\uff0c\u9ed8\u8ba480\n        server_name localhost\uff1b# \u63d0\u4f9b\u670d\u52a1\u7684\u57df\u540d\u4e3b\u673a\u540d\n        location / { # \u7b2c\u4e00\u4e2alocation\u533a\u5757\u5f00\u59cb\n            root   html\uff1b# \u7ad9\u70b9\u7684\u6839\u76ee\u5f55\uff0c\u76f8\u5f53\u4e8eNginx\u7684\u5b89\u88c5\u76ee\u5f55\n            index index.html index.htm\uff1b# \u9ed8\u8ba4\u7684\u9996\u9875\u6587\u4ef6\uff0c\u591a\u4e2a\u7528\u7a7a\u683c\u5206\u5f00\n        } # \u7b2c\u4e00\u4e2alocation\u533a\u5757\u7ed3\u679c\n        error_page 500502503504  /50x.html\uff1b# \u51fa\u73b0\u5bf9\u5e94\u7684http\u72b6\u6001\u7801\u65f6\uff0c\u4f7f\u752850x.html\u56de\u5e94\u5ba2\u6237\n        location = /50x.html { # location\u533a\u5757\u5f00\u59cb\uff0c\u8bbf\u95ee50x.html\n            root   html\uff1b# \u6307\u5b9a\u5bf9\u5e94\u7684\u7ad9\u70b9\u76ee\u5f55\u4e3ahtml\n        }\n    }\n    ......\n</code></pre>"},{"location":"interview/nginx/#11-cookie-session","title":"11. cookie \u548c session \u533a\u522b\uff1f","text":"<p>\u5171\u540c\uff1a</p> <p>\u5b58\u653e\u7528\u6237\u4fe1\u606f\u3002\u5b58\u653e\u7684\u5f62\u5f0f\uff1akey-value \u683c\u5f0f \u53d8\u91cf\u548c\u53d8\u91cf\u5185\u5bb9\u952e\u503c\u5bf9\u3002</p> <p>\u533a\u522b\uff1a</p> <ul> <li> <p>cookie</p> <p>\u5b58\u653e\u5728\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668</p> <p>\u6bcf\u4e2a\u57df\u540d\u5bf9\u5e94\u4e00\u4e2a cookie\uff0c\u4e0d\u80fd\u8de8\u8dc3\u57df\u540d\u8bbf\u95ee\u5176\u4ed6 cookie\uff0c\u7528\u6237\u53ef\u4ee5\u67e5\u770b\u6216\u4fee\u6539 cookie</p> </li> </ul> <p>http \u54cd\u5e94\u62a5\u6587\u91cc\u9762\u7ed9\u4f60\u6d4f\u89c8\u5668\u8bbe\u7f6e</p> <p>\u94a5\u5319\uff08\u7528\u4e8e\u6253\u5f00\u6d4f\u89c8\u5668\u4e0a\u9501\u5934\uff09</p> <p>session:</p> <p>\u5b58\u653e\u5728\u670d\u52a1\u5668\uff08\u6587\u4ef6\uff0c\u6570\u636e\u5e93\uff0credis\uff09</p> <p>\u5b58\u653e\u654f\u611f\u4fe1\u606f</p> <p>\u9501\u5934</p>"},{"location":"interview/nginx/#12-nginx","title":"12. \u4e3a\u4ec0\u4e48 Nginx \u4e0d\u4f7f\u7528\u591a\u7ebf\u7a0b\uff1f","text":"<p>\u201cApache: \u521b\u5efa\u591a\u4e2a\u8fdb\u7a0b\u6216\u7ebf\u7a0b\uff0c\u800c\u6bcf\u4e2a\u8fdb\u7a0b\u6216\u7ebf\u7a0b\u90fd\u4f1a\u4e3a\u5176\u5206\u914d cpu \u548c\u5185\u5b58\uff08\u7ebf\u7a0b\u8981\u6bd4\u8fdb\u7a0b\u5c0f\u7684\u591a\uff0c\u6240\u4ee5 worker \u652f\u6301\u6bd4 perfork \u9ad8\u7684\u5e76\u53d1\uff09\uff0c\u5e76\u53d1\u8fc7\u5927\u4f1a\u69a8\u5e72\u670d\u52a1\u5668\u8d44\u6e90\u3002 Nginx: \u91c7\u7528\u5355\u7ebf\u7a0b\u6765\u5f02\u6b65\u975e\u963b\u585e\u5904\u7406\u8bf7\u6c42\uff08\u7ba1\u7406\u5458\u53ef\u4ee5\u914d\u7f6e Nginx \u4e3b\u8fdb\u7a0b\u7684\u5de5\u4f5c\u8fdb\u7a0b\u7684\u6570\u91cf\uff09(epoll)\uff0c\u4e0d\u4f1a\u4e3a\u6bcf\u4e2a\u8bf7\u6c42\u5206\u914d cpu \u548c\u5185\u5b58\u8d44\u6e90\uff0c\u8282\u7701\u4e86\u5927\u91cf\u8d44\u6e90\uff0c\u540c\u65f6\u4e5f\u51cf\u5c11\u4e86\u5927\u91cf\u7684 CPU \u7684\u4e0a\u4e0b\u6587\u5207\u6362\u3002\u6240\u4ee5\u624d\u4f7f\u5f97 Nginx \u652f\u6301\u66f4\u9ad8\u7684\u5e76\u53d1\u3002</p>"},{"location":"interview/nginx/#13-nginx-apache","title":"13. nginx \u548c apache \u7684\u533a\u522b","text":"<p>\u8f7b\u91cf\u7ea7\uff0c\u540c\u6837\u8d77 web \u670d\u52a1\uff0c\u6bd4 apache \u5360\u7528\u66f4\u5c11\u7684\u5185\u5b58\u548c\u8d44\u6e90\u3002</p> <p>\u6297\u5e76\u53d1\uff0cnginx \u5904\u7406\u8bf7\u6c42\u662f\u5f02\u6b65\u975e\u963b\u585e\u7684\uff0c\u800c apache \u5219\u662f\u963b\u585e\u6027\u7684\uff0c\u5728\u9ad8\u5e76\u53d1\u4e0b nginx \u80fd\u4fdd\u6301\u4f4e\u8d44\u6e90\uff0c\u4f4e\u6d88\u8017\u9ad8\u6027\u80fd\u3002</p> <p>\u9ad8\u5ea6\u6a21\u5757\u5316\u7684\u8bbe\u8ba1\uff0c\u7f16\u5199\u6a21\u5757\u76f8\u5bf9\u7b80\u5355\u3002</p> <p>\u6700\u6838\u5fc3\u7684\u533a\u522b\u5728\u4e8e apache \u662f\u540c\u6b65\u591a\u8fdb\u7a0b\u6a21\u578b\uff0c\u4e00\u4e2a\u8fde\u63a5\u5bf9\u5e94\u4e00\u4e2a\u8fdb\u7a0b\uff0cnginx \u662f\u5f02\u6b65\u7684\uff0c\u591a\u4e2a\u8fde\u63a5\u53ef\u4ee5\u5bf9\u5e94\u4e00\u4e2a\u8fdb\u7a0b\u3002</p> <p></p>"},{"location":"interview/nginx/#14","title":"14. \u4ec0\u4e48\u662f\u52a8\u6001\u8d44\u6e90\u3001\u9759\u6001\u8d44\u6e90\u5206\u79bb\uff1f","text":"<p>\u201c\u52a8\u6001\u8d44\u6e90\u3001\u9759\u6001\u8d44\u6e90\u5206\u79bb\uff0c\u662f\u8ba9\u52a8\u6001\u7f51\u7ad9\u91cc\u7684\u52a8\u6001\u7f51\u9875\u6839\u636e\u4e00\u5b9a\u89c4\u5219\u628a\u4e0d\u53d8\u7684\u8d44\u6e90\u548c\u7ecf\u5e38\u53d8\u7684\u8d44\u6e90\u533a\u5206\u5f00\u6765\uff0c\u52a8\u9759\u8d44\u6e90\u505a\u597d\u4e86\u62c6\u5206\u4ee5\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u6839\u636e\u9759\u6001\u8d44\u6e90\u7684\u7279\u70b9\u5c06\u5176\u505a\u7f13\u5b58\u64cd\u4f5c\uff0c\u8fd9\u5c31\u662f\u7f51\u7ad9\u9759\u6001\u5316\u5904\u7406\u7684\u6838\u5fc3\u601d\u8def\u3002</p> <p>\u52a8\u6001\u8d44\u6e90\u3001\u9759\u6001\u8d44\u6e90\u5206\u79bb\u7b80\u5355\u7684\u6982\u62ec\u662f\uff1a\u52a8\u6001\u6587\u4ef6\u4e0e\u9759\u6001\u6587\u4ef6\u7684\u5206\u79bb\u3002</p>"},{"location":"interview/nginx/#15","title":"15. \u4e3a\u4ec0\u4e48\u8981\u505a\u52a8\u3001\u9759\u5206\u79bb\uff1f","text":"<p>\u5728\u6211\u4eec\u7684\u8f6f\u4ef6\u5f00\u53d1\u4e2d\uff0c\u6709\u4e9b\u8bf7\u6c42\u662f\u9700\u8981\u540e\u53f0\u5904\u7406\u7684\uff08\u5982\uff1a.jsp,.do \u7b49\u7b49\uff09\uff0c\u6709\u4e9b\u8bf7\u6c42\u662f\u4e0d\u9700\u8981\u7ecf\u8fc7\u540e\u53f0\u5904\u7406\u7684\uff08\u5982\uff1acss\u3001html\u3001jpg\u3001js \u7b49\u7b49\u6587\u4ef6\uff09\uff0c\u8fd9\u4e9b\u4e0d\u9700\u8981\u7ecf\u8fc7\u540e\u53f0\u5904\u7406\u7684\u6587\u4ef6\u79f0\u4e3a\u9759\u6001\u6587\u4ef6\uff0c\u5426\u5219\u52a8\u6001\u6587\u4ef6\u3002</p> <p>\u201c\u56e0\u6b64\u6211\u4eec\u540e\u53f0\u5904\u7406\u5ffd\u7565\u9759\u6001\u6587\u4ef6\u3002\u8fd9\u4f1a\u6709\u4eba\u53c8\u8bf4\u90a3\u6211\u540e\u53f0\u5ffd\u7565\u9759\u6001\u6587\u4ef6\u4e0d\u5c31\u5b8c\u4e86\u5417\uff1f\u5f53\u7136\u8fd9\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u662f\u8fd9\u6837\u540e\u53f0\u7684\u8bf7\u6c42\u6b21\u6570\u5c31\u660e\u663e\u589e\u591a\u4e86\u3002\u5728\u6211\u4eec\u5bf9\u8d44\u6e90\u7684\u54cd\u5e94\u901f\u5ea6\u6709\u8981\u6c42\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5e94\u8be5\u4f7f\u7528\u8fd9\u79cd\u52a8\u9759\u5206\u79bb\u7684\u7b56\u7565\u53bb\u89e3\u51b3\u52a8\u3001\u9759\u5206\u79bb\u5c06\u7f51\u7ad9\u9759\u6001\u8d44\u6e90\uff08HTML\uff0cJavaScript\uff0cCSS\uff0cimg \u7b49\u6587\u4ef6\uff09\u4e0e\u540e\u53f0\u5e94\u7528\u5206\u5f00\u90e8\u7f72\uff0c\u63d0\u9ad8\u7528\u6237\u8bbf\u95ee\u9759\u6001\u4ee3\u7801\u7684\u901f\u5ea6\uff0c\u964d\u4f4e\u5bf9\u540e\u53f0\u5e94\u7528\u8bbf\u95ee \u8fd9\u91cc\u6211\u4eec\u5c06\u9759\u6001\u8d44\u6e90\u653e\u5230 Nginx \u4e2d\uff0c\u52a8\u6001\u8d44\u6e90\u8f6c\u53d1\u5230 Tomcat \u670d\u52a1\u5668\u4e2d\u53bb\u3002</p> <p>\u5f53\u7136\uff0c\u56e0\u4e3a\u73b0\u5728\u4e03\u725b\u3001\u963f\u91cc\u4e91\u7b49 CDN \u670d\u52a1\u5df2\u7ecf\u5f88\u6210\u719f\uff0c\u4e3b\u6d41\u7684\u505a\u6cd5\uff0c\u662f\u628a\u9759\u6001\u8d44\u6e90\u7f13\u5b58\u5230 CDN \u670d\u52a1\u4e2d\uff0c\u4ece\u800c\u63d0\u5347\u8bbf\u95ee\u901f\u5ea6\u3002</p> <p>\u201c\u76f8\u6bd4\u672c\u5730\u7684 Nginx \u6765\u8bf4\uff0cCDN \u670d\u52a1\u5668\u7531\u4e8e\u5728\u56fd\u5185\u6709\u66f4\u591a\u7684\u8282\u70b9\uff0c\u53ef\u4ee5\u5b9e\u73b0\u7528\u6237\u7684\u5c31\u8fd1\u8bbf\u95ee\u3002\u5e76\u4e14\uff0cCDN \u670d\u52a1\u53ef\u4ee5\u63d0\u4f9b\u66f4\u5927\u7684\u5e26\u5bbd\uff0c\u4e0d\u50cf\u6211\u4eec\u81ea\u5df1\u7684\u5e94\u7528\u670d\u52a1\uff0c\u63d0\u4f9b\u7684\u5e26\u5bbd\u662f\u6709\u9650\u7684\u3002</p>"},{"location":"interview/nginx/#16-cdn","title":"16. \u4ec0\u4e48\u53eb CDN \u670d\u52a1\uff1f","text":"<p>CDN \uff0c\u5373\u5185\u5bb9\u5206\u53d1\u7f51\u7edc\u3002</p> <p>\u5176\u76ee\u7684\u662f\uff0c\u901a\u8fc7\u5728\u73b0\u6709\u7684 Internet \u4e2d \u589e\u52a0\u4e00\u5c42\u65b0\u7684\u7f51\u7edc\u67b6\u6784\uff0c\u5c06\u7f51\u7ad9\u7684\u5185\u5bb9\u53d1\u5e03\u5230\u6700\u63a5\u8fd1\u7528\u6237\u7684\u7f51\u7edc\u8fb9\u7f18\uff0c\u4f7f\u7528\u6237\u53ef\u5c31\u8fd1\u53d6\u5f97\u6240\u9700\u7684\u5185\u5bb9\uff0c\u63d0\u9ad8\u7528\u6237\u8bbf\u95ee\u7f51\u7ad9\u7684\u901f\u5ea6\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\uff0c\u56e0\u4e3a\u73b0\u5728 CDN \u670d\u52a1\u6bd4\u8f83\u5927\u4f17\uff0c\u6240\u4ee5\u57fa\u672c\u6240\u6709\u516c\u53f8\u90fd\u4f1a\u4f7f\u7528 CDN \u670d\u52a1\u3002</p>"},{"location":"interview/nginx/#17-nginx","title":"17. Nginx \u600e\u4e48\u505a\u7684\u52a8\u9759\u5206\u79bb\uff1f","text":"<p>\u201c\u53ea\u9700\u8981\u6307\u5b9a\u8def\u5f84\u5bf9\u5e94\u7684\u76ee\u5f55\u3002location / \u53ef\u4ee5\u4f7f\u7528\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u3002\u5e76\u6307\u5b9a\u5bf9\u5e94\u7684\u786c\u76d8\u4e2d\u7684\u76ee\u5f55\u3002\u5982\u4e0b\uff1a\uff08\u64cd\u4f5c\u90fd\u662f\u5728 Linux \u4e0a\uff09</p> <pre><code>location /image/ {\n    root /usr/local/static/;\n    autoindex on;\n}\n\n\u6b65\u9aa4\uff1a\n# \u521b\u5efa\u76ee\u5f55\nmkdir /usr/local/static/image\n\n# \u8fdb\u5165\u76ee\u5f55\ncd  /usr/local/static/image\n\n# \u4e0a\u4f20\u7167\u7247\nphoto.jpg\n\n# \u91cd\u542fnginx\nsudo nginx -s reload\n</code></pre> <p>\u6253\u5f00\u6d4f\u89c8\u5668 \u8f93\u5165 server_name/image/1.jpg \u5c31\u53ef\u4ee5\u8bbf\u95ee\u8be5\u9759\u6001\u56fe\u7247\u4e86</p>"},{"location":"interview/nginx/#18-nginx","title":"18. Nginx \u8d1f\u8f7d\u5747\u8861\u7684\u7b97\u6cd5\u600e\u4e48\u5b9e\u73b0\u7684? \u7b56\u7565\u6709\u54ea\u4e9b?","text":"<p>\u201c\u4e3a\u4e86\u907f\u514d\u670d\u52a1\u5668\u5d29\u6e83\uff0c\u5927\u5bb6\u4f1a\u901a\u8fc7\u8d1f\u8f7d\u5747\u8861\u7684\u65b9\u5f0f\u6765\u5206\u62c5\u670d\u52a1\u5668\u538b\u529b\u3002\u5c06\u5bf9\u53f0\u670d\u52a1\u5668\u7ec4\u6210\u4e00\u4e2a\u96c6\u7fa4\uff0c\u5f53\u7528\u6237\u8bbf\u95ee\u65f6\uff0c\u5148\u8bbf\u95ee\u5230\u4e00\u4e2a\u8f6c\u53d1\u670d\u52a1\u5668\uff0c\u518d\u7531\u8f6c\u53d1\u670d\u52a1\u5668\u5c06\u8bbf\u95ee\u5206\u53d1\u5230\u538b\u529b\u66f4\u5c0f\u7684\u670d\u52a1\u5668\u3002</p> <p>Nginx \u8d1f\u8f7d\u5747\u8861\u5b9e\u73b0\u7684\u7b56\u7565\u6709\u4ee5\u4e0b\u4e94\u79cd\uff1a</p> <ol> <li>\u8f6e\u8be2 (\u9ed8\u8ba4)</li> </ol> <p>\u6bcf\u4e2a\u8bf7\u6c42\u6309\u65f6\u95f4\u987a\u5e8f\u9010\u4e00\u5206\u914d\u5230\u4e0d\u540c\u7684\u540e\u7aef\u670d\u52a1\u5668\uff0c\u5982\u679c\u540e\u7aef\u67d0\u4e2a\u670d\u52a1\u5668\u5b95\u673a\uff0c\u80fd\u81ea\u52a8\u5254\u9664\u6545\u969c\u7cfb\u7edf\u3002</p> <pre><code>upstream backserver {\n server 192.168.0.12;\n server 192.168.0.13;\n}\n</code></pre> <ol> <li>\u6743\u91cd weight</li> </ol> <p>weight \u7684\u503c\u8d8a\u5927\uff0c\u5206\u914d\u5230\u7684\u8bbf\u95ee\u6982\u7387\u8d8a\u9ad8\uff0c\u4e3b\u8981\u7528\u4e8e\u540e\u7aef\u6bcf\u53f0\u670d\u52a1\u5668\u6027\u80fd\u4e0d\u5747\u8861\u7684\u60c5\u51b5\u4e0b\u3002\u5176\u6b21\u662f\u4e3a\u5728\u4e3b\u4ece\u7684\u60c5\u51b5\u4e0b\u8bbe\u7f6e\u4e0d\u540c\u7684\u6743\u503c\uff0c\u8fbe\u5230\u5408\u7406\u6709\u6548\u7684\u5730\u5229\u7528\u4e3b\u673a\u8d44\u6e90\u3002</p> <pre><code># \u6743\u91cd\u8d8a\u9ad8\uff0c\u5728\u88ab\u8bbf\u95ee\u7684\u6982\u7387\u8d8a\u5927\uff0c\u5982\u4e0a\u4f8b\uff0c\u5206\u522b\u662f20%\uff0c80%\u3002\nupstream backserver {\n server 192.168.0.12 weight=2;\n server 192.168.0.13 weight=8;\n}\n</code></pre> <ol> <li>ip_hash(IP \u7ed1\u5b9a)</li> </ol> <p>\u6bcf\u4e2a\u8bf7\u6c42\u6309\u8bbf\u95ee IP \u7684\u54c8\u5e0c\u7ed3\u679c\u5206\u914d\uff0c\u4f7f\u6765\u81ea\u540c\u4e00\u4e2a IP \u7684\u8bbf\u5ba2\u56fa\u5b9a\u8bbf\u95ee\u4e00\u53f0\u540e\u7aef\u670d\u52a1\u5668\uff0c\u5e76\u4e14\u53ef\u4ee5\u6709\u6548\u89e3\u51b3\u52a8\u6001\u7f51\u9875\u5b58\u5728\u7684 session \u5171\u4eab\u95ee\u9898</p> <pre><code>upstream backserver {\n ip_hash;\n server 192.168.0.12:88;\n server 192.168.0.13:80;\n}\n</code></pre> <ol> <li>fair(\u7b2c\u4e09\u65b9\u63d2\u4ef6)</li> </ol> <p>\u5fc5\u987b\u5b89\u88c5 upstream_fair \u6a21\u5757\u3002</p> <p>\u5bf9\u6bd4 weight\u3001ip_hash \u66f4\u52a0\u667a\u80fd\u7684\u8d1f\u8f7d\u5747\u8861\u7b97\u6cd5\uff0cfair \u7b97\u6cd5\u53ef\u4ee5\u6839\u636e\u9875\u9762\u5927\u5c0f\u548c\u52a0\u8f7d\u65f6\u95f4\u957f\u77ed\u667a\u80fd\u5730\u8fdb\u884c\u8d1f\u8f7d\u5747\u8861\uff0c\u54cd\u5e94\u65f6\u95f4\u77ed\u7684\u4f18\u5148\u5206\u914d\u3002</p> <pre><code># \u54ea\u4e2a\u670d\u52a1\u5668\u7684\u54cd\u5e94\u901f\u5ea6\u5feb\uff0c\u5c31\u5c06\u8bf7\u6c42\u5206\u914d\u5230\u90a3\u4e2a\u670d\u52a1\u5668\u4e0a\u3002\nupstream backserver {\n server server1;\n server server2;\n fair;\n}\n</code></pre> <p>5.url_hash(\u7b2c\u4e09\u65b9\u63d2\u4ef6)</p> <p>\u5fc5\u987b\u5b89\u88c5 Nginx \u7684 hash \u8f6f\u4ef6\u5305</p> <p>\u6309\u8bbf\u95ee url \u7684 hash \u7ed3\u679c\u6765\u5206\u914d\u8bf7\u6c42\uff0c\u4f7f\u6bcf\u4e2a url \u5b9a\u5411\u5230\u540c\u4e00\u4e2a\u540e\u7aef\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u8fdb\u4e00\u6b65\u63d0\u9ad8\u540e\u7aef\u7f13\u5b58\u670d\u52a1\u5668\u7684\u6548\u7387\u3002</p> <pre><code>upstream backserver {\n server squid1:3128;\n server squid2:3128;\n hash $request_uri;\n hash_method crc32;\n}\n</code></pre>"},{"location":"interview/nginx/#19-nginx","title":"19. \u5982\u4f55\u7528 Nginx \u89e3\u51b3\u524d\u7aef\u8de8\u57df\u95ee\u9898\uff1f","text":"<p>\u4f7f\u7528 Nginx \u8f6c\u53d1\u8bf7\u6c42\u3002\u628a\u8de8\u57df\u7684\u63a5\u53e3\u5199\u6210\u8c03\u672c\u57df\u7684\u63a5\u53e3\uff0c\u7136\u540e\u5c06\u8fd9\u4e9b\u63a5\u53e3\u8f6c\u53d1\u5230\u771f\u6b63\u7684\u8bf7\u6c42\u5730\u5740\u3002</p>"},{"location":"interview/nginx/#20-nginx","title":"20. Nginx \u865a\u62df\u4e3b\u673a\u600e\u4e48\u914d\u7f6e?","text":"<ol> <li>\u57fa\u4e8e\u57df\u540d\u7684\u865a\u62df\u4e3b\u673a\uff0c\u901a\u8fc7\u57df\u540d\u6765\u533a\u5206\u865a\u62df\u4e3b\u673a\u2014\u2014\u5e94\u7528\uff1a\u5916\u90e8\u7f51\u7ad9</li> <li>\u57fa\u4e8e\u7aef\u53e3\u7684\u865a\u62df\u4e3b\u673a\uff0c\u901a\u8fc7\u7aef\u53e3\u6765\u533a\u5206\u865a\u62df\u4e3b\u673a\u2014\u2014\u5e94\u7528\uff1a\u516c\u53f8\u5185\u90e8\u7f51\u7ad9\uff0c\u5916\u90e8\u7f51\u7ad9\u7684\u7ba1\u7406\u540e\u53f0</li> <li>\u57fa\u4e8e ip \u7684\u865a\u62df\u4e3b\u673a\u3002</li> </ol> <p>\u57fa\u4e8e\u865a\u62df\u4e3b\u673a\u914d\u7f6e\u57df\u540d</p> <p>\u9700\u8981\u5efa\u7acb <code>/data/www</code>\uff0c<code>/data/bbs</code> \u76ee\u5f55\uff0cwindows \u672c\u5730 hosts \u6dfb\u52a0\u865a\u62df\u673a ip \u5730\u5740\u5bf9\u5e94\u7684\u57df\u540d\u89e3\u6790\uff1b\u5bf9\u5e94\u57df\u540d\u7f51\u7ad9\u76ee\u5f55\u4e0b\u65b0\u589e index.html \u6587\u4ef6\uff1b</p> <pre><code># \u5f53\u5ba2\u6237\u7aef\u8bbf\u95eewww.lijie.com,\u76d1\u542c\u7aef\u53e3\u53f7\u4e3a80,\u76f4\u63a5\u8df3\u8f6c\u5230data/www\u76ee\u5f55\u4e0b\u6587\u4ef6\nserver {\n    listen       80;\n    server_name  www.lijie.com;\n    location / {\n        root   data/www;\n        index  index.html index.htm;\n    }\n}\n\n# \u5f53\u5ba2\u6237\u7aef\u8bbf\u95eewww.lijie.com,\u76d1\u542c\u7aef\u53e3\u53f7\u4e3a80,\u76f4\u63a5\u8df3\u8f6c\u5230data/bbs\u76ee\u5f55\u4e0b\u6587\u4ef6\n server {\n    listen       80;\n    server_name  bbs.lijie.com;\n    location / {\n        root   data/bbs;\n        index  index.html index.htm;\n    }\n}\n</code></pre> <p>\u57fa\u4e8e\u7aef\u53e3\u7684\u865a\u62df\u4e3b\u673a</p> <p>\u4f7f\u7528\u7aef\u53e3\u6765\u533a\u5206\uff0c\u6d4f\u89c8\u5668\u4f7f\u7528\u57df\u540d\u6216 ip \u5730\u5740: \u7aef\u53e3\u53f7 \u8bbf\u95ee</p> <pre><code># \u5f53\u5ba2\u6237\u7aef\u8bbf\u95eewww.lijie.com,\u76d1\u542c\u7aef\u53e3\u53f7\u4e3a8080,\u76f4\u63a5\u8df3\u8f6c\u5230data/www\u76ee\u5f55\u4e0b\u6587\u4ef6\n server {\n    listen       8080;\n    server_name  8080.lijie.com;\n    location / {\n        root   data/www;\n        index  index.html index.htm;\n    }\n}\n\n# \u5f53\u5ba2\u6237\u7aef\u8bbf\u95eewww.lijie.com,\u76d1\u542c\u7aef\u53e3\u53f7\u4e3a80\u76f4\u63a5\u8df3\u8f6c\u5230\u771f\u5b9eip\u670d\u52a1\u5668\u5730\u5740 127.0.0.1:8080\nserver {\n    listen       80;\n    server_name  www.lijie.com;\n    location / {\n         proxy_pass http://127.0.0.1:8080;\n        index  index.html index.htm;\n    }\n}\n</code></pre>"},{"location":"interview/nginx/#21-location","title":"21. location \u7684\u4f5c\u7528\u662f\u4ec0\u4e48\uff1f","text":"<p>location \u6307\u4ee4\u7684\u4f5c\u7528\u662f\u6839\u636e\u7528\u6237\u8bf7\u6c42\u7684 URI \u6765\u6267\u884c\u4e0d\u540c\u7684\u5e94\u7528\uff0c\u4e5f\u5c31\u662f\u6839\u636e\u7528\u6237\u8bf7\u6c42\u7684\u7f51\u7ad9 URL \u8fdb\u884c\u5339\u914d\uff0c\u5339\u914d\u6210\u529f\u5373\u8fdb\u884c\u76f8\u5173\u7684\u64cd\u4f5c\u3002</p> <p>location \u7684\u8bed\u6cd5\u80fd\u8bf4\u51fa\u6765\u5417\uff1f</p> <p>\u201c\u6ce8\u610f\uff1a~ \u4ee3\u8868\u81ea\u5df1\u8f93\u5165\u7684\u82f1\u6587\u5b57\u6bcd</p> \u5339\u914d\u7b26 \u5339\u914d\u89c4\u5219 \u4f18\u5148\u7ea7 = \u7cbe\u51c6\u5339\u914d 1 ^~ \u4ee5\u67d0\u4e2a\u5b57\u7b26\u4e32\u5f00\u5934 2 ~ \u533a\u5206\u5927\u5c0f\u5199\u7684\u6b63\u5219\u5339\u914d 3 ~* \u4e0d\u533a\u5206\u5927\u6d88\u606f\u7684\u6b63\u5219\u5339\u914d 4 !~ \u533a\u5206\u5927\u5c0f\u5199\u4e0d\u5339\u914d\u7684\u6b63\u5219 5 !~* \u4e0d\u533a\u5206\u5927\u5c0f\u5199\u4e0d\u5339\u914d\u7684\u6b63\u5219 6 / \u901a\u7528\u5339\u914d\uff0c\u4efb\u4f55\u8bf7\u6c42\u90fd\u4f1a\u5339\u914d\u5230 7 <p>Location \u6b63\u5219\u6848\u4f8b</p> <pre><code># \u4f18\u5148\u7ea71,\u7cbe\u786e\u5339\u914d\uff0c\u6839\u8def\u5f84\nlocation =/ {\n    return 400;\n}\n\n# \u4f18\u5148\u7ea72,\u4ee5\u67d0\u4e2a\u5b57\u7b26\u4e32\u5f00\u5934,\u4ee5av\u5f00\u5934\u7684\uff0c\u4f18\u5148\u5339\u914d\u8fd9\u91cc\uff0c\u533a\u5206\u5927\u5c0f\u5199\nlocation ^~ /av {\n   root /data/av/;\n}\n\n# \u4f18\u5148\u7ea73\uff0c\u533a\u5206\u5927\u5c0f\u5199\u7684\u6b63\u5219\u5339\u914d\uff0c\u5339\u914d/media*****\u8def\u5f84\nlocation ~ /media {\n      alias /data/static/;\n}\n\n# \u4f18\u5148\u7ea74 \uff0c\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u6b63\u5219\u5339\u914d\uff0c\u6240\u6709\u7684****.jpg|gif|png \u90fd\u8d70\u8fd9\u91cc\nlocation ~* .*\\.(jpg|gif|png|js|css)$ {\n   root  /data/av/;\n}\n\n# \u4f18\u51487\uff0c\u901a\u7528\u5339\u914d\nlocation / {\n    return 403;\n}\n</code></pre>"},{"location":"interview/nginx/#21","title":"21. \u9650\u6d41\u600e\u4e48\u505a\u7684\uff1f","text":"<p>Nginx \u9650\u6d41\u5c31\u662f\u9650\u5236\u7528\u6237\u8bf7\u6c42\u901f\u5ea6\uff0c\u9632\u6b62\u670d\u52a1\u5668\u53d7\u4e0d\u4e86</p> <p>\u9650\u6d41\u6709 3 \u79cd</p> <ul> <li>\u6b63\u5e38\u9650\u5236\u8bbf\u95ee\u9891\u7387\uff08\u6b63\u5e38\u6d41\u91cf\uff09</li> <li>\u7a81\u53d1\u9650\u5236\u8bbf\u95ee\u9891\u7387\uff08\u7a81\u53d1\u6d41\u91cf\uff09</li> <li>\u9650\u5236\u5e76\u53d1\u8fde\u63a5\u6570</li> </ul> <p>Nginx \u7684\u9650\u6d41\u90fd\u662f\u57fa\u4e8e\u6f0f\u6876\u6d41\u7b97\u6cd5</p> <p>\u5b9e\u73b0\u4e09\u79cd\u9650\u6d41\u7b97\u6cd5\uff1a</p> <p>1\u3001\u6b63\u5e38\u9650\u5236\u8bbf\u95ee\u9891\u7387\uff08\u6b63\u5e38\u6d41\u91cf\uff09\uff1a</p> <p>\u9650\u5236\u4e00\u4e2a\u7528\u6237\u53d1\u9001\u7684\u8bf7\u6c42\uff0c\u6211 Nginx \u591a\u4e45\u63a5\u6536\u4e00\u4e2a\u8bf7\u6c42\u3002</p> <p>Nginx \u4e2d\u4f7f\u7528 ngx_http_limit_req_module \u6a21\u5757\u6765\u9650\u5236\u7684\u8bbf\u95ee\u9891\u7387\uff0c\u9650\u5236\u7684\u539f\u7406\u5b9e\u8d28\u662f\u57fa\u4e8e\u6f0f\u6876\u7b97\u6cd5\u539f\u7406\u6765\u5b9e\u73b0\u7684\u3002\u5728 nginx.conf \u914d\u7f6e\u6587\u4ef6\u4e2d\u53ef\u4ee5\u4f7f\u7528 limit_req_zone \u547d\u4ee4\u53ca limit_req \u547d\u4ee4\u9650\u5236\u5355\u4e2a IP \u7684\u8bf7\u6c42\u5904\u7406\u9891\u7387\u3002</p> <pre><code># \u5b9a\u4e49\u9650\u6d41\u7ef4\u5ea6\uff0c\u4e00\u4e2a\u7528\u6237\u4e00\u5206\u949f\u4e00\u4e2a\u8bf7\u6c42\u8fdb\u6765\uff0c\u591a\u4f59\u7684\u5168\u90e8\u6f0f\u6389\nlimit_req_zone $binary_remote_addr zone=one:10m rate=1r/m;\n\n# \u7ed1\u5b9a\u9650\u6d41\u7ef4\u5ea6\nserver{\n\n    location/seckill.html{\n        limit_req zone=zone;\n        proxy_pass http://lj_seckill;\n    }\n\n}\n</code></pre> <p>1r/s \u4ee3\u8868 1 \u79d2\u4e00\u4e2a\u8bf7\u6c42\uff0c1r/m \u4e00\u5206\u949f\u63a5\u6536\u4e00\u4e2a\u8bf7\u6c42\uff0c \u5982\u679c Nginx \u8fd9\u65f6\u8fd8\u6709\u522b\u4eba\u7684\u8bf7\u6c42\u6ca1\u6709\u5904\u7406\u5b8c\uff0cNginx \u5c31\u4f1a\u62d2\u7edd\u5904\u7406\u8be5\u7528\u6237\u8bf7\u6c42\u3002</p> <p>2\u3001\u7a81\u53d1\u9650\u5236\u8bbf\u95ee\u9891\u7387\uff08\u7a81\u53d1\u6d41\u91cf\uff09\uff1a</p> <p>\u9650\u5236\u4e00\u4e2a\u7528\u6237\u53d1\u9001\u7684\u8bf7\u6c42\uff0c\u6211 Nginx \u591a\u4e45\u63a5\u6536\u4e00\u4e2a\u3002</p> <p>\u4e0a\u9762\u7684\u914d\u7f6e\u4e00\u5b9a\u7a0b\u5ea6\u53ef\u4ee5\u9650\u5236\u8bbf\u95ee\u9891\u7387\uff0c\u4f46\u662f\u4e5f\u5b58\u5728\u7740\u4e00\u4e2a\u95ee\u9898\uff1a\u5982\u679c\u7a81\u53d1\u6d41\u91cf\u8d85\u51fa\u8bf7\u6c42\u88ab\u62d2\u7edd\u5904\u7406\uff0c\u65e0\u6cd5\u5904\u7406\u6d3b\u52a8\u65f6\u5019\u7684\u7a81\u53d1\u6d41\u91cf\uff0c\u8fd9\u65f6\u5019\u5e94\u8be5\u5982\u4f55\u8fdb\u4e00\u6b65\u5904\u7406\u5462\uff1f</p> <p>Nginx \u63d0\u4f9b burst \u53c2\u6570\u7ed3\u5408 nodelay \u53c2\u6570\u53ef\u4ee5\u89e3\u51b3\u6d41\u91cf\u7a81\u53d1\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u80fd\u5904\u7406\u7684\u8d85\u8fc7\u8bbe\u7f6e\u7684\u8bf7\u6c42\u6570\u5916\u80fd\u989d\u5916\u5904\u7406\u7684\u8bf7\u6c42\u6570\u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u4e4b\u524d\u7684\u4f8b\u5b50\u6dfb\u52a0 burst \u53c2\u6570\u4ee5\u53ca nodelay \u53c2\u6570\uff1a</p> <pre><code># \u5b9a\u4e49\u9650\u6d41\u7ef4\u5ea6\uff0c\u4e00\u4e2a\u7528\u6237\u4e00\u5206\u949f\u4e00\u4e2a\u8bf7\u6c42\u8fdb\u6765\uff0c\u591a\u4f59\u7684\u5168\u90e8\u6f0f\u6389\nlimit_req_zone $binary_remote_addr zone=one:10m rate=1r/m;\n\n# \u7ed1\u5b9a\u9650\u6d41\u7ef4\u5ea6\nserver{\n\n    location/seckill.html{\n        limit_req zone=zone burst=5 nodelay;\n        proxy_pass http://lj_seckill;\n    }\n\n}\n</code></pre> <p>\u4e3a\u4ec0\u4e48\u5c31\u591a\u4e86\u4e00\u4e2a burst=5 nodelay; \u5462\uff0c\u591a\u4e86\u8fd9\u4e2a\u53ef\u4ee5\u4ee3\u8868 Nginx \u5bf9\u4e8e\u4e00\u4e2a\u7528\u6237\u7684\u8bf7\u6c42\u4f1a\u7acb\u5373\u5904\u7406\u524d\u4e94\u4e2a\uff0c\u591a\u4f59\u7684\u5c31\u6162\u6162\u6765\u843d\uff0c\u6ca1\u6709\u5176\u4ed6\u7528\u6237\u7684\u8bf7\u6c42\u6211\u5c31\u5904\u7406\u4f60\u7684\uff0c\u6709\u5176\u4ed6\u7684\u8bf7\u6c42\u7684\u8bdd\u6211 Nginx \u5c31\u6f0f\u6389\u4e0d\u63a5\u53d7\u4f60\u7684\u8bf7\u6c42</p> <p>3\u3001\u9650\u5236\u5e76\u53d1\u8fde\u63a5\u6570</p> <p>Nginx \u4e2d\u7684 ngx_http_limit_conn_module \u6a21\u5757\u63d0\u4f9b\u4e86\u9650\u5236\u5e76\u53d1\u8fde\u63a5\u6570\u7684\u529f\u80fd\uff0c\u53ef\u4ee5\u4f7f\u7528 limit_conn_zone \u6307\u4ee4\u4ee5\u53ca limit_conn \u6267\u884c\u8fdb\u884c\u914d\u7f6e\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u7b80\u5355\u7684\u4f8b\u5b50\u6765\u770b\u4e0b\uff1a</p> <pre><code>http {\n    limit_conn_zone $binary_remote_addr zone=myip:10m;\n    limit_conn_zone $server_name zone=myServerName:10m;\n}\n\nserver {\n    location / {\n        limit_conn myip 10;\n        limit_conn myServerName 100;\n        rewrite / http://www.lijie.net permanent;\n    }\n}\n</code></pre> <p>\u4e0a\u9762\u914d\u7f6e\u4e86\u5355\u4e2a IP \u540c\u65f6\u5e76\u53d1\u8fde\u63a5\u6570\u6700\u591a\u53ea\u80fd 10 \u4e2a\u8fde\u63a5\uff0c\u5e76\u4e14\u8bbe\u7f6e\u4e86\u6574\u4e2a\u865a\u62df\u670d\u52a1\u5668\u540c\u65f6\u6700\u5927\u5e76\u53d1\u6570\u6700\u591a\u53ea\u80fd 100 \u4e2a\u94fe\u63a5\u3002\u5f53\u7136\uff0c\u53ea\u6709\u5f53\u8bf7\u6c42\u7684 header \u88ab\u670d\u52a1\u5668\u5904\u7406\u540e\uff0c\u865a\u62df\u670d\u52a1\u5668\u7684\u8fde\u63a5\u6570\u624d\u4f1a\u8ba1\u6570\u3002\u521a\u624d\u6709\u63d0\u5230\u8fc7 Nginx \u662f\u57fa\u4e8e\u6f0f\u6876\u7b97\u6cd5\u539f\u7406\u5b9e\u73b0\u7684\uff0c\u5b9e\u9645\u4e0a\u9650\u6d41\u4e00\u822c\u90fd\u662f\u57fa\u4e8e\u6f0f\u6876\u7b97\u6cd5\u548c\u4ee4\u724c\u6876\u7b97\u6cd5\u5b9e\u73b0\u7684\u3002</p>"},{"location":"interview/nginx/#22","title":"22. \u6f0f\u6876\u6d41\u7b97\u6cd5\u548c\u4ee4\u724c\u6876\u7b97\u6cd5\u77e5\u9053\uff1f","text":"<p>\u6f0f\u6876\u7b97\u6cd5</p> <p>\u6f0f\u6876\u7b97\u6cd5\u601d\u8def\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u628a\u6c34\u6bd4\u4f5c\u662f\u8bf7\u6c42\uff0c\u6f0f\u6876\u6bd4\u4f5c\u662f\u7cfb\u7edf\u5904\u7406\u80fd\u529b\u6781\u9650\uff0c\u6c34\u5148\u8fdb\u5165\u5230\u6f0f\u6876\u91cc\uff0c\u6f0f\u6876\u91cc\u7684\u6c34\u6309\u4e00\u5b9a\u901f\u7387\u6d41\u51fa\uff0c\u5f53\u6d41\u51fa\u7684\u901f\u7387\u5c0f\u4e8e\u6d41\u5165\u7684\u901f\u7387\u65f6\uff0c\u7531\u4e8e\u6f0f\u6876\u5bb9\u91cf\u6709\u9650\uff0c\u540e\u7eed\u8fdb\u5165\u7684\u6c34\u76f4\u63a5\u6ea2\u51fa\uff08\u62d2\u7edd\u8bf7\u6c42\uff09\uff0c\u4ee5\u6b64\u5b9e\u73b0\u9650\u6d41\u3002</p> <p></p> <p>\u4ee4\u724c\u6876\u7b97\u6cd5</p> <p>\u4ee4\u724c\u6876\u7b97\u6cd5\u7684\u539f\u7406\u4e5f\u6bd4\u8f83\u7b80\u5355\uff0c\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\u6210\u533b\u9662\u7684\u6302\u53f7\u770b\u75c5\uff0c\u53ea\u6709\u62ff\u5230\u53f7\u4ee5\u540e\u624d\u53ef\u4ee5\u8fdb\u884c\u8bca\u75c5\u3002</p> <p>\u7cfb\u7edf\u4f1a\u7ef4\u62a4\u4e00\u4e2a\u4ee4\u724c\uff08token\uff09\u6876\uff0c\u4ee5\u4e00\u4e2a\u6052\u5b9a\u7684\u901f\u5ea6\u5f80\u6876\u91cc\u653e\u5165\u4ee4\u724c\uff08token\uff09\uff0c\u8fd9\u65f6\u5982\u679c\u6709\u8bf7\u6c42\u8fdb\u6765\u60f3\u8981\u88ab\u5904\u7406\uff0c\u5219\u9700\u8981\u5148\u4ece\u6876\u91cc\u83b7\u53d6\u4e00\u4e2a\u4ee4\u724c\uff08token\uff09\uff0c\u5f53\u6876\u91cc\u6ca1\u6709\u4ee4\u724c\uff08token\uff09\u53ef\u53d6\u65f6\uff0c\u5219\u8be5\u8bf7\u6c42\u5c06\u88ab\u62d2\u7edd\u670d\u52a1\u3002\u4ee4\u724c\u6876\u7b97\u6cd5\u901a\u8fc7\u63a7\u5236\u6876\u7684\u5bb9\u91cf\u3001\u53d1\u653e\u4ee4\u724c\u7684\u901f\u7387\uff0c\u6765\u8fbe\u5230\u5bf9\u8bf7\u6c42\u7684\u9650\u5236\u3002</p> <p></p>"},{"location":"interview/nginx/#23-nginx","title":"23. Nginx \u914d\u7f6e\u9ad8\u53ef\u7528\u6027\u600e\u4e48\u914d\u7f6e\uff1f","text":"<p>\u5f53\u4e0a\u6e38\u670d\u52a1\u5668 (\u771f\u5b9e\u8bbf\u95ee\u670d\u52a1\u5668)\uff0c\u4e00\u65e6\u51fa\u73b0\u6545\u969c\u6216\u8005\u662f\u6ca1\u6709\u53ca\u65f6\u76f8\u5e94\u7684\u8bdd\uff0c\u5e94\u8be5\u76f4\u63a5\u8f6e\u8bad\u5230\u4e0b\u4e00\u53f0\u670d\u52a1\u5668\uff0c\u4fdd\u8bc1\u670d\u52a1\u5668\u7684\u9ad8\u53ef\u7528</p> <p>Nginx \u914d\u7f6e\u4ee3\u7801\uff1a</p> <pre><code>server {\n        listen       80;\n        server_name  www.lijie.com;\n        location / {\n            ### \u6307\u5b9a\u4e0a\u6e38\u670d\u52a1\u5668\u8d1f\u8f7d\u5747\u8861\u670d\u52a1\u5668\n            proxy_pass http://backServer;\n            ###nginx\u4e0e\u4e0a\u6e38\u670d\u52a1\u5668(\u771f\u5b9e\u8bbf\u95ee\u7684\u670d\u52a1\u5668)\u8d85\u65f6\u65f6\u95f4 \u540e\u7aef\u670d\u52a1\u5668\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4_\u53d1\u8d77\u63e1\u624b\u7b49\u5019\u54cd\u5e94\u8d85\u65f6\u65f6\u95f4\n            proxy_connect_timeout 1s;\n            ###nginx\u53d1\u9001\u7ed9\u4e0a\u6e38\u670d\u52a1\u5668(\u771f\u5b9e\u8bbf\u95ee\u7684\u670d\u52a1\u5668)\u8d85\u65f6\u65f6\u95f4\n            proxy_send_timeout 1s;\n            ### nginx\u63a5\u53d7\u4e0a\u6e38\u670d\u52a1\u5668(\u771f\u5b9e\u8bbf\u95ee\u7684\u670d\u52a1\u5668)\u8d85\u65f6\u65f6\u95f4\n            proxy_read_timeout 1s;\n            index  index.html index.htm;\n        }\n    }\n</code></pre>"},{"location":"interview/nginx/#24-nginx-ip","title":"24. Nginx \u600e\u4e48\u5224\u65ad\u522b IP \u4e0d\u53ef\u8bbf\u95ee\uff1f","text":"<pre><code># \u5982\u679c\u8bbf\u95ee\u7684ip\u5730\u5740\u4e3a192.168.9.115,\u5219\u8fd4\u56de403\n if  ($remote_addr = 192.168.9.115) {\n     return 403;\n }\n</code></pre>"},{"location":"interview/nginx/#25-nginx","title":"25. \u5728 nginx \u4e2d\uff0c\u5982\u4f55\u4f7f\u7528\u672a\u5b9a\u4e49\u7684\u670d\u52a1\u5668\u540d\u79f0\u6765\u963b\u6b62\u5904\u7406\u8bf7\u6c42\uff1f","text":"<p>\u53ea\u9700\u5c06\u8bf7\u6c42\u5220\u9664\u7684\u670d\u52a1\u5668\u5c31\u53ef\u4ee5\u5b9a\u4e49\u4e3a\uff1a</p> <p>\u670d\u52a1\u5668\u540d\u88ab\u4fdd\u7559\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\uff0c\u4ed6\u5728\u6ca1\u6709\u4e3b\u673a\u5934\u5b57\u6bb5\u7684\u60c5\u51b5\u4e0b\u5339\u914d\u8bf7\u6c42\uff0c\u800c\u4e00\u4e2a\u7279\u6b8a\u7684 nginx \u7684\u975e\u6807\u51c6\u4ee3\u7801\u88ab\u8fd4\u56de\uff0c\u4ece\u800c\u7ec8\u6b62\u8fde\u63a5\u3002</p>"},{"location":"interview/nginx/#26","title":"26. \u600e\u4e48\u9650\u5236\u6d4f\u89c8\u5668\u8bbf\u95ee\uff1f","text":"<pre><code>## \u4e0d\u5141\u8bb8\u8c37\u6b4c\u6d4f\u89c8\u5668\u8bbf\u95ee \u5982\u679c\u662f\u8c37\u6b4c\u6d4f\u89c8\u5668\u8fd4\u56de500\nif ($http_user_agent ~ Chrome) {\n  return 500;\n}\n</code></pre>"},{"location":"interview/nginx/#27-rewrite","title":"27. Rewrite\u5168\u5c40\u53d8\u91cf\u662f\u4ec0\u4e48\uff1f","text":"<pre><code>$remote_addr //\u83b7\u53d6\u5ba2\u6237\u7aefip\n$binary_remote_addr //\u5ba2\u6237\u7aefip\uff08\u4e8c\u8fdb\u5236)\n$remote_port //\u5ba2\u6237\u7aefport\uff0c\u5982\uff1a50472\n$remote_user //\u5df2\u7ecf\u7ecf\u8fc7Auth Basic Module\u9a8c\u8bc1\u7684\u7528\u6237\u540d\n$host //\u8bf7\u6c42\u4e3b\u673a\u5934\u5b57\u6bb5\uff0c\u5426\u5219\u4e3a\u670d\u52a1\u5668\u540d\u79f0\uff0c\u5982:blog.sakmon.com\n$request //\u7528\u6237\u8bf7\u6c42\u4fe1\u606f\uff0c\u5982\uff1aGET ?a=1&amp;b=2 HTTP/1.1\n$request_filename //\u5f53\u524d\u8bf7\u6c42\u7684\u6587\u4ef6\u7684\u8def\u5f84\u540d\uff0c\u7531root\u6216alias\u548cURI request\u7ec4\u5408\u800c\u6210\uff0c\u5982\uff1a/2013/81.html\n$status //\u8bf7\u6c42\u7684\u54cd\u5e94\u72b6\u6001\u7801,\u5982:200\n$body_bytes_sent // \u54cd\u5e94\u65f6\u9001\u51fa\u7684body\u5b57\u8282\u6570\u6570\u91cf\u3002\u5373\u4f7f\u8fde\u63a5\u4e2d\u65ad\uff0c\u8fd9\u4e2a\u6570\u636e\u4e5f\u662f\u7cbe\u786e\u7684,\u5982\uff1a40\n$content_length // \u7b49\u4e8e\u8bf7\u6c42\u884c\u7684\u201cContent_Length\u201d\u7684\u503c\n$content_type // \u7b49\u4e8e\u8bf7\u6c42\u884c\u7684\u201cContent_Type\u201d\u7684\u503c\n$http_referer // \u5f15\u7528\u5730\u5740\n$http_user_agent // \u5ba2\u6237\u7aefagent\u4fe1\u606f,\u5982\uff1aMozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/29.0.1547.76 Safari/537.36\n$args //\u4e0e$query_string\u76f8\u540c \u7b49\u4e8e\u5f53\u4e2dURL\u7684\u53c2\u6570(GET)\uff0c\u5982a=1&amp;b=2\n$document_uri //\u4e0e$uri\u76f8\u540c \u8fd9\u4e2a\u53d8\u91cf\u6307\u5f53\u524d\u7684\u8bf7\u6c42URI\uff0c\u4e0d\u5305\u62ec\u4efb\u4f55\u53c2\u6570(\u89c1$args) \u5982:/2013/81.html\n$document_root //\u9488\u5bf9\u5f53\u524d\u8bf7\u6c42\u7684\u6839\u8def\u5f84\u8bbe\u7f6e\u503c\n$hostname //\u5982\uff1acentos53.localdomain\n$http_cookie //\u5ba2\u6237\u7aefcookie\u4fe1\u606f\n$cookie_COOKIE //cookie COOKIE\u53d8\u91cf\u7684\u503c\n$is_args //\u5982\u679c\u6709$args\u53c2\u6570\uff0c\u8fd9\u4e2a\u53d8\u91cf\u7b49\u4e8e\u201d?\u201d\uff0c\u5426\u5219\u7b49\u4e8e\u201d\"\uff0c\u7a7a\u503c\uff0c\u5982?\n$limit_rate //\u8fd9\u4e2a\u53d8\u91cf\u53ef\u4ee5\u9650\u5236\u8fde\u63a5\u901f\u7387\uff0c0\u8868\u793a\u4e0d\u9650\u901f\n$query_string // \u4e0e$args\u76f8\u540c \u7b49\u4e8e\u5f53\u4e2dURL\u7684\u53c2\u6570(GET)\uff0c\u5982a=1&amp;b=2\n$request_body // \u8bb0\u5f55POST\u8fc7\u6765\u7684\u6570\u636e\u4fe1\u606f\n$request_body_file //\u5ba2\u6237\u7aef\u8bf7\u6c42\u4e3b\u4f53\u4fe1\u606f\u7684\u4e34\u65f6\u6587\u4ef6\u540d\n$request_method //\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u52a8\u4f5c\uff0c\u901a\u5e38\u4e3aGET\u6216POST,\u5982\uff1aGET\n$request_uri //\u5305\u542b\u8bf7\u6c42\u53c2\u6570\u7684\u539f\u59cbURI\uff0c\u4e0d\u5305\u542b\u4e3b\u673a\u540d\uff0c\u5982\uff1a/2013/81.html?a=1&amp;b=2\n$scheme //HTTP\u65b9\u6cd5\uff08\u5982http\uff0chttps\uff09,\u5982\uff1ahttp\n$uri //\u8fd9\u4e2a\u53d8\u91cf\u6307\u5f53\u524d\u7684\u8bf7\u6c42URI\uff0c\u4e0d\u5305\u62ec\u4efb\u4f55\u53c2\u6570(\u89c1$args) \u5982:/2013/81.html\n$request_completion //\u5982\u679c\u8bf7\u6c42\u7ed3\u675f\uff0c\u8bbe\u7f6e\u4e3aOK. \u5f53\u8bf7\u6c42\u672a\u7ed3\u675f\u6216\u5982\u679c\u8be5\u8bf7\u6c42\u4e0d\u662f\u8bf7\u6c42\u94fe\u4e32\u7684\u6700\u540e\u4e00\u4e2a\u65f6\uff0c\u4e3a\u7a7a(Empty)\uff0c\u5982\uff1aOK\n$server_protocol //\u8bf7\u6c42\u4f7f\u7528\u7684\u534f\u8bae\uff0c\u901a\u5e38\u662fHTTP/1.0\u6216HTTP/1.1\uff0c\u5982\uff1aHTTP/1.1\n$server_addr //\u670d\u52a1\u5668IP\u5730\u5740\uff0c\u5728\u5b8c\u6210\u4e00\u6b21\u7cfb\u7edf\u8c03\u7528\u540e\u53ef\u4ee5\u786e\u5b9a\u8fd9\u4e2a\u503c\n$server_name //\u670d\u52a1\u5668\u540d\u79f0\uff0c\u5982\uff1ablog.sakmon.com\n$server_port //\u8bf7\u6c42\u5230\u8fbe\u670d\u52a1\u5668\u7684\u7aef\u53e3\u53f7,\u5982\uff1a80\n</code></pre>"},{"location":"interview/nginx/#28-nginx","title":"28. Nginx \u5982\u4f55\u5b9e\u73b0\u540e\u7aef\u670d\u52a1\u7684\u5065\u5eb7\u68c0\u67e5?","text":"<p>\u65b9\u5f0f\u4e00\uff0c\u5229\u7528 nginx \u81ea\u5e26\u6a21\u5757 ngx_http_proxy_module \u548c ngx_http_upstream_module \u5bf9\u540e\u7aef\u8282\u70b9\u505a\u5065\u5eb7\u68c0\u67e5\u3002</p> <p>\u65b9\u5f0f\u4e8c (\u63a8\u8350)\uff0c\u5229\u7528 nginx_upstream_check_module \u6a21\u5757\u5bf9\u540e\u7aef\u8282\u70b9\u505a\u5065\u5eb7\u68c0\u67e5\u3002</p>"},{"location":"interview/nginx/#29-nginx","title":"29. Nginx \u5982\u4f55\u5f00\u542f\u538b\u7f29\uff1f","text":"<p>\u5f00\u542f nginx gzip \u538b\u7f29\u540e\uff0c\u7f51\u9875\u3001css\u3001js \u7b49\u9759\u6001\u8d44\u6e90\u7684\u5927\u5c0f\u4f1a\u5927\u5927\u7684\u51cf\u5c11\uff0c\u4ece\u800c\u53ef\u4ee5\u8282\u7ea6\u5927\u91cf\u7684\u5e26\u5bbd\uff0c\u63d0\u9ad8\u4f20\u8f93\u6548\u7387\uff0c\u7ed9\u7528\u6237\u5feb\u7684\u4f53\u9a8c\u3002\u867d\u7136\u4f1a\u6d88\u8017 cpu \u8d44\u6e90\uff0c\u4f46\u662f\u4e3a\u4e86\u7ed9\u7528\u6237\u66f4\u597d\u7684\u4f53\u9a8c\u662f\u503c\u5f97\u7684\u3002</p> <p>\u5f00\u542f\u7684\u914d\u7f6e\u5982\u4e0b\uff1a</p> <p>\u5c06\u4ee5\u4e0b\u914d\u7f6e\u653e\u5230 nginx.conf \u7684 http{\u2026} \u8282\u70b9\u4e2d\u3002</p> <pre><code>http {\n  # \u5f00\u542fgzip\n  gzip on;\n\n  # \u542f\u7528gzip\u538b\u7f29\u7684\u6700\u5c0f\u6587\u4ef6\uff1b\u5c0f\u4e8e\u8bbe\u7f6e\u503c\u7684\u6587\u4ef6\u5c06\u4e0d\u4f1a\u88ab\u538b\u7f29\n  gzip_min_length 1k;\n\n  # gzip \u538b\u7f29\u7ea7\u522b 1-10\n  gzip_comp_level 2;\n\n  # \u8fdb\u884c\u538b\u7f29\u7684\u6587\u4ef6\u7c7b\u578b\u3002\n\n  gzip_types text/plain application/javascript application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png;\n\n  # \u662f\u5426\u5728http header\u4e2d\u6dfb\u52a0Vary: Accept-Encoding\uff0c\u5efa\u8bae\u5f00\u542f\n  gzip_vary on;\n}\n</code></pre> <p>\u4fdd\u5b58\u5e76\u91cd\u542f nginx\uff0c\u5237\u65b0\u9875\u9762\uff08\u4e3a\u4e86\u907f\u514d\u7f13\u5b58\uff0c\u8bf7\u5f3a\u5236\u5237\u65b0\uff09\u5c31\u80fd\u770b\u5230\u6548\u679c\u4e86\u3002\u4ee5\u8c37\u6b4c\u6d4f\u89c8\u5668\u4e3a\u4f8b\uff0c\u901a\u8fc7 F12 \u770b\u8bf7\u6c42\u7684\u54cd\u5e94\u5934\u90e8\uff1a</p> <p>\u6211\u4eec\u53ef\u4ee5\u5148\u6765\u5bf9\u6bd4\u4e0b\uff0c\u5982\u679c\u6211\u4eec\u6ca1\u6709\u5f00\u542f zip \u538b\u7f29\u4e4b\u524d\uff0c\u6211\u4eec\u7684\u5bf9\u5e94\u7684\u6587\u4ef6\u5927\u5c0f\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <p>\u73b0\u5728\u6211\u4eec\u5f00\u542f\u4e86 gzip \u8fdb\u884c\u538b\u7f29\u540e\u7684\u6587\u4ef6\u7684\u5927\u5c0f\uff0c\u53ef\u4ee5\u770b\u5230\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <p>\u5e76\u4e14\u6211\u4eec\u67e5\u770b\u54cd\u5e94\u5934\u4f1a\u770b\u5230 gzip \u8fd9\u6837\u7684\u538b\u7f29\uff0c\u5982\u4e0b\u6240\u793a</p> <p></p> <p>gzip \u538b\u7f29\u524d\u540e\u6548\u679c\u5bf9\u6bd4\uff1ajquery \u539f\u5927\u5c0f 90kb\uff0c\u538b\u7f29\u540e\u53ea\u6709 30kb\u3002</p> <p>gzip \u867d\u7136\u597d\u7528\uff0c\u4f46\u662f\u4ee5\u4e0b\u7c7b\u578b\u7684\u8d44\u6e90\u4e0d\u5efa\u8bae\u542f\u7528\u3002</p> <p>1\u3001\u56fe\u7247\u7c7b\u578b</p> <p>\u539f\u56e0\uff1a\u56fe\u7247\u5982 jpg\u3001png \u672c\u8eab\u5c31\u4f1a\u6709\u538b\u7f29\uff0c\u6240\u4ee5\u5c31\u7b97\u5f00\u542f gzip \u540e\uff0c\u538b\u7f29\u524d\u548c\u538b\u7f29\u540e\u5927\u5c0f\u6ca1\u6709\u591a\u5927\u533a\u522b\uff0c\u6240\u4ee5\u5f00\u542f\u4e86\u53cd\u800c\u4f1a\u767d\u767d\u7684\u6d6a\u8d39\u8d44\u6e90\u3002\uff08Tips\uff1a\u53ef\u4ee5\u8bd5\u8bd5\u5c06\u4e00\u5f20 jpg \u56fe\u7247\u538b\u7f29\u4e3a zip\uff0c\u89c2\u5bdf\u5927\u5c0f\u5e76\u6ca1\u6709\u591a\u5927\u7684\u53d8\u5316\u3002\u867d\u7136 zip \u548c gzip \u7b97\u6cd5\u4e0d\u4e00\u6837\uff0c\u4f46\u662f\u53ef\u4ee5\u770b\u51fa\u538b\u7f29\u56fe\u7247\u7684\u4ef7\u503c\u5e76\u4e0d\u5927\uff09</p> <p>2\u3001\u5927\u6587\u4ef6</p> <p>\u539f\u56e0\uff1a\u4f1a\u6d88\u8017\u5927\u91cf\u7684 cpu \u8d44\u6e90\uff0c\u4e14\u4e0d\u4e00\u5b9a\u6709\u660e\u663e\u7684\u6548\u679c\u3002</p>"},{"location":"interview/nginx/#30-ngx_http_upstream_module","title":"30. ngx_http_upstream_module \u7684\u4f5c\u7528\u662f\u4ec0\u4e48?","text":"<p>ngx_http_upstream_module \u7528\u4e8e\u5b9a\u4e49\u53ef\u901a\u8fc7 fastcgi \u4f20\u9012\u3001proxy \u4f20\u9012\u3001uwsgi \u4f20\u9012\u3001memcached \u4f20\u9012\u548c scgi \u4f20\u9012\u6307\u4ee4\u6765\u5f15\u7528\u7684\u670d\u52a1\u5668\u7ec4\u3002</p>"},{"location":"interview/nginx/#31-c10k","title":"31. \u4ec0\u4e48\u662f C10K \u95ee\u9898?","text":"<p>C10K \u95ee\u9898\u662f\u6307\u65e0\u6cd5\u540c\u65f6\u5904\u7406\u5927\u91cf\u5ba2\u6237\u7aef (10,000) \u7684\u7f51\u7edc\u5957\u63a5\u5b57\u3002</p>"},{"location":"interview/nginx/#32-nginx","title":"32. Nginx \u662f\u5426\u652f\u6301\u5c06\u8bf7\u6c42\u538b\u7f29\u5230\u4e0a\u6e38?","text":"<p>\u60a8\u53ef\u4ee5\u4f7f\u7528 Nginx \u6a21\u5757 gunzip \u5c06\u8bf7\u6c42\u538b\u7f29\u5230\u4e0a\u6e38\u3002gunzip \u6a21\u5757\u662f\u4e00\u4e2a\u8fc7\u6ee4\u5668\uff0c\u5b83\u53ef\u4ee5\u5bf9\u4e0d\u652f\u6301 \u201cgzip\u201d \u7f16\u7801\u65b9\u6cd5\u7684\u5ba2\u6237\u673a\u6216\u670d\u52a1\u5668\u4f7f\u7528 \u201c\u5185\u5bb9\u7f16\u7801: gzip\u201d \u6765\u89e3\u538b\u7f29\u54cd\u5e94\u3002</p>"},{"location":"interview/nginx/#33-nginx","title":"33. \u5982\u4f55\u5728 Nginx \u4e2d\u83b7\u5f97\u5f53\u524d\u7684\u65f6\u95f4?","text":"<p>\u8981\u83b7\u5f97 Nginx \u7684\u5f53\u524d\u65f6\u95f4\uff0c\u5fc5\u987b\u4f7f\u7528 SSI \u6a21\u5757\u3001\u548c date_local \u7684\u53d8\u91cf\u3002</p> <pre><code>Proxy_set_header THE-TIME $date_gmt;\n</code></pre>"},{"location":"interview/nginx/#34-nginx-s","title":"34. \u7528 Nginx \u670d\u52a1\u5668\u89e3\u91ca <code>-s</code> \u7684\u76ee\u7684\u662f\u4ec0\u4e48?","text":"<p>\u7528\u4e8e\u8fd0\u884c Nginx -s \u53c2\u6570\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002</p>"},{"location":"interview/nginx/#35-nginx","title":"35. \u5982\u4f55\u5728 Nginx \u670d\u52a1\u5668\u4e0a\u6dfb\u52a0\u6a21\u5757?","text":"<p>\u5728\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\uff0c\u5fc5\u987b\u9009\u62e9 Nginx \u6a21\u5757\uff0c\u56e0\u4e3a Nginx \u4e0d\u652f\u6301\u6a21\u5757\u7684\u8fd0\u884c\u65f6\u95f4\u9009\u62e9\u3002</p>"},{"location":"interview/nginx/#36-worker","title":"36. \u751f\u4ea7\u4e2d\u5982\u4f55\u8bbe\u7f6e worker \u8fdb\u7a0b\u7684\u6570\u91cf\u5462\uff1f","text":"<p>\u5728\u6709\u591a\u4e2a cpu \u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u591a\u4e2a worker\uff0cworker \u8fdb\u7a0b\u7684\u6570\u91cf\u53ef\u4ee5\u8bbe\u7f6e\u5230\u548c cpu \u7684\u6838\u5fc3\u6570\u4e00\u6837\u591a\uff0c\u5982\u679c\u5728\u5355\u4e2a cpu \u4e0a\u8d77\u591a\u4e2a worker \u8fdb\u7a0b\uff0c\u90a3\u4e48\u64cd\u4f5c\u7cfb\u7edf\u4f1a\u5728\u591a\u4e2a worker \u4e4b\u95f4\u8fdb\u884c\u8c03\u5ea6\uff0c\u8fd9\u79cd\u60c5\u51b5\u4f1a\u964d\u4f4e\u7cfb\u7edf\u6027\u80fd\uff0c\u5982\u679c\u53ea\u6709\u4e00\u4e2a cpu\uff0c\u90a3\u4e48\u53ea\u542f\u52a8\u4e00\u4e2a worker \u8fdb\u7a0b\u5c31\u53ef\u4ee5\u4e86\u3002</p>"},{"location":"interview/nginx/#37-nginx","title":"37. nginx \u72b6\u6001\u7801","text":"<p>499\uff1a</p> <p>\u670d\u52a1\u7aef\u5904\u7406\u65f6\u95f4\u8fc7\u957f\uff0c\u5ba2\u6237\u7aef\u4e3b\u52a8\u5173\u95ed\u4e86\u8fde\u63a5\u3002</p> <p>502\uff1a</p> <ol> <li>FastCGI \u8fdb\u7a0b\u662f\u5426\u5df2\u7ecf\u542f\u52a8</li> <li>FastCGI worker \u8fdb\u7a0b\u6570\u662f\u5426\u4e0d\u591f</li> <li>FastCGI \u6267\u884c\u65f6\u95f4\u8fc7\u957f<ul> <li>fastcgi_connect_timeout 300;</li> <li>fastcgi_send_timeout 300;</li> <li>fastcgi_read_timeout 300;</li> </ul> </li> <li>FastCGI Buffer \u4e0d\u591f\uff0cnginx \u548c apache \u4e00\u6837\uff0c\u6709\u524d\u7aef\u7f13\u51b2\u9650\u5236\uff0c\u53ef\u4ee5\u8c03\u6574\u7f13\u51b2\u53c2\u6570<ul> <li>fastcgi_buffer_size 32k;</li> <li>fastcgi_buffers 8 32k;</li> </ul> </li> <li>Proxy Buffer \u4e0d\u591f\uff0c\u5982\u679c\u4f60\u7528\u4e86 Proxying\uff0c\u8c03\u6574<ul> <li>proxy_buffer_size 16k;</li> <li>proxy_buffers 4 16k;</li> </ul> </li> <li>php \u811a\u672c\u6267\u884c\u65f6\u95f4\u8fc7\u957f<ul> <li>\u5c06 php-fpm.conf \u7684 0s \u7684 0s \u6539\u6210\u4e00\u4e2a\u65f6\u95f4</li> </ul> </li> </ol> <p>from: https://blog.csdn.net/wuzhiwei549/category_11550129.html</p>"},{"location":"linux/centos-init/","title":"CentOS 7 \u521d\u59cb\u5316","text":"\u624b\u52a8\u521d\u59cb\u5316 <ul> <li>\u53ea\u5141\u8bb8 wheel \u7ec4\u7528\u6237\u5207\u6362 root</li> </ul> <pre><code>sudo sh -c 'echo \"auth required pam_wheel.so use_uid\" &gt;&gt; /etc/pam.d/su'\nsudo sh -c 'echo \"SU_WHEEL_ONLY yes\" &gt;&gt; /etc/login.defs'\nsudo usermod -aG wheel $USER\n</code></pre> <ul> <li>\u666e\u901a\u7528\u6237\u65e0\u5bc6\u7801\u9a8c\u8bc1</li> </ul> <pre><code>sudo sh -c 'echo \"%wheel ALL=(ALL) NOPASSWD:ALL\" &gt;&gt; /etc/sudoers'\n</code></pre> <ul> <li>sudo \u63d0\u793a\u627e\u4e0d\u5230\u547d\u4ee4</li> </ul> <pre><code>sudo sed -i 's,env_reset,!&amp;,' /etc/sudoers\necho \"alias sudo='sudo env PATH=$PATH'\" &gt;&gt; ~/.bashrc\nsource ~/.bashrc\n</code></pre> <ul> <li>\u5173\u95ed\u9632\u706b\u5899</li> </ul> <pre><code>sudo systemctl stop firewalld\nsudo systemctl disable firewalld\n</code></pre> <ul> <li>\u5173\u95ed SELINUX</li> </ul> <pre><code>sudo sed -i \"/SELINUX/ s,enforcing,disabled,g\" /etc/selinux/config\nsudo setenforce 0\n</code></pre> <ul> <li>\u66f4\u6362\u56fd\u5185\u955c\u50cf</li> </ul> <pre><code>sudo curl -So /etc/yum.repos.d/Centos-Base.repo https://mirrors.aliyun.com/repo/Centos-7.repo\nsudo yum makecache fast\n</code></pre> <ul> <li>\u5b89\u88c5 epel \u6e90</li> </ul> <pre><code>sudo curl -So /etc/yum.repos.d/epel.repo https://mirrors.aliyun.com/repo/epel-7.repo\nsudo yum makecache fast\n</code></pre> <ul> <li>\u66f4\u65b0\u7cfb\u7edf</li> </ul> <pre><code>sudo yum update -y --exclude=kernel-headers\nsudo echo \"exclude=kernel-headers\" &gt;&gt; /etc/yum.conf\n</code></pre> <ul> <li>\u5b89\u88c5\u547d\u4ee4\u8865\u5168</li> </ul> <pre><code>sudo yum install -y bash-completion\nsource /etc/profile.d/bash_completion.sh\n</code></pre> <ul> <li>\u5b89\u88c5\u65b0\u7248\u5185\u6838</li> </ul> <pre><code>sudo yum install -y screen\nscreen -S kernel\nsudo sh -c '\nrpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\nyum install https://www.elrepo.org/elrepo-release-7.el7.elrepo.noarch.rpm\nyum makecache fast\nif [ `rpm -qa|grep ^kernel-headers|wc -l` -ge 1 ];then\n    rpm -e --nodeps kernel.*headers\nfi\nyum --enablerepo elrepo-kernel install -y kernel-ml kernel-ml-devel kernel-ml-headers\nyum group remove -y \"Development Tools\"\nyum group install -y \"Development Tools\"\ngrub2-set-default 0\n'\n</code></pre> <p>\u5220\u9664 kernel-headers \u4f1a\u81ea\u52a8\u5220\u9664 gcc gcc-c++ \u7b49\u4f9d\u8d56</p> <ul> <li>\u8c03\u6574 swap \u5206\u533a</li> </ul> <p>\u5bf9\u4e8e Red Hat \u5e73\u53f0\uff0c\u63a8\u8350\u8bbe\u7f6e\u7684 SWAP \u4ea4\u6362\u7a7a\u95f4\u5927\u5c0f\u4e3a\u591a\u5c11\uff1f</p> RAM \u5927\u5c0f SWAP \u5927\u5c0f \u5982\u679c\u5141\u8bb8\u4f11\u7720 SWAP \u5927\u5c0f 2GB \u6216\u66f4\u5c11 2\u500d\u7684 RAM \u5927\u5c0f 3\u500d\u7684 RAM \u5927\u5c0f 2GB - 8GB \u4e0e RAM \u5927\u5c0f\u76f8\u540c 2\u500d\u7684 RAM \u5927\u5c0f 8GB - 64GB \u81f3\u5c11 4GB 1.5\u500d\u7684 RAM \u5927\u5c0f 64GB \u6216\u66f4\u591a \u81f3\u5c11 4GB \u4e0d\u63a8\u8350\u4f11\u7720 <pre><code>mem=$(free -m|sed '1d'|awk '/Mem/{print $2}')\nswap=`expr $mem / 2`\n# \u521b\u5efa swap \u6587\u4ef6\nif [ $mem -le 2048 ];then\n    dd if=/dev/zero of=/tmp/swap bs=${swap}M count=4\nelif [ $mem -gt 2048 &amp;&amp; $mem -le 8192 ];then\n    dd if=/dev/zero of=/tmp/swap bs=${swap}M count=2\nelse\n    dd if=/dev/zero of=/tmp/swap bs=4G count=4\nfi\nsudo chown 0:0 /tmp/swap\nsudo chmod 0600 /tmp/swap\n# \u683c\u5f0f\u5316 swap \u6587\u4ef6\nsudo mkswap /tmp/swap\n# \u5f00\u673a\u81ea\u52a8\u6302\u8f7d\nswapoff -a\nsed -i \"/swap/ s|^\\(.*\\)$|#\\1|g\" /etc/fstab\nsudo sh -c 'echo \"/tmp/swap swap swap defaults 0 0\" &gt;&gt; /etc/fstab'\nsudo swapon -a\n</code></pre> <ul> <li>\u8c03\u6574\u5185\u6838</li> </ul> <pre><code>mem=$(free -m|sed '1d'|awk '/Mem/{print $2}')\nshmmax=$(awk -v m=$mem 'BEGIN{printf(\"%.f\\n\",m*1024*1024*0.9)}')\nshmall=$(awk -v m=$mem 'BEGIN{printf(\"%.f\\n\",m*1024*0.9/4)}')\ngrep -q \"^kernel.shmall\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^kernel.shmmax.*,kernel.shmmax = $shmmax,\" /etc/sysctl.conf || echo \"kernel.shmmax = $shmmax\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^kernel.shmall\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^kernel.shmall.*,kernel.shmall = $shmall,\" /etc/sysctl.conf || echo \"kernel.shmall = $shmall\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^kernel.msgmax\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^kernel.msgmax.*,kernel.msgmax = 65535,\" /etc/sysctl.conf || echo \"kernel.msgmax = 65535\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^kernel.msgmnb\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^kernel.msgmnb.*,kernel.msgmnb = 65535,\" /etc/sysctl.conf || echo \"kernel.msgmnb = 65535\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^vm.swappiness\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^vm.swappiness.*,vm.swappiness = 30,\" /etc/sysctl.conf || echo \"vm.swappiness = 30\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^fs.file-max\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^fs.file-max.*,fs.file-max = 6553560,\" /etc/sysctl.conf || echo \"fs.file-max = 6553560\" &gt;&gt; /etc/sysctl.conf\nsysctl -p\n\nsudo sysctl -p\n</code></pre> <p>kernel.shmmax: \u5355\u4e2a\u5171\u4eab\u5185\u5b58\u6bb5\u7684\u6700\u5927\u503c\uff1b\u4f8b\u5982 4G RAM: <code>4*1024*1024*1024*0.9=3865470566</code></p> <p>kernel.shmall: \u5171\u4eab\u5185\u5b58\u603b\u91cf\uff1b\u4f8b\u5982 4G RAM: <code>4*1024*1024*1024*0.9/4/1024=943718</code></p> <p>\u53c2\u8003\uff1a\u8c03\u6574\u865a\u62df\u5185\u5b58</p> <p>\u53c2\u8003\uff1a\u914d\u7f6e\u7cfb\u7edf\u5185\u5b58\u5bb9\u91cf</p> <ul> <li>\u5b89\u88c5 docker</li> </ul> <pre><code>sudo yum remove -y docker*\n\nsudo curl -So /etc/yum.repos.d/docker-ce.repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\nsudo yum makecache fast\n\nsudo yum install -y lvm2 device-mapper-persistent-data docker-ce\n\nsudo systemctl start docker\nsudo systemctl enable docker\n\nsudo sh -c 'cat &lt;&lt;EOF&gt; /etc/docker/daemon.json\n{\n    \"registry-mirrors\": [\"https://dockerhub.azk8s.cn\"],\n    \"exec-opts\": [\"native.cgroupdriver=systemd\"],\n    \"log-driver\" \"json-file\",\n    \"log-opts\": {\n        \"max-size\": \"100m\"\n    }\n}\nEOF'\n\nsudo sh -c '\ngrep -q \"^net.ipv4.ip_forward\" /etc/sysctl.conf || echo \"net.ipv4.ip_forward = 1\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^net.ipv4.ip_forward\" /etc/sysctl.conf || echo \"net.ipv4.ip_forward = 1\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^net.bridge.bridge-nf-call-iptables\" /etc/sysctl.conf || echo \"net.bridge.bridge-nf-call-iptables = 1\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^net.bridge.bridge-nf-call-ip6tables\" /etc/sysctl.conf || echo \"net.bridge.bridge-nf-call-ip6tables = 1\" &gt;&gt; /etc/sysctl.conf\n'\n\nsudo systemctl restart docker\n\nsudo usermod -aG docker $username\n\ndocker info\n</code></pre> <ul> <li>\u5b89\u88c5 docker-compose</li> </ul> <pre><code>sudo yum install -y python3-pip\n\nsudo pip3 install -U pip -i https://pypi.douban.com/simple\nsudo pip install docker-compose\n\ndocker-compose -v\n</code></pre> <ul> <li>docker-compose \u547d\u4ee4\u8865\u5168</li> </ul> <pre><code>sudo curl -L https://raw.githubusercontent.com/docker/compose/1.25.5/contrib/completion/bash/docker-compose -o /etc/bash_completion.d/docker-compose\nsource /etc/bash_completion.d/docker-compose\n</code></pre> \u5feb\u901f\u521d\u59cb\u5316 <pre><code>sudo sh -c 'curl -L https://www.jangrui.com/centos-init.sh|bash'\n</code></pre> <p>\u811a\u672c\u5185\u5bb9\uff1a</p> <pre><code>#!/usr/bin/env bash\n# CentOS 6/7/8 \u521d\u59cb\u5316\n# jangrui &lt;admin@jangrui.com&gt;\n\n# set -euxo pipefail\n\nif [ `id -u` -ne 0 ];then\n    echo \"Please use root login.\"\n    exit 1\nfi\n\n# \u6dfb\u52a0\u7528\u6237\naddUser() {\n    read -p \"Please input your username\": username\n    if [ -z \"$username\" ];then\n        echo \"\u4e0d\u6dfb\u52a0\u7528\u6237\"\n    elif [ `grep \"$username\" /etc/passwd|wc -l` -eq 0 ];then\n        useradd \"$username\"\n        read -p \"Please input your passwd\": passwd\n        echo \"$passwd\" | passwd \"$username\" --stdin\n    else\n        echo \"$username is Already\"\n    fi\n\n    # \u53ea\u5141\u8bb8 wheel \u7ec4\u7528\u6237\u5207\u6362 root\n    if [ `grep -E \"^auth.*pam_wheel.so\" /etc/pam.d/su|wc -l` -eq 0 ];then\n        echo \"auth required pam_wheel.so use_uid\" &gt;&gt; /etc/pam.d/su\n    fi\n\n    if [ `grep \"SU_WHEEL_ONLY yes\" /etc/login.defs|wc -l` -eq 0 ];then\n        echo \"SU_WHEEL_ONLY yes\" &gt;&gt; /etc/login.defs\n    fi\n    usermod -aG wheel \"$username\"\n\n    # \u666e\u901a\u7528\u6237\u65e0\u5bc6\u7801\u9a8c\u8bc1\n    if [ `grep -E \"^%wheel.*NOPASSWD\" /etc/sudoers|wc -l` -eq 0 ];then\n        echo \"%wheel ALL=(ALL) NOPASSWD:ALL\" &gt;&gt; /etc/sudoers\n    fi\n\n    # \u666e\u901a\u7528\u6237\u63d0\u793a\u627e\u4e0d\u5230\u547d\u4ee4\n    if [ `grep \"!env_reset\" /etc/sudoers|wc -l` -eq 0 ];then\n        sed -i 's,env_reset,!&amp;,' /etc/sudoers\n        echo \"alias sudo='env PATH=$PATH'\" &gt;&gt; /home/$username/.bashrc\n    fi\n}\n\n# \u5173\u95ed\u9632\u706b\u5899\nsystemctl stop firewalld\nsystemctl disable firewalld\n\n# \u5173\u95ed SELINUX\nsed -i \"/SELINUX/ s,enforcing,permissive,g\" /etc/selinux/config\nsetenforce 0\n\n# \u66f4\u6362\u56fd\u5185\u955c\u50cf\ncp -a /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak\ncentos_version=$(cat /etc/redhat-release|sed -r 's/.* ([0-9]+)\\..*/\\1/')\ncurl -o /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-$centos_version.repo\n\n# \u5b89\u88c5 epel \u6e90\ncurl -o /etc/yum.repos.d/epel.repo https://mirrors.aliyun.com/repo/epel-7.repo\nsed -i \"s|7|$centos_version|g\" /etc/yum.repo.d/epel.repo\nyum makecache\n\n# \u66f4\u65b0\u7cfb\u7edf\nyum update -y\n\n# \u5b89\u88c5\u5e38\u7528\u5305\nyum install -y bash-completion vim wget iproute telnet htop conntrack ntp ipvsadm ipset jp iptables iptables-services curl sysstat libseccomp net-tools git\n\n# \u5f00\u542f iptables \u9632\u706b\u5899\nsystemctl enable iptables &amp;&amp; systemctl start iptables &amp;&amp; iptables -F &amp;&amp; iptables -Z &amp;&amp; iptables -X &amp;&amp; service iptables save\n\n# \u5f00\u542f lvs \u670d\u52a1\nsystemctl enable ipvsadm\n\n# \u65f6\u95f4\u540c\u6b65\nsystemctl enable ntpd\nsystemctl restart ntpd\ntimedatectl set-timezone Asia/Shanghai\ntimedatectl set-ntp true\n\n# \u5b89\u88c5\u65b0\u7248\u5185\u6838\nrpm --import https://www.elrepo.org/RPM-GPG-KEY-elrepo.org\nyum install -y http://www.elrepo.org/elrepo-release-$centos_version.el$centos_version.elrepo.noarch.rpm\n\nyum makecache fast\nif [ `rpm -qa|grep ^kernel.*headers|wc -l` -ge 1 ];then\n    yum remove -y kernel.*headers\nfi\nyum --enablerepo elrepo-kernel install -y kernel-ml kernel-ml-devel kernel-ml-headers\nyum group remove -y \"Development Tools\"\nyum group install -y \"Development Tools\"\ngrub2-set-default 0\n\n# \u5f00\u542f journal \u65e5\u5fd7\u6301\u4e45\u5316\nmkdir /var/log/journal # \u6301\u4e45\u5316\u4fdd\u5b58\u65e5\u5fd7\u7684\u76ee\u5f55\nmkdir /etc/systemd/journald.conf.d\ncat &gt; /etc/systemd/journald.conf.d/99-prophet.conf &lt;&lt;EOF\n[Journal]\n# \u6301\u4e45\u5316\u4fdd\u5b58\u5230\u78c1\u76d8\nStorage=persistent\n\n# \u538b\u7f29\u5386\u53f2\u65e5\u5fd7\nCompress=yes\n\nSyncIntervalSec=5m\nRateLimitInterval=30s\nRateLimitBurst=1000\n\n# \u6700\u5927\u5360\u7528\u7a7a\u95f4 10G\nSystemMaxUse=10G\n\n# \u5355\u65e5\u5fd7\u6587\u4ef6\u6700\u5927 200M\nSystemMaxFileSize=200M\n\n# \u65e5\u5fd7\u4fdd\u5b58\u65f6\u95f4 2 \u5468\nMaxRetentionSec=2week\n\n# \u4e0d\u5c06\u65e5\u5fd7\u8f6c\u53d1\u5230 syslog\nForwardToSyslog=no\nEOF\n\nsystemctl restart systemd-journald\n\n# \u521b\u5efa swap \u6587\u4ef6\nswap(){\n    swapoff -a\n    sed -i \"/swap/ s|^\\(.*\\)$|#\\1|g\" /etc/fstab\n    mem=$(free -m|sed '1d'|awk '/Mem/{print $2}')\n    swap=`expr $mem / 2`\n    if [ $mem -le 2048 ];then\n        dd if=/dev/zero of=/tmp/swap bs=${swap}M count=4\n    elif [ $mem -gt 2048 &amp;&amp; $mem -le 8192 ];then\n        dd if=/dev/zero of=/tmp/swap bs=${swap}M count=2\n    else\n        dd if=/dev/zero of=/tmp/swap bs=4G count=4\n    fi\n    chown 0:0 /tmp/swap\n    chmod 0600 /tmp/swap\n    # \u683c\u5f0f\u5316 swap \u6587\u4ef6\n    mkswap /tmp/swap\n    # \u5f00\u673a\u81ea\u52a8\u6302\u8f7d\n    echo \"/tmp/swap swap swap defaults 0 0\" &gt;&gt; /etc/fstab\n    swapon -a\n}\n\n# \u8c03\u6574 sysctl.conf\nshmmax=$(awk -v m=$mem 'BEGIN{printf(\"%.f\\n\",m*1024*1024*0.9)}')\nshmall=$(awk -v m=$mem 'BEGIN{printf(\"%.f\\n\",m*1024*0.9/4)}')\ngrep -q \"^kernel.shmall\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^kernel.shmmax.*,kernel.shmmax = $shmmax,\" /etc/sysctl.conf || echo \"kernel.shmmax = $shmmax\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^kernel.shmall\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^kernel.shmall.*,kernel.shmall = $shmall,\" /etc/sysctl.conf || echo \"kernel.shmall = $shmall\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^kernel.msgmax\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^kernel.msgmax.*,kernel.msgmax = 65535,\" /etc/sysctl.conf || echo \"kernel.msgmax = 65535\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^kernel.msgmnb\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^kernel.msgmnb.*,kernel.msgmnb = 65535,\" /etc/sysctl.conf || echo \"kernel.msgmnb = 65535\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^vm.swappiness\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^vm.swappiness.*,vm.swappiness = 30,\" /etc/sysctl.conf || echo \"vm.swappiness = 30\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^fs.file-max\" /etc/sysctl.conf &amp;&amp; sed -i \"s,^fs.file-max.*,fs.file-max = 6553560,\" /etc/sysctl.conf || echo \"fs.file-max = 6553560\" &gt;&gt; /etc/sysctl.conf\nsysctl -p\n\nsh -c 'cat &lt;&lt;EOF&gt; /etc/security/limits.conf\n*               soft    nofile          1000000\n*               hard    nofile          1000000\nEOF'\n\n# \u5f00\u542f ipvs \u8f6c\u53d1\ncat &gt; /etc/sysconfig/modules/ipvs.modules &lt;&lt;EOF\n#!/bin/bash\nmodprobe -- ip_vs\nmodprobe -- ip_vs_rr\nmodprobe -- ip_vs_wrr\nmodprobe -- ip_vs_sh\nmodprobe -- nf_conntrack\nEOF\nchmod 755 /etc/sysconfig/modules/ipvs.modules &amp;&amp; bash /etc/sysconfig/modules/ipvs.modules &amp;&amp; lsmod | grep -e ip_vs -e nf_conntrack\n\n# \u5b89\u88c5 docker\nif [ `rpm -qa|grep ^docker|wc -l` -ge 1 ];then\n    yum remove -y docker*\nfi\ncurl -o /etc/yum.repos.d/docker-ce.repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\nyum makecache fast\ncontainerd_rpm=http://mirrors.aliyun.com/docker-ce/linux/centos/7/x86_64/stable/Packages/containerd.io-1.2.6-3.3.el7.x86_64.rpm\nyum install -y lvm2 device-mapper-persistent-data $containerd_rpm docker-ce\nsystemctl start docker\nsystemctl enable docker\n\nsh -c 'cat &gt; /etc/docker/daemon.json &lt;&lt;EOF\n{\n\"registry-mirrors\": [\"https://dockerhub.azk8s.cn\"],\n\"exec-opts\": [\"native.cgroupdriver=systemd\"],\n\"log-driver\": \"json-file\",\n\"log-opts\": {\n    \"max-size\": \"100m\"\n}\n}\nEOF'\n\ngrep -q \"^net.ipv4.ip_forward\" /etc/sysctl.conf || echo \"net.ipv4.ip_forward = 1\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^net.ipv4.tcp_tw_reuse\" /etc/sysctl.conf || echo \"net.ipv4.tcp_tw_reuse = 1\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^net.ipv4.tcp_tw_recycle\" /etc/sysctl.conf || echo \"net.ipv4.tcp_tw_recycle = 0\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^net.netfilter.nf_conntrack_max\" /etc/sysctl.conf || echo \"net.netfilter.nf_conntrack_max = 2310720\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^net.bridge.bridge-nf-call-iptables\" /etc/sysctl.conf || echo \"net.bridge.bridge-nf-call-iptables = 1\" &gt;&gt; /etc/sysctl.conf\ngrep -q \"^net.bridge.bridge-nf-call-ip6tables\" /etc/sysctl.conf || echo \"net.bridge.bridge-nf-call-ip6tables = 1\" &gt;&gt; /etc/sysctl.conf\nsed -i '/net.core.default_qdisc/d' /etc/sysctl.conf\nsed -i '/net.ipv4.tcp_congestion_control/d' /etc/sysctl.conf\necho \"net.core.default_qdisc = fq\" &gt;&gt; /etc/sysctl.conf\necho \"net.ipv4.tcp_congestion_control = bbr\" &gt;&gt; /etc/sysctl.conf\n\nsystemctl restart docker\nusermod -aG docker $username\ndocker info\n\n# \u5b89\u88c5 docker-compose\nyum install -y python3-pip\npip3 install -U pip -i https://pypi.douban.com/simple\npip install docker-compose -i https://pypi.douban.com/simple\ndocker-compose -v\n\n# docker-compose \u547d\u4ee4\u8865\u5168\ncurl -L https://raw.githubusercontent.com/docker/compose/1.25.5/contrib/completion/bash/docker-compose -o /etc/bash_completion.d/docker-compose\n\n# \u91cd\u542f\nread -p \"\u662f\u5426\u7acb\u5373\u91cd\u542f\u670d\u52a1\u5668\uff1f\uff08yes|no\uff09\": isyes\nif [ \"$isyes\" = \"yes\" -o \"$isyes\" = \"y\" ];then\n    reboot\nelse\n    echo \"\u7a0d\u540e\u8bf7\u624b\u52a8\u91cd\u542f\u670d\u52a1\u5668\uff01\"\nfi\n</code></pre>"},{"location":"linux/lock-time-limit-after-ssh-login-failure/","title":"SSH \u767b\u5f55\u5931\u8d25\u540e\u9501\u5b9a\u65f6\u95f4\u9650\u5236","text":"<p>\u5728 Linux7 \u4e2d\uff0c\u4f60\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 /etc/pam\u3002d/system--auth \u6587\u4ef6\u6765\u914d\u7f6e\u91cd\u590d\u767b\u5f55\u5931\u8d25\u540e\u9501\u5b9a\u65f6\u95f4\u9650\u5236\u3002\u5177\u4f53\u6b65\u9aa4\u5982\u4e0b\uff1a</p> <p>1.\u6253\u5f00 <code>/etc/pam.d/system-auth</code> \u6587\u4ef6\uff0c\u627e\u5230 auth \u90e8\u5206\u3002</p> <p>2.\u5728 auth \u90e8\u5206\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a</p> <pre><code>auth required pam_faillock\u3002so preauth silent audit deny=3 unlock_time=600\nauth [default=die]pam_faillock.so authfail audit deny=3 unlock_time=600\n</code></pre> <p>Tip</p> <ul> <li><code>deny</code>\uff1a\u8868\u793a\u5141\u8bb8\u5931\u8d25\u7684\u6700\u5927\u6b21\u6570\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e3a 3\uff1b</li> <li><code>unlock_time</code>\uff1a\u8868\u793a\u8d26\u6237\u88ab\u9501\u5b9a\u7684\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u79d2\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e3a 600\u79d2\uff08\u537310\u5206\u949f\uff09</li> </ul> <p>3.\u4fdd\u5b58\u6587\u4ef6\u5e76\u9000\u51fa\u3002</p> <p>4.\u91cd\u65b0\u52a0\u8f7d PAM \u914d\u7f6e\uff1a</p> <pre><code>authconfig --update --force\n</code></pre>"},{"location":"linux/bash/arithmetic/","title":"Bash \u7684\u7b97\u672f\u8fd0\u7b97","text":""},{"location":"linux/bash/arithmetic/#_1","title":"\u7b97\u672f\u8868\u8fbe\u5f0f","text":"<p><code>((...))</code>\u8bed\u6cd5\u53ef\u4ee5\u8fdb\u884c\u6574\u6570\u7684\u7b97\u672f\u8fd0\u7b97\u3002</p> <pre><code>$ ((foo = 5 + 5))\n$ echo $foo\n10\n</code></pre> <p><code>((...))</code>\u4f1a\u81ea\u52a8\u5ffd\u7565\u5185\u90e8\u7684\u7a7a\u683c\uff0c\u6240\u4ee5\u4e0b\u9762\u7684\u5199\u6cd5\u90fd\u6b63\u786e\uff0c\u5f97\u5230\u540c\u6837\u7684\u7ed3\u679c\u3002</p> <pre><code>$ ((2+2))\n$ (( 2+2 ))\n$ (( 2 + 2 ))\n</code></pre> <p>\u8fd9\u4e2a\u8bed\u6cd5\u4e0d\u8fd4\u56de\u503c\uff0c\u547d\u4ee4\u6267\u884c\u7684\u7ed3\u679c\u6839\u636e\u7b97\u672f\u8fd0\u7b97\u7684\u7ed3\u679c\u800c\u5b9a\u3002\u53ea\u8981\u7b97\u672f\u7ed3\u679c\u4e0d\u662f<code>0</code>\uff0c\u547d\u4ee4\u5c31\u7b97\u6267\u884c\u6210\u529f\u3002</p> <pre><code>$ (( 3 + 2 ))\n$ echo $?\n0\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>3 + 2</code>\u7684\u7ed3\u679c\u662f5\uff0c\u547d\u4ee4\u5c31\u7b97\u6267\u884c\u6210\u529f\uff0c\u73af\u5883\u53d8\u91cf<code>$?</code>\u4e3a<code>0</code>\u3002</p> <p>\u5982\u679c\u7b97\u672f\u7ed3\u679c\u4e3a<code>0</code>\uff0c\u547d\u4ee4\u5c31\u7b97\u6267\u884c\u5931\u8d25\u3002</p> <pre><code>$ (( 3 - 3 ))\n$ echo $?\n1\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>3 - 3</code>\u7684\u7ed3\u679c\u662f<code>0</code>\uff0c\u73af\u5883\u53d8\u91cf<code>$?</code>\u4e3a<code>1</code>\uff0c\u8868\u793a\u547d\u4ee4\u6267\u884c\u5931\u8d25\u3002</p> <p>\u5982\u679c\u8981\u8bfb\u53d6\u7b97\u672f\u8fd0\u7b97\u7684\u7ed3\u679c\uff0c\u9700\u8981\u5728<code>((...))</code>\u524d\u9762\u52a0\u4e0a\u7f8e\u5143\u7b26\u53f7<code>$((...))</code>\uff0c\u4f7f\u5176\u53d8\u6210\u7b97\u672f\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u7b97\u672f\u8fd0\u7b97\u7684\u503c\u3002</p> <pre><code>$ echo $((2 + 2))\n4\n</code></pre> <p><code>((...))</code>\u8bed\u6cd5\u652f\u6301\u7684\u7b97\u672f\u8fd0\u7b97\u7b26\u5982\u4e0b\u3002</p> <ul> <li><code>+</code>\uff1a\u52a0\u6cd5</li> <li><code>-</code>\uff1a\u51cf\u6cd5</li> <li><code>*</code>\uff1a\u4e58\u6cd5</li> <li><code>/</code>\uff1a\u9664\u6cd5\uff08\u6574\u9664\uff09</li> <li><code>%</code>\uff1a\u4f59\u6570</li> <li><code>**</code>\uff1a\u6307\u6570</li> <li><code>++</code>\uff1a\u81ea\u589e\u8fd0\u7b97\uff08\u524d\u7f00\u6216\u540e\u7f00\uff09</li> <li><code>--</code>\uff1a\u81ea\u51cf\u8fd0\u7b97\uff08\u524d\u7f00\u6216\u540e\u7f00\uff09</li> </ul> <p>\u6ce8\u610f\uff0c\u9664\u6cd5\u8fd0\u7b97\u7b26\u7684\u8fd4\u56de\u7ed3\u679c\u603b\u662f\u6574\u6570\uff0c\u6bd4\u5982<code>5</code>\u9664\u4ee5<code>2</code>\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u662f<code>2</code>\uff0c\u800c\u4e0d\u662f<code>2.5</code>\u3002</p> <pre><code>$ echo $((5 / 2))\n2\n</code></pre> <p><code>++</code>\u548c<code>--</code>\u8fd9\u4e24\u4e2a\u8fd0\u7b97\u7b26\u6709\u524d\u7f00\u548c\u540e\u7f00\u7684\u533a\u522b\u3002\u4f5c\u4e3a\u524d\u7f00\u662f\u5148\u8fd0\u7b97\u540e\u8fd4\u56de\u503c\uff0c\u4f5c\u4e3a\u540e\u7f00\u662f\u5148\u8fd4\u56de\u503c\u540e\u8fd0\u7b97\u3002</p> <pre><code>$ i=0\n$ echo $i\n0\n$ echo $((i++))\n0\n$ echo $i\n1\n$ echo $((++i))\n2\n$ echo $i\n2\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>++</code>\u4f5c\u4e3a\u540e\u7f00\u662f\u5148\u8fd4\u56de\u503c\uff0c\u6267\u884c<code>echo</code>\u547d\u4ee4\uff0c\u518d\u8fdb\u884c\u81ea\u589e\u8fd0\u7b97\uff1b\u4f5c\u4e3a\u524d\u7f00\u5219\u662f\u5148\u8fdb\u884c\u81ea\u589e\u8fd0\u7b97\uff0c\u518d\u8fd4\u56de\u503c\u6267\u884c<code>echo</code>\u547d\u4ee4\u3002</p> <p><code>$((...))</code>\u5185\u90e8\u53ef\u4ee5\u7528\u5706\u62ec\u53f7\u6539\u53d8\u8fd0\u7b97\u987a\u5e8f\u3002</p> <pre><code>$ echo $(( (2 + 3) * 4 ))\n20\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5185\u90e8\u7684\u5706\u62ec\u53f7\u8ba9\u52a0\u6cd5\u5148\u4e8e\u4e58\u6cd5\u6267\u884c\u3002</p> <p><code>$((...))</code>\u7ed3\u6784\u53ef\u4ee5\u5d4c\u5957\u3002</p> <pre><code>$ echo $(((5**2) * 3))\n75\n# \u7b49\u540c\u4e8e\n$ echo $(($((5**2)) * 3))\n75\n</code></pre> <p>\u8fd9\u4e2a\u8bed\u6cd5\u53ea\u80fd\u8ba1\u7b97\u6574\u6570\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002</p> <pre><code># \u62a5\u9519\n$ echo $((1.5 + 1))\nbash: \u8bed\u6cd5\u9519\u8bef\n</code></pre> <p><code>$((...))</code>\u7684\u5706\u62ec\u53f7\u4e4b\u4e2d\uff0c\u4e0d\u9700\u8981\u5728\u53d8\u91cf\u540d\u4e4b\u524d\u52a0\u4e0a<code>$</code>\uff0c\u4e0d\u8fc7\u52a0\u4e0a\u4e5f\u4e0d\u62a5\u9519\u3002</p> <pre><code>$ number=2\n$ echo $(($number + 1))\n3\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53d8\u91cf<code>number</code>\u524d\u9762\u6709\u6ca1\u6709\u7f8e\u5143\u7b26\u53f7\uff0c\u7ed3\u679c\u90fd\u662f\u4e00\u6837\u7684\u3002</p> <p>\u5982\u679c\u5728<code>$((...))</code>\u91cc\u9762\u4f7f\u7528\u5b57\u7b26\u4e32\uff0cBash \u4f1a\u8ba4\u4e3a\u90a3\u662f\u4e00\u4e2a\u53d8\u91cf\u540d\u3002\u5982\u679c\u4e0d\u5b58\u5728\u540c\u540d\u53d8\u91cf\uff0cBash \u5c31\u4f1a\u5c06\u5176\u4f5c\u4e3a\u7a7a\u503c\uff0c\u56e0\u6b64\u4e0d\u4f1a\u62a5\u9519\u3002</p> <pre><code>$ echo $(( \"hello\" + 2))\n2\n$ echo $(( \"hello\" * 2))\n0\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>\"hello\"</code>\u4f1a\u88ab\u5f53\u4f5c\u53d8\u91cf\u540d\uff0c\u8fd4\u56de\u7a7a\u503c\uff0c\u800c<code>$((...))</code>\u4f1a\u5c06\u7a7a\u503c\u5f53\u4f5c<code>0</code>\uff0c\u6240\u4ee5\u4e58\u6cd5\u7684\u8fd0\u7b97\u7ed3\u679c\u5c31\u662f<code>0</code>\u3002\u540c\u7406\uff0c\u5982\u679c<code>$((...))</code>\u91cc\u9762\u4f7f\u7528\u4e0d\u5b58\u5728\u7684\u53d8\u91cf\uff0c\u4e5f\u4f1a\u5f53\u4f5c<code>0</code>\u5904\u7406\u3002</p> <p>\u5982\u679c\u4e00\u4e2a\u53d8\u91cf\u7684\u503c\u4e3a\u5b57\u7b26\u4e32\uff0c\u8ddf\u4e0a\u9762\u7684\u5904\u7406\u903b\u8f91\u662f\u4e00\u6837\u7684\u3002\u5373\u8be5\u5b57\u7b26\u4e32\u5982\u679c\u4e0d\u5bf9\u5e94\u5df2\u5b58\u5728\u7684\u53d8\u91cf\uff0c\u5728<code>$((...))</code>\u91cc\u9762\u4f1a\u88ab\u5f53\u4f5c\u7a7a\u503c\u3002</p> <pre><code>$ foo=hello\n$ echo $(( foo + 2))\n2\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53d8\u91cf<code>foo</code>\u7684\u503c\u662f<code>hello</code>\uff0c\u800c<code>hello</code>\u4e5f\u4f1a\u88ab\u770b\u4f5c\u53d8\u91cf\u540d\u3002\u8fd9\u4f7f\u5f97\u6709\u53ef\u80fd\u5199\u51fa\u52a8\u6001\u66ff\u6362\u7684\u4ee3\u7801\u3002</p> <pre><code>$ foo=hello\n$ hello=3\n$ echo $(( foo + 2 ))\n5\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>foo + 2</code>\u53d6\u51b3\u4e8e\u53d8\u91cf<code>hello</code>\u7684\u503c\u3002</p> <p>\u6700\u540e\uff0c<code>$[...]</code>\u662f\u4ee5\u524d\u7684\u8bed\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u505a\u6574\u6570\u8fd0\u7b97\uff0c\u4e0d\u5efa\u8bae\u4f7f\u7528\u3002</p> <pre><code>$ echo $[2+2]\n4\n</code></pre>"},{"location":"linux/bash/arithmetic/#_2","title":"\u6570\u503c\u7684\u8fdb\u5236","text":"<p>Bash \u7684\u6570\u503c\u9ed8\u8ba4\u90fd\u662f\u5341\u8fdb\u5236\uff0c\u4f46\u662f\u5728\u7b97\u672f\u8868\u8fbe\u5f0f\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u8fdb\u5236\u3002</p> <ul> <li><code>number</code>\uff1a\u6ca1\u6709\u4efb\u4f55\u7279\u6b8a\u8868\u793a\u6cd5\u7684\u6570\u5b57\u662f\u5341\u8fdb\u5236\u6570\uff08\u4ee510\u4e3a\u5e95\uff09\u3002</li> <li><code>0number</code>\uff1a\u516b\u8fdb\u5236\u6570\u3002</li> <li><code>0xnumber</code>\uff1a\u5341\u516d\u8fdb\u5236\u6570\u3002</li> <li><code>base#number</code>\uff1a<code>base</code>\u8fdb\u5236\u7684\u6570\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u4f8b\u5b50\u3002</p> <pre><code>$ echo $((0xff))\n255\n$ echo $((2#11111111))\n255\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>0xff</code>\u662f\u5341\u516d\u8fdb\u5236\u6570\uff0c<code>2#11111111</code>\u662f\u4e8c\u8fdb\u5236\u6570\u3002</p>"},{"location":"linux/bash/arithmetic/#_3","title":"\u4f4d\u8fd0\u7b97","text":"<p><code>$((...))</code>\u652f\u6301\u4ee5\u4e0b\u7684\u4e8c\u8fdb\u5236\u4f4d\u8fd0\u7b97\u7b26\u3002</p> <ul> <li><code>&lt;&lt;</code>\uff1a\u4f4d\u5de6\u79fb\u8fd0\u7b97\uff0c\u628a\u4e00\u4e2a\u6570\u5b57\u7684\u6240\u6709\u4f4d\u5411\u5de6\u79fb\u52a8\u6307\u5b9a\u7684\u4f4d\u3002</li> <li><code>&gt;&gt;</code>\uff1a\u4f4d\u53f3\u79fb\u8fd0\u7b97\uff0c\u628a\u4e00\u4e2a\u6570\u5b57\u7684\u6240\u6709\u4f4d\u5411\u53f3\u79fb\u52a8\u6307\u5b9a\u7684\u4f4d\u3002</li> <li><code>&amp;</code>\uff1a\u4f4d\u7684\u201c\u4e0e\u201d\u8fd0\u7b97\uff0c\u5bf9\u4e24\u4e2a\u6570\u5b57\u7684\u6240\u6709\u4f4d\u6267\u884c\u4e00\u4e2a<code>AND</code>\u64cd\u4f5c\u3002</li> <li><code>|</code>\uff1a\u4f4d\u7684\u201c\u6216\u201d\u8fd0\u7b97\uff0c\u5bf9\u4e24\u4e2a\u6570\u5b57\u7684\u6240\u6709\u4f4d\u6267\u884c\u4e00\u4e2a<code>OR</code>\u64cd\u4f5c\u3002</li> <li><code>~</code>\uff1a\u4f4d\u7684\u201c\u5426\u201d\u8fd0\u7b97\uff0c\u5bf9\u4e00\u4e2a\u6570\u5b57\u7684\u6240\u6709\u4f4d\u53d6\u53cd\u3002</li> <li><code>^</code>\uff1a\u4f4d\u7684\u5f02\u6216\u8fd0\u7b97\uff08exclusive or\uff09\uff0c\u5bf9\u4e24\u4e2a\u6570\u5b57\u7684\u6240\u6709\u4f4d\u6267\u884c\u4e00\u4e2a\u5f02\u6216\u64cd\u4f5c\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u53f3\u79fb\u8fd0\u7b97\u7b26<code>&gt;&gt;</code>\u7684\u4f8b\u5b50\u3002</p> <pre><code>$ echo $((16&gt;&gt;2))\n4\n</code></pre> <p>\u4e0b\u9762\u662f\u5de6\u79fb\u8fd0\u7b97\u7b26<code>&lt;&lt;</code>\u7684\u4f8b\u5b50\u3002</p> <pre><code>$ echo $((16&lt;&lt;2))\n64\n</code></pre> <p>\u4e0b\u9762\u662f<code>17</code>\uff08\u4e8c\u8fdb\u5236<code>10001</code>\uff09\u548c<code>3</code>\uff08\u4e8c\u8fdb\u5236<code>11</code>\uff09\u7684\u5404\u79cd\u4e8c\u8fdb\u5236\u8fd0\u7b97\u7684\u7ed3\u679c\u3002</p> <pre><code>$ echo $((17&amp;3))\n1\n$ echo $((17|3))\n19\n$ echo $((17^3))\n18\n</code></pre>"},{"location":"linux/bash/arithmetic/#_4","title":"\u903b\u8f91\u8fd0\u7b97","text":"<p><code>$((...))</code>\u652f\u6301\u4ee5\u4e0b\u7684\u903b\u8f91\u8fd0\u7b97\u7b26\u3002</p> <ul> <li><code>&lt;</code>\uff1a\u5c0f\u4e8e</li> <li><code>&gt;</code>\uff1a\u5927\u4e8e</li> <li><code>&lt;=</code>\uff1a\u5c0f\u4e8e\u6216\u76f8\u7b49</li> <li><code>&gt;=</code>\uff1a\u5927\u4e8e\u6216\u76f8\u7b49</li> <li><code>==</code>\uff1a\u76f8\u7b49</li> <li><code>!=</code>\uff1a\u4e0d\u76f8\u7b49</li> <li><code>&amp;&amp;</code>\uff1a\u903b\u8f91\u4e0e</li> <li><code>||</code>\uff1a\u903b\u8f91\u6216</li> <li><code>!</code>\uff1a\u903b\u8f91\u5426</li> <li><code>expr1?expr2:expr3</code>\uff1a\u4e09\u5143\u6761\u4ef6\u8fd0\u7b97\u7b26\u3002\u82e5\u8868\u8fbe\u5f0f<code>expr1</code>\u7684\u8ba1\u7b97\u7ed3\u679c\u4e3a\u975e\u96f6\u503c\uff08\u7b97\u672f\u771f\uff09\uff0c\u5219\u6267\u884c\u8868\u8fbe\u5f0f<code>expr2</code>\uff0c\u5426\u5219\u6267\u884c\u8868\u8fbe\u5f0f<code>expr3</code>\u3002</li> </ul> <p>\u5982\u679c\u903b\u8f91\u8868\u8fbe\u5f0f\u4e3a\u771f\uff0c\u8fd4\u56de<code>1</code>\uff0c\u5426\u5219\u8fd4\u56de<code>0</code>\u3002</p> <pre><code>$ echo $((3 &gt; 2))\n1\n$ echo $(( (3 &gt; 2) || (4 &lt;= 1) ))\n1\n</code></pre> <p>\u4e09\u5143\u8fd0\u7b97\u7b26\u6267\u884c\u4e00\u4e2a\u5355\u72ec\u7684\u903b\u8f91\u6d4b\u8bd5\u3002\u5b83\u7528\u8d77\u6765\u7c7b\u4f3c\u4e8e<code>if/then/else</code>\u8bed\u53e5\u3002</p> <pre><code>$ a=0\n$ echo $((a&lt;1 ? 1 : 0))\n1\n$ echo $((a&gt;1 ? 1 : 0))\n0\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7b2c\u4e00\u4e2a\u8868\u8fbe\u5f0f\u4e3a\u771f\u65f6\uff0c\u8fd4\u56de\u7b2c\u4e8c\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\uff0c\u5426\u5219\u8fd4\u56de\u7b2c\u4e09\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\u3002</p>"},{"location":"linux/bash/arithmetic/#_5","title":"\u8d4b\u503c\u8fd0\u7b97","text":"<p>\u7b97\u672f\u8868\u8fbe\u5f0f<code>$((...))</code>\u53ef\u4ee5\u6267\u884c\u8d4b\u503c\u8fd0\u7b97\u3002</p> <pre><code>$ echo $((a=1))\n1\n$ echo $a\n1\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>a=1</code>\u5bf9\u53d8\u91cf<code>a</code>\u8fdb\u884c\u8d4b\u503c\u3002\u8fd9\u4e2a\u5f0f\u5b50\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u8fd4\u56de\u503c\u5c31\u662f\u7b49\u53f7\u53f3\u8fb9\u7684\u503c\u3002</p> <p><code>$((...))</code>\u652f\u6301\u7684\u8d4b\u503c\u8fd0\u7b97\u7b26\uff0c\u6709\u4ee5\u4e0b\u8fd9\u4e9b\u3002</p> <ul> <li><code>parameter = value</code>\uff1a\u7b80\u5355\u8d4b\u503c\u3002</li> <li><code>parameter += value</code>\uff1a\u7b49\u4ef7\u4e8e<code>parameter = parameter + value</code>\u3002</li> <li><code>parameter -= value</code>\uff1a\u7b49\u4ef7\u4e8e<code>parameter = parameter \u2013 value</code>\u3002</li> <li><code>parameter *= value</code>\uff1a\u7b49\u4ef7\u4e8e<code>parameter = parameter * value</code>\u3002</li> <li><code>parameter /= value</code>\uff1a\u7b49\u4ef7\u4e8e<code>parameter = parameter / value</code>\u3002</li> <li><code>parameter %= value</code>\uff1a\u7b49\u4ef7\u4e8e<code>parameter = parameter % value</code>\u3002</li> <li><code>parameter &lt;&lt;= value</code>\uff1a\u7b49\u4ef7\u4e8e<code>parameter = parameter &lt;&lt; value</code>\u3002</li> <li><code>parameter &gt;&gt;= value</code>\uff1a\u7b49\u4ef7\u4e8e<code>parameter = parameter &gt;&gt; value</code>\u3002</li> <li><code>parameter &amp;= value</code>\uff1a\u7b49\u4ef7\u4e8e<code>parameter = parameter &amp; value</code>\u3002</li> <li><code>parameter |= value</code>\uff1a\u7b49\u4ef7\u4e8e<code>parameter = parameter | value</code>\u3002</li> <li><code>parameter ^= value</code>\uff1a\u7b49\u4ef7\u4e8e<code>parameter = parameter ^ value</code>\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>$ foo=5\n$ echo $((foo*=2))\n10\n</code></pre> <p>\u5982\u679c\u5728\u8868\u8fbe\u5f0f\u5185\u90e8\u8d4b\u503c\uff0c\u53ef\u4ee5\u653e\u5728\u5706\u62ec\u53f7\u4e2d\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002</p> <pre><code>$ echo $(( a&lt;1 ? (a+=1) : (a-=1) ))\n</code></pre>"},{"location":"linux/bash/arithmetic/#_6","title":"\u6c42\u503c\u8fd0\u7b97","text":"<p>\u9017\u53f7<code>,</code>\u5728<code>$((...))</code>\u5185\u90e8\u662f\u6c42\u503c\u8fd0\u7b97\u7b26\uff0c\u6267\u884c\u524d\u540e\u4e24\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5e76\u8fd4\u56de\u540e\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\u3002</p> <pre><code>$ echo $((foo = 1 + 2, 3 * 4))\n12\n$ echo $foo\n3\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u9017\u53f7\u524d\u540e\u4e24\u4e2a\u8868\u8fbe\u5f0f\u90fd\u4f1a\u6267\u884c\uff0c\u7136\u540e\u8fd4\u56de\u540e\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c<code>12</code>\u3002</p>"},{"location":"linux/bash/arithmetic/#expr","title":"expr \u547d\u4ee4","text":"<p><code>expr</code>\u547d\u4ee4\u652f\u6301\u7b97\u672f\u8fd0\u7b97\uff0c\u53ef\u4ee5\u4e0d\u4f7f\u7528<code>((...))</code>\u8bed\u6cd5\u3002</p> <pre><code>$ expr 3 + 2\n5\n</code></pre> <p><code>expr</code>\u547d\u4ee4\u652f\u6301\u53d8\u91cf\u66ff\u6362\u3002</p> <pre><code>$ foo=3\n$ expr $foo + 2\n5\n</code></pre> <p><code>expr</code>\u547d\u4ee4\u4e5f\u4e0d\u652f\u6301\u975e\u6574\u6570\u53c2\u6570\u3002</p> <pre><code>$ expr 3.5 + 2\nexpr: \u975e\u6574\u6570\u53c2\u6570\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u6709\u975e\u6574\u6570\u7684\u8fd0\u7b97\uff0c<code>expr</code>\u547d\u4ee4\u5c31\u62a5\u9519\u4e86\u3002</p>"},{"location":"linux/bash/arithmetic/#let","title":"let \u547d\u4ee4","text":"<p><code>let</code>\u547d\u4ee4\u7528\u4e8e\u5c06\u7b97\u672f\u8fd0\u7b97\u7684\u7ed3\u679c\uff0c\u8d4b\u4e88\u4e00\u4e2a\u53d8\u91cf\u3002</p> <pre><code>$ let x=2+3\n$ echo $x\n5\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53d8\u91cf<code>x</code>\u7b49\u4e8e<code>2+3</code>\u7684\u8fd0\u7b97\u7ed3\u679c\u3002</p> <p>\u6ce8\u610f\uff0c<code>x=2+3</code>\u8fd9\u4e2a\u5f0f\u5b50\u91cc\u9762\u4e0d\u80fd\u6709\u7a7a\u683c\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002<code>let</code>\u547d\u4ee4\u7684\u8be6\u7ec6\u7528\u6cd5\u53c2\u89c1\u300a\u53d8\u91cf\u300b\u4e00\u7ae0\u3002</p>"},{"location":"linux/bash/array/","title":"\u6570\u7ec4","text":"<p>\u6570\u7ec4\uff08array\uff09\u662f\u4e00\u4e2a\u5305\u542b\u591a\u4e2a\u503c\u7684\u53d8\u91cf\u3002\u6210\u5458\u7684\u7f16\u53f7\u4ece0\u5f00\u59cb\uff0c\u6570\u91cf\u6ca1\u6709\u4e0a\u9650\uff0c\u4e5f\u6ca1\u6709\u8981\u6c42\u6210\u5458\u88ab\u8fde\u7eed\u7d22\u5f15\u3002</p>"},{"location":"linux/bash/array/#_2","title":"\u521b\u5efa\u6570\u7ec4","text":"<p>\u6570\u7ec4\u53ef\u4ee5\u91c7\u7528\u9010\u4e2a\u8d4b\u503c\u7684\u65b9\u6cd5\u521b\u5efa\u3002</p> <pre><code>ARRAY[INDEX]=value\n</code></pre> <p>\u4e0a\u9762\u8bed\u6cd5\u4e2d\uff0c<code>ARRAY</code>\u662f\u6570\u7ec4\u7684\u540d\u5b57\uff0c\u53ef\u4ee5\u662f\u4efb\u610f\u5408\u6cd5\u7684\u53d8\u91cf\u540d\u3002<code>INDEX</code>\u662f\u4e00\u4e2a\u5927\u4e8e\u6216\u7b49\u4e8e\u96f6\u7684\u6574\u6570\uff0c\u4e5f\u53ef\u4ee5\u662f\u7b97\u672f\u8868\u8fbe\u5f0f\u3002\u6ce8\u610f\u6570\u7ec4\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u4e0b\u6807\u662f0\uff0c \u800c\u4e0d\u662f1\u3002</p> <p>\u4e0b\u9762\u521b\u5efa\u4e00\u4e2a\u4e09\u4e2a\u6210\u5458\u7684\u6570\u7ec4\u3002</p> <pre><code>$ array[0]=val\n$ array[1]=val\n$ array[2]=val\n</code></pre> <p>\u6570\u7ec4\u4e5f\u53ef\u4ee5\u91c7\u7528\u4e00\u6b21\u6027\u8d4b\u503c\u7684\u65b9\u5f0f\u521b\u5efa\u3002</p> <pre><code>ARRAY=(value1 value2 ... valueN)\n\n# \u7b49\u540c\u4e8e\n\nARRAY=(\n  value1\n  value2\n  value3\n)\n</code></pre> <p>\u91c7\u7528\u4e0a\u9762\u65b9\u5f0f\u521b\u5efa\u6570\u7ec4\u65f6\uff0c\u53ef\u4ee5\u6309\u7167\u9ed8\u8ba4\u987a\u5e8f\u8d4b\u503c\uff0c\u4e5f\u53ef\u4ee5\u5728\u6bcf\u4e2a\u503c\u524d\u9762\u6307\u5b9a\u4f4d\u7f6e\u3002</p> <pre><code>$ array=(a b c)\n$ array=([2]=c [0]=a [1]=b)\n\n$ days=(Sun Mon Tue Wed Thu Fri Sat)\n$ days=([0]=Sun [1]=Mon [2]=Tue [3]=Wed [4]=Thu [5]=Fri [6]=Sat)\n</code></pre> <p>\u53ea\u4e3a\u67d0\u4e9b\u503c\u6307\u5b9a\u4f4d\u7f6e\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684\u3002</p> <pre><code>names=(hatter [5]=duchess alice)\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>hatter</code>\u662f\u6570\u7ec4\u76840\u53f7\u4f4d\u7f6e\uff0c<code>duchess</code>\u662f5\u53f7\u4f4d\u7f6e\uff0c<code>alice</code>\u662f6\u53f7\u4f4d\u7f6e\u3002</p> <p>\u6ca1\u6709\u8d4b\u503c\u7684\u6570\u7ec4\u5143\u7d20\u7684\u9ed8\u8ba4\u503c\u662f\u7a7a\u5b57\u7b26\u4e32\u3002</p> <p>\u5b9a\u4e49\u6570\u7ec4\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26\u3002</p> <pre><code>$ mp3s=( *.mp3 )\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5c06\u5f53\u524d\u76ee\u5f55\u7684\u6240\u6709 MP3 \u6587\u4ef6\uff0c\u653e\u8fdb\u4e00\u4e2a\u6570\u7ec4\u3002</p> <p>\u5148\u7528<code>declare -a</code>\u547d\u4ee4\u58f0\u660e\u4e00\u4e2a\u6570\u7ec4\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684\u3002</p> <pre><code>$ declare -a ARRAYNAME\n</code></pre> <p><code>read -a</code>\u547d\u4ee4\u5219\u662f\u5c06\u7528\u6237\u7684\u547d\u4ee4\u884c\u8f93\u5165\uff0c\u5b58\u5165\u4e00\u4e2a\u6570\u7ec4\u3002</p> <pre><code>$ read -a dice\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u5c06\u7528\u6237\u7684\u547d\u4ee4\u884c\u8f93\u5165\uff0c\u5b58\u5165\u6570\u7ec4<code>dice</code>\u3002</p>"},{"location":"linux/bash/array/#_3","title":"\u8bfb\u53d6\u6570\u7ec4","text":""},{"location":"linux/bash/array/#_4","title":"\u8bfb\u53d6\u5355\u4e2a\u5143\u7d20","text":"<p>\u8bfb\u53d6\u6570\u7ec4\u6307\u5b9a\u4f4d\u7f6e\u7684\u6210\u5458\uff0c\u8981\u4f7f\u7528\u4e0b\u9762\u7684\u8bed\u6cd5\u3002</p> <pre><code>$ echo ${array[i]}     # i \u662f\u7d22\u5f15\n</code></pre> <p>\u4e0a\u9762\u8bed\u6cd5\u91cc\u9762\u7684\u5927\u62ec\u53f7\u662f\u5fc5\u4e0d\u53ef\u5c11\u7684\uff0c\u5426\u5219 Bash \u4f1a\u628a\u7d22\u5f15\u90e8\u5206<code>[i]</code>\u6309\u7167\u539f\u6837\u8f93\u51fa\u3002</p> <pre><code>$ array[0]=a\n\n$ echo ${array[0]}\na\n\n$ echo $array[0]\na[0]\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u6570\u7ec4\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u662f<code>a</code>\u3002\u5982\u679c\u4e0d\u52a0\u5927\u62ec\u53f7\uff0cBash \u4f1a\u76f4\u63a5\u8bfb\u53d6<code>$array</code>\u9996\u6210\u5458\u7684\u503c\uff0c\u7136\u540e\u5c06<code>[0]</code>\u6309\u7167\u539f\u6837\u8f93\u51fa\u3002</p>"},{"location":"linux/bash/array/#_5","title":"\u8bfb\u53d6\u6240\u6709\u6210\u5458","text":"<p><code>@</code>\u548c<code>*</code>\u662f\u6570\u7ec4\u7684\u7279\u6b8a\u7d22\u5f15\uff0c\u8868\u793a\u8fd4\u56de\u6570\u7ec4\u7684\u6240\u6709\u6210\u5458\u3002</p> <pre><code>$ foo=(a b c d e f)\n$ echo ${foo[@]}\na b c d e f\n</code></pre> <p>\u8fd9\u4e24\u4e2a\u7279\u6b8a\u7d22\u5f15\u914d\u5408<code>for</code>\u5faa\u73af\uff0c\u5c31\u53ef\u4ee5\u7528\u6765\u904d\u5386\u6570\u7ec4\u3002</p> <pre><code>for i in \"${names[@]}\"; do\n  echo $i\ndone\n</code></pre> <p><code>@</code>\u548c<code>*</code>\u653e\u4e0d\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c\u662f\u6709\u5dee\u522b\u7684\u3002</p> <pre><code>$ activities=( swimming \"water skiing\" canoeing \"white-water rafting\" surfing )\n$ for act in ${activities[@]}; \\\ndo \\\necho \"Activity: $act\"; \\\ndone\n\nActivity: swimming\nActivity: water\nActivity: skiing\nActivity: canoeing\nActivity: white-water\nActivity: rafting\nActivity: surfing\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u6570\u7ec4<code>activities</code>\u5b9e\u9645\u5305\u542b5\u4e2a\u6210\u5458\uff0c\u4f46\u662f<code>for...in</code>\u5faa\u73af\u76f4\u63a5\u904d\u5386<code>${activities[@]}</code>\uff0c\u5bfc\u81f4\u8fd4\u56de7\u4e2a\u7ed3\u679c\u3002\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u4e00\u822c\u628a<code>${activities[@]}</code>\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\u3002</p> <pre><code>$ for act in \"${activities[@]}\"; \\\ndo \\\necho \"Activity: $act\"; \\\ndone\n\nActivity: swimming\nActivity: water skiing\nActivity: canoeing\nActivity: white-water rafting\nActivity: surfing\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>${activities[@]}</code>\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c\u904d\u5386\u5c31\u4f1a\u8fd4\u56de\u6b63\u786e\u7684\u7ed3\u679c\u3002</p> <p><code>${activities[*]}</code>\u4e0d\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c\u8ddf<code>${activities[@]}</code>\u4e0d\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\u662f\u4e00\u6837\u7684\u3002</p> <pre><code>$ for act in ${activities[*]}; \\\ndo \\\necho \"Activity: $act\"; \\\ndone\n\nActivity: swimming\nActivity: water\nActivity: skiing\nActivity: canoeing\nActivity: white-water\nActivity: rafting\nActivity: surfing\n</code></pre> <p><code>${activities[*]}</code>\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c\u6240\u6709\u6210\u5458\u5c31\u4f1a\u53d8\u6210\u5355\u4e2a\u5b57\u7b26\u4e32\u8fd4\u56de\u3002</p> <pre><code>$ for act in \"${activities[*]}\"; \\\ndo \\\necho \"Activity: $act\"; \\\ndone\n\nActivity: swimming water skiing canoeing white-water rafting surfing\n</code></pre> <p>\u6240\u4ee5\uff0c\u62f7\u8d1d\u4e00\u4e2a\u6570\u7ec4\u7684\u6700\u65b9\u4fbf\u65b9\u6cd5\uff0c\u5c31\u662f\u5199\u6210\u4e0b\u9762\u8fd9\u6837\u3002</p> <pre><code>$ hobbies=( \"${activities[@]}\" )\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u6570\u7ec4<code>activities</code>\u88ab\u62f7\u8d1d\u7ed9\u4e86\u53e6\u4e00\u4e2a\u6570\u7ec4<code>hobbies</code>\u3002</p> <p>\u8fd9\u79cd\u5199\u6cd5\u4e5f\u53ef\u4ee5\u7528\u6765\u4e3a\u65b0\u6570\u7ec4\u6dfb\u52a0\u6210\u5458\u3002</p> <pre><code>$ hobbies=( \"${activities[@]\" diving )\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u65b0\u6570\u7ec4<code>hobbies</code>\u5728\u6570\u7ec4<code>activities</code>\u7684\u6240\u6709\u6210\u5458\u4e4b\u540e\uff0c\u53c8\u6dfb\u52a0\u4e86\u4e00\u4e2a\u6210\u5458\u3002</p>"},{"location":"linux/bash/array/#_6","title":"\u9ed8\u8ba4\u4f4d\u7f6e","text":"<p>\u5982\u679c\u8bfb\u53d6\u6570\u7ec4\u6210\u5458\u65f6\uff0c\u6ca1\u6709\u8bfb\u53d6\u6307\u5b9a\u54ea\u4e00\u4e2a\u4f4d\u7f6e\u7684\u6210\u5458\uff0c\u9ed8\u8ba4\u4f7f\u7528<code>0</code>\u53f7\u4f4d\u7f6e\u3002</p> <pre><code>$ declare -a foo\n$ foo=A\n$ echo ${foo[0]}\nA\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>foo</code>\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u8d4b\u503c\u7684\u65f6\u5019\u4e0d\u6307\u5b9a\u4f4d\u7f6e\uff0c\u5b9e\u9645\u4e0a\u662f\u7ed9<code>foo[0]</code>\u8d4b\u503c\u3002</p> <p>\u5f15\u7528\u4e00\u4e2a\u4e0d\u5e26\u4e0b\u6807\u7684\u6570\u7ec4\u53d8\u91cf\uff0c\u5219\u5f15\u7528\u7684\u662f<code>0</code>\u53f7\u4f4d\u7f6e\u7684\u6570\u7ec4\u5143\u7d20\u3002</p> <pre><code>$ foo=(a b c d e f)\n$ echo ${foo}\na\n$ echo $foo\na\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5f15\u7528\u6570\u7ec4\u5143\u7d20\u7684\u65f6\u5019\uff0c\u6ca1\u6709\u6307\u5b9a\u4f4d\u7f6e\uff0c\u7ed3\u679c\u8fd4\u56de\u7684\u662f<code>0</code>\u53f7\u4f4d\u7f6e\u3002</p>"},{"location":"linux/bash/array/#_7","title":"\u6570\u7ec4\u7684\u957f\u5ea6","text":"<p>\u8981\u60f3\u77e5\u9053\u6570\u7ec4\u7684\u957f\u5ea6\uff08\u5373\u4e00\u5171\u5305\u542b\u591a\u5c11\u6210\u5458\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u4e24\u79cd\u8bed\u6cd5\u3002</p> <pre><code>${#array[*]}\n${#array[@]}\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>$ a[100]=foo\n\n$ echo ${#a[*]}\n1\n\n$ echo ${#a[@]}\n1\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u628a\u5b57\u7b26\u4e32\u8d4b\u503c\u7ed9<code>100</code>\u4f4d\u7f6e\u7684\u6570\u7ec4\u5143\u7d20\uff0c\u8fd9\u65f6\u7684\u6570\u7ec4\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\u3002</p> <p>\u6ce8\u610f\uff0c\u5982\u679c\u7528\u8fd9\u79cd\u8bed\u6cd5\u53bb\u8bfb\u53d6\u5177\u4f53\u7684\u6570\u7ec4\u6210\u5458\uff0c\u5c31\u4f1a\u8fd4\u56de\u8be5\u6210\u5458\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\u3002\u8fd9\u4e00\u70b9\u5fc5\u987b\u5c0f\u5fc3\u3002</p> <pre><code>$ a[100]=foo\n$ echo ${#a[100]}\n3\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>${#a[100]}</code>\u5b9e\u9645\u4e0a\u662f\u8fd4\u56de\u6570\u7ec4\u7b2c100\u53f7\u6210\u5458<code>a[100]</code>\u7684\u503c\uff08<code>foo</code>\uff09\u7684\u5b57\u7b26\u4e32\u957f\u5ea6\u3002</p>"},{"location":"linux/bash/array/#_8","title":"\u63d0\u53d6\u6570\u7ec4\u5e8f\u53f7","text":"<p><code>${!array[@]}</code>\u6216<code>${!array[*]}</code>\uff0c\u53ef\u4ee5\u8fd4\u56de\u6570\u7ec4\u7684\u6210\u5458\u5e8f\u53f7\uff0c\u5373\u54ea\u4e9b\u4f4d\u7f6e\u662f\u6709\u503c\u7684\u3002</p> <pre><code>$ arr=([5]=a [9]=b [23]=c)\n$ echo ${!arr[@]}\n5 9 23\n$ echo ${!arr[*]}\n5 9 23\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u6570\u7ec4\u76845\u30019\u300123\u53f7\u4f4d\u7f6e\u6709\u503c\u3002</p> <p>\u5229\u7528\u8fd9\u4e2a\u8bed\u6cd5\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7<code>for</code>\u5faa\u73af\u904d\u5386\u6570\u7ec4\u3002</p> <pre><code>arr=(a b c d)\n\nfor i in ${!arr[@]};do\n  echo ${arr[i]}\ndone\n</code></pre>"},{"location":"linux/bash/array/#_9","title":"\u63d0\u53d6\u6570\u7ec4\u6210\u5458","text":"<p><code>${array[@]:position:length}</code>\u7684\u8bed\u6cd5\u53ef\u4ee5\u63d0\u53d6\u6570\u7ec4\u6210\u5458\u3002</p> <pre><code>$ food=( apples bananas cucumbers dates eggs fajitas grapes )\n$ echo ${food[@]:1:1}\nbananas\n$ echo ${food[@]:1:3}\nbananas cucumbers dates\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>${food[@]:1:1}</code>\u8fd4\u56de\u4ece\u6570\u7ec41\u53f7\u4f4d\u7f6e\u5f00\u59cb\u76841\u4e2a\u6210\u5458\uff0c<code>${food[@]:1:3}</code>\u8fd4\u56de\u4ece1\u53f7\u4f4d\u7f6e\u5f00\u59cb\u76843\u4e2a\u6210\u5458\u3002</p> <p>\u5982\u679c\u7701\u7565\u957f\u5ea6\u53c2\u6570<code>length</code>\uff0c\u5219\u8fd4\u56de\u4ece\u6307\u5b9a\u4f4d\u7f6e\u5f00\u59cb\u7684\u6240\u6709\u6210\u5458\u3002</p> <pre><code>$ echo ${food[@]:4}\neggs fajitas grapes\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u8fd4\u56de\u4ece4\u53f7\u4f4d\u7f6e\u5f00\u59cb\u5230\u7ed3\u675f\u7684\u6240\u6709\u6210\u5458\u3002</p>"},{"location":"linux/bash/array/#_10","title":"\u8ffd\u52a0\u6570\u7ec4\u6210\u5458","text":"<p>\u6570\u7ec4\u672b\u5c3e\u8ffd\u52a0\u6210\u5458\uff0c\u53ef\u4ee5\u4f7f\u7528<code>+=</code>\u8d4b\u503c\u8fd0\u7b97\u7b26\u3002\u5b83\u80fd\u591f\u81ea\u52a8\u5730\u628a\u503c\u8ffd\u52a0\u5230\u6570\u7ec4\u672b\u5c3e\u3002\u5426\u5219\uff0c\u5c31\u9700\u8981\u77e5\u9053\u6570\u7ec4\u7684\u6700\u5927\u5e8f\u53f7\uff0c\u6bd4\u8f83\u9ebb\u70e6\u3002</p> <pre><code>$ foo=(a b c)\n$ echo ${foo[@]}\na b c\n\n$ foo+=(d e f)\n$ echo ${foo[@]}\na b c d e f\n</code></pre>"},{"location":"linux/bash/array/#_11","title":"\u5220\u9664\u6570\u7ec4","text":"<p>\u5220\u9664\u4e00\u4e2a\u6570\u7ec4\u6210\u5458\uff0c\u4f7f\u7528<code>unset</code>\u547d\u4ee4\u3002</p> <pre><code>$ foo=(a b c d e f)\n$ echo ${foo[@]}\na b c d e f\n\n$ unset foo[2]\n$ echo ${foo[@]}\na b d e f\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5220\u9664\u4e86\u6570\u7ec4\u4e2d\u7684\u7b2c\u4e09\u4e2a\u5143\u7d20\uff0c\u4e0b\u6807\u4e3a2\u3002</p> <p>\u5c06\u67d0\u4e2a\u6210\u5458\u8bbe\u4e3a\u7a7a\u503c\uff0c\u53ef\u4ee5\u4ece\u8fd4\u56de\u503c\u4e2d\u201c\u9690\u85cf\u201d\u8fd9\u4e2a\u6210\u5458\u3002</p> <pre><code>$ foo=(a b c d e f)\n$ foo[1]=''\n$ echo ${foo[@]}\na c d e f\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5c06\u6570\u7ec4\u7684\u7b2c\u4e8c\u4e2a\u6210\u5458\u8bbe\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff0c\u6570\u7ec4\u7684\u8fd4\u56de\u503c\u4e2d\uff0c\u8fd9\u4e2a\u6210\u5458\u5c31\u201c\u9690\u85cf\u201d\u4e86\u3002</p> <p>\u6ce8\u610f\uff0c\u8fd9\u91cc\u662f\u201c\u9690\u85cf\u201d\uff0c\u800c\u4e0d\u662f\u5220\u9664\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u6210\u5458\u4ecd\u7136\u5b58\u5728\uff0c\u53ea\u662f\u503c\u53d8\u6210\u4e86\u7a7a\u503c\u3002</p> <pre><code>$ foo=(a b c d e f)\n$ foo[1]=''\n$ echo ${#foo[@]}\n6\n$ echo ${!foo[@]}\n0 1 2 3 4 5\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u7b2c\u4e8c\u4e2a\u6210\u5458\u8bbe\u4e3a\u7a7a\u503c\u540e\uff0c\u6570\u7ec4\u4ecd\u7136\u5305\u542b6\u4e2a\u6210\u5458\u3002</p> <p>\u7531\u4e8e\u7a7a\u503c\u5c31\u662f\u7a7a\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u4e0b\u9762\u8fd9\u6837\u5199\u4e5f\u6709\u9690\u85cf\u6548\u679c\uff0c\u4f46\u662f\u4e0d\u5efa\u8bae\u8fd9\u79cd\u5199\u6cd5\u3002</p> <pre><code>$ foo[1]=\n</code></pre> <p>\u4e0a\u9762\u7684\u5199\u6cd5\u4e5f\u76f8\u5f53\u4e8e\u201c\u9690\u85cf\u201d\u4e86\u6570\u7ec4\u7684\u7b2c\u4e8c\u4e2a\u6210\u5458\u3002</p> <p>\u76f4\u63a5\u5c06\u6570\u7ec4\u53d8\u91cf\u8d4b\u503c\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff0c\u76f8\u5f53\u4e8e\u201c\u9690\u85cf\u201d\u6570\u7ec4\u7684\u7b2c\u4e00\u4e2a\u6210\u5458\u3002</p> <pre><code>$ foo=(a b c d e f)\n$ foo=''\n$ echo ${foo[@]}\nb c d e f\n</code></pre> <p>\u4e0a\u9762\u7684\u5199\u6cd5\u76f8\u5f53\u4e8e\u201c\u9690\u85cf\u201d\u4e86\u6570\u7ec4\u7684\u7b2c\u4e00\u4e2a\u6210\u5458\u3002</p> <p><code>unset ArrayName</code>\u53ef\u4ee5\u6e05\u7a7a\u6574\u4e2a\u6570\u7ec4\u3002</p> <pre><code>$ unset ARRAY\n\n$ echo ${ARRAY[*]}\n&lt;--no output--&gt;\n</code></pre>"},{"location":"linux/bash/array/#_12","title":"\u5173\u8054\u6570\u7ec4","text":"<p>Bash \u7684\u65b0\u7248\u672c\u652f\u6301\u5173\u8054\u6570\u7ec4\u3002\u5173\u8054\u6570\u7ec4\u4f7f\u7528\u5b57\u7b26\u4e32\u800c\u4e0d\u662f\u6574\u6570\u4f5c\u4e3a\u6570\u7ec4\u7d22\u5f15\u3002</p> <p><code>declare -A</code>\u53ef\u4ee5\u58f0\u660e\u5173\u8054\u6570\u7ec4\u3002</p> <pre><code>declare -A colors\ncolors[\"red\"]=\"#ff0000\"\ncolors[\"green\"]=\"#00ff00\"\ncolors[\"blue\"]=\"#0000ff\"\n</code></pre> <p>\u5173\u8054\u6570\u7ec4\u5fc5\u987b\u7528\u5e26\u6709<code>-A</code>\u9009\u9879\u7684<code>declare</code>\u547d\u4ee4\u58f0\u660e\u521b\u5efa\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u6574\u6570\u7d22\u5f15\u7684\u6570\u7ec4\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u53d8\u91cf\u540d\u521b\u5efa\u6570\u7ec4\uff0c\u5173\u8054\u6570\u7ec4\u5c31\u4e0d\u884c\u3002</p> <p>\u8bbf\u95ee\u5173\u8054\u6570\u7ec4\u6210\u5458\u7684\u65b9\u5f0f\uff0c\u51e0\u4e4e\u4e0e\u6574\u6570\u7d22\u5f15\u6570\u7ec4\u76f8\u540c\u3002</p> <pre><code>echo ${colors[\"blue\"]}\n</code></pre>"},{"location":"linux/bash/author/","title":"Bash \u6559\u7a0b","text":"","tags":["bash"]},{"location":"linux/bash/author/#author","title":"Author","text":"<p>\u962e\u4e00\u5cf0\uff0c70\u540e\uff0c\u82f1\u6587\u540dFrank\u3002\u4e0a\u6d77\u8d22\u7ecf\u5927\u5b66\u4e16\u754c\u7ecf\u6d4e\u535a\u58eb\u7814\u7a76\u751f\u3002\u4e3b\u8981\u7814\u7a76\u5b8f\u89c2\u91d1\u878d\u3001\u8d27\u5e01\u653f\u7b56\u4e0e\u7f8e\u56fd\u7ecf\u6d4e\u3002\u4e8e2008\u5e746\u6708\u83b7\u5f97\u535a\u58eb\u5b66\u4f4d\u3002\u76ee\u524d\u5728\u4e0a\u6d77\u4e00\u6240\u5f53\u5730\u5927\u5b66\uff08\u4e0a\u6d77\u91d1\u878d\u5b66\u9662 \u56fd\u9645\u7ecf\u8d38\u5b66\u9662\uff09\u4efb\u6559\u3002\u4ed6\u672c\u4eba\u4e5f\u662f\u4e00\u540dIT\u6280\u672f\u4eba\u5458\uff0c\u5e76\u4e14\u5bf9\u81ea\u7531\u8f6f\u4ef6\u6709\u7740\u575a\u5b9a\u4e0d\u79fb\u7684\u4fe1\u5ff5\u3002</p>","tags":["bash"]},{"location":"linux/bash/author/#bash_1","title":"Bash \u811a\u672c\u6559\u7a0b","text":"<p>Bash \u811a\u672c\u6559\u7a0b\uff0c\u4ecb\u7ecd Linux \u547d\u4ee4\u884c Bash \u7684\u57fa\u672c\u7528\u6cd5\u548c\u811a\u672c\u7f16\u7a0b\u3002</p>","tags":["bash"]},{"location":"linux/bash/author/#_1","title":"\u76ee\u5f55","text":"<ul> <li>\u7b80\u4ecb</li> <li>\u57fa\u672c\u8bed\u6cd5</li> <li>\u6a21\u5f0f\u6269\u5c55</li> <li>\u5f15\u53f7\u548c\u8f6c\u4e49</li> <li>\u53d8\u91cf</li> <li>\u5b57\u7b26\u4e32\u64cd\u4f5c</li> <li>\u7b97\u672f\u8fd0\u7b97</li> <li>\u884c\u64cd\u4f5c</li> <li>\u76ee\u5f55\u5806\u6808</li> <li>\u811a\u672c\u5165\u95e8</li> <li>read \u547d\u4ee4</li> <li>\u6761\u4ef6\u5224\u65ad</li> <li>\u5faa\u73af</li> <li>\u51fd\u6570</li> <li>\u6570\u7ec4</li> <li>set \u547d\u4ee4</li> <li>\u811a\u672c\u9664\u9519</li> <li>mktemp \u547d\u4ee4\uff0ctrap \u547d\u4ee4</li> <li>\u542f\u52a8\u73af\u5883</li> <li>\u547d\u4ee4\u63d0\u793a\u7b26</li> </ul>","tags":["bash"]},{"location":"linux/bash/condition/","title":"\u6761\u4ef6\u5224\u65ad","text":"<p>\u672c\u7ae0\u4ecb\u7ecd Bash \u811a\u672c\u7684\u6761\u4ef6\u5224\u65ad\u8bed\u6cd5\u3002</p>"},{"location":"linux/bash/condition/#if","title":"if \u7ed3\u6784","text":"<p><code>if</code>\u662f\u6700\u5e38\u7528\u7684\u6761\u4ef6\u5224\u65ad\u7ed3\u6784\uff0c\u53ea\u6709\u7b26\u5408\u7ed9\u5b9a\u6761\u4ef6\u65f6\uff0c\u624d\u4f1a\u6267\u884c\u6307\u5b9a\u7684\u547d\u4ee4\u3002\u5b83\u7684\u8bed\u6cd5\u5982\u4e0b\u3002</p> <pre><code>if commands; then\n  commands\n[elif commands; then\n  commands...]\n[else\n  commands]\nfi\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u5206\u6210\u4e09\u4e2a\u90e8\u5206\uff1a<code>if</code>\u3001<code>elif</code>\u548c<code>else</code>\u3002\u5176\u4e2d\uff0c\u540e\u4e24\u4e2a\u90e8\u5206\u662f\u53ef\u9009\u7684\u3002</p> <p><code>if</code>\u5173\u952e\u5b57\u540e\u9762\u662f\u4e3b\u8981\u7684\u5224\u65ad\u6761\u4ef6\uff0c<code>elif</code>\u7528\u6765\u6dfb\u52a0\u5728\u4e3b\u6761\u4ef6\u4e0d\u6210\u7acb\u65f6\u7684\u5176\u4ed6\u5224\u65ad\u6761\u4ef6\uff0c<code>else</code>\u5219\u662f\u6240\u6709\u6761\u4ef6\u90fd\u4e0d\u6210\u7acb\u65f6\u8981\u6267\u884c\u7684\u90e8\u5206\u3002</p> <pre><code>if test $USER = \"foo\"; then\n  echo \"Hello foo.\"\nelse\n  echo \"You are not foo.\"\nfi\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5224\u65ad\u6761\u4ef6\u662f\u73af\u5883\u53d8\u91cf<code>$USER</code>\u662f\u5426\u7b49\u4e8e<code>foo</code>\uff0c\u5982\u679c\u7b49\u4e8e\u5c31\u8f93\u51fa<code>Hello foo.</code>\uff0c\u5426\u5219\u8f93\u51fa\u5176\u4ed6\u5185\u5bb9\u3002</p> <p><code>if</code>\u548c<code>then</code>\u5199\u5728\u540c\u4e00\u884c\u65f6\uff0c\u9700\u8981\u5206\u53f7\u5206\u9694\u3002\u5206\u53f7\u662f Bash \u7684\u547d\u4ee4\u5206\u9694\u7b26\u3002\u5b83\u4eec\u4e5f\u53ef\u4ee5\u5199\u6210\u4e24\u884c\uff0c\u8fd9\u65f6\u4e0d\u9700\u8981\u5206\u53f7\u3002</p> <pre><code>if true\nthen\n  echo 'hello world'\nfi\n\nif false\nthen\n  echo 'it is false' # \u672c\u884c\u4e0d\u4f1a\u6267\u884c\nfi\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c<code>true</code>\u548c<code>false</code>\u662f\u4e24\u4e2a\u7279\u6b8a\u547d\u4ee4\uff0c\u524d\u8005\u4ee3\u8868\u64cd\u4f5c\u6210\u529f\uff0c\u540e\u8005\u4ee3\u8868\u64cd\u4f5c\u5931\u8d25\u3002<code>if true</code>\u610f\u5473\u7740\u547d\u4ee4\u90e8\u5206\u603b\u662f\u4f1a\u6267\u884c\uff0c<code>if false</code>\u610f\u5473\u7740\u547d\u4ee4\u90e8\u5206\u6c38\u8fdc\u4e0d\u4f1a\u6267\u884c\u3002</p> <p>\u9664\u4e86\u591a\u884c\u7684\u5199\u6cd5\uff0c<code>if</code>\u7ed3\u6784\u4e5f\u53ef\u4ee5\u5199\u6210\u5355\u884c\u3002</p> <pre><code>$ if true; then echo 'hello world'; fi\nhello world\n\n$ if false; then echo \"It's true.\"; fi\n</code></pre> <p>\u6ce8\u610f\uff0c<code>if</code>\u5173\u952e\u5b57\u540e\u9762\u4e5f\u53ef\u4ee5\u662f\u4e00\u6761\u547d\u4ee4\uff0c\u8be5\u6761\u547d\u4ee4\u6267\u884c\u6210\u529f\uff08\u8fd4\u56de\u503c<code>0</code>\uff09\uff0c\u5c31\u610f\u5473\u7740\u5224\u65ad\u6761\u4ef6\u6210\u7acb\u3002</p> <pre><code>$ if echo 'hi'; then echo 'hello world'; fi\nhi\nhello world\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>if</code>\u540e\u9762\u662f\u4e00\u6761\u547d\u4ee4<code>echo 'hi'</code>\u3002\u8be5\u547d\u4ee4\u4f1a\u6267\u884c\uff0c\u5982\u679c\u8fd4\u56de\u503c\u662f<code>0</code>\uff0c\u5219\u6267\u884c<code>then</code>\u7684\u90e8\u5206\u3002</p> <p><code>if</code>\u540e\u9762\u53ef\u4ee5\u8ddf\u4efb\u610f\u6570\u91cf\u7684\u547d\u4ee4\u3002\u8fd9\u65f6\uff0c\u6240\u6709\u547d\u4ee4\u90fd\u4f1a\u6267\u884c\uff0c\u4f46\u662f\u5224\u65ad\u771f\u4f2a\u53ea\u770b\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\uff0c\u5373\u4f7f\u524d\u9762\u6240\u6709\u547d\u4ee4\u90fd\u5931\u8d25\uff0c\u53ea\u8981\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u8fd4\u56de<code>0</code>\uff0c\u5c31\u4f1a\u6267\u884c<code>then</code>\u7684\u90e8\u5206\u3002</p> <pre><code>$ if false; true; then echo 'hello world'; fi\nhello world\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>if</code>\u540e\u9762\u6709\u4e24\u6761\u547d\u4ee4\uff08<code>false;true;</code>\uff09\uff0c\u7b2c\u4e8c\u6761\u547d\u4ee4\uff08<code>true</code>\uff09\u51b3\u5b9a\u4e86<code>then</code>\u7684\u90e8\u5206\u662f\u5426\u4f1a\u6267\u884c\u3002</p> <p><code>elif</code>\u90e8\u5206\u53ef\u4ee5\u6709\u591a\u4e2a\u3002</p> <pre><code>#!/bin/bash\n\necho -n \"\u8f93\u5165\u4e00\u4e2a1\u52303\u4e4b\u95f4\u7684\u6570\u5b57\uff08\u5305\u542b\u4e24\u7aef\uff09&gt; \"\nread character\nif [ \"$character\" = \"1\" ]; then\n    echo 1\nelif [ \"$character\" = \"2\" ]; then\n    echo 2\nelif [ \"$character\" = \"3\" ]; then\n    echo 3\nelse\n    echo \u8f93\u5165\u4e0d\u7b26\u5408\u8981\u6c42\nfi\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u7528\u6237\u8f93\u5165<code>3</code>\uff0c\u5c31\u4f1a\u8fde\u7eed\u5224\u65ad3\u6b21\u3002</p>"},{"location":"linux/bash/condition/#test","title":"test \u547d\u4ee4","text":"<p><code>if</code>\u7ed3\u6784\u7684\u5224\u65ad\u6761\u4ef6\uff0c\u4e00\u822c\u4f7f\u7528<code>test</code>\u547d\u4ee4\uff0c\u6709\u4e09\u79cd\u5f62\u5f0f\u3002</p> <pre><code># \u5199\u6cd5\u4e00\ntest expression\n\n# \u5199\u6cd5\u4e8c\n[ expression ]\n\n# \u5199\u6cd5\u4e09\n[[ expression ]]\n</code></pre> <p>\u4e0a\u9762\u4e09\u79cd\u5f62\u5f0f\u662f\u7b49\u4ef7\u7684\uff0c\u4f46\u662f\u7b2c\u4e09\u79cd\u5f62\u5f0f\u8fd8\u652f\u6301\u6b63\u5219\u5224\u65ad\uff0c\u524d\u4e24\u79cd\u4e0d\u652f\u6301\u3002</p> <p>\u4e0a\u9762\u7684<code>expression</code>\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\u3002\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u4e3a\u771f\uff0c<code>test</code>\u547d\u4ee4\u6267\u884c\u6210\u529f\uff08\u8fd4\u56de\u503c\u4e3a<code>0</code>\uff09\uff1b\u8868\u8fbe\u5f0f\u4e3a\u4f2a\uff0c<code>test</code>\u547d\u4ee4\u6267\u884c\u5931\u8d25\uff08\u8fd4\u56de\u503c\u4e3a<code>1</code>\uff09\u3002\u6ce8\u610f\uff0c\u7b2c\u4e8c\u79cd\u548c\u7b2c\u4e09\u79cd\u5199\u6cd5\uff0c<code>[</code>\u548c<code>]</code>\u4e0e\u5185\u90e8\u7684\u8868\u8fbe\u5f0f\u4e4b\u95f4\u5fc5\u987b\u6709\u7a7a\u683c\u3002</p> <pre><code>$ test -f /etc/hosts\n$ echo $?\n0\n\n$ [ -f /etc/hosts ]\n$  echo $?\n0\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c<code>test</code>\u547d\u4ee4\u91c7\u7528\u4e24\u79cd\u5199\u6cd5\uff0c\u5224\u65ad<code>/etc/hosts</code>\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u8fd9\u4e24\u79cd\u5199\u6cd5\u662f\u7b49\u4ef7\u7684\u3002\u547d\u4ee4\u6267\u884c\u540e\uff0c\u8fd4\u56de\u503c\u4e3a<code>0</code>\uff0c\u8868\u793a\u8be5\u6587\u4ef6\u786e\u5b9e\u5b58\u5728\u3002</p> <p>\u5b9e\u9645\u4e0a\uff0c<code>[</code>\u8fd9\u4e2a\u5b57\u7b26\u662f<code>test</code>\u547d\u4ee4\u7684\u4e00\u79cd\u7b80\u5199\u5f62\u5f0f\uff0c\u53ef\u4ee5\u770b\u4f5c\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u547d\u4ee4\uff0c\u8fd9\u89e3\u91ca\u4e86\u4e3a\u4ec0\u4e48\u5b83\u540e\u9762\u5fc5\u987b\u6709\u7a7a\u683c\u3002</p> <p>\u4e0b\u9762\u628a<code>test</code>\u547d\u4ee4\u7684\u4e09\u79cd\u5f62\u5f0f\uff0c\u7528\u5728<code>if</code>\u7ed3\u6784\u4e2d\uff0c\u5224\u65ad\u4e00\u4e2a\u6587\u4ef6\u662f\u5426\u5b58\u5728\u3002</p> <pre><code># \u5199\u6cd5\u4e00\nif test -e /tmp/foo.txt ; then\n  echo \"Found foo.txt\"\nfi\n\n# \u5199\u6cd5\u4e8c\nif [ -e /tmp/foo.txt ] ; then\n  echo \"Found foo.txt\"\nfi\n\n# \u5199\u6cd5\u4e09\nif [[ -e /tmp/foo.txt ]] ; then\n  echo \"Found foo.txt\"\nfi\n</code></pre>"},{"location":"linux/bash/condition/#_2","title":"\u5224\u65ad\u8868\u8fbe\u5f0f","text":"<p><code>if</code>\u5173\u952e\u5b57\u540e\u9762\uff0c\u8ddf\u7684\u662f\u4e00\u4e2a\u547d\u4ee4\u3002\u8fd9\u4e2a\u547d\u4ee4\u53ef\u4ee5\u662f<code>test</code>\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u662f\u5176\u4ed6\u547d\u4ee4\u3002\u547d\u4ee4\u7684\u8fd4\u56de\u503c\u4e3a<code>0</code>\u8868\u793a\u5224\u65ad\u6210\u7acb\uff0c\u5426\u5219\u8868\u793a\u4e0d\u6210\u7acb\u3002\u56e0\u4e3a\u8fd9\u4e9b\u547d\u4ee4\u4e3b\u8981\u662f\u4e3a\u4e86\u5f97\u5230\u8fd4\u56de\u503c\uff0c\u6240\u4ee5\u53ef\u4ee5\u89c6\u4e3a\u8868\u8fbe\u5f0f\u3002</p> <p>\u5e38\u7528\u7684\u5224\u65ad\u8868\u8fbe\u5f0f\u6709\u4e0b\u9762\u8fd9\u4e9b\u3002</p>"},{"location":"linux/bash/condition/#_3","title":"\u6587\u4ef6\u5224\u65ad","text":"<p>\u4ee5\u4e0b\u8868\u8fbe\u5f0f\u7528\u6765\u5224\u65ad\u6587\u4ef6\u72b6\u6001\u3002</p> <ul> <li><code>[ -a file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -b file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2a\u5757\uff08\u8bbe\u5907\uff09\u6587\u4ef6\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -c file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2a\u5b57\u7b26\uff08\u8bbe\u5907\uff09\u6587\u4ef6\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -d file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2a\u76ee\u5f55\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -e file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -f file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2a\u666e\u901a\u6587\u4ef6\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -g file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u8bbe\u7f6e\u4e86\u7ec4 ID\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -G file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u5c5e\u4e8e\u6709\u6548\u7684\u7ec4 ID\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -h file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u662f\u7b26\u53f7\u94fe\u63a5\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -k file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u8bbe\u7f6e\u4e86\u5b83\u7684\u201csticky bit\u201d\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -L file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2a\u7b26\u53f7\u94fe\u63a5\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -N file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u81ea\u4e0a\u6b21\u8bfb\u53d6\u540e\u5df2\u88ab\u4fee\u6539\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -O file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u5c5e\u4e8e\u6709\u6548\u7684\u7528\u6237 ID\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -p file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u662f\u4e00\u4e2a\u547d\u540d\u7ba1\u9053\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -r file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u53ef\u8bfb\uff08\u5f53\u524d\u7528\u6237\u6709\u53ef\u8bfb\u6743\u9650\uff09\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -s file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u4e14\u5176\u957f\u5ea6\u5927\u4e8e\u96f6\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -S file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u4e14\u662f\u4e00\u4e2a\u7f51\u7edc socket\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -t fd ]</code>\uff1a\u5982\u679c fd \u662f\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5e76\u4e14\u91cd\u5b9a\u5411\u5230\u7ec8\u7aef\uff0c\u5219\u4e3a<code>true</code>\u3002 \u8fd9\u53ef\u4ee5\u7528\u6765\u5224\u65ad\u662f\u5426\u91cd\u5b9a\u5411\u4e86\u6807\u51c6\u8f93\u5165\uff0f\u8f93\u51fa\uff0f\u9519\u8bef\u3002</li> <li><code>[ -u file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u8bbe\u7f6e\u4e86 setuid \u4f4d\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -w file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u53ef\u5199\uff08\u5f53\u524d\u7528\u6237\u62e5\u6709\u53ef\u5199\u6743\u9650\uff09\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ -x file ]</code>\uff1a\u5982\u679c file \u5b58\u5728\u5e76\u4e14\u53ef\u6267\u884c\uff08\u6709\u6548\u7528\u6237\u6709\u6267\u884c\uff0f\u641c\u7d22\u6743\u9650\uff09\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ file1 -nt file2 ]</code>\uff1a\u5982\u679c FILE1 \u6bd4 FILE2 \u7684\u66f4\u65b0\u65f6\u95f4\u6700\u8fd1\uff0c\u6216\u8005 FILE1 \u5b58\u5728\u800c FILE2 \u4e0d\u5b58\u5728\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ file1 -ot file2 ]</code>\uff1a\u5982\u679c FILE1 \u6bd4 FILE2 \u7684\u66f4\u65b0\u65f6\u95f4\u66f4\u65e7\uff0c\u6216\u8005 FILE2 \u5b58\u5728\u800c FILE1 \u4e0d\u5b58\u5728\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ FILE1 -ef FILE2 ]</code>\uff1a\u5982\u679c FILE1 \u548c FILE2 \u5f15\u7528\u76f8\u540c\u7684\u8bbe\u5907\u548c inode \u7f16\u53f7\uff0c\u5219\u4e3a<code>true</code>\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\u3002</p> <pre><code>#!/bin/bash\n\nFILE=~/.bashrc\n\nif [ -e \"$FILE\" ]; then\n  if [ -f \"$FILE\" ]; then\n    echo \"$FILE is a regular file.\"\n  fi\n  if [ -d \"$FILE\" ]; then\n    echo \"$FILE is a directory.\"\n  fi\n  if [ -r \"$FILE\" ]; then\n    echo \"$FILE is readable.\"\n  fi\n  if [ -w \"$FILE\" ]; then\n    echo \"$FILE is writable.\"\n  fi\n  if [ -x \"$FILE\" ]; then\n    echo \"$FILE is executable/searchable.\"\n  fi\nelse\n  echo \"$FILE does not exist\"\n  exit 1\nfi\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>$FILE</code>\u8981\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\u3002\u8fd9\u6837\u53ef\u4ee5\u9632\u6b62<code>$FILE</code>\u4e3a\u7a7a\uff0c\u56e0\u4e3a\u8fd9\u65f6<code>[ -e ]</code>\u4f1a\u5224\u65ad\u4e3a\u771f\u3002\u800c\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c\u8fd4\u56de\u7684\u5c31\u603b\u662f\u4e00\u4e2a\u7a7a\u5b57\u7b26\u4e32\uff0c<code>[ -e \"\" ]</code>\u4f1a\u5224\u65ad\u4e3a\u4f2a\u3002</p>"},{"location":"linux/bash/condition/#_4","title":"\u5b57\u7b26\u4e32\u5224\u65ad","text":"<p>\u4ee5\u4e0b\u8868\u8fbe\u5f0f\u7528\u6765\u5224\u65ad\u5b57\u7b26\u4e32\u3002</p> <ul> <li><code>[ string ]</code>\uff1a\u5982\u679c<code>string</code>\u4e0d\u4e3a\u7a7a\uff08\u957f\u5ea6\u5927\u4e8e0\uff09\uff0c\u5219\u5224\u65ad\u4e3a\u771f\u3002</li> <li><code>[ -n string ]</code>\uff1a\u5982\u679c\u5b57\u7b26\u4e32<code>string</code>\u7684\u957f\u5ea6\u5927\u4e8e\u96f6\uff0c\u5219\u5224\u65ad\u4e3a\u771f\u3002</li> <li><code>[ -z string ]</code>\uff1a\u5982\u679c\u5b57\u7b26\u4e32<code>string</code>\u7684\u957f\u5ea6\u4e3a\u96f6\uff0c\u5219\u5224\u65ad\u4e3a\u771f\u3002</li> <li><code>[ string1 = string2 ]</code>\uff1a\u5982\u679c<code>string1</code>\u548c<code>string2</code>\u76f8\u540c\uff0c\u5219\u5224\u65ad\u4e3a\u771f\u3002</li> <li><code>[ string1 == string2 ]</code> \u7b49\u540c\u4e8e<code>[ string1 = string2 ]</code>\u3002</li> <li><code>[ string1 != string2 ]</code>\uff1a\u5982\u679c<code>string1</code>\u548c<code>string2</code>\u4e0d\u76f8\u540c\uff0c\u5219\u5224\u65ad\u4e3a\u771f\u3002</li> <li><code>[ string1 '&gt;' string2 ]</code>\uff1a\u5982\u679c\u6309\u7167\u5b57\u5178\u987a\u5e8f<code>string1</code>\u6392\u5217\u5728<code>string2</code>\u4e4b\u540e\uff0c\u5219\u5224\u65ad\u4e3a\u771f\u3002</li> <li><code>[ string1 '&lt;' string2 ]</code>\uff1a\u5982\u679c\u6309\u7167\u5b57\u5178\u987a\u5e8f<code>string1</code>\u6392\u5217\u5728<code>string2</code>\u4e4b\u524d\uff0c\u5219\u5224\u65ad\u4e3a\u771f\u3002</li> </ul> <p>\u6ce8\u610f\uff0c<code>test</code>\u547d\u4ee4\u5185\u90e8\u7684<code>&gt;</code>\u548c<code>&lt;</code>\uff0c\u5fc5\u987b\u7528\u5f15\u53f7\u5f15\u8d77\u6765\uff08\u6216\u8005\u662f\u7528\u53cd\u659c\u6760\u8f6c\u4e49\uff09\u3002\u5426\u5219\uff0c\u5b83\u4eec\u4f1a\u88ab shell \u89e3\u91ca\u4e3a\u91cd\u5b9a\u5411\u64cd\u4f5c\u7b26\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\u3002</p> <pre><code>#!/bin/bash\n\nANSWER=maybe\n\nif [ -z \"$ANSWER\" ]; then\n  echo \"There is no answer.\" &gt;&amp;2\n  exit 1\nfi\nif [ \"$ANSWER\" = \"yes\" ]; then\n  echo \"The answer is YES.\"\nelif [ \"$ANSWER\" = \"no\" ]; then\n  echo \"The answer is NO.\"\nelif [ \"$ANSWER\" = \"maybe\" ]; then\n  echo \"The answer is MAYBE.\"\nelse\n  echo \"The answer is UNKNOWN.\"\nfi\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u9996\u5148\u786e\u5b9a<code>$ANSWER</code>\u5b57\u7b26\u4e32\u662f\u5426\u4e3a\u7a7a\u3002\u5982\u679c\u4e3a\u7a7a\uff0c\u5c31\u7ec8\u6b62\u811a\u672c\uff0c\u5e76\u628a\u9000\u51fa\u72b6\u6001\u8bbe\u4e3a<code>1</code>\u3002\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684<code>echo</code>\u547d\u4ee4\u628a\u9519\u8bef\u4fe1\u606f<code>There is no answer.</code>\u91cd\u5b9a\u5411\u5230\u6807\u51c6\u9519\u8bef\uff0c\u8fd9\u662f\u5904\u7406\u9519\u8bef\u4fe1\u606f\u7684\u5e38\u7528\u65b9\u6cd5\u3002\u5982\u679c<code>$ANSWER</code>\u5b57\u7b26\u4e32\u4e0d\u4e3a\u7a7a\uff0c\u5c31\u5224\u65ad\u5b83\u7684\u503c\u662f\u5426\u7b49\u4e8e<code>yes</code>\u3001<code>no</code>\u6216\u8005<code>maybe</code>\u3002</p> <p>\u6ce8\u610f\uff0c\u5b57\u7b26\u4e32\u5224\u65ad\u65f6\uff0c\u53d8\u91cf\u8981\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c\u6bd4\u5982<code>[ -n \"$COUNT\" ]</code>\uff0c\u5426\u5219\u53d8\u91cf\u66ff\u6362\u6210\u5b57\u7b26\u4e32\u4ee5\u540e\uff0c<code>test</code>\u547d\u4ee4\u53ef\u80fd\u4f1a\u62a5\u9519\uff0c\u63d0\u793a\u53c2\u6570\u8fc7\u591a\u3002\u53e6\u5916\uff0c\u5982\u679c\u4e0d\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c\u53d8\u91cf\u4e3a\u7a7a\u65f6\uff0c\u547d\u4ee4\u4f1a\u53d8\u6210<code>[ -n ]</code>\uff0c\u8fd9\u65f6\u4f1a\u5224\u65ad\u4e3a\u771f\u3002\u5982\u679c\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c<code>[ -n \"\" ]</code>\u5c31\u5224\u65ad\u4e3a\u4f2a\u3002</p>"},{"location":"linux/bash/condition/#_5","title":"\u6574\u6570\u5224\u65ad","text":"<p>\u4e0b\u9762\u7684\u8868\u8fbe\u5f0f\u7528\u4e8e\u5224\u65ad\u6574\u6570\u3002</p> <ul> <li><code>[ integer1 -eq integer2 ]</code>\uff1a\u5982\u679c<code>integer1</code>\u7b49\u4e8e<code>integer2</code>\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ integer1 -ne integer2 ]</code>\uff1a\u5982\u679c<code>integer1</code>\u4e0d\u7b49\u4e8e<code>integer2</code>\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ integer1 -le integer2 ]</code>\uff1a\u5982\u679c<code>integer1</code>\u5c0f\u4e8e\u6216\u7b49\u4e8e<code>integer2</code>\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ integer1 -lt integer2 ]</code>\uff1a\u5982\u679c<code>integer1</code>\u5c0f\u4e8e<code>integer2</code>\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ integer1 -ge integer2 ]</code>\uff1a\u5982\u679c<code>integer1</code>\u5927\u4e8e\u6216\u7b49\u4e8e<code>integer2</code>\uff0c\u5219\u4e3a<code>true</code>\u3002</li> <li><code>[ integer1 -gt integer2 ]</code>\uff1a\u5982\u679c<code>integer1</code>\u5927\u4e8e<code>integer2</code>\uff0c\u5219\u4e3a<code>true</code>\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u7528\u6cd5\u7684\u4f8b\u5b50\u3002</p> <pre><code>#!/bin/bash\n\nINT=-5\n\nif [ -z \"$INT\" ]; then\n  echo \"INT is empty.\" &gt;&amp;2\n  exit 1\nfi\nif [ $INT -eq 0 ]; then\n  echo \"INT is zero.\"\nelse\n  if [ $INT -lt 0 ]; then\n    echo \"INT is negative.\"\n  else\n    echo \"INT is positive.\"\n  fi\n  if [ $((INT % 2)) -eq 0 ]; then\n    echo \"INT is even.\"\n  else\n    echo \"INT is odd.\"\n  fi\nfi\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5148\u5224\u65ad\u53d8\u91cf<code>$INT</code>\u662f\u5426\u4e3a\u7a7a\uff0c\u7136\u540e\u5224\u65ad\u662f\u5426\u4e3a<code>0</code>\uff0c\u63a5\u7740\u5224\u65ad\u6b63\u8d1f\uff0c\u6700\u540e\u901a\u8fc7\u6c42\u4f59\u6570\u5224\u65ad\u5947\u5076\u3002</p>"},{"location":"linux/bash/condition/#_6","title":"\u6b63\u5219\u5224\u65ad","text":"<p><code>[[ expression ]]</code>\u8fd9\u79cd\u5224\u65ad\u5f62\u5f0f\uff0c\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\u3002</p> <pre><code>[[ string1 =~ regex ]]\n</code></pre> <p>\u4e0a\u9762\u7684\u8bed\u6cd5\u4e2d\uff0c<code>regex</code>\u662f\u4e00\u4e2a\u6b63\u5219\u8868\u793a\u5f0f\uff0c<code>=~</code>\u662f\u6b63\u5219\u6bd4\u8f83\u8fd0\u7b97\u7b26\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>#!/bin/bash\n\nINT=-5\n\nif [[ \"$INT\" =~ ^-?[0-9]+$ ]]; then\n  echo \"INT is an integer.\"\n  exit 0\nelse\n  echo \"INT is not an integer.\" &gt;&amp;2\n  exit 1\nfi\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u5148\u5224\u65ad\u53d8\u91cf<code>INT</code>\u7684\u5b57\u7b26\u4e32\u5f62\u5f0f\uff0c\u662f\u5426\u6ee1\u8db3<code>^-?[0-9]+$</code>\u7684\u6b63\u5219\u6a21\u5f0f\uff0c\u5982\u679c\u6ee1\u8db3\u5c31\u8868\u660e\u5b83\u662f\u4e00\u4e2a\u6574\u6570\u3002</p>"},{"location":"linux/bash/condition/#test_1","title":"test \u5224\u65ad\u7684\u903b\u8f91\u8fd0\u7b97","text":"<p>\u901a\u8fc7\u903b\u8f91\u8fd0\u7b97\uff0c\u53ef\u4ee5\u628a\u591a\u4e2a<code>test</code>\u5224\u65ad\u8868\u8fbe\u5f0f\u7ed3\u5408\u8d77\u6765\uff0c\u521b\u9020\u66f4\u590d\u6742\u7684\u5224\u65ad\u3002\u4e09\u79cd\u903b\u8f91\u8fd0\u7b97<code>AND</code>\uff0c<code>OR</code>\uff0c\u548c<code>NOT</code>\uff0c\u90fd\u6709\u81ea\u5df1\u7684\u4e13\u7528\u7b26\u53f7\u3002</p> <ul> <li><code>AND</code>\u8fd0\u7b97\uff1a\u7b26\u53f7<code>&amp;&amp;</code>\uff0c\u4e5f\u53ef\u4f7f\u7528\u53c2\u6570<code>-a</code>\u3002</li> <li><code>OR</code>\u8fd0\u7b97\uff1a\u7b26\u53f7<code>||</code>\uff0c\u4e5f\u53ef\u4f7f\u7528\u53c2\u6570<code>-o</code>\u3002</li> <li><code>NOT</code>\u8fd0\u7b97\uff1a\u7b26\u53f7<code>!</code>\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u4e00\u4e2a<code>AND</code>\u7684\u4f8b\u5b50\uff0c\u5224\u65ad\u6574\u6570\u662f\u5426\u5728\u67d0\u4e2a\u8303\u56f4\u4e4b\u5185\u3002</p> <pre><code>#!/bin/bash\n\nMIN_VAL=1\nMAX_VAL=100\n\nINT=50\n\nif [[ \"$INT\" =~ ^-?[0-9]+$ ]]; then\n  if [[ $INT -ge $MIN_VAL &amp;&amp; $INT -le $MAX_VAL ]]; then\n    echo \"$INT is within $MIN_VAL to $MAX_VAL.\"\n  else\n    echo \"$INT is out of range.\"\n  fi\nelse\n  echo \"INT is not an integer.\" &gt;&amp;2\n  exit 1\nfi\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>&amp;&amp;</code>\u7528\u6765\u8fde\u63a5\u4e24\u4e2a\u5224\u65ad\u6761\u4ef6\uff1a\u5927\u4e8e\u7b49\u4e8e<code>$MIN_VAL</code>\uff0c\u5e76\u4e14\u5c0f\u4e8e\u7b49\u4e8e<code>$MAX_VAL</code>\u3002</p> <p>\u4f7f\u7528\u5426\u5b9a\u64cd\u4f5c\u7b26<code>!</code>\u65f6\uff0c\u6700\u597d\u7528\u5706\u62ec\u53f7\u786e\u5b9a\u8f6c\u4e49\u7684\u8303\u56f4\u3002</p> <pre><code>if [ ! \\( $INT -ge $MIN_VAL -a $INT -le $MAX_VAL \\) ]; then\n    echo \"$INT is outside $MIN_VAL to $MAX_VAL.\"\nelse\n    echo \"$INT is in range.\"\nfi\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>test</code>\u547d\u4ee4\u5185\u90e8\u4f7f\u7528\u7684\u5706\u62ec\u53f7\uff0c\u5fc5\u987b\u4f7f\u7528\u5f15\u53f7\u6216\u8005\u8f6c\u4e49\uff0c\u5426\u5219\u4f1a\u88ab Bash \u89e3\u91ca\u3002</p>"},{"location":"linux/bash/condition/#_7","title":"\u7b97\u672f\u5224\u65ad","text":"<p>Bash \u8fd8\u63d0\u4f9b\u4e86<code>((...))</code>\u4f5c\u4e3a\u7b97\u672f\u6761\u4ef6\uff0c\u8fdb\u884c\u7b97\u672f\u8fd0\u7b97\u7684\u5224\u65ad\u3002</p> <pre><code>if ((3 &gt; 2)); then\n  echo \"true\"\nfi\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u6267\u884c\u540e\uff0c\u4f1a\u6253\u5370\u51fa<code>true</code>\u3002</p> <p>\u6ce8\u610f\uff0c\u7b97\u672f\u5224\u65ad\u4e0d\u9700\u8981\u4f7f\u7528<code>test</code>\u547d\u4ee4\uff0c\u800c\u662f\u76f4\u63a5\u4f7f\u7528<code>((...))</code>\u7ed3\u6784\u3002\u8fd9\u4e2a\u7ed3\u6784\u7684\u8fd4\u56de\u503c\uff0c\u51b3\u5b9a\u4e86\u5224\u65ad\u7684\u771f\u4f2a\u3002</p> <p>\u5982\u679c\u7b97\u672f\u8ba1\u7b97\u7684\u7ed3\u679c\u662f\u975e\u96f6\u503c\uff0c\u5219\u8868\u793a\u5224\u65ad\u6210\u7acb\u3002\u8fd9\u4e00\u70b9\u8ddf\u547d\u4ee4\u7684\u8fd4\u56de\u503c\u6b63\u597d\u76f8\u53cd\uff0c\u9700\u8981\u5c0f\u5fc3\u3002</p> <pre><code>$ if ((1)); then echo \"It is true.\"; fi\nIt is true.\n$ if ((0)); then echo \"It is true.\"; else echo \"it is false.\"; fi\nIt is false.\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>((1))</code>\u8868\u793a\u5224\u65ad\u6210\u7acb\uff0c<code>((0))</code>\u8868\u793a\u5224\u65ad\u4e0d\u6210\u7acb\u3002</p> <p>\u7b97\u672f\u6761\u4ef6<code>((...))</code>\u4e5f\u53ef\u4ee5\u7528\u4e8e\u53d8\u91cf\u8d4b\u503c\u3002</p> <pre><code>$ if (( foo = 5 ));then echo \"foo is $foo\"; fi\nfoo is 5\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>(( foo = 5 ))</code>\u5b8c\u6210\u4e86\u4e24\u4ef6\u4e8b\u60c5\u3002\u9996\u5148\u628a<code>5</code>\u8d4b\u503c\u7ed9\u53d8\u91cf<code>foo</code>\uff0c\u7136\u540e\u6839\u636e\u8fd4\u56de\u503c<code>5</code>\uff0c\u5224\u65ad\u6761\u4ef6\u4e3a\u771f\u3002</p> <p>\u6ce8\u610f\uff0c\u8d4b\u503c\u8bed\u53e5\u8fd4\u56de\u7b49\u53f7\u53f3\u8fb9\u7684\u503c\uff0c\u5982\u679c\u8fd4\u56de\u7684\u662f<code>0</code>\uff0c\u5219\u5224\u65ad\u4e3a\u5047\u3002</p> <pre><code>$ if (( foo = 0 ));then echo \"It is true.\";else echo \"It is false.\"; fi\nIt is false.\n</code></pre> <p>\u4e0b\u9762\u662f\u7528\u7b97\u672f\u6761\u4ef6\u6539\u5199\u7684\u6570\u503c\u5224\u65ad\u811a\u672c\u3002</p> <pre><code>#!/bin/bash\n\nINT=-5\n\nif [[ \"$INT\" =~ ^-?[0-9]+$ ]]; then\n  if ((INT == 0)); then\n    echo \"INT is zero.\"\n  else\n    if ((INT &lt; 0)); then\n      echo \"INT is negative.\"\n    else\n      echo \"INT is positive.\"\n    fi\n    if (( ((INT % 2)) == 0)); then\n      echo \"INT is even.\"\n    else\n      echo \"INT is odd.\"\n    fi\n  fi\nelse\n  echo \"INT is not an integer.\" &gt;&amp;2\n  exit 1\nfi\n</code></pre> <p>\u53ea\u8981\u662f\u7b97\u672f\u8868\u8fbe\u5f0f\uff0c\u90fd\u80fd\u7528\u4e8e<code>((...))</code>\u8bed\u6cd5\uff0c\u8be6\u89c1\u300aBash \u7684\u7b97\u672f\u8fd0\u7b97\u300b\u4e00\u7ae0\u3002</p>"},{"location":"linux/bash/condition/#_8","title":"\u666e\u901a\u547d\u4ee4\u7684\u903b\u8f91\u8fd0\u7b97","text":"<p>\u5982\u679c<code>if</code>\u7ed3\u6784\u4f7f\u7528\u7684\u4e0d\u662f<code>test</code>\u547d\u4ee4\uff0c\u800c\u662f\u666e\u901a\u547d\u4ee4\uff0c\u6bd4\u5982\u4e0a\u4e00\u8282\u7684<code>((...))</code>\u7b97\u672f\u8fd0\u7b97\uff0c\u6216\u8005<code>test</code>\u547d\u4ee4\u4e0e\u666e\u901a\u547d\u4ee4\u6df7\u7528\uff0c\u90a3\u4e48\u53ef\u4ee5\u4f7f\u7528 Bash \u7684\u547d\u4ee4\u63a7\u5236\u64cd\u4f5c\u7b26<code>&amp;&amp;</code>\uff08AND\uff09\u548c<code>||</code>\uff08OR\uff09\uff0c\u8fdb\u884c\u591a\u4e2a\u547d\u4ee4\u7684\u903b\u8f91\u8fd0\u7b97\u3002</p> <pre><code>$ command1 &amp;&amp; command2\n$ command1 || command2\n</code></pre> <p>\u5bf9\u4e8e<code>&amp;&amp;</code>\u64cd\u4f5c\u7b26\uff0c\u5148\u6267\u884c<code>command1</code>\uff0c\u53ea\u6709<code>command1</code>\u6267\u884c\u6210\u529f\u540e\uff0c \u624d\u4f1a\u6267\u884c<code>command2</code>\u3002\u5bf9\u4e8e<code>||</code>\u64cd\u4f5c\u7b26\uff0c\u5148\u6267\u884c<code>command1</code>\uff0c\u53ea\u6709<code>command1</code>\u6267\u884c\u5931\u8d25\u540e\uff0c \u624d\u4f1a\u6267\u884c<code>command2</code>\u3002</p> <pre><code>$ mkdir temp &amp;&amp; cd temp\n</code></pre> <p>\u4e0a\u9762\u7684\u547d\u4ee4\u4f1a\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a<code>temp</code>\u7684\u76ee\u5f55\uff0c\u6267\u884c\u6210\u529f\u540e\uff0c\u624d\u4f1a\u6267\u884c\u7b2c\u4e8c\u4e2a\u547d\u4ee4\uff0c\u8fdb\u5165\u8fd9\u4e2a\u76ee\u5f55\u3002</p> <pre><code>$ [ -d temp ] || mkdir temp\n</code></pre> <p>\u4e0a\u9762\u7684\u547d\u4ee4\u4f1a\u6d4b\u8bd5\u76ee\u5f55<code>temp</code>\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5c31\u4f1a\u6267\u884c\u7b2c\u4e8c\u4e2a\u547d\u4ee4\uff0c\u521b\u5efa\u8fd9\u4e2a\u76ee\u5f55\u3002\u8fd9\u79cd\u5199\u6cd5\u975e\u5e38\u6709\u52a9\u4e8e\u5728\u811a\u672c\u4e2d\u5904\u7406\u9519\u8bef\u3002</p> <pre><code>[ ! -d temp ] &amp;&amp; exit 1\n</code></pre> <p>\u4e0a\u9762\u7684\u547d\u4ee4\u4e2d\uff0c\u5982\u679c<code>temp</code>\u5b50\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u811a\u672c\u4f1a\u7ec8\u6b62\uff0c\u5e76\u4e14\u8fd4\u56de\u503c\u4e3a<code>1</code>\u3002</p> <p>\u4e0b\u9762\u5c31\u662f<code>if</code>\u4e0e<code>&amp;&amp;</code>\u7ed3\u5408\u4f7f\u7528\u7684\u5199\u6cd5\u3002</p> <pre><code>if [ condition ] &amp;&amp; [ condition ]; then\n  command\nfi\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\u3002</p> <pre><code>#! /bin/bash\n\nfilename=$1\nword1=$2\nword2=$3\n\nif grep $word1 $filename &amp;&amp; grep $word2 $filename\nthen\n  echo \"$word1 and $word2 are both in $filename.\"\nfi\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u53ea\u6709\u5728\u6307\u5b9a\u6587\u4ef6\u91cc\u9762\uff0c\u540c\u65f6\u5b58\u5728\u641c\u7d22\u8bcd<code>word1</code>\u548c<code>word2</code>\uff0c\u5c31\u4f1a\u6267\u884c<code>if</code>\u7684\u547d\u4ee4\u90e8\u5206\u3002</p> <p>\u4e0b\u9762\u7684\u793a\u4f8b\u6f14\u793a\u5982\u4f55\u5c06\u4e00\u4e2a<code>&amp;&amp;</code>\u5224\u65ad\u8868\u8fbe\u5f0f\uff0c\u6539\u5199\u6210\u5bf9\u5e94\u7684<code>if</code>\u7ed3\u6784\u3002</p> <pre><code>[[ -d \"$dir_name\" ]] &amp;&amp; cd \"$dir_name\" &amp;&amp; rm *\n\n# \u7b49\u540c\u4e8e\n\nif [[ ! -d \"$dir_name\" ]]; then\n  echo \"No such directory: '$dir_name'\" &gt;&amp;2\n  exit 1\nfi\nif ! cd \"$dir_name\"; then\n  echo \"Cannot cd to '$dir_name'\" &gt;&amp;2\n  exit 1\nfi\nif ! rm *; then\n  echo \"File deletion failed. Check results\" &gt;&amp;2\n  exit 1\nfi\n</code></pre>"},{"location":"linux/bash/condition/#case","title":"case \u7ed3\u6784","text":"<p><code>case</code>\u7ed3\u6784\u7528\u4e8e\u591a\u503c\u5224\u65ad\uff0c\u53ef\u4ee5\u4e3a\u6bcf\u4e2a\u503c\u6307\u5b9a\u5bf9\u5e94\u7684\u547d\u4ee4\uff0c\u8ddf\u5305\u542b\u591a\u4e2a<code>elif</code>\u7684<code>if</code>\u7ed3\u6784\u7b49\u4ef7\uff0c\u4f46\u662f\u8bed\u4e49\u66f4\u597d\u3002\u5b83\u7684\u8bed\u6cd5\u5982\u4e0b\u3002</p> <pre><code>case expression in\n  pattern )\n    commands ;;\n  pattern )\n    commands ;;\n  ...\nesac\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>expression</code>\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c<code>pattern</code>\u662f\u8868\u8fbe\u5f0f\u7684\u503c\u6216\u8005\u4e00\u4e2a\u6a21\u5f0f\uff0c\u53ef\u4ee5\u6709\u591a\u6761\uff0c\u7528\u6765\u5339\u914d\u591a\u4e2a\u503c\uff0c\u6bcf\u6761\u4ee5\u4e24\u4e2a\u5206\u53f7\uff08<code>;</code>\uff09\u7ed3\u5c3e\u3002</p> <pre><code>#!/bin/bash\n\necho -n \"\u8f93\u5165\u4e00\u4e2a1\u52303\u4e4b\u95f4\u7684\u6570\u5b57\uff08\u5305\u542b\u4e24\u7aef\uff09&gt; \"\nread character\ncase $character in\n  1 ) echo 1\n    ;;\n  2 ) echo 2\n    ;;\n  3 ) echo 3\n    ;;\n  * ) echo \u8f93\u5165\u4e0d\u7b26\u5408\u8981\u6c42\nesac\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u6700\u540e\u4e00\u6761\u5339\u914d\u8bed\u53e5\u7684\u6a21\u5f0f\u662f<code>*</code>\uff0c\u8fd9\u4e2a\u901a\u914d\u7b26\u53ef\u4ee5\u5339\u914d\u5176\u4ed6\u5b57\u7b26\u548c\u6ca1\u6709\u8f93\u5165\u5b57\u7b26\u7684\u60c5\u51b5\uff0c\u7c7b\u4f3c<code>if</code>\u7684<code>else</code>\u90e8\u5206\u3002</p> <p>\u4e0b\u9762\u662f\u53e6\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>#!/bin/bash\n\nOS=$(uname -s)\n\ncase \"$OS\" in\n  FreeBSD) echo \"This is FreeBSD\" ;;\n  Darwin) echo \"This is Mac OSX\" ;;\n  AIX) echo \"This is AIX\" ;;\n  Minix) echo \"This is Minix\" ;;\n  Linux) echo \"This is Linux\" ;;\n  *) echo \"Failed to identify this OS\" ;;\nesac\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u5224\u65ad\u5f53\u524d\u662f\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf\u3002</p> <p><code>case</code>\u7684\u5339\u914d\u6a21\u5f0f\u53ef\u4ee5\u4f7f\u7528\u5404\u79cd\u901a\u914d\u7b26\uff0c\u4e0b\u9762\u662f\u4e00\u4e9b\u4f8b\u5b50\u3002</p> <ul> <li><code>a)</code>\uff1a\u5339\u914d<code>a</code>\u3002</li> <li><code>a|b)</code>\uff1a\u5339\u914d<code>a</code>\u6216<code>b</code>\u3002</li> <li><code>[[:alpha:]])</code>\uff1a\u5339\u914d\u5355\u4e2a\u5b57\u6bcd\u3002</li> <li><code>???)</code>\uff1a\u5339\u914d3\u4e2a\u5b57\u7b26\u7684\u5355\u8bcd\u3002</li> <li><code>*.txt)</code>\uff1a\u5339\u914d<code>.txt</code>\u7ed3\u5c3e\u3002</li> <li><code>*)</code>\uff1a\u5339\u914d\u4efb\u610f\u8f93\u5165\uff0c\u901a\u8fc7\u4f5c\u4e3a<code>case</code>\u7ed3\u6784\u7684\u6700\u540e\u4e00\u4e2a\u6a21\u5f0f\u3002</li> </ul> <pre><code>#!/bin/bash\n\necho -n \"\u8f93\u5165\u4e00\u4e2a\u5b57\u6bcd\u6216\u6570\u5b57 &gt; \"\nread character\ncase $character in\n  [[:lower:]] | [[:upper:]] ) echo \"\u8f93\u5165\u4e86\u5b57\u6bcd $character\"\n                              ;;\n  [0-9] )                     echo \"\u8f93\u5165\u4e86\u6570\u5b57 $character\"\n                              ;;\n  * )                         echo \"\u8f93\u5165\u4e0d\u7b26\u5408\u8981\u6c42\"\nesac\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u4f7f\u7528\u901a\u914d\u7b26<code>[[:lower:]] | [[:upper:]]</code>\u5339\u914d\u5b57\u6bcd\uff0c<code>[0-9]</code>\u5339\u914d\u6570\u5b57\u3002</p> <p>Bash 4.0\u4e4b\u524d\uff0c<code>case</code>\u7ed3\u6784\u53ea\u80fd\u5339\u914d\u4e00\u4e2a\u6761\u4ef6\uff0c\u7136\u540e\u5c31\u4f1a\u9000\u51fa<code>case</code>\u7ed3\u6784\u3002Bash 4.0\u4e4b\u540e\uff0c\u5141\u8bb8\u5339\u914d\u591a\u4e2a\u6761\u4ef6\uff0c\u8fd9\u65f6\u53ef\u4ee5\u7528<code>;;&amp;</code>\u7ec8\u6b62\u6bcf\u4e2a\u6761\u4ef6\u5757\u3002</p> <pre><code>#!/bin/bash\n# test.sh\n\nread -n 1 -p \"Type a character &gt; \"\necho\ncase $REPLY in\n  [[:upper:]])    echo \"'$REPLY' is upper case.\" ;;&amp;\n  [[:lower:]])    echo \"'$REPLY' is lower case.\" ;;&amp;\n  [[:alpha:]])    echo \"'$REPLY' is alphabetic.\" ;;&amp;\n  [[:digit:]])    echo \"'$REPLY' is a digit.\" ;;&amp;\n  [[:graph:]])    echo \"'$REPLY' is a visible character.\" ;;&amp;\n  [[:punct:]])    echo \"'$REPLY' is a punctuation symbol.\" ;;&amp;\n  [[:space:]])    echo \"'$REPLY' is a whitespace character.\" ;;&amp;\n  [[:xdigit:]])   echo \"'$REPLY' is a hexadecimal digit.\" ;;&amp;\nesac\n</code></pre> <p>\u6267\u884c\u4e0a\u9762\u7684\u811a\u672c\uff0c\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u7ed3\u679c\u3002</p> <pre><code>$ test.sh\nType a character &gt; a\n'a' is lower case.\n'a' is alphabetic.\n'a' is a visible character.\n'a' is a hexadecimal digit.\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u6761\u4ef6\u8bed\u53e5\u7ed3\u5c3e\u6dfb\u52a0\u4e86<code>;;&amp;</code>\u4ee5\u540e\uff0c\u5728\u5339\u914d\u4e00\u4e2a\u6761\u4ef6\u4e4b\u540e\uff0c\u5e76\u6ca1\u6709\u9000\u51fa<code>case</code>\u7ed3\u6784\uff0c\u800c\u662f\u7ee7\u7eed\u5224\u65ad\u4e0b\u4e00\u4e2a\u6761\u4ef6\u3002</p>"},{"location":"linux/bash/condition/#_9","title":"\u53c2\u8003\u94fe\u63a5","text":"<ul> <li>The Linux Command Line, William Shotts</li> </ul>"},{"location":"linux/bash/debug/","title":"\u811a\u672c\u9664\u9519","text":"<p>\u672c\u7ae0\u4ecb\u7ecd\u5982\u4f55\u5bf9 Shell \u811a\u672c\u9664\u9519\u3002</p>"},{"location":"linux/bash/debug/#_2","title":"\u5e38\u89c1\u9519\u8bef","text":"<p>\u7f16\u5199 Shell \u811a\u672c\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u8003\u8651\u5230\u547d\u4ee4\u5931\u8d25\u7684\u60c5\u51b5\uff0c\u5426\u5219\u5f88\u5bb9\u6613\u51fa\u9519\u3002</p> <pre><code>#! /bin/bash\n\ndir_name=/path/not/exist\n\ncd $dir_name\nrm *\n</code></pre> <p>\u4e0a\u9762\u811a\u672c\u4e2d\uff0c\u5982\u679c\u76ee\u5f55<code>$dir_name</code>\u4e0d\u5b58\u5728\uff0c<code>cd $dir_name</code>\u547d\u4ee4\u5c31\u4f1a\u6267\u884c\u5931\u8d25\u3002\u8fd9\u65f6\uff0c\u5c31\u4e0d\u4f1a\u6539\u53d8\u5f53\u524d\u76ee\u5f55\uff0c\u811a\u672c\u4f1a\u7ee7\u7eed\u6267\u884c\u4e0b\u53bb\uff0c\u5bfc\u81f4<code>rm *</code>\u547d\u4ee4\u5220\u5149\u5f53\u524d\u76ee\u5f55\u7684\u6587\u4ef6\u3002</p> <p>\u5982\u679c\u6539\u6210\u4e0b\u9762\u7684\u6837\u5b50\uff0c\u4e5f\u4f1a\u6709\u95ee\u9898\u3002</p> <pre><code>cd $dir_name &amp;&amp; rm *\n</code></pre> <p>\u4e0a\u9762\u811a\u672c\u4e2d\uff0c\u53ea\u6709<code>cd $dir_name</code>\u6267\u884c\u6210\u529f\uff0c\u624d\u4f1a\u6267\u884c<code>rm *</code>\u3002\u4f46\u662f\uff0c\u5982\u679c\u53d8\u91cf<code>$dir_name</code>\u4e3a\u7a7a\uff0c<code>cd</code>\u5c31\u4f1a\u8fdb\u5165\u7528\u6237\u4e3b\u76ee\u5f55\uff0c\u4ece\u800c\u5220\u5149\u7528\u6237\u4e3b\u76ee\u5f55\u7684\u6587\u4ef6\u3002</p> <p>\u4e0b\u9762\u7684\u5199\u6cd5\u624d\u662f\u6b63\u786e\u7684\u3002</p> <pre><code>[[ -d $dir_name ]] &amp;&amp; cd $dir_name &amp;&amp; rm *\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u5148\u5224\u65ad\u76ee\u5f55<code>$dir_name</code>\u662f\u5426\u5b58\u5728\uff0c\u7136\u540e\u624d\u6267\u884c\u5176\u4ed6\u64cd\u4f5c\u3002</p> <p>\u5982\u679c\u4e0d\u653e\u5fc3\u5220\u9664\u4ec0\u4e48\u6587\u4ef6\uff0c\u53ef\u4ee5\u5148\u6253\u5370\u51fa\u6765\u770b\u4e00\u4e0b\u3002</p> <pre><code>[[ -d $dir_name ]] &amp;&amp; cd $dir_name &amp;&amp; echo rm *\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>echo rm *</code>\u4e0d\u4f1a\u5220\u9664\u6587\u4ef6\uff0c\u53ea\u4f1a\u6253\u5370\u51fa\u6765\u8981\u5220\u9664\u7684\u6587\u4ef6\u3002</p>"},{"location":"linux/bash/debug/#bash-x","title":"<code>bash</code>\u7684<code>-x</code>\u53c2\u6570","text":"<p><code>bash</code>\u7684<code>-x</code>\u53c2\u6570\u53ef\u4ee5\u5728\u6267\u884c\u6bcf\u4e00\u884c\u547d\u4ee4\u4e4b\u524d\uff0c\u6253\u5370\u8be5\u547d\u4ee4\u3002\u4e00\u65e6\u51fa\u9519\uff0c\u8fd9\u6837\u5c31\u6bd4\u8f83\u5bb9\u6613\u8ffd\u67e5\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u811a\u672c<code>script.sh</code>\u3002</p> <pre><code># script.sh\necho hello world\n</code></pre> <p>\u52a0\u4e0a<code>-x</code>\u53c2\u6570\uff0c\u6267\u884c\u6bcf\u6761\u547d\u4ee4\u4e4b\u524d\uff0c\u90fd\u4f1a\u663e\u793a\u8be5\u547d\u4ee4\u3002</p> <pre><code>$ bash -x script.sh\n+ echo hello world\nhello world\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u884c\u9996\u4e3a<code>+</code>\u7684\u884c\uff0c\u663e\u793a\u8be5\u884c\u662f\u6240\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4e0b\u4e00\u884c\u624d\u662f\u8be5\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u3002</p> <p>\u4e0b\u9762\u518d\u770b\u4e00\u4e2a<code>-x</code>\u5199\u5728\u811a\u672c\u5185\u90e8\u7684\u4f8b\u5b50\u3002</p> <pre><code>#! /bin/bash -x\n# trouble: script to demonstrate common errors\n\nnumber=1\nif [ $number = 1 ]; then\n  echo \"Number is equal to 1.\"\nelse\n  echo \"Number is not equal to 1.\"\nfi\n</code></pre> <p>\u4e0a\u9762\u7684\u811a\u672c\u6267\u884c\u4e4b\u540e\uff0c\u4f1a\u8f93\u51fa\u6bcf\u4e00\u884c\u547d\u4ee4\u3002</p> <pre><code>$ trouble\n+ number=1\n+ '[' 1 = 1 ']'\n+ echo 'Number is equal to 1.'\nNumber is equal to 1.\n</code></pre> <p>\u8f93\u51fa\u7684\u547d\u4ee4\u4e4b\u524d\u7684<code>+</code>\u53f7\uff0c\u662f\u7531\u7cfb\u7edf\u53d8\u91cf<code>PS4</code>\u51b3\u5b9a\uff0c\u53ef\u4ee5\u4fee\u6539\u8fd9\u4e2a\u53d8\u91cf\u3002</p> <pre><code>$ export PS4='$LINENO + '\n$ trouble\n5 + number=1\n7 + '[' 1 = 1 ']'\n8 + echo 'Number is equal to 1.'\nNumber is equal to 1.\n</code></pre> <p>\u53e6\u5916\uff0c<code>set</code>\u547d\u4ee4\u4e5f\u53ef\u4ee5\u8bbe\u7f6e Shell \u7684\u884c\u4e3a\u53c2\u6570\uff0c\u6709\u5229\u4e8e\u811a\u672c\u9664\u9519\uff0c\u8be6\u89c1\u300aset \u547d\u4ee4\u300b\u4e00\u7ae0\u3002</p>"},{"location":"linux/bash/debug/#_3","title":"\u73af\u5883\u53d8\u91cf","text":"<p>\u6709\u4e00\u4e9b\u73af\u5883\u53d8\u91cf\u5e38\u7528\u4e8e\u9664\u9519\u3002</p>"},{"location":"linux/bash/debug/#lineno","title":"LINENO","text":"<p>\u53d8\u91cf<code>LINENO</code>\u8fd4\u56de\u5b83\u5728\u811a\u672c\u91cc\u9762\u7684\u884c\u53f7\u3002</p> <pre><code>#!/bin/bash\n\necho \"This is line $LINENO\"\n</code></pre> <p>\u6267\u884c\u4e0a\u9762\u7684\u811a\u672c<code>test.sh</code>\uff0c<code>$LINENO</code>\u4f1a\u8fd4\u56de<code>3</code>\u3002</p> <pre><code>$ ./test.sh\nThis is line 3\n</code></pre>"},{"location":"linux/bash/debug/#funcname","title":"FUNCNAME","text":"<p>\u53d8\u91cf<code>FUNCNAME</code>\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\uff0c\u5185\u5bb9\u662f\u5f53\u524d\u7684\u51fd\u6570\u8c03\u7528\u5806\u6808\u3002\u8be5\u6570\u7ec4\u76840\u53f7\u6210\u5458\u662f\u5f53\u524d\u8c03\u7528\u7684\u51fd\u6570\uff0c1\u53f7\u6210\u5458\u662f\u8c03\u7528\u5f53\u524d\u51fd\u6570\u7684\u51fd\u6570\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <pre><code>#!/bin/bash\n\nfunction func1()\n{\n  echo \"func1: FUNCNAME0 is ${FUNCNAME[0]}\"\n  echo \"func1: FUNCNAME1 is ${FUNCNAME[1]}\"\n  echo \"func1: FUNCNAME2 is ${FUNCNAME[2]}\"\n  func2\n}\n\nfunction func2()\n{\n  echo \"func2: FUNCNAME0 is ${FUNCNAME[0]}\"\n  echo \"func2: FUNCNAME1 is ${FUNCNAME[1]}\"\n  echo \"func2: FUNCNAME2 is ${FUNCNAME[2]}\"\n}\n\nfunc1\n</code></pre> <p>\u6267\u884c\u4e0a\u9762\u7684\u811a\u672c<code>test.sh</code>\uff0c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ ./test.sh\nfunc1: FUNCNAME0 is func1\nfunc1: FUNCNAME1 is main\nfunc1: FUNCNAME2 is\nfunc2: FUNCNAME0 is func2\nfunc2: FUNCNAME1 is func1\nfunc2: FUNCNAME2 is main\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u6267\u884c<code>func1</code>\u65f6\uff0c\u53d8\u91cf<code>FUNCNAME</code>\u76840\u53f7\u6210\u5458\u662f<code>func1</code>\uff0c1\u53f7\u6210\u5458\u662f\u8c03\u7528<code>func1</code>\u7684\u4e3b\u811a\u672c<code>main</code>\u3002\u6267\u884c<code>func2</code>\u65f6\uff0c\u53d8\u91cf<code>FUNCNAME</code>\u76840\u53f7\u6210\u5458\u662f<code>func2</code>\uff0c1\u53f7\u6210\u5458\u662f\u8c03\u7528<code>func2</code>\u7684<code>func1</code>\u3002</p>"},{"location":"linux/bash/debug/#bash_source","title":"BASH_SOURCE","text":"<p>\u53d8\u91cf<code>BASH_SOURCE</code>\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\uff0c\u5185\u5bb9\u662f\u5f53\u524d\u7684\u811a\u672c\u8c03\u7528\u5806\u6808\u3002\u8be5\u6570\u7ec4\u76840\u53f7\u6210\u5458\u662f\u5f53\u524d\u6267\u884c\u7684\u811a\u672c\uff0c1\u53f7\u6210\u5458\u662f\u8c03\u7528\u5f53\u524d\u811a\u672c\u7684\u811a\u672c\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u8ddf\u53d8\u91cf<code>FUNCNAME</code>\u662f\u4e00\u4e00\u5bf9\u5e94\u5173\u7cfb\u3002</p> <p>\u4e0b\u9762\u6709\u4e24\u4e2a\u5b50\u811a\u672c<code>lib1.sh</code>\u548c<code>lib2.sh</code>\u3002</p> <pre><code># lib1.sh\nfunction func1()\n{\n  echo \"func1: BASH_SOURCE0 is ${BASH_SOURCE[0]}\"\n  echo \"func1: BASH_SOURCE1 is ${BASH_SOURCE[1]}\"\n  echo \"func1: BASH_SOURCE2 is ${BASH_SOURCE[2]}\"\n  func2\n}\n</code></pre> <pre><code># lib2.sh\nfunction func2()\n{\n  echo \"func2: BASH_SOURCE0 is ${BASH_SOURCE[0]}\"\n  echo \"func2: BASH_SOURCE1 is ${BASH_SOURCE[1]}\"\n  echo \"func2: BASH_SOURCE2 is ${BASH_SOURCE[2]}\"\n}\n</code></pre> <p>\u7136\u540e\uff0c\u4e3b\u811a\u672c<code>main.sh</code>\u8c03\u7528\u4e0a\u9762\u4e24\u4e2a\u5b50\u811a\u672c\u3002</p> <pre><code>#!/bin/bash\n# main.sh\n\nsource lib1.sh\nsource lib2.sh\n\nfunc1\n</code></pre> <p>\u6267\u884c\u4e3b\u811a\u672c<code>main.sh</code>\uff0c\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u7ed3\u679c\u3002</p> <pre><code>$ ./main.sh\nfunc1: BASH_SOURCE0 is lib1.sh\nfunc1: BASH_SOURCE1 is ./main.sh\nfunc1: BASH_SOURCE2 is\nfunc2: BASH_SOURCE0 is lib2.sh\nfunc2: BASH_SOURCE1 is lib1.sh\nfunc2: BASH_SOURCE2 is ./main.sh\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u6267\u884c\u51fd\u6570<code>func1</code>\u65f6\uff0c\u53d8\u91cf<code>BASH_SOURCE</code>\u76840\u53f7\u6210\u5458\u662f<code>func1</code>\u6240\u5728\u7684\u811a\u672c<code>lib1.sh</code>\uff0c1\u53f7\u6210\u5458\u662f\u4e3b\u811a\u672c<code>main.sh</code>\uff1b\u6267\u884c\u51fd\u6570<code>func2</code>\u65f6\uff0c\u53d8\u91cf<code>BASH_SOURCE</code>\u76840\u53f7\u6210\u5458\u662f<code>func2</code>\u6240\u5728\u7684\u811a\u672c<code>lib2.sh</code>\uff0c1\u53f7\u6210\u5458\u662f\u8c03\u7528<code>func2</code>\u7684\u811a\u672c<code>lib1.sh</code>\u3002</p>"},{"location":"linux/bash/debug/#bash_lineno","title":"BASH_LINENO","text":"<p>\u53d8\u91cf<code>BASH_LINENO</code>\u8fd4\u56de\u4e00\u4e2a\u6570\u7ec4\uff0c\u5185\u5bb9\u662f\u6bcf\u4e00\u8f6e\u8c03\u7528\u5bf9\u5e94\u7684\u884c\u53f7\u3002<code>${BASH_LINENO[$i]}</code>\u8ddf<code>${FUNCNAME[$i]}</code>\u662f\u4e00\u4e00\u5bf9\u5e94\u5173\u7cfb\uff0c\u8868\u793a<code>${FUNCNAME[$i]}</code>\u5728\u8c03\u7528\u5b83\u7684\u811a\u672c\u6587\u4ef6<code>${BASH_SOURCE[$i+1]}</code>\u91cc\u9762\u7684\u884c\u53f7\u3002</p> <p>\u4e0b\u9762\u6709\u4e24\u4e2a\u5b50\u811a\u672c<code>lib1.sh</code>\u548c<code>lib2.sh</code>\u3002</p> <pre><code># lib1.sh\nfunction func1()\n{\n  echo \"func1: BASH_LINENO is ${BASH_LINENO[0]}\"\n  echo \"func1: FUNCNAME is ${FUNCNAME[0]}\"\n  echo \"func1: BASH_SOURCE is ${BASH_SOURCE[1]}\"\n\n  func2\n}\n</code></pre> <pre><code># lib2.sh\nfunction func2()\n{\n  echo \"func2: BASH_LINENO is ${BASH_LINENO[0]}\"\n  echo \"func2: FUNCNAME is ${FUNCNAME[0]}\"\n  echo \"func2: BASH_SOURCE is ${BASH_SOURCE[1]}\"\n}\n</code></pre> <p>\u7136\u540e\uff0c\u4e3b\u811a\u672c<code>main.sh</code>\u8c03\u7528\u4e0a\u9762\u4e24\u4e2a\u5b50\u811a\u672c\u3002</p> <pre><code>#!/bin/bash\n# main.sh\n\nsource lib1.sh\nsource lib2.sh\n\nfunc1\n</code></pre> <p>\u6267\u884c\u4e3b\u811a\u672c<code>main.sh</code>\uff0c\u4f1a\u5f97\u5230\u4e0b\u9762\u7684\u7ed3\u679c\u3002</p> <pre><code>$ ./main.sh\nfunc1: BASH_LINENO is 7\nfunc1: FUNCNAME is func1\nfunc1: BASH_SOURCE is main.sh\nfunc2: BASH_LINENO is 8\nfunc2: FUNCNAME is func2\nfunc2: BASH_SOURCE is lib1.sh\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u51fd\u6570<code>func1</code>\u662f\u5728<code>main.sh</code>\u7684\u7b2c7\u884c\u8c03\u7528\uff0c\u51fd\u6570<code>func2</code>\u662f\u5728<code>lib1.sh</code>\u7684\u7b2c8\u884c\u8c03\u7528\u7684\u3002</p>"},{"location":"linux/bash/expansion/","title":"Bash \u7684\u6a21\u5f0f\u6269\u5c55","text":""},{"location":"linux/bash/expansion/#_1","title":"\u7b80\u4ecb","text":"<p>Shell \u63a5\u6536\u5230\u7528\u6237\u8f93\u5165\u7684\u547d\u4ee4\u4ee5\u540e\uff0c\u4f1a\u6839\u636e\u7a7a\u683c\u5c06\u7528\u6237\u7684\u8f93\u5165\uff0c\u62c6\u5206\u6210\u4e00\u4e2a\u4e2a\u8bcd\u5143\uff08token\uff09\u3002\u7136\u540e\uff0cShell \u4f1a\u6269\u5c55\u8bcd\u5143\u91cc\u9762\u7684\u7279\u6b8a\u5b57\u7b26\uff0c\u6269\u5c55\u5b8c\u6210\u540e\u624d\u4f1a\u8c03\u7528\u76f8\u5e94\u7684\u547d\u4ee4\u3002</p> <p>\u8fd9\u79cd\u7279\u6b8a\u5b57\u7b26\u7684\u6269\u5c55\uff0c\u79f0\u4e3a\u6a21\u5f0f\u6269\u5c55\uff08globbing\uff09\u3002\u5176\u4e2d\u6709\u4e9b\u7528\u5230\u901a\u914d\u7b26\uff0c\u53c8\u79f0\u4e3a\u901a\u914d\u7b26\u6269\u5c55\uff08wildcard expansion\uff09\u3002Bash \u4e00\u5171\u63d0\u4f9b\u516b\u79cd\u6269\u5c55\u3002</p> <ul> <li>\u6ce2\u6d6a\u7ebf\u6269\u5c55</li> <li><code>?</code> \u5b57\u7b26\u6269\u5c55</li> <li><code>*</code> \u5b57\u7b26\u6269\u5c55</li> <li>\u65b9\u62ec\u53f7\u6269\u5c55</li> <li>\u5927\u62ec\u53f7\u6269\u5c55</li> <li>\u53d8\u91cf\u6269\u5c55</li> <li>\u5b50\u547d\u4ee4\u6269\u5c55</li> <li>\u7b97\u672f\u6269\u5c55</li> </ul> <p>\u672c\u7ae0\u4ecb\u7ecd\u8fd9\u516b\u79cd\u6269\u5c55\u3002</p> <p>Bash \u662f\u5148\u8fdb\u884c\u6269\u5c55\uff0c\u518d\u6267\u884c\u547d\u4ee4\u3002\u56e0\u6b64\uff0c\u6269\u5c55\u7684\u7ed3\u679c\u662f\u7531 Bash \u8d1f\u8d23\u7684\uff0c\u4e0e\u6240\u8981\u6267\u884c\u7684\u547d\u4ee4\u65e0\u5173\u3002\u547d\u4ee4\u672c\u8eab\u5e76\u4e0d\u5b58\u5728\u53c2\u6570\u6269\u5c55\uff0c\u6536\u5230\u4ec0\u4e48\u53c2\u6570\u5c31\u539f\u6837\u6267\u884c\u3002\u8fd9\u4e00\u70b9\u52a1\u5fc5\u9700\u8981\u8bb0\u4f4f\u3002</p> <p>\u6a21\u5757\u6269\u5c55\u7684\u82f1\u6587\u5355\u8bcd\u662f<code>globbing</code>\uff0c\u8fd9\u4e2a\u8bcd\u6765\u81ea\u4e8e\u65e9\u671f\u7684 Unix \u7cfb\u7edf\u6709\u4e00\u4e2a<code>/etc/glob</code>\u6587\u4ef6\uff0c\u4fdd\u5b58\u6269\u5c55\u7684\u6a21\u677f\u3002\u540e\u6765 Bash \u5185\u7f6e\u4e86\u8fd9\u4e2a\u529f\u80fd\uff0c\u4f46\u662f\u8fd9\u4e2a\u540d\u5b57\u5c31\u4fdd\u7559\u4e86\u4e0b\u6765\u3002</p> <p>\u6a21\u5f0f\u6269\u5c55\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5173\u7cfb\u662f\uff0c\u6a21\u5f0f\u6269\u5c55\u65e9\u4e8e\u6b63\u5219\u8868\u8fbe\u5f0f\u51fa\u73b0\uff0c\u53ef\u4ee5\u770b\u4f5c\u662f\u539f\u59cb\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\u5b83\u7684\u529f\u80fd\u6ca1\u6709\u6b63\u5219\u90a3\u4e48\u5f3a\u5927\u7075\u6d3b\uff0c\u4f46\u662f\u4f18\u70b9\u662f\u7b80\u5355\u548c\u65b9\u4fbf\u3002</p> <p>Bash \u5141\u8bb8\u7528\u6237\u5173\u95ed\u6269\u5c55\u3002</p> <pre><code>$ set -o noglob\n# \u6216\u8005\n$ set -f\n</code></pre> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u91cd\u65b0\u6253\u5f00\u6269\u5c55\u3002</p> <pre><code>$ set +o noglob\n# \u6216\u8005\n$ set +f\n</code></pre>"},{"location":"linux/bash/expansion/#_2","title":"\u6ce2\u6d6a\u7ebf\u6269\u5c55","text":"<p>\u6ce2\u6d6a\u7ebf<code>~</code>\u4f1a\u81ea\u52a8\u6269\u5c55\u6210\u5f53\u524d\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u3002</p> <pre><code>$ echo ~\n/home/me\n</code></pre> <p><code>~/dir</code>\u8868\u793a\u6269\u5c55\u6210\u4e3b\u76ee\u5f55\u7684\u67d0\u4e2a\u5b50\u76ee\u5f55\uff0c<code>dir</code>\u662f\u4e3b\u76ee\u5f55\u91cc\u9762\u7684\u4e00\u4e2a\u5b50\u76ee\u5f55\u540d\u3002</p> <pre><code># \u8fdb\u5165 /home/me/foo \u76ee\u5f55\n$ cd ~/foo\n</code></pre> <p><code>~user</code>\u8868\u793a\u6269\u5c55\u6210\u7528\u6237<code>user</code>\u7684\u4e3b\u76ee\u5f55\u3002</p> <pre><code>$ echo ~foo\n/home/foo\n\n$ echo ~root\n/root\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0cBash \u4f1a\u6839\u636e\u6ce2\u6d6a\u53f7\u540e\u9762\u7684\u7528\u6237\u540d\uff0c\u8fd4\u56de\u8be5\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u3002</p> <p>\u5982\u679c<code>~user</code>\u7684<code>user</code>\u662f\u4e0d\u5b58\u5728\u7684\u7528\u6237\u540d\uff0c\u5219\u6ce2\u6d6a\u53f7\u6269\u5c55\u4e0d\u8d77\u4f5c\u7528\u3002</p> <pre><code>$ echo ~nonExistedUser\n~nonExistedUser\n</code></pre> <p><code>~+</code>\u4f1a\u6269\u5c55\u6210\u5f53\u524d\u6240\u5728\u7684\u76ee\u5f55\uff0c\u7b49\u540c\u4e8e<code>pwd</code>\u547d\u4ee4\u3002</p> <pre><code>$ cd ~/foo\n$ echo ~+\n/home/me/foo\n</code></pre>"},{"location":"linux/bash/expansion/#_3","title":"<code>?</code> \u5b57\u7b26\u6269\u5c55","text":"<p><code>?</code>\u5b57\u7b26\u4ee3\u8868\u6587\u4ef6\u8def\u5f84\u91cc\u9762\u7684\u4efb\u610f\u5355\u4e2a\u5b57\u7b26\uff0c\u4e0d\u5305\u62ec\u7a7a\u5b57\u7b26\u3002\u6bd4\u5982\uff0c<code>Data???</code>\u5339\u914d\u6240\u6709<code>Data</code>\u540e\u9762\u8ddf\u7740\u4e09\u4e2a\u5b57\u7b26\u7684\u6587\u4ef6\u540d\u3002</p> <pre><code># \u5b58\u5728\u6587\u4ef6 a.txt \u548c b.txt\n$ ls ?.txt\na.txt b.txt\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>?</code>\u8868\u793a\u5355\u4e2a\u5b57\u7b26\uff0c\u6240\u4ee5\u4f1a\u540c\u65f6\u5339\u914d<code>a.txt</code>\u548c<code>b.txt</code>\u3002</p> <p>\u5982\u679c\u5339\u914d\u591a\u4e2a\u5b57\u7b26\uff0c\u5c31\u9700\u8981\u591a\u4e2a<code>?</code>\u8fde\u7528\u3002</p> <pre><code># \u5b58\u5728\u6587\u4ef6 a.txt\u3001b.txt \u548c ab.txt\n$ ls ??.txt\nab.txt\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>??</code>\u5339\u914d\u4e86\u4e24\u4e2a\u5b57\u7b26\u3002</p> <p><code>?</code> \u5b57\u7b26\u6269\u5c55\u5c5e\u4e8e\u6587\u4ef6\u540d\u6269\u5c55\uff0c\u53ea\u6709\u6587\u4ef6\u786e\u5b9e\u5b58\u5728\u7684\u524d\u63d0\u4e0b\uff0c\u624d\u4f1a\u53d1\u751f\u6269\u5c55\u3002\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u6269\u5c55\u5c31\u4e0d\u4f1a\u53d1\u751f\u3002</p> <pre><code># \u5f53\u524d\u76ee\u5f55\u6709 a.txt \u6587\u4ef6\n$ echo ?.txt\na.txt\n\n# \u5f53\u524d\u76ee\u5f55\u4e3a\u7a7a\u76ee\u5f55\n$ echo ?.txt\n?.txt\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c<code>?.txt</code>\u53ef\u4ee5\u6269\u5c55\u6210\u6587\u4ef6\u540d\uff0c<code>echo</code>\u547d\u4ee4\u4f1a\u8f93\u51fa\u6269\u5c55\u540e\u7684\u7ed3\u679c\uff1b\u5982\u679c\u4e0d\u80fd\u6269\u5c55\u6210\u6587\u4ef6\u540d\uff0c<code>echo</code>\u5c31\u4f1a\u539f\u6837\u8f93\u51fa<code>?.txt</code>\u3002</p>"},{"location":"linux/bash/expansion/#_4","title":"<code>*</code> \u5b57\u7b26\u6269\u5c55","text":"<p><code>*</code>\u5b57\u7b26\u4ee3\u8868\u6587\u4ef6\u8def\u5f84\u91cc\u9762\u7684\u4efb\u610f\u6570\u91cf\u7684\u4efb\u610f\u5b57\u7b26\uff0c\u5305\u62ec\u96f6\u4e2a\u5b57\u7b26\u3002</p> <pre><code># \u5b58\u5728\u6587\u4ef6 a.txt\u3001b.txt \u548c ab.txt\n$ ls *.txt\na.txt b.txt ab.txt\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>*.txt</code>\u4ee3\u8868\u540e\u7f00\u540d\u4e3a<code>.txt</code>\u7684\u6240\u6709\u6587\u4ef6\u3002</p> <p>\u5982\u679c\u60f3\u8f93\u51fa\u5f53\u524d\u76ee\u5f55\u7684\u6240\u6709\u6587\u4ef6\uff0c\u76f4\u63a5\u7528<code>*</code>\u5373\u53ef\u3002</p> <pre><code>$ ls *\n</code></pre> <p><code>*</code>\u53ef\u4ee5\u5339\u914d\u7a7a\u5b57\u7b26\uff0c\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code># \u5b58\u5728\u6587\u4ef6 a.txt\u3001b.txt \u548c ab.txt\n$ ls a*.txt\na.txt ab.txt\n\n$ ls *b*\nb.txt ab.txt\n</code></pre> <p>\u6ce8\u610f\uff0c<code>*</code>\u4e0d\u4f1a\u5339\u914d\u9690\u85cf\u6587\u4ef6\uff08\u4ee5<code>.</code>\u5f00\u5934\u7684\u6587\u4ef6\uff09\uff0c\u5373<code>ls *</code>\u4e0d\u4f1a\u8f93\u51fa\u9690\u85cf\u6587\u4ef6\u3002</p> <p>\u5982\u679c\u8981\u5339\u914d\u9690\u85cf\u6587\u4ef6\uff0c\u9700\u8981\u5199\u6210<code>.*</code>\u3002</p> <pre><code># \u663e\u793a\u6240\u6709\u9690\u85cf\u6587\u4ef6\n$ echo .*\n</code></pre> <p>\u5982\u679c\u8981\u5339\u914d\u9690\u85cf\u6587\u4ef6\uff0c\u540c\u65f6\u8981\u6392\u9664<code>.</code>\u548c<code>..</code>\u8fd9\u4e24\u4e2a\u7279\u6b8a\u7684\u9690\u85cf\u6587\u4ef6\uff0c\u53ef\u4ee5\u4e0e\u65b9\u62ec\u53f7\u6269\u5c55\u7ed3\u5408\u4f7f\u7528\uff0c\u5199\u6210<code>.[!.]*</code>\u3002</p> <pre><code>$ echo .[!.]*\n</code></pre> <p>\u6ce8\u610f\uff0c<code>*</code>\u5b57\u7b26\u6269\u5c55\u5c5e\u4e8e\u6587\u4ef6\u540d\u6269\u5c55\uff0c\u53ea\u6709\u6587\u4ef6\u786e\u5b9e\u5b58\u5728\u7684\u524d\u63d0\u4e0b\u624d\u4f1a\u6269\u5c55\u3002\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5c31\u4f1a\u539f\u6837\u8f93\u51fa\u3002</p> <pre><code># \u5f53\u524d\u76ee\u5f55\u4e0d\u5b58\u5728 c \u5f00\u5934\u7684\u6587\u4ef6\n$ echo c*.txt\nc*.txt\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5f53\u524d\u76ee\u5f55\u91cc\u9762\u6ca1\u6709<code>c</code>\u5f00\u5934\u7684\u6587\u4ef6\uff0c\u5bfc\u81f4<code>c*.txt</code>\u4f1a\u539f\u6837\u8f93\u51fa\u3002</p> <p><code>*</code>\u53ea\u5339\u914d\u5f53\u524d\u76ee\u5f55\uff0c\u4e0d\u4f1a\u5339\u914d\u5b50\u76ee\u5f55\u3002</p> <pre><code># \u5b50\u76ee\u5f55\u6709\u4e00\u4e2a a.txt\n# \u65e0\u6548\u7684\u5199\u6cd5\n$ ls *.txt\n\n# \u6709\u6548\u7684\u5199\u6cd5\n$ ls */*.txt\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\uff0c\u6587\u672c\u6587\u4ef6\u5728\u5b50\u76ee\u5f55\uff0c<code>*.txt</code>\u4e0d\u4f1a\u4ea7\u751f\u5339\u914d\uff0c\u5fc5\u987b\u5199\u6210<code>*/*.txt</code>\u3002\u6709\u51e0\u5c42\u5b50\u76ee\u5f55\uff0c\u5c31\u5fc5\u987b\u5199\u51e0\u5c42\u661f\u53f7\u3002</p> <p>Bash 4.0 \u5f15\u5165\u4e86\u4e00\u4e2a\u53c2\u6570<code>globstar</code>\uff0c\u5f53\u8be5\u53c2\u6570\u6253\u5f00\u65f6\uff0c\u5141\u8bb8<code>**</code>\u5339\u914d\u96f6\u4e2a\u6216\u591a\u4e2a\u5b50\u76ee\u5f55\u3002\u56e0\u6b64\uff0c<code>**/*.txt</code>\u53ef\u4ee5\u5339\u914d\u9876\u5c42\u7684\u6587\u672c\u6587\u4ef6\u548c\u4efb\u610f\u6df1\u5ea6\u5b50\u76ee\u5f55\u7684\u6587\u672c\u6587\u4ef6\u3002\u8be6\u7ec6\u4ecb\u7ecd\u8bf7\u770b\u540e\u9762<code>shopt</code>\u547d\u4ee4\u7684\u4ecb\u7ecd\u3002</p>"},{"location":"linux/bash/expansion/#_5","title":"\u65b9\u62ec\u53f7\u6269\u5c55","text":"<p>\u65b9\u62ec\u53f7\u6269\u5c55\u7684\u5f62\u5f0f\u662f<code>[...]</code>\uff0c\u53ea\u6709\u6587\u4ef6\u786e\u5b9e\u5b58\u5728\u7684\u524d\u63d0\u4e0b\u624d\u4f1a\u6269\u5c55\u3002\u5982\u679c\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5c31\u4f1a\u539f\u6837\u8f93\u51fa\u3002\u62ec\u53f7\u4e4b\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\u3002\u6bd4\u5982\uff0c<code>[aeiou]</code>\u53ef\u4ee5\u5339\u914d\u4e94\u4e2a\u5143\u97f3\u5b57\u6bcd\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u3002</p> <pre><code># \u5b58\u5728\u6587\u4ef6 a.txt \u548c b.txt\n$ ls [ab].txt\na.txt b.txt\n\n# \u53ea\u5b58\u5728\u6587\u4ef6 a.txt\n$ ls [ab].txt\na.txt\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>[ab]</code>\u53ef\u4ee5\u5339\u914d<code>a</code>\u6216<code>b</code>\uff0c\u524d\u63d0\u662f\u786e\u5b9e\u5b58\u5728\u76f8\u5e94\u7684\u6587\u4ef6\u3002</p> <p>\u65b9\u62ec\u53f7\u6269\u5c55\u5c5e\u4e8e\u6587\u4ef6\u540d\u5339\u914d\uff0c\u5373\u6269\u5c55\u540e\u7684\u7ed3\u679c\u5fc5\u987b\u7b26\u5408\u73b0\u6709\u7684\u6587\u4ef6\u8def\u5f84\u3002\u5982\u679c\u4e0d\u5b58\u5728\u5339\u914d\uff0c\u5c31\u4f1a\u4fdd\u6301\u539f\u6837\uff0c\u4e0d\u8fdb\u884c\u6269\u5c55\u3002</p> <pre><code># \u4e0d\u5b58\u5728\u6587\u4ef6 a.txt \u548c b.txt\n$ ls [ab].txt\nls: \u65e0\u6cd5\u8bbf\u95ee'[ab].txt': \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7531\u4e8e\u6269\u5c55\u540e\u7684\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c<code>[ab].txt</code>\u5c31\u539f\u6837\u8f93\u51fa\u4e86\uff0c\u5bfc\u81f4<code>ls</code>\u547d\u540d\u62a5\u9519\u3002</p> <p>\u65b9\u62ec\u53f7\u6269\u5c55\u8fd8\u6709\u4e24\u79cd\u53d8\u4f53\uff1a<code>[^...]</code>\u548c<code>[!...]</code>\u3002\u5b83\u4eec\u8868\u793a\u5339\u914d\u4e0d\u5728\u65b9\u62ec\u53f7\u91cc\u9762\u7684\u5b57\u7b26\uff0c\u8fd9\u4e24\u79cd\u5199\u6cd5\u662f\u7b49\u4ef7\u7684\u3002\u6bd4\u5982\uff0c<code>[^abc]</code>\u6216<code>[!abc]</code>\u8868\u793a\u5339\u914d\u9664\u4e86<code>a</code>\u3001<code>b</code>\u3001<code>c</code>\u4ee5\u5916\u7684\u5b57\u7b26\u3002</p> <pre><code># \u5b58\u5728 aaa\u3001bbb\u3001aba \u4e09\u4e2a\u6587\u4ef6\n$ ls ?[!a]?\naba bbb\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>[!a]</code>\u8868\u793a\u6587\u4ef6\u540d\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u4e0d\u662f<code>a</code>\u7684\u6587\u4ef6\u540d\uff0c\u6240\u4ee5\u8fd4\u56de\u4e86<code>aba</code>\u548c<code>bbb</code>\u4e24\u4e2a\u6587\u4ef6\u3002</p> <p>\u6ce8\u610f\uff0c\u5982\u679c\u9700\u8981\u5339\u914d<code>[</code>\u5b57\u7b26\uff0c\u53ef\u4ee5\u653e\u5728\u65b9\u62ec\u53f7\u5185\uff0c\u6bd4\u5982<code>[[aeiou]</code>\u3002\u5982\u679c\u9700\u8981\u5339\u914d\u8fde\u5b57\u53f7<code>-</code>\uff0c\u53ea\u80fd\u653e\u5728\u65b9\u62ec\u53f7\u5185\u90e8\u7684\u5f00\u5934\u6216\u7ed3\u5c3e\uff0c\u6bd4\u5982<code>[-aeiou]</code>\u6216<code>[aeiou-]</code>\u3002</p>"},{"location":"linux/bash/expansion/#start-end","title":"[start-end] \u6269\u5c55","text":"<p>\u65b9\u62ec\u53f7\u6269\u5c55\u6709\u4e00\u4e2a\u7b80\u5199\u5f62\u5f0f<code>[start-end]</code>\uff0c\u8868\u793a\u5339\u914d\u4e00\u4e2a\u8fde\u7eed\u7684\u8303\u56f4\u3002\u6bd4\u5982\uff0c<code>[a-c]</code>\u7b49\u540c\u4e8e<code>[abc]</code>\uff0c<code>[0-9]</code>\u5339\u914d<code>[0123456789]</code>\u3002</p> <pre><code># \u5b58\u5728\u6587\u4ef6 a.txt\u3001b.txt \u548c c.txt\n$ ls [a-c].txt\na.txt\nb.txt\nc.txt\n\n# \u5b58\u5728\u6587\u4ef6 report1.txt\u3001report2.txt \u548c report3.txt\n$ ls report[0-9].txt\nreport1.txt\nreport2.txt\nreport3.txt\n...\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u5e38\u7528\u7b80\u5199\u7684\u4f8b\u5b50\u3002</p> <ul> <li><code>[a-z]</code>\uff1a\u6240\u6709\u5c0f\u5199\u5b57\u6bcd\u3002</li> <li><code>[a-zA-Z]</code>\uff1a\u6240\u6709\u5c0f\u5199\u5b57\u6bcd\u4e0e\u5927\u5199\u5b57\u6bcd\u3002</li> <li><code>[a-zA-Z0-9]</code>\uff1a\u6240\u6709\u5c0f\u5199\u5b57\u6bcd\u3001\u5927\u5199\u5b57\u6bcd\u4e0e\u6570\u5b57\u3002</li> <li><code>[abc]*</code>\uff1a\u6240\u6709\u4ee5<code>a</code>\u3001<code>b</code>\u3001<code>c</code>\u5b57\u7b26\u4e4b\u4e00\u5f00\u5934\u7684\u6587\u4ef6\u540d\u3002</li> <li><code>program.[co]</code>\uff1a\u6587\u4ef6<code>program.c</code>\u4e0e\u6587\u4ef6<code>program.o</code>\u3002</li> <li><code>BACKUP.[0-9][0-9][0-9]</code>\uff1a\u6240\u6709\u4ee5<code>BACKUP.</code>\u5f00\u5934\uff0c\u540e\u9762\u662f\u4e09\u4e2a\u6570\u5b57\u7684\u6587\u4ef6\u540d\u3002</li> </ul> <p>\u8fd9\u79cd\u7b80\u5199\u5f62\u5f0f\u6709\u4e00\u4e2a\u5426\u5b9a\u5f62\u5f0f<code>[!start-end]</code>\uff0c\u8868\u793a\u5339\u914d\u4e0d\u5c5e\u4e8e\u8fd9\u4e2a\u8303\u56f4\u7684\u5b57\u7b26\u3002\u6bd4\u5982\uff0c<code>[!a-zA-Z]</code>\u8868\u793a\u5339\u914d\u975e\u82f1\u6587\u5b57\u6bcd\u7684\u5b57\u7b26\u3002</p> <pre><code>$ echo report[!1\u20133].txt\nreport4.txt report5.txt\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>[!1-3]</code>\u8868\u793a\u6392\u96641\u30012\u548c3\u3002</p>"},{"location":"linux/bash/expansion/#_6","title":"\u5927\u62ec\u53f7\u6269\u5c55","text":"<p>\u5927\u62ec\u53f7\u6269\u5c55<code>{...}</code>\u8868\u793a\u5206\u522b\u6269\u5c55\u6210\u5927\u62ec\u53f7\u91cc\u9762\u7684\u6240\u6709\u503c\uff0c\u5404\u4e2a\u503c\u4e4b\u95f4\u4f7f\u7528\u9017\u53f7\u5206\u9694\u3002\u6bd4\u5982\uff0c<code>{1,2,3}</code>\u6269\u5c55\u6210<code>1 2 3</code>\u3002</p> <pre><code>$ echo {1,2,3}\n1 2 3\n\n$ echo d{a,e,i,u,o}g\ndag deg dig dug dog\n\n$ echo Front-{A,B,C}-Back\nFront-A-Back Front-B-Back Front-C-Back\n</code></pre> <p>\u6ce8\u610f\uff0c\u5927\u62ec\u53f7\u6269\u5c55\u4e0d\u662f\u6587\u4ef6\u540d\u6269\u5c55\u3002\u5b83\u4f1a\u6269\u5c55\u6210\u6240\u6709\u7ed9\u5b9a\u7684\u503c\uff0c\u800c\u4e0d\u7ba1\u662f\u5426\u6709\u5bf9\u5e94\u7684\u6587\u4ef6\u5b58\u5728\u3002</p> <pre><code>$ ls {a,b,c}.txt\nls: \u65e0\u6cd5\u8bbf\u95ee'a.txt': \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\nls: \u65e0\u6cd5\u8bbf\u95ee'b.txt': \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\nls: \u65e0\u6cd5\u8bbf\u95ee'c.txt': \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5373\u4f7f\u4e0d\u5b58\u5728\u5bf9\u5e94\u7684\u6587\u4ef6\uff0c<code>{a,b,c}</code>\u4f9d\u7136\u6269\u5c55\u6210\u4e09\u4e2a\u6587\u4ef6\u540d\uff0c\u5bfc\u81f4<code>ls</code>\u547d\u4ee4\u62a5\u4e86\u4e09\u4e2a\u9519\u8bef\u3002</p> <p>\u53e6\u4e00\u4e2a\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\u662f\uff0c\u5927\u62ec\u53f7\u5185\u90e8\u7684\u9017\u53f7\u524d\u540e\u4e0d\u80fd\u6709\u7a7a\u683c\u3002\u5426\u5219\uff0c\u5927\u62ec\u53f7\u6269\u5c55\u4f1a\u5931\u6548\u3002</p> <pre><code>$ echo {1 , 2}\n{1 , 2}\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u9017\u53f7\u524d\u540e\u6709\u7a7a\u683c\uff0cBash \u5c31\u4f1a\u8ba4\u4e3a\u8fd9\u4e0d\u662f\u5927\u62ec\u53f7\u6269\u5c55\uff0c\u800c\u662f\u4e09\u4e2a\u72ec\u7acb\u7684\u53c2\u6570\u3002</p> <p>\u9017\u53f7\u524d\u9762\u53ef\u4ee5\u6ca1\u6709\u503c\uff0c\u8868\u793a\u6269\u5c55\u7684\u7b2c\u4e00\u9879\u4e3a\u7a7a\u3002</p> <pre><code>$ cp a.log{,.bak}\n\n# \u7b49\u540c\u4e8e\n# cp a.log a.log.bak\n</code></pre> <p>\u5927\u62ec\u53f7\u53ef\u4ee5\u5d4c\u5957\u3002</p> <pre><code>$ echo {j{p,pe}g,png}\njpg jpeg png\n\n$ echo a{A{1,2},B{3,4}}b\naA1b aA2b aB3b aB4b\n</code></pre> <p>\u5927\u62ec\u53f7\u4e5f\u53ef\u4ee5\u4e0e\u5176\u4ed6\u6a21\u5f0f\u8054\u7528\uff0c\u5e76\u4e14\u603b\u662f\u5148\u4e8e\u5176\u4ed6\u6a21\u5f0f\u8fdb\u884c\u6269\u5c55\u3002</p> <pre><code>$ echo /bin/{cat,b*}\n/bin/cat /bin/b2sum /bin/base32 /bin/base64 ... ...\n\n# \u57fa\u672c\u7b49\u540c\u4e8e\n$ echo /bin/cat;echo /bin/b*\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u4f1a\u5148\u8fdb\u884c\u5927\u62ec\u53f7\u6269\u5c55\uff0c\u7136\u540e\u8fdb\u884c<code>*</code>\u6269\u5c55\uff0c\u7b49\u540c\u4e8e\u6267\u884c\u4e24\u6761<code>echo</code>\u547d\u4ee4\u3002</p> <p>\u5927\u62ec\u53f7\u53ef\u4ee5\u7528\u4e8e\u591a\u5b57\u7b26\u7684\u6a21\u5f0f\uff0c\u65b9\u62ec\u53f7\u4e0d\u884c\uff08\u53ea\u80fd\u5339\u914d\u5355\u5b57\u7b26\uff09\u3002</p> <pre><code>$ echo {cat,dog}\ncat dog\n</code></pre> <p>\u7531\u4e8e\u5927\u62ec\u53f7\u6269\u5c55<code>{...}</code>\u4e0d\u662f\u6587\u4ef6\u540d\u6269\u5c55\uff0c\u6240\u4ee5\u5b83\u603b\u662f\u4f1a\u6269\u5c55\u7684\u3002\u8fd9\u4e0e\u65b9\u62ec\u53f7\u6269\u5c55<code>[...]</code>\u5b8c\u5168\u4e0d\u540c\uff0c\u5982\u679c\u5339\u914d\u7684\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u65b9\u62ec\u53f7\u5c31\u4e0d\u4f1a\u6269\u5c55\u3002\u8fd9\u4e00\u70b9\u8981\u6ce8\u610f\u533a\u5206\u3002</p> <pre><code># \u4e0d\u5b58\u5728 a.txt \u548c b.txt\n$ echo [ab].txt\n[ab].txt\n\n$ echo {a,b}.txt\na.txt b.txt\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u4e0d\u5b58\u5728<code>a.txt</code>\u548c<code>b.txt</code>\uff0c\u90a3\u4e48<code>[ab].txt</code>\u5c31\u4f1a\u53d8\u6210\u4e00\u4e2a\u666e\u901a\u7684\u6587\u4ef6\u540d\uff0c\u800c<code>{a,b}.txt</code>\u53ef\u4ee5\u7167\u6837\u6269\u5c55\u3002</p>"},{"location":"linux/bash/expansion/#startend","title":"{start..end} \u6269\u5c55","text":"<p>\u5927\u62ec\u53f7\u6269\u5c55\u6709\u4e00\u4e2a\u7b80\u5199\u5f62\u5f0f<code>{start..end}</code>\uff0c\u8868\u793a\u6269\u5c55\u6210\u4e00\u4e2a\u8fde\u7eed\u5e8f\u5217\u3002\u6bd4\u5982\uff0c<code>{a..z}</code>\u53ef\u4ee5\u6269\u5c55\u621026\u4e2a\u5c0f\u5199\u82f1\u6587\u5b57\u6bcd\u3002</p> <pre><code>$ echo {a..c}\na b c\n\n$ echo d{a..d}g\ndag dbg dcg ddg\n\n$ echo {1..4}\n1 2 3 4\n\n$ echo Number_{1..5}\nNumber_1 Number_2 Number_3 Number_4 Number_5\n</code></pre> <p>\u8fd9\u79cd\u7b80\u5199\u5f62\u5f0f\u652f\u6301\u9006\u5e8f\u3002</p> <pre><code>$ echo {c..a}\nc b a\n\n$ echo {5..1}\n5 4 3 2 1\n</code></pre> <p>\u6ce8\u610f\uff0c\u5982\u679c\u9047\u5230\u65e0\u6cd5\u7406\u89e3\u7684\u7b80\u5199\uff0c\u5927\u62ec\u53f7\u6a21\u5f0f\u5c31\u4f1a\u539f\u6837\u8f93\u51fa\uff0c\u4e0d\u4f1a\u6269\u5c55\u3002</p> <pre><code>$ echo {a1..3c}\n{a1..3c}\n</code></pre> <p>\u8fd9\u79cd\u7b80\u5199\u5f62\u5f0f\u53ef\u4ee5\u5d4c\u5957\u4f7f\u7528\uff0c\u5f62\u6210\u590d\u6742\u7684\u6269\u5c55\u3002</p> <pre><code>$ echo .{mp{3..4},m4{a,b,p,v}}\n.mp3 .mp4 .m4a .m4b .m4p .m4v\n</code></pre> <p>\u5927\u62ec\u53f7\u6269\u5c55\u7684\u5e38\u89c1\u7528\u9014\u4e3a\u65b0\u5efa\u4e00\u7cfb\u5217\u76ee\u5f55\u3002</p> <pre><code>$ mkdir {2007..2009}-{01..12}\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4f1a\u65b0\u5efa36\u4e2a\u5b50\u76ee\u5f55\uff0c\u6bcf\u4e2a\u5b50\u76ee\u5f55\u7684\u540d\u5b57\u90fd\u662f\u201d\u5e74\u4efd-\u6708\u4efd\u201c\u3002</p> <p>\u8fd9\u4e2a\u5199\u6cd5\u7684\u53e6\u4e00\u4e2a\u5e38\u89c1\u7528\u9014\uff0c\u662f\u76f4\u63a5\u7528\u4e8e<code>for</code>\u5faa\u73af\u3002</p> <pre><code>for i in {1..4}\ndo\n  echo $i\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4f1a\u5faa\u73af4\u6b21\u3002</p> <p>\u5982\u679c\u6574\u6570\u524d\u9762\u6709\u524d\u5bfc<code>0</code>\uff0c\u6269\u5c55\u8f93\u51fa\u7684\u6bcf\u4e00\u9879\u90fd\u6709\u524d\u5bfc<code>0</code>\u3002</p> <pre><code>$ echo {01..5}\n01 02 03 04 05\n\n$ echo {001..5}\n001 002 003 004 005\n</code></pre> <p>\u8fd9\u79cd\u7b80\u5199\u5f62\u5f0f\u8fd8\u53ef\u4ee5\u4f7f\u7528\u7b2c\u4e8c\u4e2a\u53cc\u70b9\u53f7\uff08<code>start..end..step</code>\uff09\uff0c\u7528\u6765\u6307\u5b9a\u6269\u5c55\u7684\u6b65\u957f\u3002</p> <pre><code>$ echo {0..8..2}\n0 2 4 6 8\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u5c06<code>0</code>\u6269\u5c55\u5230<code>8</code>\uff0c\u6bcf\u6b21\u9012\u589e\u7684\u957f\u5ea6\u4e3a<code>2</code>\uff0c\u6240\u4ee5\u4e00\u5171\u8f93\u51fa5\u4e2a\u6570\u5b57\u3002</p> <p>\u591a\u4e2a\u7b80\u5199\u5f62\u5f0f\u8fde\u7528\uff0c\u4f1a\u6709\u5faa\u73af\u5904\u7406\u7684\u6548\u679c\u3002</p> <pre><code>$ echo {a..c}{1..3}\na1 a2 a3 b1 b2 b3 c1 c2 c3\n</code></pre>"},{"location":"linux/bash/expansion/#_7","title":"\u53d8\u91cf\u6269\u5c55","text":"<p>Bash \u5c06\u7f8e\u5143\u7b26\u53f7<code>$</code>\u5f00\u5934\u7684\u8bcd\u5143\u89c6\u4e3a\u53d8\u91cf\uff0c\u5c06\u5176\u6269\u5c55\u6210\u53d8\u91cf\u503c\uff0c\u8be6\u89c1\u300aBash \u53d8\u91cf\u300b\u4e00\u7ae0\u3002</p> <pre><code>$ echo $SHELL\n/bin/bash\n</code></pre> <p>\u53d8\u91cf\u540d\u9664\u4e86\u653e\u5728\u7f8e\u5143\u7b26\u53f7\u540e\u9762\uff0c\u4e5f\u53ef\u4ee5\u653e\u5728<code>${}</code>\u91cc\u9762\u3002</p> <pre><code>$ echo ${SHELL}\n/bin/bash\n</code></pre> <p><code>${!string*}</code>\u6216<code>${!string@}</code>\u8fd4\u56de\u6240\u6709\u5339\u914d\u7ed9\u5b9a\u5b57\u7b26\u4e32<code>string</code>\u7684\u53d8\u91cf\u540d\u3002</p> <pre><code>$ echo ${!S*}\nSECONDS SHELL SHELLOPTS SHLVL SSH_AGENT_PID SSH_AUTH_SOCK\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>${!S*}</code>\u6269\u5c55\u6210\u6240\u6709\u4ee5<code>S</code>\u5f00\u5934\u7684\u53d8\u91cf\u540d\u3002</p>"},{"location":"linux/bash/expansion/#_8","title":"\u5b50\u547d\u4ee4\u6269\u5c55","text":"<p><code>$(...)</code>\u53ef\u4ee5\u6269\u5c55\u6210\u53e6\u4e00\u4e2a\u547d\u4ee4\u7684\u8fd0\u884c\u7ed3\u679c\uff0c\u8be5\u547d\u4ee4\u7684\u6240\u6709\u8f93\u51fa\u90fd\u4f1a\u4f5c\u4e3a\u8fd4\u56de\u503c\u3002</p> <pre><code>$ echo $(date)\nTue Jan 28 00:01:13 CST 2020\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>$(date)</code>\u8fd4\u56de<code>date</code>\u547d\u4ee4\u7684\u8fd0\u884c\u7ed3\u679c\u3002</p> <p>\u8fd8\u6709\u53e6\u4e00\u79cd\u8f83\u8001\u7684\u8bed\u6cd5\uff0c\u5b50\u547d\u4ee4\u653e\u5728\u53cd\u5f15\u53f7\u4e4b\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u6269\u5c55\u6210\u547d\u4ee4\u7684\u8fd0\u884c\u7ed3\u679c\u3002</p> <pre><code>$ echo `date`\nTue Jan 28 00:01:13 CST 2020\n</code></pre> <p><code>$(...)</code>\u53ef\u4ee5\u5d4c\u5957\uff0c\u6bd4\u5982<code>$(ls $(pwd))</code>\u3002</p>"},{"location":"linux/bash/expansion/#_9","title":"\u7b97\u672f\u6269\u5c55","text":"<p><code>$((...))</code>\u53ef\u4ee5\u6269\u5c55\u6210\u6574\u6570\u8fd0\u7b97\u7684\u7ed3\u679c\uff0c\u8be6\u89c1\u300aBash \u7684\u7b97\u672f\u8fd0\u7b97\u300b\u4e00\u7ae0\u3002</p> <pre><code>$ echo $((2 + 2))\n4\n</code></pre>"},{"location":"linux/bash/expansion/#_10","title":"\u5b57\u7b26\u7c7b","text":"<p><code>[[:class:]]</code>\u8868\u793a\u4e00\u4e2a\u5b57\u7b26\u7c7b\uff0c\u6269\u5c55\u6210\u67d0\u4e00\u7c7b\u7279\u5b9a\u5b57\u7b26\u4e4b\u4e2d\u7684\u4e00\u4e2a\u3002\u5e38\u7528\u7684\u5b57\u7b26\u7c7b\u5982\u4e0b\u3002</p> <ul> <li><code>[[:alnum:]]</code>\uff1a\u5339\u914d\u4efb\u610f\u82f1\u6587\u5b57\u6bcd\u4e0e\u6570\u5b57</li> <li><code>[[:alpha:]]</code>\uff1a\u5339\u914d\u4efb\u610f\u82f1\u6587\u5b57\u6bcd</li> <li><code>[[:blank:]]</code>\uff1a\u7a7a\u683c\u548c Tab \u952e\u3002</li> <li><code>[[:cntrl:]]</code>\uff1aASCII \u7801 0-31 \u7684\u4e0d\u53ef\u6253\u5370\u5b57\u7b26\u3002</li> <li><code>[[:digit:]]</code>\uff1a\u5339\u914d\u4efb\u610f\u6570\u5b57 0-9\u3002</li> <li><code>[[:graph:]]</code>\uff1aA-Z\u3001a-z\u30010-9 \u548c\u6807\u70b9\u7b26\u53f7\u3002</li> <li><code>[[:lower:]]</code>\uff1a\u5339\u914d\u4efb\u610f\u5c0f\u5199\u5b57\u6bcd a-z\u3002</li> <li><code>[[:print:]]</code>\uff1aASCII \u7801 32-127 \u7684\u53ef\u6253\u5370\u5b57\u7b26\u3002</li> <li><code>[[:punct:]]</code>\uff1a\u6807\u70b9\u7b26\u53f7\uff08\u9664\u4e86 A-Z\u3001a-z\u30010-9 \u7684\u53ef\u6253\u5370\u5b57\u7b26\uff09\u3002</li> <li><code>[[:space:]]</code>\uff1a\u7a7a\u683c\u3001Tab\u3001LF\uff0810\uff09\u3001VT\uff0811\uff09\u3001FF\uff0812\uff09\u3001CR\uff0813\uff09\u3002</li> <li><code>[[:upper:]]</code>\uff1a\u5339\u914d\u4efb\u610f\u5927\u5199\u5b57\u6bcd A-Z\u3002</li> <li><code>[[:xdigit:]]</code>\uff1a16\u8fdb\u5236\u5b57\u7b26\uff08A-F\u3001a-f\u30010-9\uff09\u3002</li> </ul> <p>\u8bf7\u770b\u4e0b\u9762\u7684\u4f8b\u5b50\u3002</p> <pre><code>$ echo [[:upper:]]*\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u8f93\u51fa\u6240\u6709\u5927\u5199\u5b57\u6bcd\u5f00\u5934\u7684\u6587\u4ef6\u540d\u3002</p> <p>\u5b57\u7b26\u7c7b\u7684\u7b2c\u4e00\u4e2a\u65b9\u62ec\u53f7\u540e\u9762\uff0c\u53ef\u4ee5\u52a0\u4e0a\u611f\u53f9\u53f7<code>!</code>\uff0c\u8868\u793a\u5426\u5b9a\u3002\u6bd4\u5982\uff0c<code>[![:digit:]]</code>\u5339\u914d\u6240\u6709\u975e\u6570\u5b57\u3002</p> <pre><code>$ echo [![:digit:]]*\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u8f93\u51fa\u6240\u6709\u4e0d\u4ee5\u6570\u5b57\u5f00\u5934\u7684\u6587\u4ef6\u540d\u3002</p> <p>\u5b57\u7b26\u7c7b\u4e5f\u5c5e\u4e8e\u6587\u4ef6\u540d\u6269\u5c55\uff0c\u5982\u679c\u6ca1\u6709\u5339\u914d\u7684\u6587\u4ef6\u540d\uff0c\u5b57\u7b26\u7c7b\u5c31\u4f1a\u539f\u6837\u8f93\u51fa\u3002</p> <pre><code># \u4e0d\u5b58\u5728\u4ee5\u5927\u5199\u5b57\u6bcd\u5f00\u5934\u7684\u6587\u4ef6\n$ echo [[:upper:]]*\n[[:upper:]]*\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7531\u4e8e\u6ca1\u6709\u53ef\u5339\u914d\u7684\u6587\u4ef6\uff0c\u5b57\u7b26\u7c7b\u5c31\u539f\u6837\u8f93\u51fa\u4e86\u3002</p>"},{"location":"linux/bash/expansion/#_11","title":"\u4f7f\u7528\u6ce8\u610f\u70b9","text":"<p>\u901a\u914d\u7b26\u6709\u4e00\u4e9b\u4f7f\u7528\u6ce8\u610f\u70b9\uff0c\u4e0d\u53ef\u4e0d\u77e5\u3002</p> <p>\uff081\uff09\u901a\u914d\u7b26\u662f\u5148\u89e3\u91ca\uff0c\u518d\u6267\u884c\u3002</p> <p>Bash \u63a5\u6536\u5230\u547d\u4ee4\u4ee5\u540e\uff0c\u53d1\u73b0\u91cc\u9762\u6709\u901a\u914d\u7b26\uff0c\u4f1a\u8fdb\u884c\u901a\u914d\u7b26\u6269\u5c55\uff0c\u7136\u540e\u518d\u6267\u884c\u547d\u4ee4\u3002</p> <pre><code>$ ls a*.txt\nab.txt\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u7684\u6267\u884c\u8fc7\u7a0b\u662f\uff0cBash \u5148\u5c06<code>a*.txt</code>\u6269\u5c55\u6210<code>ab.txt</code>\uff0c\u7136\u540e\u518d\u6267\u884c<code>ls ab.txt</code>\u3002</p> <p>\uff082\uff09\u6587\u4ef6\u540d\u6269\u5c55\u5728\u4e0d\u5339\u914d\u65f6\uff0c\u4f1a\u539f\u6837\u8f93\u51fa\u3002</p> <p>\u6587\u4ef6\u540d\u6269\u5c55\u5728\u6ca1\u6709\u53ef\u5339\u914d\u7684\u6587\u4ef6\u65f6\uff0c\u4f1a\u539f\u6837\u8f93\u51fa\u3002</p> <pre><code># \u4e0d\u5b58\u5728 r \u5f00\u5934\u7684\u6587\u4ef6\u540d\n$ echo r*\nr*\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u7531\u4e8e\u4e0d\u5b58\u5728<code>r</code>\u5f00\u5934\u7684\u6587\u4ef6\u540d\uff0c<code>r*</code>\u4f1a\u539f\u6837\u8f93\u51fa\u3002</p> <p>\u4e0b\u9762\u662f\u53e6\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>$ ls *.csv\nls: *.csv: No such file or directory\n</code></pre> <p>\u53e6\u5916\uff0c\u524d\u9762\u5df2\u7ecf\u8bf4\u8fc7\uff0c\u5927\u62ec\u53f7\u6269\u5c55<code>{...}</code>\u4e0d\u662f\u6587\u4ef6\u540d\u6269\u5c55\u3002</p> <p>\uff083\uff09\u53ea\u9002\u7528\u4e8e\u5355\u5c42\u8def\u5f84\u3002</p> <p>\u6240\u6709\u6587\u4ef6\u540d\u6269\u5c55\u53ea\u5339\u914d\u5355\u5c42\u8def\u5f84\uff0c\u4e0d\u80fd\u8de8\u76ee\u5f55\u5339\u914d\uff0c\u5373\u65e0\u6cd5\u5339\u914d\u5b50\u76ee\u5f55\u91cc\u9762\u7684\u6587\u4ef6\u3002\u6216\u8005\u8bf4\uff0c<code>?</code>\u6216<code>*</code>\u8fd9\u6837\u7684\u901a\u914d\u7b26\uff0c\u4e0d\u80fd\u5339\u914d\u8def\u5f84\u5206\u9694\u7b26\uff08<code>/</code>\uff09\u3002</p> <p>\u5982\u679c\u8981\u5339\u914d\u5b50\u76ee\u5f55\u91cc\u9762\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u5199\u6210\u4e0b\u9762\u8fd9\u6837\u3002</p> <pre><code>$ ls */*.txt\n</code></pre> <p>Bash 4.0 \u65b0\u589e\u4e86\u4e00\u4e2a<code>globstar</code>\u53c2\u6570\uff0c\u5141\u8bb8<code>**</code>\u5339\u914d\u96f6\u4e2a\u6216\u591a\u4e2a\u5b50\u76ee\u5f55\uff0c\u8be6\u89c1\u540e\u9762<code>shopt</code>\u547d\u4ee4\u7684\u4ecb\u7ecd\u3002</p> <p>\uff084\uff09\u6587\u4ef6\u540d\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26\u3002</p> <p>Bash \u5141\u8bb8\u6587\u4ef6\u540d\u4f7f\u7528\u901a\u914d\u7b26\uff0c\u5373\u6587\u4ef6\u540d\u5305\u62ec\u7279\u6b8a\u5b57\u7b26\u3002\u8fd9\u65f6\u5f15\u7528\u6587\u4ef6\u540d\uff0c\u9700\u8981\u628a\u6587\u4ef6\u540d\u653e\u5728\u5355\u5f15\u53f7\u91cc\u9762\u3002</p> <pre><code>$ touch 'fo*'\n$ ls\nfo*\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u521b\u5efa\u4e86\u4e00\u4e2a<code>fo*</code>\u6587\u4ef6\uff0c\u8fd9\u65f6<code>*</code>\u5c31\u662f\u6587\u4ef6\u540d\u7684\u4e00\u90e8\u5206\u3002</p>"},{"location":"linux/bash/expansion/#_12","title":"\u91cf\u8bcd\u8bed\u6cd5","text":"<p>\u91cf\u8bcd\u8bed\u6cd5\u7528\u6765\u63a7\u5236\u6a21\u5f0f\u5339\u914d\u7684\u6b21\u6570\u3002\u5b83\u53ea\u6709\u5728 Bash \u7684<code>extglob</code>\u53c2\u6570\u6253\u5f00\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u4f7f\u7528\uff0c\u4e0d\u8fc7\u4e00\u822c\u662f\u9ed8\u8ba4\u6253\u5f00\u7684\u3002\u4e0b\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u67e5\u8be2\u3002</p> <pre><code>$ shopt extglob\nextglob         on\n</code></pre> <p>\u5982\u679c<code>extglob</code>\u53c2\u6570\u662f\u5173\u95ed\u7684\uff0c\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u6253\u5f00\u3002</p> <pre><code>$ shopt -s extglob\n</code></pre> <p>\u91cf\u8bcd\u8bed\u6cd5\u6709\u4e0b\u9762\u51e0\u4e2a\u3002</p> <ul> <li><code>?(pattern-list)</code>\uff1a\u5339\u914d\u96f6\u4e2a\u6216\u4e00\u4e2a\u6a21\u5f0f\u3002</li> <li><code>*(pattern-list)</code>\uff1a\u5339\u914d\u96f6\u4e2a\u6216\u591a\u4e2a\u6a21\u5f0f\u3002</li> <li><code>+(pattern-list)</code>\uff1a\u5339\u914d\u4e00\u4e2a\u6216\u591a\u4e2a\u6a21\u5f0f\u3002</li> <li><code>@(pattern-list)</code>\uff1a\u53ea\u5339\u914d\u4e00\u4e2a\u6a21\u5f0f\u3002</li> <li><code>!(pattern-list)</code>\uff1a\u5339\u914d\u7ed9\u5b9a\u6a21\u5f0f\u4ee5\u5916\u7684\u4efb\u4f55\u5185\u5bb9\u3002</li> </ul> <pre><code>$ ls abc?(.)txt\nabctxt abc.txt\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>?(.)</code>\u5339\u914d\u96f6\u4e2a\u6216\u4e00\u4e2a\u70b9\u3002</p> <pre><code>$ ls abc?(def)\nabc abcdef\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>?(def)</code>\u5339\u914d\u96f6\u4e2a\u6216\u4e00\u4e2a<code>def</code>\u3002</p> <pre><code>$ ls abc+(.txt|.php)\nabc.php abc.txt\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>+(.txt|.php)</code>\u5339\u914d\u6587\u4ef6\u6709\u4e00\u4e2a<code>.txt</code>\u6216<code>.php</code>\u540e\u7f00\u540d\u3002</p> <pre><code>$ ls abc+(.txt)\nabc.txt abc.txt.txt\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>+(.txt)</code>\u5339\u914d\u6587\u4ef6\u6709\u4e00\u4e2a\u6216\u591a\u4e2a<code>.txt</code>\u540e\u7f00\u540d\u3002</p> <pre><code>$ ls a!(b).txt\na.txt abb.txt ac.txt\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>!(b)</code>\u8868\u793a\u5339\u914d\u5355\u4e2a\u5b57\u6bcd<code>b</code>\u4ee5\u5916\u7684\u4efb\u610f\u5185\u5bb9\uff0c\u6240\u4ee5\u9664\u4e86<code>ab.txt</code>\u4ee5\u5916\uff0c\u5176\u4ed6\u6587\u4ef6\u540d\u90fd\u80fd\u5339\u914d\u3002</p> <p>\u91cf\u8bcd\u8bed\u6cd5\u4e5f\u5c5e\u4e8e\u6587\u4ef6\u540d\u6269\u5c55\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u53ef\u5339\u914d\u7684\u6587\u4ef6\uff0c\u5c31\u4f1a\u539f\u6837\u8f93\u51fa\u3002</p> <pre><code># \u6ca1\u6709 abc \u5f00\u5934\u7684\u6587\u4ef6\u540d\n$ ls abc?(def)\nls: \u65e0\u6cd5\u8bbf\u95ee'abc?(def)': \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7531\u4e8e\u6ca1\u6709\u53ef\u5339\u914d\u7684\u6587\u4ef6\uff0c<code>abc?(def)</code>\u5c31\u539f\u6837\u8f93\u51fa\uff0c\u5bfc\u81f4<code>ls</code>\u547d\u4ee4\u62a5\u9519\u3002</p>"},{"location":"linux/bash/expansion/#shopt","title":"shopt \u547d\u4ee4","text":"<p><code>shopt</code>\u547d\u4ee4\u53ef\u4ee5\u8c03\u6574 Bash \u7684\u884c\u4e3a\u3002\u5b83\u6709\u597d\u51e0\u4e2a\u53c2\u6570\u8ddf\u901a\u914d\u7b26\u6269\u5c55\u6709\u5173\u3002</p> <p><code>shopt</code>\u547d\u4ee4\u7684\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\u3002</p> <pre><code># \u6253\u5f00\u67d0\u4e2a\u53c2\u6570\n$ shopt -s [optionname]\n\n# \u5173\u95ed\u67d0\u4e2a\u53c2\u6570\n$ shopt -u [optionname]\n\n# \u67e5\u8be2\u67d0\u4e2a\u53c2\u6570\u5173\u95ed\u8fd8\u662f\u6253\u5f00\n$ shopt [optionname]\n</code></pre> <p>\uff081\uff09dotglob \u53c2\u6570</p> <p><code>dotglob</code>\u53c2\u6570\u53ef\u4ee5\u8ba9\u6269\u5c55\u7ed3\u679c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\uff08\u5373\u70b9\u5f00\u5934\u7684\u6587\u4ef6\uff09\u3002</p> <p>\u6b63\u5e38\u60c5\u51b5\u4e0b\uff0c\u6269\u5c55\u7ed3\u679c\u4e0d\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3002</p> <pre><code>$ ls *\nabc.txt\n</code></pre> <p>\u6253\u5f00<code>dotglob</code>\uff0c\u5c31\u4f1a\u5305\u62ec\u9690\u85cf\u6587\u4ef6\u3002</p> <pre><code>$ shopt -s dotglob\n$ ls *\nabc.txt .config\n</code></pre> <p>\uff082\uff09nullglob \u53c2\u6570</p> <p><code>nullglob</code>\u53c2\u6570\u53ef\u4ee5\u8ba9\u901a\u914d\u7b26\u4e0d\u5339\u914d\u4efb\u4f55\u6587\u4ef6\u540d\u65f6\uff0c\u8fd4\u56de\u7a7a\u5b57\u7b26\u3002</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u901a\u914d\u7b26\u4e0d\u5339\u914d\u4efb\u4f55\u6587\u4ef6\u540d\u65f6\uff0c\u4f1a\u4fdd\u6301\u4e0d\u53d8\u3002</p> <pre><code>$ rm b*\nrm: \u65e0\u6cd5\u5220\u9664'b*': \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7531\u4e8e\u5f53\u524d\u76ee\u5f55\u4e0d\u5305\u62ec<code>b</code>\u5f00\u5934\u7684\u6587\u4ef6\u540d\uff0c\u5bfc\u81f4<code>b*</code>\u4e0d\u4f1a\u53d1\u751f\u6587\u4ef6\u540d\u6269\u5c55\uff0c\u4fdd\u6301\u539f\u6837\u4e0d\u53d8\uff0c\u6240\u4ee5<code>rm</code>\u547d\u4ee4\u62a5\u9519\u6ca1\u6709<code>b*</code>\u8fd9\u4e2a\u6587\u4ef6\u3002</p> <p>\u6253\u5f00<code>nullglob</code>\u53c2\u6570\uff0c\u5c31\u53ef\u4ee5\u8ba9\u4e0d\u5339\u914d\u7684\u901a\u914d\u7b26\u8fd4\u56de\u7a7a\u5b57\u7b26\u4e32\u3002</p> <pre><code>$ shopt -s nullglob\n$ rm b*\nrm: \u7f3a\u5c11\u64cd\u4f5c\u6570\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7531\u4e8e\u6ca1\u6709<code>b*</code>\u5339\u914d\u7684\u6587\u4ef6\u540d\uff0c\u6240\u4ee5<code>rm b*</code>\u6269\u5c55\u6210\u4e86<code>rm</code>\uff0c\u5bfc\u81f4\u62a5\u9519\u53d8\u6210\u4e86\u201d\u7f3a\u5c11\u64cd\u4f5c\u6570\u201c\u3002</p> <p>\uff083\uff09failglob \u53c2\u6570</p> <p><code>failglob</code>\u53c2\u6570\u4f7f\u5f97\u901a\u914d\u7b26\u4e0d\u5339\u914d\u4efb\u4f55\u6587\u4ef6\u540d\u65f6\uff0cBash \u4f1a\u76f4\u63a5\u62a5\u9519\uff0c\u800c\u4e0d\u662f\u8ba9\u5404\u4e2a\u547d\u4ee4\u53bb\u5904\u7406\u3002</p> <pre><code>$ shopt -s failglob\n$ rm b*\nbash: \u65e0\u5339\u914d: b*\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u6253\u5f00<code>failglob</code>\u4ee5\u540e\uff0c\u7531\u4e8e<code>b*</code>\u4e0d\u5339\u914d\u4efb\u4f55\u6587\u4ef6\u540d\uff0cBash \u76f4\u63a5\u62a5\u9519\u4e86\uff0c\u4e0d\u518d\u8ba9<code>rm</code>\u547d\u4ee4\u53bb\u5904\u7406\u3002</p> <p>\uff084\uff09extglob \u53c2\u6570</p> <p><code>extglob</code>\u53c2\u6570\u4f7f\u5f97 Bash \u652f\u6301 ksh \u7684\u4e00\u4e9b\u6269\u5c55\u8bed\u6cd5\u3002\u5b83\u9ed8\u8ba4\u5e94\u8be5\u662f\u6253\u5f00\u7684\u3002</p> <pre><code>$ shopt extglob\nextglob         on\n</code></pre> <p>\u5b83\u7684\u4e3b\u8981\u5e94\u7528\u662f\u652f\u6301\u91cf\u8bcd\u8bed\u6cd5\u3002\u5982\u679c\u4e0d\u5e0c\u671b\u652f\u6301\u91cf\u8bcd\u8bed\u6cd5\uff0c\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u5173\u95ed\u3002</p> <pre><code>$ shopt -u extglob\n</code></pre> <p>\uff085\uff09nocaseglob \u53c2\u6570</p> <p><code>nocaseglob</code>\u53c2\u6570\u53ef\u4ee5\u8ba9\u901a\u914d\u7b26\u6269\u5c55\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u3002</p> <pre><code>$ shopt -s nocaseglob\n$ ls /windows/program*\n/windows/ProgramData\n/windows/Program Files\n/windows/Program Files (x86)\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u6253\u5f00<code>nocaseglob</code>\u4ee5\u540e\uff0c<code>program*</code>\u5c31\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u4e86\uff0c\u53ef\u4ee5\u5339\u914d<code>ProgramData</code>\u7b49\u3002</p> <p>\uff086\uff09globstar \u53c2\u6570</p> <p><code>globstar</code>\u53c2\u6570\u53ef\u4ee5\u4f7f\u5f97<code>**</code>\u5339\u914d\u96f6\u4e2a\u6216\u591a\u4e2a\u5b50\u76ee\u5f55\u3002\u8be5\u53c2\u6570\u9ed8\u8ba4\u662f\u5173\u95ed\u7684\u3002</p> <p>\u5047\u8bbe\u6709\u4e0b\u9762\u7684\u6587\u4ef6\u7ed3\u6784\u3002</p> <pre><code>a.txt\nsub1/b.txt\nsub1/sub2/c.txt\n</code></pre> <p>\u4e0a\u9762\u7684\u6587\u4ef6\u7ed3\u6784\u4e2d\uff0c\u9876\u5c42\u76ee\u5f55\u3001\u7b2c\u4e00\u7ea7\u5b50\u76ee\u5f55<code>sub1</code>\u3001\u7b2c\u4e8c\u7ea7\u5b50\u76ee\u5f55<code>sub1\\sub2</code>\u91cc\u9762\u5404\u6709\u4e00\u4e2a\u6587\u672c\u6587\u4ef6\u3002\u8bf7\u95ee\u600e\u6837\u624d\u80fd\u4f7f\u7528\u901a\u914d\u7b26\uff0c\u5c06\u5b83\u4eec\u663e\u793a\u51fa\u6765\uff1f</p> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ea\u80fd\u5199\u6210\u4e0b\u9762\u8fd9\u6837\u3002</p> <pre><code>$ ls *.txt */*.txt */*/*.txt\na.txt  sub1/b.txt  sub1/sub2/c.txt\n</code></pre> <p>\u8fd9\u662f\u56e0\u4e3a<code>*</code>\u53ea\u5339\u914d\u5f53\u524d\u76ee\u5f55\uff0c\u5982\u679c\u8981\u5339\u914d\u5b50\u76ee\u5f55\uff0c\u53ea\u80fd\u4e00\u5c42\u5c42\u5199\u51fa\u6765\u3002</p> <p>\u6253\u5f00<code>globstar</code>\u53c2\u6570\u4ee5\u540e\uff0c<code>**</code>\u5339\u914d\u96f6\u4e2a\u6216\u591a\u4e2a\u5b50\u76ee\u5f55\u3002\u56e0\u6b64\uff0c<code>**/*.txt</code>\u5c31\u53ef\u4ee5\u5f97\u5230\u60f3\u8981\u7684\u7ed3\u679c\u3002</p> <pre><code>$ shopt -s globstar\n$ ls **/*.txt\na.txt  sub1/b.txt  sub1/sub2/c.txt\n</code></pre>"},{"location":"linux/bash/expansion/#_13","title":"\u53c2\u8003\u94fe\u63a5","text":"<ul> <li>Think You Understand Wildcards? Think Again</li> <li>Advanced Wildcard Patterns Most People Don\u2019t Know</li> </ul>"},{"location":"linux/bash/function/","title":"Bash \u51fd\u6570","text":"<p>\u672c\u7ae0\u4ecb\u7ecd Bash \u51fd\u6570\u7684\u7528\u6cd5\u3002</p>"},{"location":"linux/bash/function/#_1","title":"\u7b80\u4ecb","text":"<p>\u51fd\u6570\uff08function\uff09\u662f\u53ef\u4ee5\u91cd\u590d\u4f7f\u7528\u7684\u4ee3\u7801\u7247\u6bb5\uff0c\u6709\u5229\u4e8e\u4ee3\u7801\u7684\u590d\u7528\u3002\u5b83\u4e0e\u522b\u540d\uff08alias\uff09\u7684\u533a\u522b\u662f\uff0c\u522b\u540d\u53ea\u9002\u5408\u5c01\u88c5\u7b80\u5355\u7684\u5355\u4e2a\u547d\u4ee4\uff0c\u51fd\u6570\u5219\u53ef\u4ee5\u5c01\u88c5\u590d\u6742\u7684\u591a\u884c\u547d\u4ee4\u3002</p> <p>\u51fd\u6570\u603b\u662f\u5728\u5f53\u524d Shell \u6267\u884c\uff0c\u8fd9\u662f\u8ddf\u811a\u672c\u7684\u4e00\u4e2a\u91cd\u5927\u533a\u522b\uff0cBash \u4f1a\u65b0\u5efa\u4e00\u4e2a\u5b50 Shell \u6267\u884c\u811a\u672c\u3002\u5982\u679c\u51fd\u6570\u4e0e\u811a\u672c\u540c\u540d\uff0c\u51fd\u6570\u4f1a\u4f18\u5148\u6267\u884c\u3002\u4f46\u662f\uff0c\u51fd\u6570\u7684\u4f18\u5148\u7ea7\u4e0d\u5982\u522b\u540d\uff0c\u5373\u5982\u679c\u51fd\u6570\u4e0e\u522b\u540d\u540c\u540d\uff0c\u90a3\u4e48\u522b\u540d\u4f18\u5148\u6267\u884c\u3002</p> <p>Bash \u51fd\u6570\u5b9a\u4e49\u7684\u8bed\u6cd5\u6709\u4e24\u79cd\u3002</p> <pre><code># \u7b2c\u4e00\u79cd\nfn() {\n  # codes\n}\n\n# \u7b2c\u4e8c\u79cd\nfunction fn() {\n  # codes\n}\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>fn</code>\u662f\u81ea\u5b9a\u4e49\u7684\u51fd\u6570\u540d\uff0c\u51fd\u6570\u4ee3\u7801\u5c31\u5199\u5728\u5927\u62ec\u53f7\u4e4b\u4e2d\u3002\u8fd9\u4e24\u79cd\u5199\u6cd5\u662f\u7b49\u4ef7\u7684\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u7b80\u5355\u51fd\u6570\u7684\u4f8b\u5b50\u3002</p> <pre><code>hello() {\n  echo \"Hello $1\"\n}\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u51fd\u6570\u4f53\u91cc\u9762\u7684<code>$1</code>\u8868\u793a\u51fd\u6570\u8c03\u7528\u65f6\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u3002</p> <p>\u8c03\u7528\u65f6\uff0c\u5c31\u76f4\u63a5\u5199\u51fd\u6570\u540d\uff0c\u53c2\u6570\u8ddf\u5728\u51fd\u6570\u540d\u540e\u9762\u3002</p> <pre><code>$ hello world\nHello world\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u591a\u884c\u51fd\u6570\u7684\u4f8b\u5b50\uff0c\u663e\u793a\u5f53\u524d\u65e5\u671f\u65f6\u95f4\u3002</p> <pre><code>today() {\n  echo -n \"Today's date is: \"\n  date +\"%A, %B %-d, %Y\"\n}\n</code></pre> <p>\u5220\u9664\u4e00\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u4f7f\u7528<code>unset</code>\u547d\u4ee4\u3002</p> <pre><code>unset -f functionName\n</code></pre> <p>\u67e5\u770b\u5f53\u524d Shell \u5df2\u7ecf\u5b9a\u4e49\u7684\u6240\u6709\u51fd\u6570\uff0c\u53ef\u4ee5\u4f7f\u7528<code>declare</code>\u547d\u4ee4\u3002</p> <pre><code>$ declare -f\n</code></pre> <p>\u4e0a\u9762\u7684<code>declare</code>\u547d\u4ee4\u4e0d\u4ec5\u4f1a\u8f93\u51fa\u51fd\u6570\u540d\uff0c\u8fd8\u4f1a\u8f93\u51fa\u6240\u6709\u5b9a\u4e49\u3002\u8f93\u51fa\u987a\u5e8f\u662f\u6309\u7167\u51fd\u6570\u540d\u7684\u5b57\u6bcd\u8868\u987a\u5e8f\u3002\u7531\u4e8e\u4f1a\u8f93\u51fa\u5f88\u591a\u5185\u5bb9\uff0c\u6700\u597d\u901a\u8fc7\u7ba1\u9053\u547d\u4ee4\u914d\u5408<code>more</code>\u6216<code>less</code>\u4f7f\u7528\u3002</p> <p><code>declare</code>\u547d\u4ee4\u8fd8\u652f\u6301\u67e5\u770b\u5355\u4e2a\u51fd\u6570\u7684\u5b9a\u4e49\u3002</p> <pre><code>$ declare -f functionName\n</code></pre> <p><code>declare -F</code>\u53ef\u4ee5\u8f93\u51fa\u6240\u6709\u5df2\u7ecf\u5b9a\u4e49\u7684\u51fd\u6570\u540d\uff0c\u4e0d\u542b\u51fd\u6570\u4f53\u3002</p> <pre><code>$ declare -F\n</code></pre>"},{"location":"linux/bash/function/#_2","title":"\u53c2\u6570\u53d8\u91cf","text":"<p>\u51fd\u6570\u4f53\u5185\u53ef\u4ee5\u4f7f\u7528\u53c2\u6570\u53d8\u91cf\uff0c\u83b7\u53d6\u51fd\u6570\u53c2\u6570\u3002\u51fd\u6570\u7684\u53c2\u6570\u53d8\u91cf\uff0c\u4e0e\u811a\u672c\u53c2\u6570\u53d8\u91cf\u662f\u4e00\u81f4\u7684\u3002</p> <ul> <li><code>$1</code>~<code>$9</code>\uff1a\u51fd\u6570\u7684\u7b2c\u4e00\u4e2a\u5230\u7b2c9\u4e2a\u7684\u53c2\u6570\u3002</li> <li><code>$0</code>\uff1a\u51fd\u6570\u6240\u5728\u7684\u811a\u672c\u540d\u3002</li> <li><code>$#</code>\uff1a\u51fd\u6570\u7684\u53c2\u6570\u603b\u6570\u3002</li> <li><code>$@</code>\uff1a\u51fd\u6570\u7684\u5168\u90e8\u53c2\u6570\uff0c\u53c2\u6570\u4e4b\u95f4\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u3002</li> <li><code>$*</code>\uff1a\u51fd\u6570\u7684\u5168\u90e8\u53c2\u6570\uff0c\u53c2\u6570\u4e4b\u95f4\u4f7f\u7528\u53d8\u91cf<code>$IFS</code>\u503c\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u5206\u9694\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u683c\uff0c\u4f46\u662f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u3002</li> </ul> <p>\u5982\u679c\u51fd\u6570\u7684\u53c2\u6570\u591a\u4e8e9\u4e2a\uff0c\u90a3\u4e48\u7b2c10\u4e2a\u53c2\u6570\u53ef\u4ee5\u7528<code>${10}</code>\u7684\u5f62\u5f0f\u5f15\u7528\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u793a\u4f8b\u811a\u672c<code>test.sh</code>\u3002</p> <pre><code>#!/bin/bash\n# test.sh\n\nfunction alice {\n  echo \"alice: $@\"\n  echo \"$0: $1 $2 $3 $4\"\n  echo \"$# arguments\"\n\n}\n\nalice in wonderland\n</code></pre> <p>\u8fd0\u884c\u8be5\u811a\u672c\uff0c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ bash test.sh\nalice: in wonderland\ntest.sh: in wonderland\n2 arguments\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7531\u4e8e\u51fd\u6570<code>alice</code>\u53ea\u6709\u7b2c\u4e00\u4e2a\u548c\u7b2c\u4e8c\u4e2a\u53c2\u6570\uff0c\u6240\u4ee5\u7b2c\u4e09\u4e2a\u548c\u7b2c\u56db\u4e2a\u53c2\u6570\u4e3a\u7a7a\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u65e5\u5fd7\u51fd\u6570\u7684\u4f8b\u5b50\u3002</p> <pre><code>function log_msg {\n  echo \"[`date '+ %F %T'` ]: $@\"\n}\n</code></pre> <p>\u4f7f\u7528\u65b9\u6cd5\u5982\u4e0b\u3002</p> <pre><code>$ log_msg \"This is sample log message\"\n[ 2018-08-16 19:56:34 ]: This is sample log message\n</code></pre>"},{"location":"linux/bash/function/#return","title":"return \u547d\u4ee4","text":"<p><code>return</code>\u547d\u4ee4\u7528\u4e8e\u4ece\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u503c\u3002\u51fd\u6570\u6267\u884c\u5230\u8fd9\u6761\u547d\u4ee4\uff0c\u5c31\u4e0d\u518d\u5f80\u4e0b\u6267\u884c\u4e86\uff0c\u76f4\u63a5\u8fd4\u56de\u4e86\u3002</p> <pre><code>function func_return_value {\n  return 10\n}\n</code></pre> <p>\u51fd\u6570\u5c06\u8fd4\u56de\u503c\u8fd4\u56de\u7ed9\u8c03\u7528\u8005\u3002\u5982\u679c\u547d\u4ee4\u884c\u76f4\u63a5\u6267\u884c\u51fd\u6570\uff0c\u4e0b\u4e00\u4e2a\u547d\u4ee4\u53ef\u4ee5\u7528<code>$?</code>\u62ff\u5230\u8fd4\u56de\u503c\u3002</p> <pre><code>$ func_return_value\n$ echo \"Value returned by function is: $?\"\nValue returned by function is: 10\n</code></pre> <p><code>return</code>\u540e\u9762\u4e0d\u8ddf\u53c2\u6570\uff0c\u53ea\u7528\u4e8e\u8fd4\u56de\u4e5f\u662f\u53ef\u4ee5\u7684\u3002</p> <pre><code>function name {\n  commands\n  return\n}\n</code></pre>"},{"location":"linux/bash/function/#local","title":"\u5168\u5c40\u53d8\u91cf\u548c\u5c40\u90e8\u53d8\u91cf\uff0clocal \u547d\u4ee4","text":"<p>Bash \u51fd\u6570\u4f53\u5185\u76f4\u63a5\u58f0\u660e\u7684\u53d8\u91cf\uff0c\u5c5e\u4e8e\u5168\u5c40\u53d8\u91cf\uff0c\u6574\u4e2a\u811a\u672c\u90fd\u53ef\u4ee5\u8bfb\u53d6\u3002\u8fd9\u4e00\u70b9\u9700\u8981\u7279\u522b\u5c0f\u5fc3\u3002</p> <pre><code># \u811a\u672c test.sh\nfn () {\n  foo=1\n  echo \"fn: foo = $foo\"\n}\n\nfn\necho \"global: foo = $foo\"\n</code></pre> <p>\u4e0a\u9762\u811a\u672c\u7684\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ bash test.sh\nfn: foo = 1\nglobal: foo = 1\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53d8\u91cf<code>$foo</code>\u662f\u5728\u51fd\u6570<code>fn</code>\u5185\u90e8\u58f0\u660e\u7684\uff0c\u51fd\u6570\u4f53\u5916\u4e5f\u53ef\u4ee5\u8bfb\u53d6\u3002</p> <p>\u51fd\u6570\u4f53\u5185\u4e0d\u4ec5\u53ef\u4ee5\u58f0\u660e\u5168\u5c40\u53d8\u91cf\uff0c\u8fd8\u53ef\u4ee5\u4fee\u6539\u5168\u5c40\u53d8\u91cf\u3002</p> <pre><code>#! /bin/bash\nfoo=1\n\nfn () {\n  foo=2\n}\n\nfn\n\necho $foo\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u6267\u884c\u540e\uff0c\u8f93\u51fa\u7684\u53d8\u91cf<code>$foo</code>\u503c\u4e3a2\u3002</p> <p>\u51fd\u6570\u91cc\u9762\u53ef\u4ee5\u7528<code>local</code>\u547d\u4ee4\u58f0\u660e\u5c40\u90e8\u53d8\u91cf\u3002</p> <pre><code>#! /bin/bash\n# \u811a\u672c test.sh\nfn () {\n  local foo\n  foo=1\n  echo \"fn: foo = $foo\"\n}\n\nfn\necho \"global: foo = $foo\"\n</code></pre> <p>\u4e0a\u9762\u811a\u672c\u7684\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ bash test.sh\nfn: foo = 1\nglobal: foo =\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>local</code>\u547d\u4ee4\u58f0\u660e\u7684<code>$foo</code>\u53d8\u91cf\uff0c\u53ea\u5728\u51fd\u6570\u4f53\u5185\u6709\u6548\uff0c\u51fd\u6570\u4f53\u5916\u6ca1\u6709\u5b9a\u4e49\u3002</p>"},{"location":"linux/bash/function/#_3","title":"\u53c2\u8003\u94fe\u63a5","text":"<ul> <li>How to define and use functions in Linux Shell Script, by Pradeep Kumar</li> </ul>"},{"location":"linux/bash/grammar/","title":"Bash \u7684\u57fa\u672c\u8bed\u6cd5","text":"<p>\u672c\u7ae0\u4ecb\u7ecd Bash \u7684\u6700\u57fa\u672c\u8bed\u6cd5\u3002</p>"},{"location":"linux/bash/grammar/#echo","title":"echo \u547d\u4ee4","text":"<p>\u7531\u4e8e\u540e\u9762\u7684\u4f8b\u5b50\u4f1a\u5927\u91cf\u7528\u5230<code>echo</code>\u547d\u4ee4\uff0c\u8fd9\u91cc\u5148\u4ecb\u7ecd\u8fd9\u4e2a\u547d\u4ee4\u3002</p> <p><code>echo</code>\u547d\u4ee4\u7684\u4f5c\u7528\u662f\u5728\u5c4f\u5e55\u8f93\u51fa\u4e00\u884c\u6587\u672c\uff0c\u53ef\u4ee5\u5c06\u8be5\u547d\u4ee4\u7684\u53c2\u6570\u539f\u6837\u8f93\u51fa\u3002</p> <pre><code>$ echo hello world\nhello world\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>echo</code>\u7684\u53c2\u6570\u662f<code>hello world</code>\uff0c\u53ef\u4ee5\u539f\u6837\u8f93\u51fa\u3002</p> <p>\u5982\u679c\u60f3\u8981\u8f93\u51fa\u7684\u662f\u591a\u884c\u6587\u672c\uff0c\u5373\u5305\u62ec\u6362\u884c\u7b26\u3002\u8fd9\u65f6\u9700\u8981\u628a\u591a\u884c\u6587\u672c\u653e\u5728\u5f15\u53f7\u91cc\u9762\u3002</p> <pre><code>$ echo \"&lt;HTML&gt;\n    &lt;HEAD&gt;\n          &lt;TITLE&gt;Page Title&lt;/TITLE&gt;\n    &lt;/HEAD&gt;\n    &lt;BODY&gt;\n          Page body.\n    &lt;/BODY&gt;\n&lt;/HTML&gt;\"\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>echo</code>\u53ef\u4ee5\u539f\u6837\u8f93\u51fa\u591a\u884c\u6587\u672c\u3002</p>"},{"location":"linux/bash/grammar/#-n","title":"<code>-n</code>\u53c2\u6570","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c<code>echo</code>\u8f93\u51fa\u7684\u6587\u672c\u672b\u5c3e\u4f1a\u6709\u4e00\u4e2a\u56de\u8f66\u7b26\u3002<code>-n</code>\u53c2\u6570\u53ef\u4ee5\u53d6\u6d88\u672b\u5c3e\u7684\u56de\u8f66\u7b26\uff0c\u4f7f\u5f97\u4e0b\u4e00\u4e2a\u63d0\u793a\u7b26\u7d27\u8ddf\u5728\u8f93\u51fa\u5185\u5bb9\u7684\u540e\u9762\u3002</p> <pre><code>$ echo -n hello world\nhello world$\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>world</code>\u540e\u9762\u76f4\u63a5\u5c31\u662f\u4e0b\u4e00\u884c\u7684\u63d0\u793a\u7b26<code>$</code>\u3002</p> <pre><code>$ echo a;echo b\na\nb\n\n$ echo -n a;echo b\nab\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>-n</code>\u53c2\u6570\u53ef\u4ee5\u8ba9\u4e24\u4e2a<code>echo</code>\u547d\u4ee4\u7684\u8f93\u51fa\u8fde\u5728\u4e00\u8d77\uff0c\u51fa\u73b0\u5728\u540c\u4e00\u884c\u3002</p>"},{"location":"linux/bash/grammar/#-e","title":"<code>-e</code>\u53c2\u6570","text":"<p><code>-e</code>\u53c2\u6570\u4f1a\u89e3\u91ca\u5f15\u53f7\uff08\u53cc\u5f15\u53f7\u548c\u5355\u5f15\u53f7\uff09\u91cc\u9762\u7684\u7279\u6b8a\u5b57\u7b26\uff08\u6bd4\u5982\u6362\u884c\u7b26<code>\\n</code>\uff09\u3002\u5982\u679c\u4e0d\u4f7f\u7528<code>-e</code>\u53c2\u6570\uff0c\u5373\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5f15\u53f7\u4f1a\u8ba9\u7279\u6b8a\u5b57\u7b26\u53d8\u6210\u666e\u901a\u5b57\u7b26\uff0c<code>echo</code>\u4e0d\u89e3\u91ca\u5b83\u4eec\uff0c\u539f\u6837\u8f93\u51fa\u3002</p> <pre><code>$ echo \"Hello\\nWorld\"\nHello\\nWorld\n\n# \u53cc\u5f15\u53f7\u7684\u60c5\u51b5\n$ echo -e \"Hello\\nWorld\"\nHello\nWorld\n\n# \u5355\u5f15\u53f7\u7684\u60c5\u51b5\n$ echo -e 'Hello\\nWorld'\nHello\nWorld\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>-e</code>\u53c2\u6570\u4f7f\u5f97<code>\\n</code>\u89e3\u91ca\u4e3a\u6362\u884c\u7b26\uff0c\u5bfc\u81f4\u8f93\u51fa\u5185\u5bb9\u91cc\u9762\u51fa\u73b0\u6362\u884c\u3002</p>"},{"location":"linux/bash/grammar/#_1","title":"\u547d\u4ee4\u683c\u5f0f","text":"<p>\u547d\u4ee4\u884c\u73af\u5883\u4e2d\uff0c\u4e3b\u8981\u901a\u8fc7\u4f7f\u7528 Shell \u547d\u4ee4\uff0c\u8fdb\u884c\u5404\u79cd\u64cd\u4f5c\u3002Shell \u547d\u4ee4\u57fa\u672c\u90fd\u662f\u4e0b\u9762\u7684\u683c\u5f0f\u3002</p> <pre><code>$ command [ arg1 ... [ argN ]]\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>command</code>\u662f\u5177\u4f53\u7684\u547d\u4ee4\u6216\u8005\u4e00\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c<code>arg1 ... argN</code>\u662f\u4f20\u9012\u7ed9\u547d\u4ee4\u7684\u53c2\u6570\uff0c\u5b83\u4eec\u662f\u53ef\u9009\u7684\u3002</p> <pre><code>$ ls -l\n</code></pre> <p>\u4e0a\u9762\u8fd9\u4e2a\u547d\u4ee4\u4e2d\uff0c<code>ls</code>\u662f\u547d\u4ee4\uff0c<code>-l</code>\u662f\u53c2\u6570\u3002</p> <p>\u6709\u4e9b\u53c2\u6570\u662f\u547d\u4ee4\u7684\u914d\u7f6e\u9879\uff0c\u8fd9\u4e9b\u914d\u7f6e\u9879\u4e00\u822c\u90fd\u4ee5\u4e00\u4e2a\u8fde\u8bcd\u7ebf\u5f00\u5934\uff0c\u6bd4\u5982\u4e0a\u9762\u7684<code>-l</code>\u3002\u540c\u4e00\u4e2a\u914d\u7f6e\u9879\u5f80\u5f80\u6709\u957f\u548c\u77ed\u4e24\u79cd\u5f62\u5f0f\uff0c\u6bd4\u5982<code>-l</code>\u662f\u77ed\u5f62\u5f0f\uff0c<code>--list</code>\u662f\u957f\u5f62\u5f0f\uff0c\u5b83\u4eec\u7684\u4f5c\u7528\u5b8c\u5168\u76f8\u540c\u3002\u77ed\u5f62\u5f0f\u4fbf\u4e8e\u624b\u52a8\u8f93\u5165\uff0c\u957f\u5f62\u5f0f\u4e00\u822c\u7528\u5728\u811a\u672c\u4e4b\u4e2d\uff0c\u53ef\u8bfb\u6027\u66f4\u597d\uff0c\u5229\u4e8e\u89e3\u91ca\u81ea\u8eab\u7684\u542b\u4e49\u3002</p> <pre><code># \u77ed\u5f62\u5f0f\n$ ls -r\n\n# \u957f\u5f62\u5f0f\n$ ls --reverse\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>-r</code>\u662f\u77ed\u5f62\u5f0f\uff0c<code>--reverse</code>\u662f\u957f\u5f62\u5f0f\uff0c\u4f5c\u7528\u5b8c\u5168\u4e00\u6837\u3002\u524d\u8005\u4fbf\u4e8e\u8f93\u5165\uff0c\u540e\u8005\u4fbf\u4e8e\u7406\u89e3\u3002</p> <p>Bash \u5355\u4e2a\u547d\u4ee4\u4e00\u822c\u90fd\u662f\u4e00\u884c\uff0c\u7528\u6237\u6309\u4e0b\u56de\u8f66\u952e\uff0c\u5c31\u5f00\u59cb\u6267\u884c\u3002\u6709\u4e9b\u547d\u4ee4\u6bd4\u8f83\u957f\uff0c\u5199\u6210\u591a\u884c\u4f1a\u6709\u5229\u4e8e\u9605\u8bfb\u548c\u7f16\u8f91\uff0c\u8fd9\u65f6\u53ef\u4ee5\u5728\u6bcf\u4e00\u884c\u7684\u7ed3\u5c3e\u52a0\u4e0a\u53cd\u659c\u6760\uff0cBash \u5c31\u4f1a\u5c06\u4e0b\u4e00\u884c\u8ddf\u5f53\u524d\u884c\u653e\u5728\u4e00\u8d77\u89e3\u91ca\u3002</p> <pre><code>$ echo foo bar\n\n# \u7b49\u540c\u4e8e\n$ echo foo \\\nbar\n</code></pre>"},{"location":"linux/bash/grammar/#_2","title":"\u7a7a\u683c","text":"<p>Bash \u4f7f\u7528\u7a7a\u683c\uff08\u6216 Tab \u952e\uff09\u533a\u5206\u4e0d\u540c\u7684\u53c2\u6570\u3002</p> <pre><code>$ command foo bar\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>foo</code>\u548c<code>bar</code>\u4e4b\u95f4\u6709\u4e00\u4e2a\u7a7a\u683c\uff0c\u6240\u4ee5 Bash \u8ba4\u4e3a\u5b83\u4eec\u662f\u4e24\u4e2a\u53c2\u6570\u3002</p> <p>\u5982\u679c\u53c2\u6570\u4e4b\u95f4\u6709\u591a\u4e2a\u7a7a\u683c\uff0cBash \u4f1a\u81ea\u52a8\u5ffd\u7565\u591a\u4f59\u7684\u7a7a\u683c\u3002</p> <pre><code>$ echo this is a     test\nthis is a test\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>a</code>\u548c<code>test</code>\u4e4b\u95f4\u6709\u591a\u4e2a\u7a7a\u683c\uff0cBash \u4f1a\u5ffd\u7565\u591a\u4f59\u7684\u7a7a\u683c\u3002</p>"},{"location":"linux/bash/grammar/#_3","title":"\u5206\u53f7","text":"<p>\u5206\u53f7\uff08<code>;</code>\uff09\u662f\u547d\u4ee4\u7684\u7ed3\u675f\u7b26\uff0c\u4f7f\u5f97\u4e00\u884c\u53ef\u4ee5\u653e\u7f6e\u591a\u4e2a\u547d\u4ee4\uff0c\u4e0a\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u7ed3\u675f\u540e\uff0c\u518d\u6267\u884c\u7b2c\u4e8c\u4e2a\u547d\u4ee4\u3002</p> <pre><code>$ clear; ls\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0cBash \u5148\u6267\u884c<code>clear</code>\u547d\u4ee4\uff0c\u6267\u884c\u5b8c\u6210\u540e\uff0c\u518d\u6267\u884c<code>ls</code>\u547d\u4ee4\u3002</p> <p>\u6ce8\u610f\uff0c\u4f7f\u7528\u5206\u53f7\u65f6\uff0c\u7b2c\u4e8c\u4e2a\u547d\u4ee4\u603b\u662f\u63a5\u7740\u7b2c\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\uff0c\u4e0d\u7ba1\u7b2c\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u6210\u529f\u6216\u5931\u8d25\u3002</p>"},{"location":"linux/bash/grammar/#_4","title":"\u547d\u4ee4\u7684\u7ec4\u5408\u7b26<code>&amp;&amp;</code>\u548c<code>||</code>","text":"<p>\u9664\u4e86\u5206\u53f7\uff0cBash \u8fd8\u63d0\u4f9b\u4e24\u4e2a\u547d\u4ee4\u7ec4\u5408\u7b26<code>&amp;&amp;</code>\u548c<code>||</code>\uff0c\u5141\u8bb8\u66f4\u597d\u5730\u63a7\u5236\u591a\u4e2a\u547d\u4ee4\u4e4b\u95f4\u7684\u7ee7\u53d1\u5173\u7cfb\u3002</p> <pre><code>Command1 &amp;&amp; Command2\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u7684\u610f\u601d\u662f\uff0c\u5982\u679c<code>Command1</code>\u547d\u4ee4\u8fd0\u884c\u6210\u529f\uff0c\u5219\u7ee7\u7eed\u8fd0\u884c<code>Command2</code>\u547d\u4ee4\u3002</p> <pre><code>Command1 || Command2\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u7684\u610f\u601d\u662f\uff0c\u5982\u679c<code>Command1</code>\u547d\u4ee4\u8fd0\u884c\u5931\u8d25\uff0c\u5219\u7ee7\u7eed\u8fd0\u884c<code>Command2</code>\u547d\u4ee4\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u4f8b\u5b50\u3002</p> <pre><code>$ cat filelist.txt ; ls -l filelist.txt\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53ea\u8981<code>cat</code>\u547d\u4ee4\u6267\u884c\u7ed3\u675f\uff0c\u4e0d\u7ba1\u6210\u529f\u6216\u5931\u8d25\uff0c\u90fd\u4f1a\u7ee7\u7eed\u6267\u884c<code>ls</code>\u547d\u4ee4\u3002</p> <pre><code>$ cat filelist.txt &amp;&amp; ls -l filelist.txt\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53ea\u6709<code>cat</code>\u547d\u4ee4\u6267\u884c\u6210\u529f\uff0c\u624d\u4f1a\u7ee7\u7eed\u6267\u884c<code>ls</code>\u547d\u4ee4\u3002\u5982\u679c<code>cat</code>\u6267\u884c\u5931\u8d25\uff08\u6bd4\u5982\u4e0d\u5b58\u5728\u6587\u4ef6<code>flielist.txt</code>\uff09\uff0c\u90a3\u4e48<code>ls</code>\u547d\u4ee4\u5c31\u4e0d\u4f1a\u6267\u884c\u3002</p> <pre><code>$ mkdir foo || mkdir bar\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53ea\u6709<code>mkdir foo</code>\u547d\u4ee4\u6267\u884c\u5931\u8d25\uff08\u6bd4\u5982<code>foo</code>\u76ee\u5f55\u5df2\u7ecf\u5b58\u5728\uff09\uff0c\u624d\u4f1a\u7ee7\u7eed\u6267\u884c<code>mkdir bar</code>\u547d\u4ee4\u3002\u5982\u679c<code>mkdir foo</code>\u547d\u4ee4\u6267\u884c\u6210\u529f\uff0c\u5c31\u4e0d\u4f1a\u521b\u5efa<code>bar</code>\u76ee\u5f55\u4e86\u3002</p>"},{"location":"linux/bash/grammar/#type","title":"type \u547d\u4ee4","text":"<p>Bash \u672c\u8eab\u5185\u7f6e\u4e86\u5f88\u591a\u547d\u4ee4\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u6267\u884c\u5916\u90e8\u7a0b\u5e8f\u3002\u600e\u4e48\u77e5\u9053\u4e00\u4e2a\u547d\u4ee4\u662f\u5185\u7f6e\u547d\u4ee4\uff0c\u8fd8\u662f\u5916\u90e8\u7a0b\u5e8f\u5462\uff1f</p> <p><code>type</code>\u547d\u4ee4\u7528\u6765\u5224\u65ad\u547d\u4ee4\u7684\u6765\u6e90\u3002</p> <pre><code>$ type echo\necho is a shell builtin\n$ type ls\nls is hashed (/bin/ls)\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>type</code>\u547d\u4ee4\u544a\u8bc9\u6211\u4eec\uff0c<code>echo</code>\u662f\u5185\u90e8\u547d\u4ee4\uff0c<code>ls</code>\u662f\u5916\u90e8\u7a0b\u5e8f\uff08<code>/bin/ls</code>\uff09\u3002</p> <p><code>type</code>\u547d\u4ee4\u672c\u8eab\u4e5f\u662f\u5185\u7f6e\u547d\u4ee4\u3002</p> <pre><code>$ type type\ntype is a shell builtin\n</code></pre> <p>\u5982\u679c\u8981\u67e5\u770b\u4e00\u4e2a\u547d\u4ee4\u7684\u6240\u6709\u5b9a\u4e49\uff0c\u53ef\u4ee5\u4f7f\u7528<code>type</code>\u547d\u4ee4\u7684<code>-a</code>\u53c2\u6570\u3002</p> <pre><code>$ type -a echo\necho is shell builtin\necho is /usr/bin/echo\necho is /bin/echo\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u8868\u793a\uff0c<code>echo</code>\u547d\u4ee4\u5373\u662f\u5185\u7f6e\u547d\u4ee4\uff0c\u4e5f\u6709\u5bf9\u5e94\u7684\u5916\u90e8\u7a0b\u5e8f\u3002</p> <p><code>type</code>\u547d\u4ee4\u7684<code>-t</code>\u53c2\u6570\uff0c\u53ef\u4ee5\u8fd4\u56de\u4e00\u4e2a\u547d\u4ee4\u7684\u7c7b\u578b\uff1a\u522b\u540d\uff08alias\uff09\uff0c\u5173\u952e\u8bcd\uff08keyword\uff09\uff0c\u51fd\u6570\uff08function\uff09\uff0c\u5185\u7f6e\u547d\u4ee4\uff08builtin\uff09\u548c\u6587\u4ef6\uff08file\uff09\u3002</p> <pre><code>$ type -t bash\nfile\n$ type -t if\nkeyword\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>bash</code>\u662f\u6587\u4ef6\uff0c<code>if</code>\u662f\u5173\u952e\u8bcd\u3002</p>"},{"location":"linux/bash/grammar/#_5","title":"\u5feb\u6377\u952e","text":"<p>Bash \u63d0\u4f9b\u5f88\u591a\u5feb\u6377\u952e\uff0c\u53ef\u4ee5\u5927\u5927\u65b9\u4fbf\u64cd\u4f5c\u3002\u4e0b\u9762\u662f\u4e00\u4e9b\u6700\u5e38\u7528\u7684\u5feb\u6377\u952e\uff0c\u5b8c\u6574\u7684\u4ecb\u7ecd\u53c2\u89c1\u300a\u884c\u64cd\u4f5c\u300b\u4e00\u7ae0\u3002</p> <ul> <li><code>Ctrl + L</code>\uff1a\u6e05\u9664\u5c4f\u5e55\u5e76\u5c06\u5f53\u524d\u884c\u79fb\u5230\u9875\u9762\u9876\u90e8\u3002</li> <li><code>Ctrl + C</code>\uff1a\u4e2d\u6b62\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684\u547d\u4ee4\u3002</li> <li><code>Shift + PageUp</code>\uff1a\u5411\u4e0a\u6eda\u52a8\u3002</li> <li><code>Shift + PageDown</code>\uff1a\u5411\u4e0b\u6eda\u52a8\u3002</li> <li><code>Ctrl + U</code>\uff1a\u4ece\u5149\u6807\u4f4d\u7f6e\u5220\u9664\u5230\u884c\u9996\u3002</li> <li><code>Ctrl + K</code>\uff1a\u4ece\u5149\u6807\u4f4d\u7f6e\u5220\u9664\u5230\u884c\u5c3e\u3002</li> <li><code>Ctrl + D</code>\uff1a\u5173\u95ed Shell \u4f1a\u8bdd\u3002</li> <li><code>\u2191</code>\uff0c<code>\u2193</code>\uff1a\u6d4f\u89c8\u5df2\u6267\u884c\u547d\u4ee4\u7684\u5386\u53f2\u8bb0\u5f55\u3002</li> </ul> <p>\u9664\u4e86\u4e0a\u9762\u7684\u5feb\u6377\u952e\uff0cBash \u8fd8\u5177\u6709\u81ea\u52a8\u8865\u5168\u529f\u80fd\u3002\u547d\u4ee4\u8f93\u5165\u5230\u4e00\u534a\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u6309\u4e0b Tab \u952e\uff0cBash \u4f1a\u81ea\u52a8\u5b8c\u6210\u5269\u4e0b\u7684\u90e8\u5206\u3002\u6bd4\u5982\uff0c\u8f93\u5165<code>pw</code>\uff0c\u7136\u540e\u6309\u4e00\u4e0b Tab \u952e\uff0cBash \u4f1a\u81ea\u52a8\u8865\u4e0a<code>d</code>\u3002</p> <p>\u9664\u4e86\u547d\u4ee4\u7684\u81ea\u52a8\u8865\u5168\uff0cBash \u8fd8\u652f\u6301\u8def\u5f84\u7684\u81ea\u52a8\u8865\u5168\u3002\u6709\u65f6\uff0c\u9700\u8981\u8f93\u5165\u5f88\u957f\u7684\u8def\u5f84\uff0c\u8fd9\u65f6\u53ea\u9700\u8981\u8f93\u5165\u524d\u9762\u7684\u90e8\u5206\uff0c\u7136\u540e\u6309\u4e0b Tab \u952e\uff0c\u5c31\u4f1a\u81ea\u52a8\u8865\u5168\u540e\u9762\u7684\u90e8\u5206\u3002\u5982\u679c\u6709\u591a\u4e2a\u53ef\u80fd\u7684\u9009\u62e9\uff0c\u6309\u4e24\u6b21 Tab \u952e\uff0cBash \u4f1a\u663e\u793a\u6240\u6709\u9009\u9879\uff0c\u8ba9\u4f60\u9009\u62e9\u3002</p>"},{"location":"linux/bash/intro/","title":"Bash \u7b80\u4ecb","text":"<p>Bash \u662f Unix \u7cfb\u7edf\u548c Linux \u7cfb\u7edf\u7684\u4e00\u79cd Shell\uff08\u547d\u4ee4\u884c\u73af\u5883\uff09\uff0c\u662f\u76ee\u524d\u7edd\u5927\u591a\u6570 Linux \u53d1\u884c\u7248\u7684\u9ed8\u8ba4 Shell\u3002</p>"},{"location":"linux/bash/intro/#shell","title":"Shell \u7684\u542b\u4e49","text":"<p>\u5b66\u4e60 Bash\uff0c\u9996\u5148\u9700\u8981\u7406\u89e3 Shell \u662f\u4ec0\u4e48\u3002Shell \u8fd9\u4e2a\u5355\u8bcd\u7684\u539f\u610f\u662f\u201c\u5916\u58f3\u201d\uff0c\u8ddf kernel\uff08\u5185\u6838\uff09\u76f8\u5bf9\u5e94\uff0c\u6bd4\u55bb\u5185\u6838\u5916\u9762\u7684\u4e00\u5c42\uff0c\u5373\u7528\u6237\u8ddf\u5185\u6838\u4ea4\u4e92\u7684\u5bf9\u8bdd\u754c\u9762\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\uff0cShell \u8fd9\u4e2a\u8bcd\u6709\u591a\u79cd\u542b\u4e49\u3002</p> <p>\u9996\u5148\uff0cShell \u662f\u4e00\u4e2a\u7a0b\u5e8f\uff0c\u63d0\u4f9b\u4e00\u4e2a\u4e0e\u7528\u6237\u5bf9\u8bdd\u7684\u73af\u5883\u3002\u8fd9\u4e2a\u73af\u5883\u53ea\u6709\u4e00\u4e2a\u547d\u4ee4\u63d0\u793a\u7b26\uff0c\u8ba9\u7528\u6237\u4ece\u952e\u76d8\u8f93\u5165\u547d\u4ee4\uff0c\u6240\u4ee5\u53c8\u79f0\u4e3a\u547d\u4ee4\u884c\u73af\u5883\uff08command line interface\uff0c\u7b80\u5199\u4e3a CLI\uff09\u3002Shell \u63a5\u6536\u5230\u7528\u6237\u8f93\u5165\u7684\u547d\u4ee4\uff0c\u5c06\u547d\u4ee4\u9001\u5165\u64cd\u4f5c\u7cfb\u7edf\u6267\u884c\uff0c\u5e76\u5c06\u7ed3\u679c\u8fd4\u56de\u7ed9\u7528\u6237\u3002\u672c\u4e66\u4e2d\uff0c\u9664\u975e\u7279\u522b\u6307\u660e\uff0cShell \u6307\u7684\u5c31\u662f\u547d\u4ee4\u884c\u73af\u5883\u3002</p> <p>\u5176\u6b21\uff0cShell \u662f\u4e00\u4e2a\u547d\u4ee4\u89e3\u91ca\u5668\uff0c\u89e3\u91ca\u7528\u6237\u8f93\u5165\u7684\u547d\u4ee4\u3002\u5b83\u652f\u6301\u53d8\u91cf\u3001\u6761\u4ef6\u5224\u65ad\u3001\u5faa\u73af\u64cd\u4f5c\u7b49\u8bed\u6cd5\uff0c\u6240\u4ee5\u7528\u6237\u53ef\u4ee5\u7528 Shell \u547d\u4ee4\u5199\u51fa\u5404\u79cd\u5c0f\u7a0b\u5e8f\uff0c\u53c8\u79f0\u4e3a\u811a\u672c\uff08script\uff09\u3002\u8fd9\u4e9b\u811a\u672c\u90fd\u901a\u8fc7 Shell \u7684\u89e3\u91ca\u6267\u884c\uff0c\u800c\u4e0d\u901a\u8fc7\u7f16\u8bd1\u3002</p> <p>\u6700\u540e\uff0cShell \u662f\u4e00\u4e2a\u5de5\u5177\u7bb1\uff0c\u63d0\u4f9b\u4e86\u5404\u79cd\u5c0f\u5de5\u5177\uff0c\u4f9b\u7528\u6237\u65b9\u4fbf\u5730\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u7684\u529f\u80fd\u3002</p>"},{"location":"linux/bash/intro/#shell_1","title":"Shell \u7684\u79cd\u7c7b","text":"<p>Shell \u6709\u5f88\u591a\u79cd\uff0c\u53ea\u8981\u80fd\u7ed9\u7528\u6237\u63d0\u4f9b\u547d\u4ee4\u884c\u73af\u5883\u7684\u7a0b\u5e8f\uff0c\u90fd\u53ef\u4ee5\u770b\u4f5c\u662f Shell\u3002</p> <p>\u5386\u53f2\u4e0a\uff0c\u4e3b\u8981\u7684 Shell \u6709\u4e0b\u9762\u8fd9\u4e9b\u3002</p> <ul> <li>Bourne Shell\uff08sh\uff09</li> <li>Bourne Again shell\uff08bash\uff09</li> <li>C Shell\uff08csh\uff09</li> <li>TENEX C Shell\uff08tcsh\uff09</li> <li>Korn shell\uff08ksh\uff09</li> <li>Z Shell\uff08zsh\uff09</li> <li>Friendly Interactive Shell\uff08fish\uff09</li> </ul> <p>Bash \u662f\u76ee\u524d\u6700\u5e38\u7528\u7684 Shell\uff0c\u9664\u975e\u7279\u522b\u6307\u660e\uff0c\u4e0b\u6587\u7684 Shell \u548c Bash \u5f53\u4f5c\u540c\u4e49\u8bcd\u4f7f\u7528\uff0c\u53ef\u4ee5\u4e92\u6362\u3002</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u8fd0\u884c\u7684 Shell\u3002</p> <pre><code>$ echo $SHELL\n/bin/bash\n</code></pre> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u7684 Linux \u7cfb\u7edf\u5b89\u88c5\u7684\u6240\u6709 Shell\u3002</p> <pre><code>$ cat /etc/shells\n</code></pre> <p>\u4e0a\u9762\u4e24\u4e2a\u547d\u4ee4\u4e2d\uff0c<code>$</code>\u662f\u547d\u4ee4\u884c\u73af\u5883\u7684\u63d0\u793a\u7b26\uff0c\u7528\u6237\u53ea\u9700\u8981\u8f93\u5165\u63d0\u793a\u7b26\u540e\u9762\u7684\u5185\u5bb9\u3002</p> <p>Linux \u5141\u8bb8\u6bcf\u4e2a\u7528\u6237\u4f7f\u7528\u4e0d\u540c\u7684 Shell\uff0c\u7528\u6237\u7684\u9ed8\u8ba4 Shell \u4e00\u822c\u90fd\u662f Bash\uff0c\u6216\u8005\u4e0e Bash \u517c\u5bb9\u3002</p>"},{"location":"linux/bash/intro/#_1","title":"\u547d\u4ee4\u884c\u73af\u5883","text":""},{"location":"linux/bash/intro/#_2","title":"\u7ec8\u7aef\u6a21\u62df\u5668","text":"<p>\u5982\u679c\u662f\u4e0d\u5e26\u6709\u56fe\u5f62\u73af\u5883\u7684 Linux \u7cfb\u7edf\uff08\u6bd4\u5982\u4e13\u7528\u4e8e\u670d\u52a1\u5668\u7684\u7cfb\u7edf\uff09\uff0c\u542f\u52a8\u540e\u5c31\u76f4\u63a5\u662f\u547d\u4ee4\u884c\u73af\u5883\u3002</p> <p>\u4e0d\u8fc7\uff0c\u73b0\u5728\u5927\u90e8\u5206\u7684 Linux \u53d1\u884c\u7248\uff0c\u5c24\u5176\u662f\u9488\u5bf9\u666e\u901a\u7528\u6237\u7684\u53d1\u884c\u7248\uff0c\u90fd\u662f\u56fe\u5f62\u73af\u5883\u3002\u7528\u6237\u767b\u5f55\u7cfb\u7edf\u540e\uff0c\u81ea\u52a8\u8fdb\u5165\u56fe\u5f62\u73af\u5883\uff0c\u9700\u8981\u81ea\u5df1\u542f\u52a8\u7ec8\u7aef\u6a21\u62df\u5668\uff0c\u624d\u80fd\u8fdb\u5165\u547d\u4ee4\u884c\u73af\u5883\u3002</p> <p>\u6240\u8c13\u201c\u7ec8\u7aef\u6a21\u62df\u5668\u201d\uff08terminal emulator\uff09\u5c31\u662f\u4e00\u4e2a\u6a21\u62df\u547d\u4ee4\u884c\u7a97\u53e3\u7684\u7a0b\u5e8f\uff0c\u8ba9\u7528\u6237\u5728\u4e00\u4e2a\u7a97\u53e3\u4e2d\u4f7f\u7528\u547d\u4ee4\u884c\u73af\u5883\uff0c\u5e76\u4e14\u63d0\u4f9b\u5404\u79cd\u9644\u52a0\u529f\u80fd\uff0c\u6bd4\u5982\u8c03\u6574\u989c\u8272\u3001\u5b57\u4f53\u5927\u5c0f\u3001\u884c\u8ddd\u7b49\u7b49\u3002</p> <p>\u4e0d\u540c Linux \u53d1\u884c\u7248\uff08\u51c6\u786e\u5730\u8bf4\u662f\u4e0d\u540c\u7684\u684c\u9762\u73af\u5883\uff09\u5e26\u6709\u7684\u7ec8\u7aef\u7a0b\u5e8f\u662f\u4e0d\u4e00\u6837\u7684\uff0c\u6bd4\u5982 KDE \u684c\u9762\u73af\u5883\u7684\u7ec8\u7aef\u7a0b\u5e8f\u662f konsole\uff0cGnome \u684c\u9762\u73af\u5883\u7684\u7ec8\u7aef\u7a0b\u5e8f\u662f gnome-terminal\uff0c\u7528\u6237\u4e5f\u53ef\u4ee5\u5b89\u88c5\u7b2c\u4e09\u65b9\u7684\u7ec8\u7aef\u7a0b\u5e8f\u3002\u6240\u6709\u7ec8\u7aef\u7a0b\u5e8f\uff0c\u5c3d\u7ba1\u540d\u5b57\u4e0d\u540c\uff0c\u57fa\u672c\u529f\u80fd\u90fd\u662f\u4e00\u6837\u7684\uff0c\u5c31\u662f\u8ba9\u7528\u6237\u53ef\u4ee5\u8fdb\u5165\u547d\u4ee4\u884c\u73af\u5883\uff0c\u4f7f\u7528 Shell\u3002</p>"},{"location":"linux/bash/intro/#_3","title":"\u547d\u4ee4\u884c\u63d0\u793a\u7b26","text":"<p>\u8fdb\u5165\u547d\u4ee4\u884c\u73af\u5883\u4ee5\u540e\uff0c\u7528\u6237\u4f1a\u770b\u5230 Shell \u7684\u63d0\u793a\u7b26\u3002\u63d0\u793a\u7b26\u5f80\u5f80\u662f\u4e00\u4e32\u524d\u7f00\uff0c\u6700\u540e\u4ee5\u4e00\u4e2a\u7f8e\u5143\u7b26\u53f7<code>$</code>\u7ed3\u5c3e\uff0c\u7528\u6237\u53ef\u4ee5\u5728\u8fd9\u4e2a\u7b26\u53f7\u540e\u9762\u8f93\u5165\u5404\u79cd\u547d\u4ee4\u3002</p> <pre><code>[user@hostname] $\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5b8c\u6574\u7684\u63d0\u793a\u7b26\u662f<code>[user@hostname] $</code>\uff0c\u5176\u4e2d\u524d\u7f00\u662f\u7528\u6237\u540d\uff08<code>user</code>\uff09\u52a0\u4e0a<code>@</code>\uff0c\u518d\u52a0\u4e3b\u673a\u540d\uff08<code>hostname</code>\uff09\u3002\u6bd4\u5982\uff0c\u7528\u6237\u540d\u662f<code>bill</code>\uff0c\u4e3b\u673a\u540d\u662f<code>home-machine</code>\uff0c\u524d\u7f00\u5c31\u662f<code>bill@home-machine</code>\u3002</p> <p>\u6ce8\u610f\uff0c\u6839\u7528\u6237\uff08root\uff09\u7684\u63d0\u793a\u7b26\uff0c\u4e0d\u4ee5\u7f8e\u5143\u7b26\u53f7\uff08<code>$</code>\uff09\u7ed3\u5c3e\uff0c\u800c\u4ee5\u4e95\u53f7\uff08<code>#</code>\uff09\u7ed3\u5c3e\uff0c\u7528\u6765\u63d0\u9192\u7528\u6237\uff0c\u73b0\u5728\u5177\u6709\u6839\u6743\u9650\uff0c\u53ef\u4ee5\u6267\u884c\u5404\u79cd\u64cd\u4f5c\uff0c\u52a1\u5fc5\u5c0f\u5fc3\uff0c\u4e0d\u8981\u51fa\u73b0\u8bef\u64cd\u4f5c\u3002\u8fd9\u4e2a\u7b26\u53f7\u662f\u53ef\u4ee5\u81ea\u5df1\u5b9a\u4e49\u7684\uff0c\u8be6\u89c1\u300a\u547d\u4ee4\u63d0\u793a\u7b26\u300b\u4e00\u7ae0\u3002</p> <p>\u4e3a\u4e86\u7b80\u6d01\uff0c\u540e\u6587\u7684\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u90fd\u53ea\u4f7f\u7528<code>$</code>\u8868\u793a\u3002</p>"},{"location":"linux/bash/intro/#_4","title":"\u8fdb\u5165\u548c\u9000\u51fa\u65b9\u6cd5","text":"<p>\u8fdb\u5165\u547d\u4ee4\u884c\u73af\u5883\u4ee5\u540e\uff0c\u4e00\u822c\u5c31\u5df2\u7ecf\u6253\u5f00 Bash \u4e86\u3002\u5982\u679c\u4f60\u7684 Shell \u4e0d\u662f Bash\uff0c\u53ef\u4ee5\u8f93\u5165<code>bash</code>\u547d\u4ee4\u542f\u52a8 Bash\u3002</p> <pre><code>$ bash\n</code></pre> <p>\u9000\u51fa Bash \u73af\u5883\uff0c\u53ef\u4ee5\u4f7f\u7528<code>exit</code>\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u540c\u65f6\u6309\u4e0b<code>Ctrl + d</code>\u3002</p> <pre><code>$ exit\n</code></pre> <p>Bash \u7684\u57fa\u672c\u7528\u6cd5\u5c31\u662f\u5728\u547d\u4ee4\u884c\u8f93\u5165\u5404\u79cd\u547d\u4ee4\uff0c\u975e\u5e38\u76f4\u89c2\u3002\u4f5c\u4e3a\u7ec3\u4e60\uff0c\u53ef\u4ee5\u8bd5\u7740\u8f93\u5165<code>pwd</code>\u547d\u4ee4\u3002\u6309\u4e0b\u56de\u8f66\u952e\uff0c\u5c31\u4f1a\u663e\u793a\u5f53\u524d\u6240\u5728\u7684\u76ee\u5f55\u3002</p> <pre><code>$ pwd\n/home/me\n</code></pre> <p>\u5982\u679c\u4e0d\u5c0f\u5fc3\u8f93\u5165\u4e86<code>pwe</code>\uff0c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u63d0\u793a\uff0c\u8868\u793a\u8f93\u5165\u51fa\u9519\uff0c\u6ca1\u6709\u5bf9\u5e94\u7684\u53ef\u6267\u884c\u7a0b\u5e8f\u3002</p> <pre><code>$ pwe\nbash: pwe\uff1a\u672a\u627e\u5230\u547d\u4ee4\n</code></pre>"},{"location":"linux/bash/intro/#shell-bash","title":"Shell \u548c Bash \u7684\u5386\u53f2","text":"<p>Shell \u4f34\u968f\u7740 Unix \u7cfb\u7edf\u7684\u8bde\u751f\u800c\u8bde\u751f\u3002</p> <p>1969\u5e74\uff0cKen Thompson \u548c Dennis Ritchie \u5f00\u53d1\u4e86\u7b2c\u4e00\u7248\u7684 Unix\u3002</p> <p>1971\u5e74\uff0cKen Thompson \u7f16\u5199\u4e86\u6700\u521d\u7684 Shell\uff0c\u79f0\u4e3a Thompson shell\uff0c\u7a0b\u5e8f\u540d\u662f<code>sh</code>\uff0c\u65b9\u4fbf\u7528\u6237\u4f7f\u7528 Unix\u3002</p> <p>1973\u5e74\u81f31975\u5e74\u95f4\uff0cJohn R. Mashey \u6269\u5c55\u4e86\u6700\u521d\u7684 Thompson shell\uff0c\u6dfb\u52a0\u4e86\u7f16\u7a0b\u529f\u80fd\uff0c\u4f7f\u5f97 Shell \u6210\u4e3a\u4e00\u79cd\u7f16\u7a0b\u8bed\u8a00\u3002\u8fd9\u4e2a\u7248\u672c\u7684 Shell \u79f0\u4e3a Mashey shell\u3002</p> <p>1976\u5e74\uff0cStephen Bourne \u7ed3\u5408 Mashey shell \u7684\u529f\u80fd\uff0c\u91cd\u5199\u4e00\u4e2a\u65b0\u7684 Shell\uff0c\u79f0\u4e3a Bourne shell\u3002</p> <p>1978\u5e74\uff0c\u52a0\u5dde\u5927\u5b66\u4f2f\u514b\u5229\u5206\u6821\u7684 Bill Joy \u5f00\u53d1\u4e86 C shell\uff0c\u4e3a Shell \u63d0\u4f9b C \u8bed\u8a00\u7684\u8bed\u6cd5\uff0c\u7a0b\u5e8f\u540d\u662f<code>csh</code>\u3002\u5b83\u662f\u7b2c\u4e00\u4e2a\u771f\u6b63\u66ff\u4ee3<code>sh</code>\u7684 UNIX shell\uff0c\u88ab\u5408\u5e76\u5230 Berkeley UNIX \u7684 2BSD \u7248\u672c\u4e2d\u3002</p> <p>1979\u5e74\uff0cUNIX \u7b2c\u4e03\u7248\u53d1\u5e03\uff0c\u5185\u7f6e\u4e86 Bourne Shell\uff0c\u5bfc\u81f4\u5b83\u6210\u4e3a Unix \u7684\u9ed8\u8ba4 Shell\u3002\u6ce8\u610f\uff0cThompson shell\u3001Mashey shell \u548c Bourne shell \u90fd\u662f\u8d1d\u5c14\u5b9e\u9a8c\u5ba4\u7684\u4ea7\u54c1\uff0c\u7a0b\u5e8f\u540d\u90fd\u662f<code>sh</code>\u3002\u5bf9\u4e8e\u7528\u6237\u6765\u8bf4\uff0c\u5b83\u4eec\u662f\u540c\u4e00\u4e2a\u4e1c\u897f\uff0c\u53ea\u662f\u5e95\u5c42\u4ee3\u7801\u4e0d\u540c\u800c\u5df2\u3002</p> <p>1983\u5e74\uff0cDavid Korn \u5f00\u53d1\u4e86Korn shell\uff0c\u7a0b\u5e8f\u540d\u662f<code>ksh</code>\u3002</p> <p>1985\u5e74\uff0cRichard Stallman \u6210\u7acb\u4e86\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a\uff08FSF\uff09\uff0c\u7531\u4e8e Shell \u7684\u7248\u6743\u5c5e\u4e8e\u8d1d\u5c14\u516c\u53f8\uff0c\u6240\u4ee5\u4ed6\u51b3\u5b9a\u5199\u4e00\u4e2a\u81ea\u7531\u7248\u6743\u7684\u3001\u4f7f\u7528 GNU \u8bb8\u53ef\u8bc1\u7684 Shell \u7a0b\u5e8f\uff0c\u907f\u514d Unix \u7684\u7248\u6743\u4e89\u8bae\u3002</p> <p>1988\u5e74\uff0c\u81ea\u7531\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u7684\u7b2c\u4e00\u4e2a\u4ed8\u85aa\u7a0b\u5e8f\u5458 Brian Fox \u5199\u4e86\u4e00\u4e2a Shell\uff0c\u529f\u80fd\u57fa\u672c\u4e0a\u662f Bourne shell \u7684\u514b\u9686\uff0c\u53eb\u505a Bourne-Again SHell\uff0c\u7b80\u79f0 Bash\uff0c\u7a0b\u5e8f\u540d\u4e3a<code>bash</code>\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u514d\u8d39\u4f7f\u7528\u3002\u540e\u6765\uff0c\u5b83\u9010\u6e10\u6210\u4e3a Linux \u7cfb\u7edf\u7684\u6807\u51c6 Shell\u3002</p> <p>1989\u5e74\uff0cBash \u53d1\u5e031.0\u7248\u3002</p> <p>1996\u5e74\uff0cBash \u53d1\u5e032.0\u7248\u3002</p> <p>2004\u5e74\uff0cBash \u53d1\u5e033.0\u7248\u3002</p> <p>2009\u5e74\uff0cBash \u53d1\u5e034.0\u7248\u3002</p> <p>2019\u5e74\uff0cBash \u53d1\u5e035.0\u7248\u3002</p> <p>\u7528\u6237\u53ef\u4ee5\u901a\u8fc7<code>bash</code>\u547d\u4ee4\u7684<code>--version</code>\u53c2\u6570\u6216\u8005\u73af\u5883\u53d8\u91cf<code>$BASH_VERSION</code>\uff0c\u67e5\u770b\u672c\u673a\u7684 Bash \u7248\u672c\u3002</p> <pre><code>$ bash --version\nGNU bash\uff0c\u7248\u672c 5.0.3(1)-release (x86_64-pc-linux-gnu)\n\n# \u6216\u8005\n$ echo $BASH_VERSION\n5.0.3(1)-release\n</code></pre>"},{"location":"linux/bash/loop/","title":"\u5faa\u73af","text":"<p>Bash \u63d0\u4f9b\u4e09\u79cd\u5faa\u73af\u8bed\u6cd5<code>for</code>\u3001<code>while</code>\u548c<code>until</code>\u3002</p>"},{"location":"linux/bash/loop/#while","title":"while \u5faa\u73af","text":"<p><code>while</code>\u5faa\u73af\u6709\u4e00\u4e2a\u5224\u65ad\u6761\u4ef6\uff0c\u53ea\u8981\u7b26\u5408\u6761\u4ef6\uff0c\u5c31\u4e0d\u65ad\u5faa\u73af\u6267\u884c\u6307\u5b9a\u7684\u8bed\u53e5\u3002</p> <pre><code>while condition; do\n  commands\ndone\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u53ea\u8981\u6ee1\u8db3\u6761\u4ef6<code>condition</code>\uff0c\u5c31\u4f1a\u6267\u884c\u547d\u4ee4<code>commands</code>\u3002\u7136\u540e\uff0c\u518d\u6b21\u5224\u65ad\u662f\u5426\u6ee1\u8db3\u6761\u4ef6<code>condition</code>\uff0c\u53ea\u8981\u6ee1\u8db3\uff0c\u5c31\u4f1a\u4e00\u76f4\u6267\u884c\u4e0b\u53bb\u3002\u53ea\u6709\u4e0d\u6ee1\u8db3\u6761\u4ef6\uff0c\u624d\u4f1a\u9000\u51fa\u5faa\u73af\u3002</p> <p>\u5faa\u73af\u6761\u4ef6<code>condition</code>\u53ef\u4ee5\u4f7f\u7528<code>test</code>\u547d\u4ee4\uff0c\u8ddf<code>if</code>\u7ed3\u6784\u7684\u5224\u65ad\u6761\u4ef6\u5199\u6cd5\u4e00\u81f4\u3002</p> <pre><code>#!/bin/bash\n\nnumber=0\nwhile [ \"$number\" -lt 10 ]; do\n  echo \"Number = $number\"\n  number=$((number + 1))\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53ea\u8981\u53d8\u91cf<code>$number</code>\u5c0f\u4e8e10\uff0c\u5c31\u4f1a\u4e0d\u65ad\u52a01\uff0c\u76f4\u5230<code>$number</code>\u7b49\u4e8e10\uff0c\u7136\u540e\u9000\u51fa\u5faa\u73af\u3002</p> <p>\u5173\u952e\u5b57<code>do</code>\u53ef\u4ee5\u8ddf<code>while</code>\u4e0d\u5728\u540c\u4e00\u884c\uff0c\u8fd9\u65f6\u4e24\u8005\u4e4b\u95f4\u4e0d\u9700\u8981\u4f7f\u7528\u5206\u53f7\u5206\u9694\u3002</p> <pre><code>while true\ndo\n  echo 'Hi, while looping ...';\ndone\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4f1a\u65e0\u9650\u5faa\u73af\uff0c\u53ef\u4ee5\u6309\u4e0b Ctrl + c \u505c\u6b62\u3002</p> <p><code>while</code>\u5faa\u73af\u5199\u6210\u4e00\u884c\uff0c\u4e5f\u662f\u53ef\u4ee5\u7684\u3002</p> <pre><code>$ while true; do echo 'Hi, while looping ...'; done\n</code></pre> <p><code>while</code>\u7684\u6761\u4ef6\u90e8\u5206\u4e5f\u53ef\u4ee5\u662f\u6267\u884c\u4e00\u4e2a\u547d\u4ee4\u3002</p> <pre><code>$ while echo 'ECHO'; do echo 'Hi, while looping ...'; done\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5224\u65ad\u6761\u4ef6\u662f<code>echo 'ECHO'</code>\u3002\u7531\u4e8e\u8fd9\u4e2a\u547d\u4ee4\u603b\u662f\u6267\u884c\u6210\u529f\uff0c\u6240\u4ee5\u4e0a\u9762\u547d\u4ee4\u4f1a\u4ea7\u751f\u65e0\u9650\u5faa\u73af\u3002</p> <p><code>while</code>\u7684\u6761\u4ef6\u90e8\u5206\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u6570\u91cf\u7684\u547d\u4ee4\uff0c\u4f46\u662f\u6267\u884c\u7ed3\u679c\u7684\u771f\u4f2a\u53ea\u770b\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u3002</p> <pre><code>$ while true; false; do echo 'Hi, looping ...'; done\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u8fd0\u884c\u540e\uff0c\u4e0d\u4f1a\u6709\u4efb\u4f55\u8f93\u51fa\uff0c\u56e0\u4e3a<code>while</code>\u7684\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\u662f<code>false</code>\u3002</p>"},{"location":"linux/bash/loop/#until","title":"until \u5faa\u73af","text":"<p><code>until</code>\u5faa\u73af\u4e0e<code>while</code>\u5faa\u73af\u6070\u597d\u76f8\u53cd\uff0c\u53ea\u8981\u4e0d\u7b26\u5408\u5224\u65ad\u6761\u4ef6\uff08\u5224\u65ad\u6761\u4ef6\u5931\u8d25\uff09\uff0c\u5c31\u4e0d\u65ad\u5faa\u73af\u6267\u884c\u6307\u5b9a\u7684\u8bed\u53e5\u3002\u4e00\u65e6\u7b26\u5408\u5224\u65ad\u6761\u4ef6\uff0c\u5c31\u9000\u51fa\u5faa\u73af\u3002</p> <pre><code>until condition; do\n  commands\ndone\n</code></pre> <p>\u5173\u952e\u5b57<code>do</code>\u53ef\u4ee5\u4e0e<code>until</code>\u4e0d\u5199\u5728\u540c\u4e00\u884c\uff0c\u8fd9\u65f6\u4e24\u8005\u4e4b\u95f4\u4e0d\u9700\u8981\u5206\u53f7\u5206\u9694\u3002</p> <pre><code>until condition\ndo\n  commands\ndone\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>$ until false; do echo 'Hi, until looping ...'; done\nHi, until looping ...\nHi, until looping ...\nHi, until looping ...\n^C\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>until</code>\u7684\u90e8\u5206\u4e00\u76f4\u4e3a<code>false</code>\uff0c\u5bfc\u81f4\u547d\u4ee4\u65e0\u9650\u8fd0\u884c\uff0c\u5fc5\u987b\u6309\u4e0b Ctrl + c \u7ec8\u6b62\u3002</p> <pre><code>#!/bin/bash\n\nnumber=0\nuntil [ \"$number\" -ge 10 ]; do\n  echo \"Number = $number\"\n  number=$((number + 1))\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53ea\u8981\u53d8\u91cf<code>number</code>\u5c0f\u4e8e10\uff0c\u5c31\u4f1a\u4e0d\u65ad\u52a01\uff0c\u76f4\u5230<code>number</code>\u5927\u4e8e\u7b49\u4e8e10\uff0c\u5c31\u9000\u51fa\u5faa\u73af\u3002</p> <p><code>until</code>\u7684\u6761\u4ef6\u90e8\u5206\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u547d\u4ee4\uff0c\u8868\u793a\u5728\u8fd9\u4e2a\u547d\u4ee4\u6267\u884c\u6210\u529f\u4e4b\u524d\uff0c\u4e0d\u65ad\u91cd\u590d\u5c1d\u8bd5\u3002</p> <pre><code>until cp $1 $2; do\n  echo 'Attempt to copy failed. waiting...'\n  sleep 5\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u8868\u793a\uff0c\u53ea\u8981<code>cp $1 $2</code>\u8fd9\u4e2a\u547d\u4ee4\u6267\u884c\u4e0d\u6210\u529f\uff0c\u5c315\u79d2\u949f\u540e\u518d\u5c1d\u8bd5\u4e00\u6b21\uff0c\u76f4\u5230\u6210\u529f\u4e3a\u6b62\u3002</p> <p><code>until</code>\u5faa\u73af\u90fd\u53ef\u4ee5\u8f6c\u4e3a<code>while</code>\u5faa\u73af\uff0c\u53ea\u8981\u628a\u6761\u4ef6\u8bbe\u4e3a\u5426\u5b9a\u5373\u53ef\u3002\u4e0a\u9762\u8fd9\u4e2a\u4f8b\u5b50\u53ef\u4ee5\u6539\u5199\u5982\u4e0b\u3002</p> <pre><code>while ! cp $1 $2; do\n  echo 'Attempt to copy failed. waiting...'\n  sleep 5\ndone\n</code></pre> <p>\u4e00\u822c\u6765\u8bf4\uff0c<code>until</code>\u7528\u5f97\u6bd4\u8f83\u5c11\uff0c\u5b8c\u5168\u53ef\u4ee5\u7edf\u4e00\u90fd\u4f7f\u7528<code>while</code>\u3002</p>"},{"location":"linux/bash/loop/#forin","title":"for...in \u5faa\u73af","text":"<p><code>for...in</code>\u5faa\u73af\u7528\u4e8e\u904d\u5386\u5217\u8868\u7684\u6bcf\u4e00\u9879\u3002</p> <pre><code>for variable in list\ndo\n  commands\ndone\n</code></pre> <p>\u4e0a\u9762\u8bed\u6cd5\u4e2d\uff0c<code>for</code>\u5faa\u73af\u4f1a\u4f9d\u6b21\u4ece<code>list</code>\u5217\u8868\u4e2d\u53d6\u51fa\u4e00\u9879\uff0c\u4f5c\u4e3a\u53d8\u91cf<code>variable</code>\uff0c\u7136\u540e\u5728\u5faa\u73af\u4f53\u4e2d\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u5173\u952e\u8bcd<code>do</code>\u53ef\u4ee5\u8ddf<code>for</code>\u5199\u5728\u540c\u4e00\u884c\uff0c\u4e24\u8005\u4f7f\u7528\u5206\u53f7\u5206\u9694\u3002</p> <pre><code>for variable in list; do\n  commands\ndone\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>#!/bin/bash\n\nfor i in word1 word2 word3; do\n  echo $i\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>word1 word2 word3</code>\u662f\u4e00\u4e2a\u5305\u542b\u4e09\u4e2a\u5355\u8bcd\u7684\u5217\u8868\uff0c\u53d8\u91cf<code>i</code>\u4f9d\u6b21\u7b49\u4e8e<code>word1</code>\u3001<code>word2</code>\u3001<code>word3</code>\uff0c\u547d\u4ee4<code>echo $i</code>\u5219\u4f1a\u76f8\u5e94\u5730\u6267\u884c\u4e09\u6b21\u3002</p> <p>\u5217\u8868\u53ef\u4ee5\u7531\u901a\u914d\u7b26\u4ea7\u751f\u3002</p> <pre><code>for i in *.png; do\n  ls -l $i\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>*.png</code>\u4f1a\u66ff\u6362\u6210\u5f53\u524d\u76ee\u5f55\u4e2d\u6240\u6709 PNG \u56fe\u7247\u6587\u4ef6\uff0c\u53d8\u91cf<code>i</code>\u4f1a\u4f9d\u6b21\u7b49\u4e8e\u6bcf\u4e00\u4e2a\u6587\u4ef6\u3002</p> <p>\u5217\u8868\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5b50\u547d\u4ee4\u4ea7\u751f\u3002</p> <pre><code>#!/bin/bash\n\ncount=0\nfor i in $(cat ~/.bash_profile); do\n  count=$((count + 1))\n  echo \"Word $count ($i) contains $(echo -n $i | wc -c) characters\"\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>cat ~/.bash_profile</code>\u547d\u4ee4\u4f1a\u8f93\u51fa<code>~/.bash_profile</code>\u6587\u4ef6\u7684\u5185\u5bb9\uff0c\u7136\u540e\u901a\u8fc7\u904d\u5386\u6bcf\u4e00\u4e2a\u8bcd\uff0c\u8ba1\u7b97\u8be5\u6587\u4ef6\u4e00\u5171\u5305\u542b\u591a\u5c11\u4e2a\u8bcd\uff0c\u4ee5\u53ca\u6bcf\u4e2a\u8bcd\u6709\u591a\u5c11\u4e2a\u5b57\u7b26\u3002</p> <p><code>in list</code>\u7684\u90e8\u5206\u53ef\u4ee5\u7701\u7565\uff0c\u8fd9\u65f6<code>list</code>\u9ed8\u8ba4\u7b49\u4e8e\u811a\u672c\u7684\u6240\u6709\u53c2\u6570<code>$@</code>\u3002\u4f46\u662f\uff0c\u4e3a\u4e86\u53ef\u8bfb\u6027\uff0c\u6700\u597d\u8fd8\u662f\u4e0d\u8981\u7701\u7565\uff0c\u53c2\u8003\u4e0b\u9762\u7684\u4f8b\u5b50\u3002</p> <pre><code>for filename; do\n  echo \"$filename\"\ndone\n\n# \u7b49\u540c\u4e8e\n\nfor filename in \"$@\" ; do\n  echo \"$filename\"\ndone\n</code></pre> <p>\u5728\u51fd\u6570\u4f53\u4e2d\u4e5f\u662f\u4e00\u6837\u7684\uff0c<code>for...in</code>\u5faa\u73af\u7701\u7565<code>in list</code>\u7684\u90e8\u5206\uff0c\u5219<code>list</code>\u9ed8\u8ba4\u7b49\u4e8e\u51fd\u6570\u7684\u6240\u6709\u53c2\u6570\u3002</p>"},{"location":"linux/bash/loop/#for","title":"for \u5faa\u73af","text":"<p><code>for</code>\u5faa\u73af\u8fd8\u652f\u6301 C \u8bed\u8a00\u7684\u5faa\u73af\u8bed\u6cd5\u3002</p> <pre><code>for (( expression1; expression2; expression3 )); do\n  commands\ndone\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>expression1</code>\u7528\u6765\u521d\u59cb\u5316\u5faa\u73af\u6761\u4ef6\uff0c<code>expression2</code>\u7528\u6765\u51b3\u5b9a\u5faa\u73af\u7ed3\u675f\u7684\u6761\u4ef6\uff0c<code>expression3</code>\u5728\u6bcf\u6b21\u5faa\u73af\u8fed\u4ee3\u7684\u672b\u5c3e\u6267\u884c\uff0c\u7528\u4e8e\u66f4\u65b0\u503c\u3002</p> <p>\u6ce8\u610f\uff0c\u5faa\u73af\u6761\u4ef6\u653e\u5728\u53cc\u91cd\u5706\u62ec\u53f7\u4e4b\u4e2d\u3002\u53e6\u5916\uff0c\u5706\u62ec\u53f7\u4e4b\u4e2d\u4f7f\u7528\u53d8\u91cf\uff0c\u4e0d\u5fc5\u52a0\u4e0a\u7f8e\u5143\u7b26\u53f7<code>$</code>\u3002</p> <p>\u5b83\u7b49\u540c\u4e8e\u4e0b\u9762\u7684<code>while</code>\u5faa\u73af\u3002</p> <pre><code>(( expression1 ))\nwhile (( expression2 )); do\n  commands\n  (( expression3 ))\ndone\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>for (( i=0; i&lt;5; i=i+1 )); do\n  echo $i\ndone\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u521d\u59cb\u5316\u53d8\u91cf<code>i</code>\u7684\u503c\u4e3a0\uff0c\u5faa\u73af\u6267\u884c\u7684\u6761\u4ef6\u662f<code>i</code>\u5c0f\u4e8e5\u3002\u6bcf\u6b21\u5faa\u73af\u8fed\u4ee3\u7ed3\u675f\u65f6\uff0c<code>i</code>\u7684\u503c\u52a01\u3002</p> <p><code>for</code>\u6761\u4ef6\u90e8\u5206\u7684\u4e09\u4e2a\u8bed\u53e5\uff0c\u90fd\u53ef\u4ee5\u7701\u7565\u3002</p> <pre><code>for ((;;))\ndo\n  read var\n  if [ \"$var\" = \".\" ]; then\n    break\n  fi\ndone\n</code></pre> <p>\u4e0a\u9762\u811a\u672c\u4f1a\u53cd\u590d\u8bfb\u53d6\u547d\u4ee4\u884c\u8f93\u5165\uff0c\u76f4\u5230\u7528\u6237\u8f93\u5165\u4e86\u4e00\u4e2a\u70b9\uff08<code>.</code>\uff09\u4e3a\u6b62\uff0c\u624d\u4f1a\u8df3\u51fa\u5faa\u73af\u3002</p>"},{"location":"linux/bash/loop/#breakcontinue","title":"break\uff0ccontinue","text":"<p>Bash \u63d0\u4f9b\u4e86\u4e24\u4e2a\u5185\u90e8\u547d\u4ee4<code>break</code>\u548c<code>continue</code>\uff0c\u7528\u6765\u5728\u5faa\u73af\u5185\u90e8\u8df3\u51fa\u5faa\u73af\u3002</p> <p><code>break</code>\u547d\u4ee4\u7acb\u5373\u7ec8\u6b62\u5faa\u73af\uff0c\u7a0b\u5e8f\u7ee7\u7eed\u6267\u884c\u5faa\u73af\u5757\u4e4b\u540e\u7684\u8bed\u53e5\uff0c\u5373\u4e0d\u518d\u6267\u884c\u5269\u4e0b\u7684\u5faa\u73af\u3002</p> <pre><code>#!/bin/bash\n\nfor number in 1 2 3 4 5 6\ndo\n  echo \"number is $number\"\n  if [ \"$number\" = \"3\" ]; then\n    break\n  fi\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u53ea\u4f1a\u6253\u53703\u884c\u7ed3\u679c\u3002\u4e00\u65e6\u53d8\u91cf<code>$number</code>\u7b49\u4e8e3\uff0c\u5c31\u4f1a\u8df3\u51fa\u5faa\u73af\uff0c\u4e0d\u518d\u7ee7\u7eed\u6267\u884c\u3002</p> <p><code>continue</code>\u547d\u4ee4\u7acb\u5373\u7ec8\u6b62\u672c\u8f6e\u5faa\u73af\uff0c\u5f00\u59cb\u6267\u884c\u4e0b\u4e00\u8f6e\u5faa\u73af\u3002</p> <pre><code>#!/bin/bash\n\nwhile read -p \"What file do you want to test?\" filename\ndo\n  if [ ! -e \"$filename\" ]; then\n    echo \"The file does not exist.\"\n    continue\n  fi\n\n  echo \"You entered a valid file..\"\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53ea\u8981\u7528\u6237\u8f93\u5165\u7684\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c<code>continue</code>\u547d\u4ee4\u5c31\u4f1a\u751f\u6548\uff0c\u76f4\u63a5\u8fdb\u5165\u4e0b\u4e00\u8f6e\u5faa\u73af\uff08\u8ba9\u7528\u6237\u91cd\u65b0\u8f93\u5165\u6587\u4ef6\u540d\uff09\uff0c\u4e0d\u518d\u6267\u884c\u540e\u9762\u7684\u6253\u5370\u8bed\u53e5\u3002</p>"},{"location":"linux/bash/loop/#select","title":"select \u7ed3\u6784","text":"<p><code>select</code>\u7ed3\u6784\u4e3b\u8981\u7528\u6765\u751f\u6210\u7b80\u5355\u7684\u83dc\u5355\u3002\u5b83\u7684\u8bed\u6cd5\u4e0e<code>for...in</code>\u5faa\u73af\u57fa\u672c\u4e00\u81f4\u3002</p> <pre><code>select name\n[in list]\ndo\n  commands\ndone\n</code></pre> <p>Bash \u4f1a\u5bf9<code>select</code>\u4f9d\u6b21\u8fdb\u884c\u4e0b\u9762\u7684\u5904\u7406\u3002</p> <ol> <li><code>select</code>\u751f\u6210\u4e00\u4e2a\u83dc\u5355\uff0c\u5185\u5bb9\u662f\u5217\u8868<code>list</code>\u7684\u6bcf\u4e00\u9879\uff0c\u5e76\u4e14\u6bcf\u4e00\u9879\u524d\u9762\u8fd8\u6709\u4e00\u4e2a\u6570\u5b57\u7f16\u53f7\u3002</li> <li>Bash \u63d0\u793a\u7528\u6237\u9009\u62e9\u4e00\u9879\uff0c\u8f93\u5165\u5b83\u7684\u7f16\u53f7\u3002</li> <li>\u7528\u6237\u8f93\u5165\u4ee5\u540e\uff0cBash \u4f1a\u5c06\u8be5\u9879\u7684\u5185\u5bb9\u5b58\u5728\u53d8\u91cf<code>name</code>\uff0c\u8be5\u9879\u7684\u7f16\u53f7\u5b58\u5165\u73af\u5883\u53d8\u91cf<code>REPLY</code>\u3002\u5982\u679c\u7528\u6237\u6ca1\u6709\u8f93\u5165\uff0c\u5c31\u6309\u56de\u8f66\u952e\uff0cBash \u4f1a\u91cd\u65b0\u8f93\u51fa\u83dc\u5355\uff0c\u8ba9\u7528\u6237\u9009\u62e9\u3002</li> <li>\u6267\u884c\u547d\u4ee4\u4f53<code>commands</code>\u3002</li> <li>\u6267\u884c\u7ed3\u675f\u540e\uff0c\u56de\u5230\u7b2c\u4e00\u6b65\uff0c\u91cd\u590d\u8fd9\u4e2a\u8fc7\u7a0b\u3002</li> </ol> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>#!/bin/bash\n# select.sh\n\nselect brand in Samsung Sony iphone symphony Walton\ndo\n  echo \"You have chosen $brand\"\ndone\n</code></pre> <p>\u6267\u884c\u4e0a\u9762\u7684\u811a\u672c\uff0cBash \u4f1a\u8f93\u51fa\u4e00\u4e2a\u54c1\u724c\u7684\u5217\u8868\uff0c\u8ba9\u7528\u6237\u9009\u62e9\u3002</p> <pre><code>$ ./select.sh\n1) Samsung\n2) Sony\n3) iphone\n4) symphony\n5) Walton\n#?\n</code></pre> <p>\u5982\u679c\u7528\u6237\u6ca1\u6709\u8f93\u5165\u7f16\u53f7\uff0c\u76f4\u63a5\u6309\u56de\u8f66\u952e\u3002Bash \u5c31\u4f1a\u91cd\u65b0\u8f93\u51fa\u4e00\u904d\u8fd9\u4e2a\u83dc\u5355\uff0c\u76f4\u5230\u7528\u6237\u6309\u4e0b<code>Ctrl + c</code>\uff0c\u9000\u51fa\u6267\u884c\u3002</p> <p><code>select</code>\u53ef\u4ee5\u4e0e<code>case</code>\u7ed3\u5408\uff0c\u9488\u5bf9\u4e0d\u540c\u9879\uff0c\u6267\u884c\u4e0d\u540c\u7684\u547d\u4ee4\u3002</p> <pre><code>#!/bin/bash\n\necho \"Which Operating System do you like?\"\n\nselect os in Ubuntu LinuxMint Windows8 Windows10 WindowsXP\ndo\n  case $os in\n    \"Ubuntu\"|\"LinuxMint\")\n      echo \"I also use $os.\"\n    ;;\n    \"Windows8\" | \"Windows10\" | \"WindowsXP\")\n      echo \"Why don't you try Linux?\"\n    ;;\n    *)\n      echo \"Invalid entry.\"\n      break\n    ;;\n  esac\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>case</code>\u9488\u5bf9\u7528\u6237\u9009\u62e9\u7684\u4e0d\u540c\u9879\uff0c\u6267\u884c\u4e0d\u540c\u7684\u547d\u4ee4\u3002</p>"},{"location":"linux/bash/loop/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<ul> <li>Bash Select Command, Fahmida Yesmin</li> </ul>"},{"location":"linux/bash/mktemp/","title":"mktemp \u547d\u4ee4\uff0ctrap \u547d\u4ee4","text":"<p>Bash \u811a\u672c\u6709\u65f6\u9700\u8981\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\u6216\u4e34\u65f6\u76ee\u5f55\u3002\u5e38\u89c1\u7684\u505a\u6cd5\u662f\uff0c\u5728<code>/tmp</code>\u76ee\u5f55\u91cc\u9762\u521b\u5efa\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u8fd9\u6837\u505a\u6709\u5f88\u591a\u5f0a\u7aef\uff0c\u4f7f\u7528<code>mktemp</code>\u547d\u4ee4\u662f\u6700\u5b89\u5168\u7684\u505a\u6cd5\u3002</p>"},{"location":"linux/bash/mktemp/#_1","title":"\u4e34\u65f6\u6587\u4ef6\u7684\u5b89\u5168\u95ee\u9898","text":"<p>\u76f4\u63a5\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\uff0c\u5c24\u5176\u5728<code>/tmp</code>\u76ee\u5f55\u91cc\u9762\uff0c\u5f80\u5f80\u4f1a\u5bfc\u81f4\u5b89\u5168\u95ee\u9898\u3002</p> <p>\u9996\u5148\uff0c<code>/tmp</code>\u76ee\u5f55\u662f\u6240\u6709\u4eba\u53ef\u8bfb\u5199\u7684\uff0c\u4efb\u4f55\u7528\u6237\u90fd\u53ef\u4ee5\u5f80\u8be5\u76ee\u5f55\u91cc\u9762\u5199\u6587\u4ef6\u3002\u521b\u5efa\u7684\u4e34\u65f6\u6587\u4ef6\u4e5f\u662f\u6240\u6709\u4eba\u53ef\u8bfb\u7684\u3002</p> <pre><code>$ touch /tmp/info.txt\n$ ls -l /tmp/info.txt\n-rw-r--r-- 1 ruanyf ruanyf 0 12\u6708 28 17:12 /tmp/info.txt\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u5728<code>/tmp</code>\u76ee\u5f55\u76f4\u63a5\u521b\u5efa\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u9ed8\u8ba4\u662f\u6240\u6709\u4eba\u53ef\u8bfb\u7684\u3002</p> <p>\u5176\u6b21\uff0c\u5982\u679c\u653b\u51fb\u8005\u77e5\u9053\u4e34\u65f6\u6587\u4ef6\u7684\u6587\u4ef6\u540d\uff0c\u4ed6\u53ef\u4ee5\u521b\u5efa\u7b26\u53f7\u94fe\u63a5\uff0c\u94fe\u63a5\u5230\u4e34\u65f6\u6587\u4ef6\uff0c\u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u8fd0\u884c\u5f02\u5e38\u3002\u653b\u51fb\u8005\u4e5f\u53ef\u80fd\u5411\u811a\u672c\u63d0\u4f9b\u4e00\u4e9b\u6076\u610f\u6570\u636e\u3002\u56e0\u6b64\uff0c\u4e34\u65f6\u6587\u4ef6\u6700\u597d\u4f7f\u7528\u4e0d\u53ef\u9884\u6d4b\u3001\u6bcf\u6b21\u90fd\u4e0d\u4e00\u6837\u7684\u6587\u4ef6\u540d\uff0c\u9632\u6b62\u88ab\u5229\u7528\u3002</p> <p>\u6700\u540e\uff0c\u4e34\u65f6\u6587\u4ef6\u4f7f\u7528\u5b8c\u6bd5\uff0c\u5e94\u8be5\u5220\u9664\u3002\u4f46\u662f\uff0c\u811a\u672c\u610f\u5916\u9000\u51fa\u65f6\uff0c\u5f80\u5f80\u4f1a\u5ffd\u7565\u6e05\u7406\u4e34\u65f6\u6587\u4ef6\u3002</p> <p>\u751f\u6210\u4e34\u65f6\u6587\u4ef6\u5e94\u8be5\u9075\u5faa\u4e0b\u9762\u7684\u89c4\u5219\u3002</p> <ul> <li>\u521b\u5efa\u524d\u68c0\u67e5\u6587\u4ef6\u662f\u5426\u5df2\u7ecf\u5b58\u5728\u3002</li> <li>\u786e\u4fdd\u4e34\u65f6\u6587\u4ef6\u5df2\u6210\u529f\u521b\u5efa\u3002</li> <li>\u4e34\u65f6\u6587\u4ef6\u5fc5\u987b\u6709\u6743\u9650\u7684\u9650\u5236\u3002</li> <li>\u4e34\u65f6\u6587\u4ef6\u8981\u4f7f\u7528\u4e0d\u53ef\u9884\u6d4b\u7684\u6587\u4ef6\u540d\u3002</li> <li>\u811a\u672c\u9000\u51fa\u65f6\uff0c\u8981\u5220\u9664\u4e34\u65f6\u6587\u4ef6\uff08\u4f7f\u7528<code>trap</code>\u547d\u4ee4\uff09\u3002</li> </ul>"},{"location":"linux/bash/mktemp/#mktemp","title":"mktemp \u547d\u4ee4\u7684\u7528\u6cd5","text":"<p><code>mktemp</code>\u547d\u4ee4\u5c31\u662f\u4e3a\u5b89\u5168\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\u800c\u8bbe\u8ba1\u7684\u3002\u867d\u7136\u5728\u521b\u5efa\u4e34\u65f6\u6587\u4ef6\u4e4b\u524d\uff0c\u5b83\u4e0d\u4f1a\u68c0\u67e5\u4e34\u65f6\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u4f46\u662f\u5b83\u652f\u6301\u552f\u4e00\u6587\u4ef6\u540d\u548c\u6e05\u9664\u673a\u5236\uff0c\u56e0\u6b64\u53ef\u4ee5\u51cf\u8f7b\u5b89\u5168\u653b\u51fb\u7684\u98ce\u9669\u3002</p> <p>\u76f4\u63a5\u8fd0\u884c<code>mktemp</code>\u547d\u4ee4\uff0c\u5c31\u80fd\u751f\u6210\u4e00\u4e2a\u4e34\u65f6\u6587\u4ef6\u3002</p> <pre><code>$ mktemp\n/tmp/tmp.4GcsWSG4vj\n\n$ ls -l /tmp/tmp.4GcsWSG4vj\n-rw------- 1 ruanyf ruanyf 0 12\u6708 28 12:49 /tmp/tmp.4GcsWSG4vj\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>mktemp</code>\u547d\u4ee4\u751f\u6210\u7684\u4e34\u65f6\u6587\u4ef6\u540d\u662f\u968f\u673a\u7684\uff0c\u800c\u4e14\u6743\u9650\u662f\u53ea\u6709\u7528\u6237\u672c\u4eba\u53ef\u8bfb\u5199\u3002</p> <p>Bash \u811a\u672c\u4f7f\u7528<code>mktemp</code>\u547d\u4ee4\u7684\u7528\u6cd5\u5982\u4e0b\u3002</p> <pre><code>#!/bin/bash\n\nTMPFILE=$(mktemp)\necho \"Our temp file is $TMPFILE\"\n</code></pre> <p>\u4e3a\u4e86\u786e\u4fdd\u4e34\u65f6\u6587\u4ef6\u521b\u5efa\u6210\u529f\uff0c<code>mktemp</code>\u547d\u4ee4\u540e\u9762\u6700\u597d\u4f7f\u7528 OR \u8fd0\u7b97\u7b26\uff08<code>||</code>\uff09\uff0c\u4fdd\u8bc1\u521b\u5efa\u5931\u8d25\u65f6\u9000\u51fa\u811a\u672c\u3002</p> <pre><code>#!/bin/bash\n\nTMPFILE=$(mktemp) || exit 1\necho \"Our temp file is $TMPFILE\"\n</code></pre> <p>\u4e3a\u4e86\u4fdd\u8bc1\u811a\u672c\u9000\u51fa\u65f6\u4e34\u65f6\u6587\u4ef6\u88ab\u5220\u9664\uff0c\u53ef\u4ee5\u4f7f\u7528<code>trap</code>\u547d\u4ee4\u6307\u5b9a\u9000\u51fa\u65f6\u7684\u6e05\u9664\u64cd\u4f5c\u3002</p> <pre><code>#!/bin/bash\n\ntrap 'rm -f \"$TMPFILE\"' EXIT\n\nTMPFILE=$(mktemp) || exit 1\necho \"Our temp file is $TMPFILE\"\n</code></pre>"},{"location":"linux/bash/mktemp/#mktemp_1","title":"mktemp \u547d\u4ee4\u7684\u53c2\u6570","text":"<p><code>-d</code>\u53c2\u6570\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u76ee\u5f55\u3002</p> <pre><code>$ mktemp -d\n/tmp/tmp.Wcau5UjmN6\n</code></pre> <p><code>-p</code>\u53c2\u6570\u53ef\u4ee5\u6307\u5b9a\u4e34\u65f6\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\u3002\u9ed8\u8ba4\u662f\u4f7f\u7528<code>$TMPDIR</code>\u73af\u5883\u53d8\u91cf\u6307\u5b9a\u7684\u76ee\u5f55\uff0c\u5982\u679c\u8fd9\u4e2a\u53d8\u91cf\u6ca1\u8bbe\u7f6e\uff0c\u90a3\u4e48\u4f7f\u7528<code>/tmp</code>\u76ee\u5f55\u3002</p> <pre><code>$ mktemp -p /home/ruanyf/\n/home/ruanyf/tmp.FOKEtvs2H3\n</code></pre> <p><code>-t</code>\u53c2\u6570\u53ef\u4ee5\u6307\u5b9a\u4e34\u65f6\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u6a21\u677f\uff0c\u6a21\u677f\u7684\u672b\u5c3e\u5fc5\u987b\u81f3\u5c11\u5305\u542b\u4e09\u4e2a\u8fde\u7eed\u7684<code>X</code>\u5b57\u7b26\uff0c\u8868\u793a\u968f\u673a\u5b57\u7b26\uff0c\u5efa\u8bae\u81f3\u5c11\u4f7f\u7528\u516d\u4e2a<code>X</code>\u3002\u9ed8\u8ba4\u7684\u6587\u4ef6\u540d\u6a21\u677f\u662f<code>tmp.</code>\u540e\u63a5\u5341\u4e2a\u968f\u673a\u5b57\u7b26\u3002</p> <pre><code>$ mktemp -t mytemp.XXXXXXX\n/tmp/mytemp.yZ1HgZV\n</code></pre>"},{"location":"linux/bash/mktemp/#trap","title":"trap \u547d\u4ee4","text":"<p><code>trap</code>\u547d\u4ee4\u7528\u6765\u5728 Bash \u811a\u672c\u4e2d\u54cd\u5e94\u7cfb\u7edf\u4fe1\u53f7\u3002</p> <p>\u6700\u5e38\u89c1\u7684\u7cfb\u7edf\u4fe1\u53f7\u5c31\u662f SIGINT\uff08\u4e2d\u65ad\uff09\uff0c\u5373\u6309 Ctrl + C \u6240\u4ea7\u751f\u7684\u4fe1\u53f7\u3002<code>trap</code>\u547d\u4ee4\u7684<code>-l</code>\u53c2\u6570\uff0c\u53ef\u4ee5\u5217\u51fa\u6240\u6709\u7684\u7cfb\u7edf\u4fe1\u53f7\u3002</p> <pre><code>$ trap -l\n 1) SIGHUP   2) SIGINT   3) SIGQUIT  4) SIGILL   5) SIGTRAP\n 6) SIGABRT  7) SIGBUS   8) SIGFPE   9) SIGKILL 10) SIGUSR1\n11) SIGSEGV 12) SIGUSR2 13) SIGPIPE 14) SIGALRM 15) SIGTERM\n16) SIGSTKFLT   17) SIGCHLD 18) SIGCONT 19) SIGSTOP 20) SIGTSTP\n21) SIGTTIN 22) SIGTTOU 23) SIGURG  24) SIGXCPU 25) SIGXFSZ\n26) SIGVTALRM   27) SIGPROF 28) SIGWINCH    29) SIGIO   30) SIGPWR\n31) SIGSYS  34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3\n38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8\n43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13\n48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12\n53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7\n58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2\n63) SIGRTMAX-1  64) SIGRTMAX\n</code></pre> <p><code>trap</code>\u7684\u547d\u4ee4\u683c\u5f0f\u5982\u4e0b\u3002</p> <pre><code>$ trap [\u52a8\u4f5c] [\u4fe1\u53f71] [\u4fe1\u53f72] ...\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u201c\u52a8\u4f5c\u201d\u662f\u4e00\u4e2a Bash \u547d\u4ee4\uff0c\u201c\u4fe1\u53f7\u201d\u5e38\u7528\u7684\u6709\u4ee5\u4e0b\u51e0\u4e2a\u3002</p> <ul> <li>HUP\uff1a\u7f16\u53f71\uff0c\u811a\u672c\u4e0e\u6240\u5728\u7684\u7ec8\u7aef\u8131\u79bb\u8054\u7cfb\u3002</li> <li>INT\uff1a\u7f16\u53f72\uff0c\u7528\u6237\u6309\u4e0b Ctrl + C\uff0c\u610f\u56fe\u8ba9\u811a\u672c\u7ec8\u6b62\u8fd0\u884c\u3002</li> <li>QUIT\uff1a\u7f16\u53f73\uff0c\u7528\u6237\u6309\u4e0b Ctrl + \u659c\u6760\uff0c\u610f\u56fe\u9000\u51fa\u811a\u672c\u3002</li> <li>KILL\uff1a\u7f16\u53f79\uff0c\u8be5\u4fe1\u53f7\u7528\u4e8e\u6740\u6b7b\u8fdb\u7a0b\u3002</li> <li>TERM\uff1a\u7f16\u53f715\uff0c\u8fd9\u662f<code>kill</code>\u547d\u4ee4\u53d1\u51fa\u7684\u9ed8\u8ba4\u4fe1\u53f7\u3002</li> <li>EXIT\uff1a\u7f16\u53f70\uff0c\u8fd9\u4e0d\u662f\u7cfb\u7edf\u4fe1\u53f7\uff0c\u800c\u662f Bash \u811a\u672c\u7279\u6709\u7684\u4fe1\u53f7\uff0c\u4e0d\u7ba1\u4ec0\u4e48\u60c5\u51b5\uff0c\u53ea\u8981\u9000\u51fa\u811a\u672c\u5c31\u4f1a\u4ea7\u751f\u3002</li> </ul> <p><code>trap</code>\u547d\u4ee4\u54cd\u5e94<code>EXIT</code>\u4fe1\u53f7\u7684\u5199\u6cd5\u5982\u4e0b\u3002</p> <pre><code>$ trap 'rm -f \"$TMPFILE\"' EXIT\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c\u811a\u672c\u9047\u5230<code>EXIT</code>\u4fe1\u53f7\u65f6\uff0c\u5c31\u4f1a\u6267\u884c<code>rm -f \"$TMPFILE\"</code>\u3002</p> <p>trap \u547d\u4ee4\u7684\u5e38\u89c1\u4f7f\u7528\u573a\u666f\uff0c\u5c31\u662f\u5728 Bash \u811a\u672c\u4e2d\u6307\u5b9a\u9000\u51fa\u65f6\u6267\u884c\u7684\u6e05\u7406\u547d\u4ee4\u3002</p> <pre><code>#!/bin/bash\n\ntrap 'rm -f \"$TMPFILE\"' EXIT\n\nTMPFILE=$(mktemp) || exit 1\nls /etc &gt; $TMPFILE\nif grep -qi \"kernel\" $TMPFILE; then\n  echo 'find'\nfi\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u4e0d\u7ba1\u662f\u811a\u672c\u6b63\u5e38\u6267\u884c\u7ed3\u675f\uff0c\u8fd8\u662f\u7528\u6237\u6309 Ctrl + C \u7ec8\u6b62\uff0c\u90fd\u4f1a\u4ea7\u751f<code>EXIT</code>\u4fe1\u53f7\uff0c\u4ece\u800c\u89e6\u53d1\u5220\u9664\u4e34\u65f6\u6587\u4ef6\u3002</p> <p>\u6ce8\u610f\uff0c<code>trap</code>\u547d\u4ee4\u5fc5\u987b\u653e\u5728\u811a\u672c\u7684\u5f00\u5934\u3002\u5426\u5219\uff0c\u5b83\u4e0a\u65b9\u7684\u4efb\u4f55\u547d\u4ee4\u5bfc\u81f4\u811a\u672c\u9000\u51fa\uff0c\u90fd\u4e0d\u4f1a\u88ab\u5b83\u6355\u83b7\u3002</p> <p>\u5982\u679c<code>trap</code>\u9700\u8981\u89e6\u53d1\u591a\u6761\u547d\u4ee4\uff0c\u53ef\u4ee5\u5c01\u88c5\u4e00\u4e2a Bash \u51fd\u6570\u3002</p> <pre><code>function egress {\n  command1\n  command2\n  command3\n}\n\ntrap egress EXIT\n</code></pre>"},{"location":"linux/bash/mktemp/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<ul> <li>Working with Temporary Files and Directories in Shell Scripts, Steven Vona</li> <li>Using Trap to Exit Bash Scripts Cleanly</li> <li>Sending and Trapping Signals</li> </ul>"},{"location":"linux/bash/prompt/","title":"\u547d\u4ee4\u63d0\u793a\u7b26","text":"<p>\u7528\u6237\u8fdb\u5165 Bash \u4ee5\u540e\uff0cBash \u4f1a\u663e\u793a\u4e00\u4e2a\u547d\u4ee4\u63d0\u793a\u7b26\uff0c\u7528\u6765\u63d0\u793a\u7528\u6237\u5728\u8be5\u4f4d\u7f6e\u540e\u9762\u8f93\u5165\u547d\u4ee4\u3002</p>"},{"location":"linux/bash/prompt/#ps1","title":"\u73af\u5883\u53d8\u91cf PS1","text":"<p>\u547d\u4ee4\u63d0\u793a\u7b26\u901a\u5e38\u662f\u7f8e\u5143\u7b26\u53f7<code>$</code>\uff0c\u5bf9\u4e8e\u6839\u7528\u6237\u5219\u662f\u4e95\u53f7<code>#</code>\u3002\u8fd9\u4e2a\u7b26\u53f7\u662f\u73af\u5883\u53d8\u91cf<code>PS1</code>\u51b3\u5b9a\u7684\uff0c\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u770b\u5230\u5f53\u524d\u547d\u4ee4\u63d0\u793a\u7b26\u7684\u5b9a\u4e49\u3002</p> <pre><code>$ echo $PS1\n</code></pre> <p>Bash \u5141\u8bb8\u7528\u6237\u81ea\u5b9a\u4e49\u547d\u4ee4\u63d0\u793a\u7b26\uff0c\u53ea\u8981\u6539\u5199\u8fd9\u4e2a\u53d8\u91cf\u5373\u53ef\u3002\u6539\u5199\u540e\u7684<code>PS1</code>\uff0c\u53ef\u4ee5\u653e\u5728\u7528\u6237\u7684 Bash \u914d\u7f6e\u6587\u4ef6<code>.bashrc</code>\u91cc\u9762\uff0c\u4ee5\u540e\u65b0\u5efa Bash \u5bf9\u8bdd\u65f6\uff0c\u65b0\u7684\u63d0\u793a\u7b26\u5c31\u4f1a\u751f\u6548\u3002\u8981\u5728\u5f53\u524d\u7a97\u53e3\u770b\u5230\u4fee\u6539\u540e\u7684\u63d0\u793a\u7b26\uff0c\u53ef\u4ee5\u6267\u884c\u4e0b\u9762\u7684\u547d\u4ee4\u3002</p> <pre><code>$ source ~/.bashrc\n</code></pre> <p>\u547d\u4ee4\u63d0\u793a\u7b26\u7684\u5b9a\u4e49\uff0c\u53ef\u4ee5\u5305\u542b\u7279\u6b8a\u7684\u8f6c\u4e49\u5b57\u7b26\uff0c\u8868\u793a\u7279\u5b9a\u5185\u5bb9\u3002</p> <ul> <li><code>\\a</code>\uff1a\u54cd\u94c3\uff0c\u8ba1\u7b97\u673a\u53d1\u51fa\u4e00\u8bb0\u58f0\u97f3\u3002</li> <li><code>\\d</code>\uff1a\u4ee5\u661f\u671f\u3001\u6708\u3001\u65e5\u683c\u5f0f\u8868\u793a\u5f53\u524d\u65e5\u671f\uff0c\u4f8b\u5982\u201cMon May 26\u201d\u3002</li> <li><code>\\h</code>\uff1a\u672c\u673a\u7684\u4e3b\u673a\u540d\u3002</li> <li><code>\\H</code>\uff1a\u5b8c\u6574\u7684\u4e3b\u673a\u540d\u3002</li> <li><code>\\j</code>\uff1a\u8fd0\u884c\u5728\u5f53\u524d Shell \u4f1a\u8bdd\u7684\u5de5\u4f5c\u6570\u3002</li> <li><code>\\l</code>\uff1a\u5f53\u524d\u7ec8\u7aef\u8bbe\u5907\u540d\u3002</li> <li><code>\\n</code>\uff1a\u4e00\u4e2a\u6362\u884c\u7b26\u3002</li> <li><code>\\r</code>\uff1a\u4e00\u4e2a\u56de\u8f66\u7b26\u3002</li> <li><code>\\s</code>\uff1aShell \u7684\u540d\u79f0\u3002</li> <li><code>\\t</code>\uff1a24\u5c0f\u65f6\u5236\u7684<code>hours:minutes:seconds</code>\u683c\u5f0f\u8868\u793a\u5f53\u524d\u65f6\u95f4\u3002</li> <li><code>\\T</code>\uff1a12\u5c0f\u65f6\u5236\u7684\u5f53\u524d\u65f6\u95f4\u3002</li> <li><code>\\@</code>\uff1a12\u5c0f\u65f6\u5236\u7684<code>AM/PM</code>\u683c\u5f0f\u8868\u793a\u5f53\u524d\u65f6\u95f4\u3002</li> <li><code>\\A</code>\uff1a24\u5c0f\u65f6\u5236\u7684<code>hours:minutes</code>\u8868\u793a\u5f53\u524d\u65f6\u95f4\u3002</li> <li><code>\\u</code>\uff1a\u5f53\u524d\u7528\u6237\u540d\u3002</li> <li><code>\\v</code>\uff1aShell \u7684\u7248\u672c\u53f7\u3002</li> <li><code>\\V</code>\uff1aShell \u7684\u7248\u672c\u53f7\u548c\u53d1\u5e03\u53f7\u3002</li> <li><code>\\w</code>\uff1a\u5f53\u524d\u7684\u5de5\u4f5c\u8def\u5f84\u3002</li> <li><code>\\W</code>\uff1a\u5f53\u524d\u76ee\u5f55\u540d\u3002</li> <li><code>\\!</code>\uff1a\u5f53\u524d\u547d\u4ee4\u5728\u547d\u4ee4\u5386\u53f2\u4e2d\u7684\u7f16\u53f7\u3002</li> <li><code>\\#</code>\uff1a\u5f53\u524d shell \u4f1a\u8bdd\u4e2d\u7684\u547d\u4ee4\u6570\u3002</li> <li><code>\\$</code>\uff1a\u666e\u901a\u7528\u6237\u663e\u793a\u4e3a<code>$</code>\u5b57\u7b26\uff0c\u6839\u7528\u6237\u663e\u793a\u4e3a<code>#</code>\u5b57\u7b26\u3002</li> <li><code>\\[</code>\uff1a\u975e\u6253\u5370\u5b57\u7b26\u5e8f\u5217\u7684\u5f00\u59cb\u6807\u5fd7\u3002</li> <li><code>\\]</code>\uff1a\u975e\u6253\u5370\u5b57\u7b26\u5e8f\u5217\u7684\u7ed3\u675f\u6807\u5fd7\u3002</li> </ul> <p>\u4e3e\u4f8b\u6765\u8bf4\uff0c<code>[\\u@\\h \\W]\\$</code>\u8fd9\u4e2a\u63d0\u793a\u7b26\u5b9a\u4e49\uff0c\u663e\u793a\u51fa\u6765\u5c31\u662f<code>[user@host ~]$</code>\uff08\u5177\u4f53\u7684\u663e\u793a\u5185\u5bb9\u53d6\u51b3\u4e8e\u4f60\u7684\u7cfb\u7edf\uff09\u3002</p> <pre><code>[user@host ~]$ echo $PS1\n[\\u@\\h \\W]\\$\n</code></pre> <p>\u6539\u5199<code>PS1</code>\u53d8\u91cf\uff0c\u5c31\u53ef\u4ee5\u6539\u53d8\u8fd9\u4e2a\u547d\u4ee4\u63d0\u793a\u7b26\u3002</p> <pre><code>$ PS1=\"\\A \\h \\$ \"\n17:33 host $\n</code></pre> <p>\u6ce8\u610f\uff0c<code>$</code>\u540e\u9762\u6700\u597d\u8ddf\u4e00\u4e2a\u7a7a\u683c\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u7528\u6237\u7684\u8f93\u5165\u4e0e\u63d0\u793a\u7b26\u5c31\u4e0d\u4f1a\u8fde\u5728\u4e00\u8d77\u3002</p>"},{"location":"linux/bash/prompt/#_2","title":"\u989c\u8272","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u547d\u4ee4\u63d0\u793a\u7b26\u662f\u663e\u793a\u7ec8\u7aef\u9884\u5b9a\u4e49\u7684\u989c\u8272\u3002Bash \u5141\u8bb8\u81ea\u5b9a\u4e49\u63d0\u793a\u7b26\u989c\u8272\u3002</p> <p>\u4f7f\u7528\u4e0b\u9762\u7684\u4ee3\u7801\uff0c\u53ef\u4ee5\u8bbe\u5b9a\u5176\u540e\u6587\u672c\u7684\u989c\u8272\u3002</p> <ul> <li><code>\\033[0;30m</code>\uff1a\u9ed1\u8272</li> <li><code>\\033[1;30m</code>\uff1a\u6df1\u7070\u8272</li> <li><code>\\033[0;31m</code>\uff1a\u7ea2\u8272</li> <li><code>\\033[1;31m</code>\uff1a\u6d45\u7ea2\u8272</li> <li><code>\\033[0;32m</code>\uff1a\u7eff\u8272</li> <li><code>\\033[1;32m</code>\uff1a\u6d45\u7eff\u8272</li> <li><code>\\033[0;33m</code>\uff1a\u68d5\u8272</li> <li><code>\\033[1;33m</code>\uff1a\u9ec4\u8272</li> <li><code>\\033[0;34m</code>\uff1a\u84dd\u8272</li> <li><code>\\033[1;34m</code>\uff1a\u6d45\u84dd\u8272</li> <li><code>\\033[0;35m</code>\uff1a\u7c89\u7ea2</li> <li><code>\\033[1;35m</code>\uff1a\u6d45\u7c89\u8272</li> <li><code>\\033[0;36m</code>\uff1a\u9752\u8272</li> <li><code>\\033[1;36m</code>\uff1a\u6d45\u9752\u8272</li> <li><code>\\033[0;37m</code>\uff1a\u6d45\u7070\u8272</li> <li><code>\\033[1;37m</code>\uff1a\u767d\u8272</li> </ul> <p>\u4e3e\u4f8b\u6765\u8bf4\uff0c\u5982\u679c\u8981\u5c06\u63d0\u793a\u7b26\u8bbe\u4e3a\u7ea2\u8272\uff0c\u53ef\u4ee5\u5c06<code>PS1</code>\u8bbe\u6210\u4e0b\u9762\u7684\u4ee3\u7801\u3002</p> <pre><code>PS1='\\[\\033[0;31m\\]&lt;\\u@\\h \\W&gt;\\$'\n</code></pre> <p>\u4f46\u662f\uff0c\u4e0a\u9762\u8fd9\u6837\u8bbe\u7f6e\u4ee5\u540e\uff0c\u7528\u6237\u5728\u63d0\u793a\u7b26\u540e\u9762\u8f93\u5165\u7684\u6587\u672c\u4e5f\u662f\u7ea2\u8272\u7684\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c \u53ef\u4ee5\u5728\u7ed3\u5c3e\u6dfb\u52a0\u53e6\u4e00\u4e2a\u7279\u6b8a\u4ee3\u7801<code>\\[\\033[00m\\]</code>\uff0c\u8868\u793a\u5c06\u5176\u540e\u7684\u6587\u672c\u6062\u590d\u5230\u9ed8\u8ba4\u989c\u8272\u3002</p> <pre><code>PS1='\\[\\033[0;31m\\]&lt;\\u@\\h \\W&gt;\\$\\[\\033[00m\\]'\n</code></pre> <p>\u9664\u4e86\u8bbe\u7f6e\u524d\u666f\u989c\u8272\uff0cBash \u8fd8\u5141\u8bb8\u8bbe\u7f6e\u80cc\u666f\u989c\u8272\u3002</p> <ul> <li><code>\\033[0;40m</code>\uff1a\u84dd\u8272</li> <li><code>\\033[1;44m</code>\uff1a\u9ed1\u8272</li> <li><code>\\033[0;41m</code>\uff1a\u7ea2\u8272</li> <li><code>\\033[1;45m</code>\uff1a\u7c89\u7ea2</li> <li><code>\\033[0;42m</code>\uff1a\u7eff\u8272</li> <li><code>\\033[1;46m</code>\uff1a\u9752\u8272</li> <li><code>\\033[0;43m</code>\uff1a\u68d5\u8272</li> <li><code>\\033[1;47m</code>\uff1a\u6d45\u7070\u8272</li> </ul> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u5e26\u6709\u7ea2\u8272\u80cc\u666f\u7684\u63d0\u793a\u7b26\u3002</p> <pre><code>PS1='\\[\\033[0;41m\\]&lt;\\u@\\h \\W&gt;\\$\\[\\033[0m\\] '\n</code></pre>"},{"location":"linux/bash/prompt/#ps2ps3ps4","title":"\u73af\u5883\u53d8\u91cf PS2\uff0cPS3\uff0cPS4","text":"<p>\u9664\u4e86<code>PS1</code>\uff0cBash \u8fd8\u63d0\u4f9b\u4e86\u63d0\u793a\u7b26\u76f8\u5173\u7684\u53e6\u5916\u4e09\u4e2a\u73af\u5883\u53d8\u91cf\u3002</p> <p>\u73af\u5883\u53d8\u91cf<code>PS2</code>\u662f\u547d\u4ee4\u884c\u6298\u884c\u8f93\u5165\u65f6\u7cfb\u7edf\u7684\u63d0\u793a\u7b26\uff0c\u9ed8\u8ba4\u4e3a<code>&gt;</code>\u3002</p> <pre><code>$ echo \"hello\n&gt; world\"\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c\u8f93\u5165<code>hello</code>\u4ee5\u540e\u6309\u4e0b\u56de\u8f66\u952e\uff0c\u7cfb\u7edf\u4f1a\u63d0\u793a\u7ee7\u7eed\u8f93\u5165\u3002\u8fd9\u65f6\uff0c\u7b2c\u4e8c\u884c\u663e\u793a\u7684\u63d0\u793a\u7b26\u5c31\u662f<code>PS2</code>\u5b9a\u4e49\u7684<code>&gt;</code>\u3002</p> <p>\u73af\u5883\u53d8\u91cf<code>PS3</code>\u662f\u4f7f\u7528<code>select</code>\u547d\u4ee4\u65f6\uff0c\u7cfb\u7edf\u8f93\u5165\u83dc\u5355\u7684\u63d0\u793a\u7b26\u3002</p> <p>\u73af\u5883\u53d8\u91cf<code>PS4</code>\u9ed8\u8ba4\u4e3a<code>+</code>\u3002\u5b83\u662f\u4f7f\u7528 Bash \u7684<code>-x</code>\u53c2\u6570\u6267\u884c\u811a\u672c\u65f6\uff0c\u6bcf\u4e00\u884c\u547d\u4ee4\u5728\u6267\u884c\u524d\u90fd\u4f1a\u5148\u6253\u5370\u51fa\u6765\uff0c\u5e76\u4e14\u5728\u884c\u9996\u51fa\u73b0\u7684\u90a3\u4e2a\u63d0\u793a\u7b26\u3002</p> <p>\u6bd4\u5982\u4e0b\u9762\u662f\u811a\u672c<code>test.sh</code>\u3002</p> <pre><code>#!/bin/bash\n\necho \"hello world\"\n</code></pre> <p>\u4f7f\u7528<code>-x</code>\u53c2\u6570\u6267\u884c\u8fd9\u4e2a\u811a\u672c\u3002</p> <pre><code>$ bash -x test.sh\n+ echo 'hello world'\nhello world\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u8f93\u51fa\u7684\u7b2c\u4e00\u884c\u524d\u9762\u6709\u4e00\u4e2a<code>+</code>\uff0c\u8fd9\u5c31\u662f\u53d8\u91cf<code>PS4</code>\u5b9a\u4e49\u7684\u3002</p>"},{"location":"linux/bash/quotation/","title":"\u5f15\u53f7\u548c\u8f6c\u4e49","text":"<p>Bash \u53ea\u6709\u4e00\u79cd\u6570\u636e\u7c7b\u578b\uff0c\u5c31\u662f\u5b57\u7b26\u4e32\u3002\u4e0d\u7ba1\u7528\u6237\u8f93\u5165\u4ec0\u4e48\u6570\u636e\uff0cBash \u90fd\u89c6\u4e3a\u5b57\u7b26\u4e32\u3002\u56e0\u6b64\uff0c\u5b57\u7b26\u4e32\u76f8\u5173\u7684\u5f15\u53f7\u548c\u8f6c\u4e49\uff0c\u5bf9 Bash \u6765\u8bf4\u5c31\u975e\u5e38\u91cd\u8981\u3002</p>"},{"location":"linux/bash/quotation/#_2","title":"\u8f6c\u4e49","text":"<p>\u67d0\u4e9b\u5b57\u7b26\u5728 Bash \u91cc\u9762\u6709\u7279\u6b8a\u542b\u4e49\uff08\u6bd4\u5982<code>$</code>\u3001<code>&amp;</code>\u3001<code>*</code>\uff09\u3002</p> <pre><code>$ echo $date\n\n$\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u8f93\u51fa<code>$date</code>\u4e0d\u4f1a\u6709\u4efb\u4f55\u7ed3\u679c\uff0c\u56e0\u4e3a<code>$</code>\u662f\u4e00\u4e2a\u7279\u6b8a\u5b57\u7b26\u3002</p> <p>\u5982\u679c\u60f3\u8981\u539f\u6837\u8f93\u51fa\u8fd9\u4e9b\u7279\u6b8a\u5b57\u7b26\uff0c\u5c31\u5fc5\u987b\u5728\u5b83\u4eec\u524d\u9762\u52a0\u4e0a\u53cd\u659c\u6760\uff0c\u4f7f\u5176\u53d8\u6210\u666e\u901a\u5b57\u7b26\u3002\u8fd9\u5c31\u53eb\u505a\u201c\u8f6c\u4e49\u201d\uff08escape\uff09\u3002</p> <pre><code>$ echo \\$date\n$date\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c\u53ea\u6709\u5728\u7279\u6b8a\u5b57\u7b26<code>$</code>\u524d\u9762\u52a0\u53cd\u659c\u6760\uff0c\u624d\u80fd\u539f\u6837\u8f93\u51fa\u3002</p> <p>\u53cd\u659c\u6760\u672c\u8eab\u4e5f\u662f\u7279\u6b8a\u5b57\u7b26\uff0c\u5982\u679c\u60f3\u8981\u539f\u6837\u8f93\u51fa\u53cd\u659c\u6760\uff0c\u5c31\u9700\u8981\u5bf9\u5b83\u81ea\u8eab\u8f6c\u4e49\uff0c\u8fde\u7eed\u4f7f\u7528\u4e24\u4e2a\u53cd\u659c\u7ebf\uff08<code>\\\\</code>\uff09\u3002</p> <pre><code>$ echo \\\\\n\\\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u8f93\u51fa\u4e86\u53cd\u659c\u6760\u672c\u8eab\u3002</p> <p>\u53cd\u659c\u6760\u9664\u4e86\u7528\u4e8e\u8f6c\u4e49\uff0c\u8fd8\u53ef\u4ee5\u8868\u793a\u4e00\u4e9b\u4e0d\u53ef\u6253\u5370\u7684\u5b57\u7b26\u3002</p> <ul> <li><code>\\a</code>\uff1a\u54cd\u94c3</li> <li><code>\\b</code>\uff1a\u9000\u683c</li> <li><code>\\n</code>\uff1a\u6362\u884c</li> <li><code>\\r</code>\uff1a\u56de\u8f66</li> <li><code>\\t</code>\uff1a\u5236\u8868\u7b26</li> </ul> <p>\u5982\u679c\u60f3\u8981\u5728\u547d\u4ee4\u884c\u4f7f\u7528\u8fd9\u4e9b\u4e0d\u53ef\u6253\u5370\u7684\u5b57\u7b26\uff0c\u53ef\u4ee5\u628a\u5b83\u4eec\u653e\u5728\u5f15\u53f7\u91cc\u9762\uff0c\u7136\u540e\u4f7f\u7528<code>echo</code>\u547d\u4ee4\u7684<code>-e</code>\u53c2\u6570\u3002</p> <pre><code>$ echo a\\tb\natb\n\n$ echo -e \"a\\tb\"\na        b\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u547d\u4ee4\u884c\u76f4\u63a5\u8f93\u51fa\u4e0d\u53ef\u6253\u5370\u5b57\u7b26<code>\\t</code>\uff0cBash \u4e0d\u80fd\u6b63\u786e\u89e3\u91ca\u3002\u5fc5\u987b\u628a\u5b83\u4eec\u653e\u5728\u5f15\u53f7\u4e4b\u4e2d\uff0c\u7136\u540e\u4f7f\u7528<code>echo</code>\u547d\u4ee4\u7684<code>-e</code>\u53c2\u6570\u3002</p> <p>\u6362\u884c\u7b26\u662f\u4e00\u4e2a\u7279\u6b8a\u5b57\u7b26\uff0c\u8868\u793a\u547d\u4ee4\u7684\u7ed3\u675f\uff0cBash \u6536\u5230\u8fd9\u4e2a\u5b57\u7b26\u4ee5\u540e\uff0c\u5c31\u4f1a\u5bf9\u8f93\u5165\u7684\u547d\u4ee4\u8fdb\u884c\u89e3\u91ca\u6267\u884c\u3002\u6362\u884c\u7b26\u524d\u9762\u52a0\u4e0a\u53cd\u659c\u6760\u8f6c\u4e49\uff0c\u5c31\u4f7f\u5f97\u6362\u884c\u7b26\u53d8\u6210\u4e00\u4e2a\u666e\u901a\u5b57\u7b26\uff0cBash \u4f1a\u5c06\u5176\u5f53\u4f5c\u7a7a\u683c\u5904\u7406\uff0c\u4ece\u800c\u53ef\u4ee5\u5c06\u4e00\u884c\u547d\u4ee4\u5199\u6210\u591a\u884c\u3002</p> <pre><code>$ mv \\\n/path/to/foo \\\n/path/to/bar\n\n# \u7b49\u540c\u4e8e\n$ mv /path/to/foo /path/to/bar\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u4e00\u6761\u547d\u4ee4\u8fc7\u957f\uff0c\u5c31\u53ef\u4ee5\u5728\u884c\u5c3e\u4f7f\u7528\u53cd\u659c\u6760\uff0c\u5c06\u5176\u6539\u5199\u6210\u591a\u884c\u3002\u8fd9\u662f\u5e38\u89c1\u7684\u591a\u884c\u547d\u4ee4\u7684\u5199\u6cd5\u3002</p>"},{"location":"linux/bash/quotation/#_3","title":"\u5355\u5f15\u53f7","text":"<p>Bash \u5141\u8bb8\u5b57\u7b26\u4e32\u653e\u5728\u5355\u5f15\u53f7\u6216\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c\u52a0\u4ee5\u5f15\u7528\u3002</p> <p>\u5355\u5f15\u53f7\u7528\u4e8e\u4fdd\u7559\u5b57\u7b26\u7684\u5b57\u9762\u542b\u4e49\uff0c\u5404\u79cd\u7279\u6b8a\u5b57\u7b26\u5728\u5355\u5f15\u53f7\u91cc\u9762\uff0c\u90fd\u4f1a\u53d8\u4e3a\u666e\u901a\u5b57\u7b26\uff0c\u6bd4\u5982\u661f\u53f7\uff08<code>*</code>\uff09\u3001\u7f8e\u5143\u7b26\u53f7\uff08<code>$</code>\uff09\u3001\u53cd\u659c\u6760\uff08<code>\\</code>\uff09\u7b49\u3002</p> <pre><code>$ echo '*'\n*\n\n$ echo '$USER'\n$USER\n\n$ echo '$((2+2))'\n$((2+2))\n\n$ echo '$(echo foo)'\n$(echo foo)\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c\u5355\u5f15\u53f7\u4f7f\u5f97 Bash \u6269\u5c55\u3001\u53d8\u91cf\u5f15\u7528\u3001\u7b97\u672f\u8fd0\u7b97\u548c\u5b50\u547d\u4ee4\uff0c\u90fd\u5931\u6548\u4e86\u3002\u5982\u679c\u4e0d\u4f7f\u7528\u5355\u5f15\u53f7\uff0c\u5b83\u4eec\u90fd\u4f1a\u88ab Bash \u81ea\u52a8\u6269\u5c55\u3002</p> <p>\u7531\u4e8e\u53cd\u659c\u6760\u5728\u5355\u5f15\u53f7\u91cc\u9762\u53d8\u6210\u4e86\u666e\u901a\u5b57\u7b26\uff0c\u6240\u4ee5\u5982\u679c\u5355\u5f15\u53f7\u4e4b\u4e2d\uff0c\u8fd8\u8981\u4f7f\u7528\u5355\u5f15\u53f7\uff0c\u4e0d\u80fd\u4f7f\u7528\u8f6c\u4e49\uff0c\u9700\u8981\u5728\u5916\u5c42\u7684\u5355\u5f15\u53f7\u524d\u9762\u52a0\u4e0a\u4e00\u4e2a\u7f8e\u5143\u7b26\u53f7\uff08<code>$</code>\uff09\uff0c\u7136\u540e\u518d\u5bf9\u91cc\u5c42\u7684\u5355\u5f15\u53f7\u8f6c\u4e49\u3002</p> <pre><code># \u4e0d\u6b63\u786e\n$ echo it's\n\n# \u4e0d\u6b63\u786e\n$ echo 'it\\'s'\n\n# \u6b63\u786e\n$ echo $'it\\'s'\n</code></pre> <p>\u4e0d\u8fc7\uff0c\u66f4\u5408\u7406\u7684\u65b9\u6cd5\u662f\u6539\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\u4f7f\u7528\u5355\u5f15\u53f7\u3002</p> <pre><code>$ echo \"it's\"\nit's\n</code></pre>"},{"location":"linux/bash/quotation/#_4","title":"\u53cc\u5f15\u53f7","text":"<p>\u53cc\u5f15\u53f7\u6bd4\u5355\u5f15\u53f7\u5bbd\u677e\uff0c\u5927\u90e8\u5206\u7279\u6b8a\u5b57\u7b26\u5728\u53cc\u5f15\u53f7\u91cc\u9762\uff0c\u90fd\u4f1a\u5931\u53bb\u7279\u6b8a\u542b\u4e49\uff0c\u53d8\u6210\u666e\u901a\u5b57\u7b26\u3002</p> <pre><code>$ echo \"*\"\n*\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u901a\u914d\u7b26<code>*</code>\u662f\u4e00\u4e2a\u7279\u6b8a\u5b57\u7b26\uff0c\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c\u5c31\u53d8\u6210\u4e86\u666e\u901a\u5b57\u7b26\uff0c\u4f1a\u539f\u6837\u8f93\u51fa\u3002\u8fd9\u4e00\u70b9\u9700\u8981\u7279\u522b\u7559\u610f\uff0c\u8fd9\u610f\u5473\u7740\uff0c\u53cc\u5f15\u53f7\u91cc\u9762\u4e0d\u4f1a\u8fdb\u884c\u6587\u4ef6\u540d\u6269\u5c55\u3002</p> <p>\u4f46\u662f\uff0c\u4e09\u4e2a\u7279\u6b8a\u5b57\u7b26\u9664\u5916\uff1a\u7f8e\u5143\u7b26\u53f7\uff08<code>$</code>\uff09\u3001\u53cd\u5f15\u53f7\uff08<code>`</code>\uff09\u548c\u53cd\u659c\u6760\uff08<code>\\</code>\uff09\u3002\u8fd9\u4e09\u4e2a\u5b57\u7b26\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c\u4f9d\u7136\u6709\u7279\u6b8a\u542b\u4e49\uff0c\u4f1a\u88ab Bash \u81ea\u52a8\u6269\u5c55\u3002</p> <pre><code>$ echo \"$SHELL\"\n/bin/bash\n\n$ echo \"`date`\"\nMon Jan 27 13:33:18 CST 2020\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7f8e\u5143\u7b26\u53f7\uff08<code>$</code>\uff09\u548c\u53cd\u5f15\u53f7\uff08<code>`</code>\uff09\u5728\u53cc\u5f15\u53f7\u4e2d\uff0c\u90fd\u4fdd\u6301\u7279\u6b8a\u542b\u4e49\u3002\u7f8e\u5143\u7b26\u53f7\u7528\u6765\u5f15\u7528\u53d8\u91cf\uff0c\u53cd\u5f15\u53f7\u5219\u662f\u6267\u884c\u5b50\u547d\u4ee4\u3002</p> <pre><code>$ echo \"I'd say: \\\"hello!\\\"\"\nI'd say: \"hello!\"\n\n$ echo \"\\\\\"\n\\\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53cd\u659c\u6760\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\u4fdd\u6301\u7279\u6b8a\u542b\u4e49\uff0c\u7528\u6765\u8f6c\u4e49\u3002\u6240\u4ee5\uff0c\u53ef\u4ee5\u4f7f\u7528\u53cd\u659c\u6760\uff0c\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\u63d2\u5165\u53cc\u5f15\u53f7\uff0c\u6216\u8005\u63d2\u5165\u53cd\u659c\u6760\u672c\u8eab\u3002</p> <p>\u6362\u884c\u7b26\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c\u4f1a\u5931\u53bb\u7279\u6b8a\u542b\u4e49\uff0cBash \u4e0d\u518d\u5c06\u5176\u89e3\u91ca\u4e3a\u547d\u4ee4\u7684\u7ed3\u675f\uff0c\u53ea\u662f\u4f5c\u4e3a\u666e\u901a\u7684\u6362\u884c\u7b26\u3002\u6240\u4ee5\u53ef\u4ee5\u5229\u7528\u53cc\u5f15\u53f7\uff0c\u5728\u547d\u4ee4\u884c\u8f93\u5165\u591a\u884c\u6587\u672c\u3002</p> <pre><code>$ echo \"hello\nworld\"\nhello\nworld\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0cBash \u6b63\u5e38\u60c5\u51b5\u4e0b\u4f1a\u5c06\u6362\u884c\u7b26\u89e3\u91ca\u4e3a\u547d\u4ee4\u7ed3\u675f\uff0c\u4f46\u662f\u6362\u884c\u7b26\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\u5c31\u5931\u53bb\u4e86\u8fd9\u79cd\u7279\u6b8a\u4f5c\u7528\uff0c\u53ea\u7528\u6765\u6362\u884c\uff0c\u6240\u4ee5\u53ef\u4ee5\u8f93\u5165\u591a\u884c\u3002<code>echo</code>\u547d\u4ee4\u4f1a\u5c06\u6362\u884c\u7b26\u539f\u6837\u8f93\u51fa\uff0c\u663e\u793a\u7684\u65f6\u5019\u6b63\u5e38\u89e3\u91ca\u4e3a\u6362\u884c\u3002</p> <p>\u53cc\u5f15\u53f7\u7684\u53e6\u4e00\u4e2a\u5e38\u89c1\u7684\u4f7f\u7528\u573a\u5408\u662f\uff0c\u6587\u4ef6\u540d\u5305\u542b\u7a7a\u683c\u3002\u8fd9\u65f6\u5c31\u5fc5\u987b\u4f7f\u7528\u53cc\u5f15\u53f7\uff0c\u5c06\u6587\u4ef6\u540d\u653e\u5728\u91cc\u9762\u3002</p> <pre><code>$ ls \"two words.txt\"\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>two words.txt</code>\u662f\u4e00\u4e2a\u5305\u542b\u7a7a\u683c\u7684\u6587\u4ef6\u540d\uff0c\u5426\u5219\u5c31\u4f1a\u88ab Bash \u5f53\u4f5c\u4e24\u4e2a\u6587\u4ef6\u3002</p> <p>\u53cc\u5f15\u53f7\u4f1a\u539f\u6837\u4fdd\u5b58\u591a\u4f59\u7684\u7a7a\u683c\u3002</p> <pre><code>$ echo \"this is a     test\"\nthis is a     test\n</code></pre> <p>\u53cc\u5f15\u53f7\u8fd8\u6709\u4e00\u4e2a\u4f5c\u7528\uff0c\u5c31\u662f\u4fdd\u5b58\u539f\u59cb\u547d\u4ee4\u7684\u8f93\u51fa\u683c\u5f0f\u3002</p> <pre><code># \u5355\u884c\u8f93\u51fa\n$ echo $(cal)\n\u4e00\u6708 2020 \u65e5 \u4e00 \u4e8c \u4e09 \u56db \u4e94 \u516d 1 2 3 ... 31\n\n# \u539f\u59cb\u683c\u5f0f\u8f93\u51fa\n$ echo \"$(cal)\"\n      \u4e00\u6708 2020\n\u65e5 \u4e00 \u4e8c \u4e09 \u56db \u4e94 \u516d\n          1  2  3  4\n 5  6  7  8  9 10 11\n12 13 14 15 16 17 18\n19 20 21 22 23 24 25\n26 27 28 29 30 31\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c<code>$(cal)</code>\u4e0d\u653e\u5728\u53cc\u5f15\u53f7\u4e4b\u4e2d\uff0c<code>echo</code>\u5c31\u4f1a\u5c06\u6240\u6709\u7ed3\u679c\u4ee5\u5355\u884c\u8f93\u51fa\uff0c\u4e22\u5f03\u4e86\u6240\u6709\u539f\u59cb\u7684\u683c\u5f0f\u3002</p>"},{"location":"linux/bash/quotation/#here","title":"Here \u6587\u6863","text":"<p>Here \u6587\u6863\uff08here document\uff09\u662f\u4e00\u79cd\u8f93\u5165\u591a\u884c\u5b57\u7b26\u4e32\u7684\u65b9\u6cd5\uff0c\u683c\u5f0f\u5982\u4e0b\u3002</p> <pre><code>&lt;&lt; token\ntext\ntoken\n</code></pre> <p>\u5b83\u7684\u683c\u5f0f\u5206\u6210\u5f00\u59cb\u6807\u8bb0\uff08<code>&lt;&lt; token</code>\uff09\u548c\u7ed3\u675f\u6807\u8bb0\uff08<code>token</code>\uff09\u3002\u5f00\u59cb\u6807\u8bb0\u662f\u4e24\u4e2a\u5c0f\u4e8e\u53f7 + Here \u6587\u6863\u7684\u540d\u79f0\uff0c\u540d\u79f0\u53ef\u4ee5\u968f\u610f\u53d6\uff0c\u540e\u9762\u5fc5\u987b\u662f\u4e00\u4e2a\u6362\u884c\u7b26\uff1b\u7ed3\u675f\u6807\u8bb0\u662f\u5355\u72ec\u4e00\u884c\u9876\u683c\u5199\u7684 Here \u6587\u6863\u540d\u79f0\uff0c\u5982\u679c\u4e0d\u662f\u9876\u683c\uff0c\u7ed3\u675f\u6807\u8bb0\u4e0d\u8d77\u4f5c\u7528\u3002\u4e24\u8005\u4e4b\u95f4\u5c31\u662f\u591a\u884c\u5b57\u7b26\u4e32\u7684\u5185\u5bb9\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u901a\u8fc7 Here \u6587\u6863\u8f93\u51fa HTML \u4ee3\u7801\u7684\u4f8b\u5b50\u3002</p> <pre><code>$ cat &lt;&lt; _EOF_\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;\n    The title of your page\n    &lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n    Your page content goes here.\n&lt;/body&gt;\n&lt;/html&gt;\n_EOF_\n</code></pre> <p>Here \u6587\u6863\u5185\u90e8\u4f1a\u53d1\u751f\u53d8\u91cf\u66ff\u6362\uff0c\u540c\u65f6\u652f\u6301\u53cd\u659c\u6760\u8f6c\u4e49\uff0c\u4f46\u662f\u4e0d\u652f\u6301\u901a\u914d\u7b26\u6269\u5c55\uff0c\u53cc\u5f15\u53f7\u548c\u5355\u5f15\u53f7\u4e5f\u5931\u53bb\u8bed\u6cd5\u4f5c\u7528\uff0c\u53d8\u6210\u4e86\u666e\u901a\u5b57\u7b26\u3002</p> <pre><code>$ foo='hello world'\n$ cat &lt;&lt; _example_\n$foo\n\"$foo\"\n'$foo'\n_example_\n\nhello world\n\"hello world\"\n'hello world'\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53d8\u91cf<code>$foo</code>\u53d1\u751f\u4e86\u66ff\u6362\uff0c\u4f46\u662f\u53cc\u5f15\u53f7\u548c\u5355\u5f15\u53f7\u90fd\u539f\u6837\u8f93\u51fa\u4e86\uff0c\u8868\u660e\u5b83\u4eec\u5df2\u7ecf\u5931\u53bb\u4e86\u5f15\u7528\u7684\u529f\u80fd\u3002</p> <p>\u5982\u679c\u4e0d\u5e0c\u671b\u53d1\u751f\u53d8\u91cf\u66ff\u6362\uff0c\u53ef\u4ee5\u628a Here \u6587\u6863\u7684\u5f00\u59cb\u6807\u8bb0\u653e\u5728\u5355\u5f15\u53f7\u4e4b\u4e2d\u3002</p> <pre><code>$ foo='hello world'\n$ cat &lt;&lt; '_example_'\n$foo\n\"$foo\"\n'$foo'\n_example_\n\n$foo\n\"$foo\"\n'$foo'\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0cHere \u6587\u6863\u7684\u5f00\u59cb\u6807\u8bb0\uff08<code>_example_</code>\uff09\u653e\u5728\u5355\u5f15\u53f7\u4e4b\u4e2d\uff0c\u5bfc\u81f4\u53d8\u91cf\u66ff\u6362\u5931\u6548\u4e86\u3002</p> <p>Here \u6587\u6863\u7684\u672c\u8d28\u662f\u91cd\u5b9a\u5411\uff0c\u5b83\u5c06\u5b57\u7b26\u4e32\u91cd\u5b9a\u5411\u8f93\u51fa\u7ed9\u67d0\u4e2a\u547d\u4ee4\uff0c\u76f8\u5f53\u4e8e\u5305\u542b\u4e86<code>echo</code>\u547d\u4ee4\u3002</p> <pre><code>$ command &lt;&lt; token\n  string\ntoken\n\n# \u7b49\u540c\u4e8e\n\n$ echo string | command\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0cHere \u6587\u6863\u76f8\u5f53\u4e8e<code>echo</code>\u547d\u4ee4\u7684\u91cd\u5b9a\u5411\u3002</p> <p>\u6240\u4ee5\uff0cHere \u5b57\u7b26\u4e32\u53ea\u9002\u5408\u90a3\u4e9b\u53ef\u4ee5\u63a5\u53d7\u6807\u51c6\u8f93\u5165\u4f5c\u4e3a\u53c2\u6570\u7684\u547d\u4ee4\uff0c\u5bf9\u4e8e\u5176\u4ed6\u547d\u4ee4\u65e0\u6548\uff0c\u6bd4\u5982<code>echo</code>\u547d\u4ee4\u5c31\u4e0d\u80fd\u7528 Here \u6587\u6863\u4f5c\u4e3a\u53c2\u6570\u3002</p> <pre><code>$ echo &lt;&lt; _example_\nhello\n_example_\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e0d\u4f1a\u6709\u4efb\u4f55\u8f93\u51fa\uff0c\u56e0\u4e3a Here \u6587\u6863\u5bf9\u4e8e<code>echo</code>\u547d\u4ee4\u65e0\u6548\u3002</p> <p>\u6b64\u5916\uff0cHere \u6587\u6863\u4e5f\u4e0d\u80fd\u4f5c\u4e3a\u53d8\u91cf\u7684\u503c\uff0c\u53ea\u80fd\u7528\u4e8e\u547d\u4ee4\u7684\u53c2\u6570\u3002</p>"},{"location":"linux/bash/quotation/#here_1","title":"Here \u5b57\u7b26\u4e32","text":"<p>Here \u6587\u6863\u8fd8\u6709\u4e00\u4e2a\u53d8\u4f53\uff0c\u53eb\u505a Here \u5b57\u7b26\u4e32\uff08Here string\uff09\uff0c\u4f7f\u7528\u4e09\u4e2a\u5c0f\u4e8e\u53f7\uff08<code>&lt;&lt;&lt;</code>\uff09\u8868\u793a\u3002</p> <pre><code>&lt;&lt;&lt; string\n</code></pre> <p>\u5b83\u7684\u4f5c\u7528\u662f\u5c06\u5b57\u7b26\u4e32\u901a\u8fc7\u6807\u51c6\u8f93\u5165\uff0c\u4f20\u9012\u7ed9\u547d\u4ee4\u3002</p> <p>\u6709\u4e9b\u547d\u4ee4\u76f4\u63a5\u63a5\u53d7\u7ed9\u5b9a\u7684\u53c2\u6570\uff0c\u4e0e\u901a\u8fc7\u6807\u51c6\u8f93\u5165\u63a5\u53d7\u53c2\u6570\uff0c\u7ed3\u679c\u662f\u4e0d\u4e00\u6837\u7684\u3002\u6240\u4ee5\u624d\u6709\u4e86\u8fd9\u4e2a\u8bed\u6cd5\uff0c\u4f7f\u5f97\u5c06\u5b57\u7b26\u4e32\u901a\u8fc7\u6807\u51c6\u8f93\u5165\u4f20\u9012\u7ed9\u547d\u4ee4\u66f4\u65b9\u4fbf\uff0c\u6bd4\u5982<code>cat</code>\u547d\u4ee4\u53ea\u63a5\u53d7\u6807\u51c6\u8f93\u5165\u4f20\u5165\u7684\u5b57\u7b26\u4e32\u3002</p> <pre><code>$ cat &lt;&lt;&lt; 'hi there'\n# \u7b49\u540c\u4e8e\n$ echo 'hi there' | cat\n</code></pre> <p>\u4e0a\u9762\u7684\u7b2c\u4e00\u79cd\u8bed\u6cd5\u4f7f\u7528\u4e86 Here \u5b57\u7b26\u4e32\uff0c\u8981\u6bd4\u7b2c\u4e8c\u79cd\u8bed\u6cd5\u770b\u4e0a\u53bb\u8bed\u4e49\u66f4\u597d\uff0c\u4e5f\u66f4\u7b80\u6d01\u3002</p> <pre><code>$ md5sum &lt;&lt;&lt; 'ddd'\n# \u7b49\u540c\u4e8e\n$ echo 'ddd' | md5sum\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>md5sum</code>\u547d\u4ee4\u53ea\u80fd\u63a5\u53d7\u6807\u51c6\u8f93\u5165\u4f5c\u4e3a\u53c2\u6570\uff0c\u4e0d\u80fd\u76f4\u63a5\u5c06\u5b57\u7b26\u4e32\u653e\u5728\u547d\u4ee4\u540e\u9762\uff0c\u4f1a\u88ab\u5f53\u4f5c\u6587\u4ef6\u540d\uff0c\u5373<code>md5sum ddd</code>\u91cc\u9762\u7684<code>ddd</code>\u4f1a\u88ab\u89e3\u91ca\u6210\u6587\u4ef6\u540d\u3002\u8fd9\u65f6\u5c31\u53ef\u4ee5\u7528 Here \u5b57\u7b26\u4e32\uff0c\u5c06\u5b57\u7b26\u4e32\u4f20\u7ed9<code>md5sum</code>\u547d\u4ee4\u3002</p>"},{"location":"linux/bash/read/","title":"read \u547d\u4ee4","text":""},{"location":"linux/bash/read/#_1","title":"\u7528\u6cd5","text":"<p>\u6709\u65f6\uff0c\u811a\u672c\u9700\u8981\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u7531\u7528\u6237\u63d0\u4f9b\u4e00\u90e8\u5206\u6570\u636e\uff0c\u8fd9\u65f6\u53ef\u4ee5\u4f7f\u7528<code>read</code>\u547d\u4ee4\u3002\u5b83\u5c06\u7528\u6237\u7684\u8f93\u5165\u5b58\u5165\u4e00\u4e2a\u53d8\u91cf\uff0c\u65b9\u4fbf\u540e\u9762\u7684\u4ee3\u7801\u4f7f\u7528\u3002\u7528\u6237\u6309\u4e0b\u56de\u8f66\u952e\uff0c\u5c31\u8868\u793a\u8f93\u5165\u7ed3\u675f\u3002</p> <p><code>read</code>\u547d\u4ee4\u7684\u683c\u5f0f\u5982\u4e0b\u3002</p> <pre><code>read [-options] [variable...]\n</code></pre> <p>\u4e0a\u9762\u8bed\u6cd5\u4e2d\uff0c<code>options</code>\u662f\u53c2\u6570\u9009\u9879\uff0c<code>variable</code>\u662f\u7528\u6765\u4fdd\u5b58\u8f93\u5165\u6570\u503c\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u53d8\u91cf\u540d\u3002\u5982\u679c\u6ca1\u6709\u63d0\u4f9b\u53d8\u91cf\u540d\uff0c\u73af\u5883\u53d8\u91cf<code>REPLY</code>\u4f1a\u5305\u542b\u7528\u6237\u8f93\u5165\u7684\u4e00\u6574\u884c\u6570\u636e\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50<code>demo.sh</code>\u3002</p> <pre><code>#!/bin/bash\n\necho -n \"\u8f93\u5165\u4e00\u4e9b\u6587\u672c &gt; \"\nread text\necho \"\u4f60\u7684\u8f93\u5165\uff1a$text\"\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5148\u663e\u793a\u4e00\u884c\u63d0\u793a\u6587\u672c\uff0c\u7136\u540e\u4f1a\u7b49\u5f85\u7528\u6237\u8f93\u5165\u6587\u672c\u3002\u7528\u6237\u8f93\u5165\u7684\u6587\u672c\uff0c\u5b58\u5165\u53d8\u91cf<code>text</code>\uff0c\u5728\u4e0b\u4e00\u884c\u663e\u793a\u51fa\u6765\u3002</p> <pre><code>$ bash demo.sh\n\u8f93\u5165\u4e00\u4e9b\u6587\u672c &gt; \u4f60\u597d\uff0c\u4e16\u754c\n\u4f60\u7684\u8f93\u5165\uff1a\u4f60\u597d\uff0c\u4e16\u754c\n</code></pre> <p><code>read</code>\u53ef\u4ee5\u63a5\u53d7\u7528\u6237\u8f93\u5165\u7684\u591a\u4e2a\u503c\u3002</p> <pre><code>#!/bin/bash\necho Please, enter your firstname and lastname\nread FN LN\necho \"Hi! $LN, $FN !\"\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>read</code>\u6839\u636e\u7528\u6237\u7684\u8f93\u5165\uff0c\u540c\u65f6\u4e3a\u4e24\u4e2a\u53d8\u91cf\u8d4b\u503c\u3002</p> <p>\u5982\u679c\u7528\u6237\u7684\u8f93\u5165\u9879\u5c11\u4e8e<code>read</code>\u547d\u4ee4\u7ed9\u51fa\u7684\u53d8\u91cf\u6570\u76ee\uff0c\u90a3\u4e48\u989d\u5916\u7684\u53d8\u91cf\u503c\u4e3a\u7a7a\u3002\u5982\u679c\u7528\u6237\u7684\u8f93\u5165\u9879\u591a\u4e8e\u5b9a\u4e49\u7684\u53d8\u91cf\uff0c\u90a3\u4e48\u591a\u4f59\u7684\u8f93\u5165\u9879\u4f1a\u5305\u542b\u5230\u6700\u540e\u4e00\u4e2a\u53d8\u91cf\u4e2d\u3002</p> <p>\u5982\u679c<code>read</code>\u547d\u4ee4\u4e4b\u540e\u6ca1\u6709\u5b9a\u4e49\u53d8\u91cf\u540d\uff0c\u90a3\u4e48\u73af\u5883\u53d8\u91cf<code>REPLY</code>\u4f1a\u5305\u542b\u6240\u6709\u7684\u8f93\u5165\u3002</p> <pre><code>#!/bin/bash\n# read-single: read multiple values into default variable\necho -n \"Enter one or more values &gt; \"\nread\necho \"REPLY = '$REPLY'\"\n</code></pre> <p>\u4e0a\u9762\u811a\u672c\u7684\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ read-single\nEnter one or more values &gt; a b c d\nREPLY = 'a b c d'\n</code></pre> <p><code>read</code>\u547d\u4ee4\u9664\u4e86\u8bfb\u53d6\u952e\u76d8\u8f93\u5165\uff0c\u53ef\u4ee5\u7528\u6765\u8bfb\u53d6\u6587\u4ef6\u3002</p> <pre><code>#!/bin/bash\n\nfilename='/etc/hosts'\n\nwhile read myline\ndo\n  echo \"$myline\"\ndone &lt; $filename\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u901a\u8fc7<code>read</code>\u547d\u4ee4\uff0c\u8bfb\u53d6\u4e00\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u3002<code>done</code>\u547d\u4ee4\u540e\u9762\u7684\u5b9a\u5411\u7b26<code>&lt;</code>\uff0c\u5c06\u6587\u4ef6\u5185\u5bb9\u5bfc\u5411<code>read</code>\u547d\u4ee4\uff0c\u6bcf\u6b21\u8bfb\u53d6\u4e00\u884c\uff0c\u5b58\u5165\u53d8\u91cf<code>myline</code>\uff0c\u76f4\u5230\u6587\u4ef6\u8bfb\u53d6\u5b8c\u6bd5\u3002</p>"},{"location":"linux/bash/read/#_2","title":"\u53c2\u6570","text":"<p><code>read</code>\u547d\u4ee4\u7684\u53c2\u6570\u5982\u4e0b\u3002</p> <p>\uff081\uff09-t \u53c2\u6570</p> <p><code>read</code>\u547d\u4ee4\u7684<code>-t</code>\u53c2\u6570\uff0c\u8bbe\u7f6e\u4e86\u8d85\u65f6\u7684\u79d2\u6570\u3002\u5982\u679c\u8d85\u8fc7\u4e86\u6307\u5b9a\u65f6\u95f4\uff0c\u7528\u6237\u4ecd\u7136\u6ca1\u6709\u8f93\u5165\uff0c\u811a\u672c\u5c06\u653e\u5f03\u7b49\u5f85\uff0c\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\u3002</p> <pre><code>#!/bin/bash\n\necho -n \"\u8f93\u5165\u4e00\u4e9b\u6587\u672c &gt; \"\nif read -t 3 response; then\n  echo \"\u7528\u6237\u5df2\u7ecf\u8f93\u5165\u4e86\"\nelse\n  echo \"\u7528\u6237\u6ca1\u6709\u8f93\u5165\"\nfi\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u8f93\u5165\u547d\u4ee4\u4f1a\u7b49\u5f853\u79d2\uff0c\u5982\u679c\u7528\u6237\u8d85\u8fc7\u8fd9\u4e2a\u65f6\u95f4\u6ca1\u6709\u8f93\u5165\uff0c\u8fd9\u4e2a\u547d\u4ee4\u5c31\u4f1a\u6267\u884c\u5931\u8d25\u3002<code>if</code>\u6839\u636e\u547d\u4ee4\u7684\u8fd4\u56de\u503c\uff0c\u8f6c\u5165<code>else</code>\u4ee3\u7801\u5757\uff0c\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\u3002</p> <p>\u73af\u5883\u53d8\u91cf<code>TMOUT</code>\u4e5f\u53ef\u4ee5\u8d77\u5230\u540c\u6837\u4f5c\u7528\uff0c\u6307\u5b9a<code>read</code>\u547d\u4ee4\u7b49\u5f85\u7528\u6237\u8f93\u5165\u7684\u65f6\u95f4\uff08\u5355\u4f4d\u4e3a\u79d2\uff09\u3002</p> <pre><code>$ TMOUT=3\n$ read response\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e5f\u662f\u7b49\u5f853\u79d2\uff0c\u5982\u679c\u7528\u6237\u8fd8\u6ca1\u6709\u8f93\u5165\uff0c\u5c31\u4f1a\u8d85\u65f6\u3002</p> <p>\uff082\uff09-p \u53c2\u6570</p> <p><code>-p</code>\u53c2\u6570\u6307\u5b9a\u7528\u6237\u8f93\u5165\u7684\u63d0\u793a\u4fe1\u606f\u3002</p> <pre><code>read -p \"Enter one or more values &gt; \"\necho \"REPLY = '$REPLY'\"\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5148\u663e\u793a<code>Enter one or more values &gt;</code>\uff0c\u518d\u63a5\u53d7\u7528\u6237\u7684\u8f93\u5165\u3002</p> <p>\uff083\uff09-a \u53c2\u6570</p> <p><code>-a</code>\u53c2\u6570\u628a\u7528\u6237\u7684\u8f93\u5165\u8d4b\u503c\u7ed9\u4e00\u4e2a\u6570\u7ec4\uff0c\u4ece\u96f6\u53f7\u4f4d\u7f6e\u5f00\u59cb\u3002</p> <pre><code>$ read -a people\nalice duchess dodo\n$ echo ${people[2]}\ndodo\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7528\u6237\u8f93\u5165\u88ab\u8d4b\u503c\u7ed9\u4e00\u4e2a\u6570\u7ec4<code>people</code>\uff0c\u8fd9\u4e2a\u6570\u7ec4\u76842\u53f7\u6210\u5458\u5c31\u662f<code>dodo</code>\u3002</p> <p>\uff084\uff09-n \u53c2\u6570</p> <p><code>-n</code>\u53c2\u6570\u6307\u5b9a\u53ea\u8bfb\u53d6\u82e5\u5e72\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u53d8\u91cf\u503c\uff0c\u800c\u4e0d\u662f\u6574\u884c\u8bfb\u53d6\u3002</p> <pre><code>$ read -n 3 letter\nabcdefghij\n$ echo $letter\nabc\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53d8\u91cf<code>letter</code>\u53ea\u5305\u542b3\u4e2a\u5b57\u6bcd\u3002</p> <p>\uff085\uff09-e \u53c2\u6570</p> <p><code>-e</code>\u53c2\u6570\u5141\u8bb8\u7528\u6237\u8f93\u5165\u7684\u65f6\u5019\uff0c\u4f7f\u7528<code>readline</code>\u5e93\u63d0\u4f9b\u7684\u5feb\u6377\u952e\uff0c\u6bd4\u5982\u81ea\u52a8\u8865\u5168\u3002\u5177\u4f53\u7684\u5feb\u6377\u952e\u53ef\u4ee5\u53c2\u9605\u300a\u884c\u64cd\u4f5c\u300b\u4e00\u7ae0\u3002</p> <pre><code>#!/bin/bash\n\necho Please input the path to the file:\n\nread -e fileName\n\necho $fileName\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>read</code>\u547d\u4ee4\u63a5\u53d7\u7528\u6237\u8f93\u5165\u7684\u6587\u4ef6\u540d\u3002\u8fd9\u65f6\uff0c\u7528\u6237\u53ef\u80fd\u60f3\u4f7f\u7528 Tab \u952e\u7684\u6587\u4ef6\u540d\u201c\u81ea\u52a8\u8865\u5168\u201d\u529f\u80fd\uff0c\u4f46\u662f<code>read</code>\u547d\u4ee4\u7684\u8f93\u5165\u9ed8\u8ba4\u4e0d\u652f\u6301<code>readline</code>\u5e93\u7684\u529f\u80fd\u3002<code>-e</code>\u53c2\u6570\u5c31\u53ef\u4ee5\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u81ea\u52a8\u8865\u5168\u3002</p> <p>\uff086\uff09\u5176\u4ed6\u53c2\u6570</p> <ul> <li><code>-d delimiter</code>\uff1a\u5b9a\u4e49\u5b57\u7b26\u4e32<code>delimiter</code>\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u7528\u6237\u8f93\u5165\u7684\u7ed3\u675f\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u6362\u884c\u7b26\u3002</li> <li><code>-r</code>\uff1araw \u6a21\u5f0f\uff0c\u8868\u793a\u4e0d\u628a\u7528\u6237\u8f93\u5165\u7684\u53cd\u659c\u6760\u5b57\u7b26\u89e3\u91ca\u4e3a\u8f6c\u4e49\u5b57\u7b26\u3002</li> <li><code>-s</code>\uff1a\u4f7f\u5f97\u7528\u6237\u7684\u8f93\u5165\u4e0d\u663e\u793a\u5728\u5c4f\u5e55\u4e0a\uff0c\u8fd9\u5e38\u5e38\u7528\u4e8e\u8f93\u5165\u5bc6\u7801\u6216\u4fdd\u5bc6\u4fe1\u606f\u3002</li> <li><code>-u fd</code>\uff1a\u4f7f\u7528\u6587\u4ef6\u63cf\u8ff0\u7b26<code>fd</code>\u4f5c\u4e3a\u8f93\u5165\u3002</li> </ul>"},{"location":"linux/bash/read/#ifs","title":"IFS \u53d8\u91cf","text":"<p><code>read</code>\u547d\u4ee4\u8bfb\u53d6\u7684\u503c\uff0c\u9ed8\u8ba4\u662f\u4ee5\u7a7a\u683c\u5206\u9694\u3002\u53ef\u4ee5\u901a\u8fc7\u81ea\u5b9a\u4e49\u73af\u5883\u53d8\u91cf<code>IFS</code>\uff08\u5185\u90e8\u5b57\u6bb5\u5206\u9694\u7b26\uff0cInternal Field Separator \u7684\u7f29\u5199\uff09\uff0c\u4fee\u6539\u5206\u9694\u6807\u5fd7\u3002</p> <p><code>IFS</code>\u7684\u9ed8\u8ba4\u503c\u662f\u7a7a\u683c\u3001Tab \u7b26\u53f7\u3001\u6362\u884c\u7b26\u53f7\uff0c\u901a\u5e38\u53d6\u7b2c\u4e00\u4e2a\uff08\u5373\u7a7a\u683c\uff09\u3002</p> <p>\u5982\u679c\u628a<code>IFS</code>\u5b9a\u4e49\u6210\u5192\u53f7\uff08<code>:</code>\uff09\u6216\u5206\u53f7\uff08<code>;</code>\uff09\uff0c\u5c31\u53ef\u4ee5\u5206\u9694\u4ee5\u8fd9\u4e24\u4e2a\u7b26\u53f7\u5206\u9694\u7684\u503c\uff0c\u8fd9\u5bf9\u8bfb\u53d6\u6587\u4ef6\u5f88\u6709\u7528\u3002</p> <pre><code>#!/bin/bash\n# read-ifs: read fields from a file\n\nFILE=/etc/passwd\n\nread -p \"Enter a username &gt; \" user_name\nfile_info=\"$(grep \"^$user_name:\" $FILE)\"\n\nif [ -n \"$file_info\" ]; then\n  IFS=\":\" read user pw uid gid name home shell &lt;&lt;&lt; \"$file_info\"\n  echo \"User = '$user'\"\n  echo \"UID = '$uid'\"\n  echo \"GID = '$gid'\"\n  echo \"Full Name = '$name'\"\n  echo \"Home Dir. = '$home'\"\n  echo \"Shell = '$shell'\"\nelse\n  echo \"No such user '$user_name'\" &gt;&amp;2\n  exit 1\nfi\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>IFS</code>\u8bbe\u4e3a\u5192\u53f7\uff0c\u7136\u540e\u7528\u6765\u5206\u89e3<code>/etc/passwd</code>\u6587\u4ef6\u7684\u4e00\u884c\u3002<code>IFS</code>\u7684\u8d4b\u503c\u547d\u4ee4\u548c<code>read</code>\u547d\u4ee4\u5199\u5728\u4e00\u884c\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c<code>IFS</code>\u7684\u6539\u53d8\u4ec5\u5bf9\u540e\u9762\u7684\u547d\u4ee4\u751f\u6548\uff0c\u8be5\u547d\u4ee4\u6267\u884c\u540e<code>IFS</code>\u4f1a\u81ea\u52a8\u6062\u590d\u539f\u6765\u7684\u503c\u3002\u5982\u679c\u4e0d\u5199\u5728\u4e00\u884c\uff0c\u5c31\u8981\u91c7\u7528\u4e0b\u9762\u7684\u5199\u6cd5\u3002</p> <pre><code>OLD_IFS=\"$IFS\"\nIFS=\":\"\nread user pw uid gid name home shell &lt;&lt;&lt; \"$file_info\"\nIFS=\"$OLD_IFS\"\n</code></pre> <p>\u53e6\u5916\uff0c\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>&lt;&lt;&lt;</code>\u662f Here \u5b57\u7b26\u4e32\uff0c\u7528\u4e8e\u5c06\u53d8\u91cf\u503c\u8f6c\u4e3a\u6807\u51c6\u8f93\u5165\uff0c\u56e0\u4e3a<code>read</code>\u547d\u4ee4\u53ea\u80fd\u89e3\u6790\u6807\u51c6\u8f93\u5165\u3002</p> <p>\u5982\u679c<code>IFS</code>\u8bbe\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff0c\u5c31\u7b49\u540c\u4e8e\u5c06\u6574\u884c\u8bfb\u5165\u4e00\u4e2a\u53d8\u91cf\u3002</p> <pre><code>#!/bin/bash\ninput=\"/path/to/txt/file\"\nwhile IFS= read -r line\ndo\n  echo \"$line\"\ndone &lt; \"$input\"\n</code></pre> <p>\u4e0a\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u9010\u884c\u8bfb\u53d6\u6587\u4ef6\uff0c\u6bcf\u4e00\u884c\u5b58\u5165\u53d8\u91cf<code>line</code>\uff0c\u6253\u5370\u51fa\u6765\u4ee5\u540e\u518d\u8bfb\u53d6\u4e0b\u4e00\u884c\u3002</p>"},{"location":"linux/bash/readline/","title":"Bash \u884c\u64cd\u4f5c","text":""},{"location":"linux/bash/readline/#_1","title":"\u7b80\u4ecb","text":"<p>Bash \u5185\u7f6e\u4e86 Readline \u5e93\uff0c\u5177\u6709\u8fd9\u4e2a\u5e93\u63d0\u4f9b\u7684\u5f88\u591a\u201c\u884c\u64cd\u4f5c\u201d\u529f\u80fd\uff0c\u6bd4\u5982\u547d\u4ee4\u7684\u81ea\u52a8\u8865\u5168\uff0c\u53ef\u4ee5\u5927\u5927\u52a0\u5feb\u64cd\u4f5c\u901f\u5ea6\u3002</p> <p>\u8fd9\u4e2a\u5e93\u9ed8\u8ba4\u91c7\u7528 Emacs \u5feb\u6377\u952e\uff0c\u4e5f\u53ef\u4ee5\u6539\u6210 Vi \u5feb\u6377\u952e\u3002</p> <pre><code>$ set -o vi\n</code></pre> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u53ef\u4ee5\u6539\u56de Emacs \u5feb\u6377\u952e\u3002</p> <pre><code>$ set -o emacs\n</code></pre> <p>\u5982\u679c\u60f3\u6c38\u4e45\u6027\u66f4\u6539\u7f16\u8f91\u6a21\u5f0f\uff08Emacs / Vi\uff09\uff0c\u53ef\u4ee5\u5c06\u547d\u4ee4\u5199\u5728<code>~/.inputrc</code>\u6587\u4ef6\uff0c\u8fd9\u4e2a\u6587\u4ef6\u662f Readline \u7684\u914d\u7f6e\u6587\u4ef6\u3002</p> <pre><code>set editing-mode vi\n</code></pre> <p>\u672c\u7ae0\u4ecb\u7ecd\u7684\u5feb\u6377\u952e\u90fd\u5c5e\u4e8e Emacs \u6a21\u5f0f\u3002Vi \u6a21\u5f0f\u7684\u5feb\u6377\u952e\uff0c\u8bfb\u8005\u53ef\u4ee5\u53c2\u8003 Vi \u7f16\u8f91\u5668\u7684\u6559\u7a0b\u3002</p> <p>Bash \u9ed8\u8ba4\u5f00\u542f\u8fd9\u4e2a\u5e93\uff0c\u4f46\u662f\u5141\u8bb8\u5173\u95ed\u3002</p> <pre><code>$ bash --noediting\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>--noediting</code>\u53c2\u6570\u5173\u95ed\u4e86 Readline \u5e93\uff0c\u542f\u52a8\u7684 Bash \u5c31\u4e0d\u5e26\u6709\u884c\u64cd\u4f5c\u529f\u80fd\u3002</p>"},{"location":"linux/bash/readline/#_2","title":"\u5149\u6807\u79fb\u52a8","text":"<p>Readline \u63d0\u4f9b\u5feb\u901f\u79fb\u52a8\u5149\u6807\u7684\u5feb\u6377\u952e\u3002</p> <ul> <li><code>Ctrl + a</code>\uff1a\u79fb\u5230\u884c\u9996\u3002</li> <li><code>Ctrl + b</code>\uff1a\u5411\u884c\u9996\u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26\uff0c\u4e0e\u5de6\u7bad\u5934\u4f5c\u7528\u76f8\u540c\u3002</li> <li><code>Ctrl + e</code>\uff1a\u79fb\u5230\u884c\u5c3e\u3002</li> <li><code>Ctrl + f</code>\uff1a\u5411\u884c\u5c3e\u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26\uff0c\u4e0e\u53f3\u7bad\u5934\u4f5c\u7528\u76f8\u540c\u3002</li> <li><code>Alt + f</code>\uff1a\u79fb\u52a8\u5230\u5f53\u524d\u5355\u8bcd\u7684\u8bcd\u5c3e\u3002</li> <li><code>Alt + b</code>\uff1a\u79fb\u52a8\u5230\u5f53\u524d\u5355\u8bcd\u7684\u8bcd\u9996\u3002</li> </ul> <p>\u4e0a\u9762\u5feb\u6377\u952e\u7684 Alt \u952e\uff0c\u4e5f\u53ef\u4ee5\u7528 ESC \u952e\u4ee3\u66ff\u3002</p>"},{"location":"linux/bash/readline/#_3","title":"\u6e05\u9664\u5c4f\u5e55","text":"<p><code>Ctrl + l</code>\u5feb\u6377\u952e\u53ef\u4ee5\u6e05\u9664\u5c4f\u5e55\uff0c\u5373\u5c06\u5f53\u524d\u884c\u79fb\u5230\u5c4f\u5e55\u7684\u7b2c\u4e00\u884c\uff0c\u4e0e<code>clear</code>\u547d\u4ee4\u4f5c\u7528\u76f8\u540c\u3002</p>"},{"location":"linux/bash/readline/#_4","title":"\u7f16\u8f91\u64cd\u4f5c","text":"<p>\u4e0b\u9762\u7684\u5feb\u6377\u952e\u53ef\u4ee5\u7f16\u8f91\u547d\u4ee4\u884c\u5185\u5bb9\u3002</p> <ul> <li><code>Ctrl + d</code>\uff1a\u5220\u9664\u5149\u6807\u4f4d\u7f6e\u7684\u5b57\u7b26\uff08delete\uff09\u3002</li> <li><code>Ctrl + w</code>\uff1a\u5220\u9664\u5149\u6807\u524d\u9762\u7684\u5355\u8bcd\u3002</li> <li><code>Ctrl + t</code>\uff1a\u5149\u6807\u4f4d\u7f6e\u7684\u5b57\u7b26\u4e0e\u5b83\u524d\u9762\u4e00\u4f4d\u7684\u5b57\u7b26\u4ea4\u6362\u4f4d\u7f6e\uff08transpose\uff09\u3002</li> <li><code>Alt + t</code>\uff1a\u5149\u6807\u4f4d\u7f6e\u7684\u8bcd\u4e0e\u5b83\u524d\u9762\u4e00\u4f4d\u7684\u8bcd\u4ea4\u6362\u4f4d\u7f6e\uff08transpose\uff09\u3002</li> <li><code>Alt + l</code>\uff1a\u5c06\u5149\u6807\u4f4d\u7f6e\u81f3\u8bcd\u5c3e\u8f6c\u4e3a\u5c0f\u5199\uff08lowercase\uff09\u3002</li> <li><code>Alt + u</code>\uff1a\u5c06\u5149\u6807\u4f4d\u7f6e\u81f3\u8bcd\u5c3e\u8f6c\u4e3a\u5927\u5199\uff08uppercase\uff09\u3002</li> </ul> <p>\u4f7f\u7528<code>Ctrl + d</code>\u7684\u65f6\u5019\uff0c\u5982\u679c\u5f53\u524d\u884c\u6ca1\u6709\u4efb\u4f55\u5b57\u7b26\uff0c\u4f1a\u5bfc\u81f4\u9000\u51fa\u5f53\u524d Shell\uff0c\u6240\u4ee5\u8981\u5c0f\u5fc3\u3002</p> <p>\u526a\u5207\u548c\u7c98\u8d34\u5feb\u6377\u952e\u5982\u4e0b\u3002</p> <ul> <li><code>Ctrl + k</code>\uff1a\u526a\u5207\u5149\u6807\u4f4d\u7f6e\u5230\u884c\u5c3e\u7684\u6587\u672c\u3002</li> <li><code>Ctrl + u</code>\uff1a\u526a\u5207\u5149\u6807\u4f4d\u7f6e\u5230\u884c\u9996\u7684\u6587\u672c\u3002</li> <li><code>Alt + d</code>\uff1a\u526a\u5207\u5149\u6807\u4f4d\u7f6e\u5230\u8bcd\u5c3e\u7684\u6587\u672c\u3002</li> <li><code>Alt + Backspace</code>\uff1a\u526a\u5207\u5149\u6807\u4f4d\u7f6e\u5230\u8bcd\u9996\u7684\u6587\u672c\u3002</li> <li><code>Ctrl + y</code>\uff1a\u5728\u5149\u6807\u4f4d\u7f6e\u7c98\u8d34\u6587\u672c\u3002</li> </ul> <p>\u540c\u6837\u5730\uff0cAlt \u952e\u53ef\u4ee5\u7528 Esc \u952e\u4ee3\u66ff\u3002</p>"},{"location":"linux/bash/readline/#_5","title":"\u81ea\u52a8\u8865\u5168","text":"<p>\u547d\u4ee4\u8f93\u5165\u5230\u4e00\u534a\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u6309\u4e00\u4e0b Tab \u952e\uff0cReadline \u4f1a\u81ea\u52a8\u8865\u5168\u547d\u4ee4\u6216\u8def\u5f84\u3002\u6bd4\u5982\uff0c\u8f93\u5165<code>cle</code>\uff0c\u518d\u6309\u4e0b Tab \u952e\uff0cBash \u4f1a\u81ea\u52a8\u5c06\u8fd9\u4e2a\u547d\u4ee4\u8865\u5168\u4e3a<code>clear</code>\u3002</p> <p>\u5982\u679c\u7b26\u5408\u6761\u4ef6\u7684\u547d\u4ee4\u6216\u8def\u5f84\u6709\u591a\u4e2a\uff0c\u5c31\u9700\u8981\u8fde\u7eed\u6309\u4e24\u6b21 Tab \u952e\uff0cBash \u4f1a\u63d0\u793a\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684\u547d\u4ee4\u6216\u8def\u5f84\u3002</p> <p>\u9664\u4e86\u547d\u4ee4\u6216\u8def\u5f84\uff0cTab \u8fd8\u53ef\u4ee5\u8865\u5168\u5176\u4ed6\u503c\u3002\u5982\u679c\u4e00\u4e2a\u503c\u4ee5<code>$</code>\u5f00\u5934\uff0c\u5219\u6309\u4e0b Tab \u952e\u4f1a\u8865\u5168\u53d8\u91cf\uff1b\u5982\u679c\u4ee5<code>~</code>\u5f00\u5934\uff0c\u5219\u8865\u5168\u7528\u6237\u540d\uff1b\u5982\u679c\u4ee5<code>@</code>\u5f00\u5934\uff0c\u5219\u8865\u5168\u4e3b\u673a\u540d\uff08hostname\uff09\uff0c\u4e3b\u673a\u540d\u4ee5\u5217\u5728<code>/etc/hosts</code>\u6587\u4ef6\u91cc\u9762\u7684\u4e3b\u673a\u4e3a\u51c6\u3002</p> <p>\u81ea\u52a8\u8865\u5168\u76f8\u5173\u7684\u5feb\u6377\u952e\u5982\u4e0b\u3002</p> <ul> <li>Tab\uff1a\u5b8c\u6210\u81ea\u52a8\u8865\u5168\u3002</li> <li><code>Alt + ?</code>\uff1a\u5217\u51fa\u53ef\u80fd\u7684\u8865\u5168\uff0c\u4e0e\u8fde\u6309\u4e24\u6b21 Tab \u952e\u4f5c\u7528\u76f8\u540c\u3002</li> <li><code>Alt + /</code>\uff1a\u5c1d\u8bd5\u6587\u4ef6\u8def\u5f84\u8865\u5168\u3002</li> <li><code>Ctrl + x /</code>\uff1a\u5148\u6309<code>Ctrl + x</code>\uff0c\u518d\u6309<code>/</code>\uff0c\u7b49\u540c\u4e8e<code>Alt + ?</code>\uff0c\u5217\u51fa\u53ef\u80fd\u7684\u6587\u4ef6\u8def\u5f84\u8865\u5168\u3002</li> <li><code>Alt + !</code>\uff1a\u547d\u4ee4\u8865\u5168\u3002</li> <li><code>Ctrl + x !</code>\uff1a\u5148\u6309<code>Ctrl + x</code>\uff0c\u518d\u6309<code>!</code>\uff0c\u7b49\u540c\u4e8e<code>Alt + !</code>\uff0c\u547d\u4ee4\u8865\u5168\u3002</li> <li><code>Alt + ~</code>\uff1a\u7528\u6237\u540d\u8865\u5168\u3002</li> <li><code>Ctrl + x ~</code>\uff1a\u5148\u6309<code>Ctrl + x</code>\uff0c\u518d\u6309<code>~</code>\uff0c\u7b49\u540c\u4e8e<code>Alt + ~</code>\uff0c\u7528\u6237\u540d\u8865\u5168\u3002</li> <li><code>Alt + $</code>\uff1a\u53d8\u91cf\u540d\u8865\u5168\u3002</li> <li><code>Ctrl + x $</code>\uff1a\u5148\u6309<code>Ctrl + x</code>\uff0c\u518d\u6309<code>$</code>\uff0c\u7b49\u540c\u4e8e<code>Alt + $</code>\uff0c\u53d8\u91cf\u540d\u8865\u5168\u3002</li> <li><code>Alt + @</code>\uff1a\u4e3b\u673a\u540d\u8865\u5168\u3002</li> <li><code>Ctrl + x @</code>\uff1a\u5148\u6309<code>Ctrl + x</code>\uff0c\u518d\u6309<code>@</code>\uff0c\u7b49\u540c\u4e8e<code>Alt + @</code>\uff0c\u4e3b\u673a\u540d\u8865\u5168\u3002</li> <li><code>Alt + *</code>\uff1a\u5728\u547d\u4ee4\u884c\u4e00\u6b21\u6027\u63d2\u5165\u6240\u6709\u53ef\u80fd\u7684\u8865\u5168\u3002</li> <li><code>Alt + Tab</code>\uff1a\u5c1d\u8bd5\u7528<code>.bash_history</code>\u91cc\u9762\u4ee5\u524d\u6267\u884c\u547d\u4ee4\uff0c\u8fdb\u884c\u8865\u5168\u3002</li> </ul> <p>\u4e0a\u9762\u7684<code>Alt</code>\u952e\u4e5f\u53ef\u4ee5\u7528 ESC \u952e\u4ee3\u66ff\u3002</p>"},{"location":"linux/bash/readline/#_6","title":"\u64cd\u4f5c\u5386\u53f2","text":""},{"location":"linux/bash/readline/#_7","title":"\u57fa\u672c\u7528\u6cd5","text":"<p>Bash \u4f1a\u4fdd\u7559\u7528\u6237\u7684\u64cd\u4f5c\u5386\u53f2\uff0c\u5373\u7528\u6237\u8f93\u5165\u7684\u6bcf\u4e00\u6761\u547d\u4ee4\u90fd\u4f1a\u8bb0\u5f55\u3002\u9000\u51fa\u5f53\u524d Shell \u7684\u65f6\u5019\uff0cBash \u4f1a\u5c06\u7528\u6237\u5728\u5f53\u524d Shell \u7684\u64cd\u4f5c\u5386\u53f2\u5199\u5165<code>~/.bash_history</code>\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u9ed8\u8ba4\u50a8\u5b58500\u4e2a\u64cd\u4f5c\u3002</p> <p>\u73af\u5883\u53d8\u91cf<code>HISTFILE</code>\u603b\u662f\u6307\u5411\u8fd9\u4e2a\u6587\u4ef6\u3002</p> <pre><code>$ echo $HISTFILE\n/home/me/.bash_history\n</code></pre> <p>\u6709\u4e86\u64cd\u4f5c\u5386\u53f2\u4ee5\u540e\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u65b9\u5411\u952e\u7684<code>\u2191</code>\u548c<code>\u2193</code>\uff0c\u5feb\u901f\u6d4f\u89c8\u4e0a\u4e00\u6761\u548c\u4e0b\u4e00\u6761\u547d\u4ee4\u3002</p> <p>\u4e0b\u9762\u7684\u65b9\u6cd5\u53ef\u4ee5\u5feb\u901f\u6267\u884c\u4ee5\u524d\u6267\u884c\u8fc7\u7684\u547d\u4ee4\u3002</p> <pre><code>$ echo Hello World\nHello World\n\n$ echo Goodbye\nGoodbye\n\n$ !e\necho Goodbye\nGoodbye\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>!e</code>\u8868\u793a\u627e\u51fa\u64cd\u4f5c\u5386\u53f2\u4e4b\u4e2d\uff0c\u6700\u8fd1\u7684\u90a3\u4e00\u6761\u4ee5<code>e</code>\u5f00\u5934\u7684\u547d\u4ee4\u5e76\u6267\u884c\u3002Bash \u4f1a\u5148\u8f93\u51fa\u90a3\u4e00\u6761\u547d\u4ee4<code>echo Goodbye</code>\uff0c\u7136\u540e\u76f4\u63a5\u6267\u884c\u3002</p> <p>\u540c\u7406\uff0c<code>!echo</code>\u4e5f\u4f1a\u6267\u884c\u6700\u8fd1\u4e00\u6761\u4ee5<code>echo</code>\u5f00\u5934\u7684\u547d\u4ee4\u3002</p> <pre><code>$ !echo\necho Goodbye\nGoodbye\n\n$ !echo H\necho Goodbye H\nGoodbye H\n\n$ !echo H G\necho Goodbye H G\nGoodbye H G\n</code></pre> <p>\u6ce8\u610f\uff0c<code>!string</code>\u8bed\u6cd5\u53ea\u4f1a\u5339\u914d\u547d\u4ee4\uff0c\u4e0d\u4f1a\u5339\u914d\u53c2\u6570\u3002\u6240\u4ee5<code>!echo H</code>\u4e0d\u4f1a\u6267\u884c<code>echo Hello World</code>\uff0c\u800c\u662f\u4f1a\u6267\u884c<code>echo Goodbye</code>\uff0c\u5e76\u628a\u53c2\u6570<code>H</code>\u9644\u52a0\u5728\u8fd9\u6761\u547d\u4ee4\u4e4b\u540e\u3002\u540c\u7406\uff0c<code>!echo H G</code>\u4e5f\u662f\u7b49\u540c\u4e8e<code>echo Goodbye</code>\u547d\u4ee4\u4e4b\u540e\u9644\u52a0<code>H G</code>\u3002</p> <p>\u7531\u4e8e\u201d\u611f\u53f9\u53f7 + \u5b57\u7b26\u201c\u4f1a\u6269\u5c55\u6210\u4ee5\u524d\u6267\u884c\u8fc7\u7684\u547d\u4ee4\uff0c\u6240\u4ee5\u542b\u6709\u611f\u53f9\u53f7\u7684\u5b57\u7b26\u4e32\u653e\u5728\u53cc\u5f15\u53f7\u91cc\u9762\uff0c\u5fc5\u987b\u975e\u5e38\u5c0f\u5fc3\uff0c\u6709\u53ef\u80fd\u4f1a\u62a5\u9519\u3002</p> <pre><code>$ echo \"I say:\\\"hello!\\\"\"\nbash: !\\: event not found\n</code></pre> <p>\u4e0a\u9762\u7684\u547d\u4ee4\u4f1a\u62a5\u9519\uff0c\u539f\u56e0\u662f\u611f\u53f9\u53f7\u540e\u9762\u662f\u4e00\u4e2a\u53cd\u659c\u6760\uff0cBash \u4f1a\u5c1d\u8bd5\u5bfb\u627e\uff0c\u4ee5\u524d\u662f\u5426\u6267\u884c\u8fc7\u53cd\u659c\u6760\u5f00\u5934\u7684\u547d\u4ee4\uff0c\u4e00\u65e6\u627e\u4e0d\u5230\u5c31\u4f1a\u62a5\u9519\u3002\u89e3\u51b3\u65b9\u6cd5\u5c31\u662f\u5728\u611f\u53f9\u53f7\u524d\u9762\uff0c\u4e5f\u52a0\u4e0a\u53cd\u659c\u6760\u3002</p> <pre><code>$ echo \"I say:\\\"hello\\!\\\"\"\nI say:\"hello\\!\"\n</code></pre> <p>\u6700\u540e\uff0c\u6309\u4e0b<code>Ctrl + r</code>\u4f1a\u663e\u793a\u64cd\u4f5c\u5386\u53f2\uff0c\u53ef\u4ee5\u7528\u65b9\u5411\u952e\u4e0a\u4e0b\u79fb\u52a8\uff0c\u9009\u62e9\u5176\u4e2d\u8981\u6267\u884c\u7684\u547d\u4ee4\u3002\u4e5f\u53ef\u4ee5\u952e\u5165\u547d\u4ee4\u7684\u9996\u5b57\u6bcd\uff0cShell \u5c31\u4f1a\u81ea\u52a8\u5728\u5386\u53f2\u6587\u4ef6\u4e2d\uff0c\u67e5\u8be2\u5e76\u663e\u793a\u5339\u914d\u7684\u7ed3\u679c\u3002</p>"},{"location":"linux/bash/readline/#history","title":"history \u547d\u4ee4","text":"<p><code>history</code>\u547d\u4ee4\u80fd\u663e\u793a\u64cd\u4f5c\u5386\u53f2\uff0c\u5373<code>.bash_history</code>\u6587\u4ef6\u7684\u5185\u5bb9\u3002</p> <pre><code>$ history\n...\n498 echo Goodbye\n499 ls ~\n500 cd\n</code></pre> <p>\u4f7f\u7528\u8be5\u547d\u4ee4\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u8bfb\u53d6<code>.bash_history</code>\u6587\u4ef6\u7684\u597d\u5904\u662f\uff0c\u5b83\u4f1a\u5728\u6240\u6709\u7684\u64cd\u4f5c\u524d\u52a0\u4e0a\u884c\u53f7\uff0c\u6700\u8fd1\u7684\u64cd\u4f5c\u5728\u6700\u540e\u9762\uff0c\u884c\u53f7\u6700\u5927\u3002</p> <p>\u901a\u8fc7\u5b9a\u5236\u73af\u5883\u53d8\u91cf<code>HISTTIMEFORMAT</code>\uff0c\u53ef\u4ee5\u663e\u793a\u6bcf\u4e2a\u64cd\u4f5c\u7684\u65f6\u95f4\u3002</p> <pre><code>$ export HISTTIMEFORMAT='%F %T  '\n$ history\n1  2013-06-09 10:40:12   cat /etc/issue\n2  2013-06-09 10:40:12   clear\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>%F</code>\u76f8\u5f53\u4e8e<code>%Y - %m - %d</code>\uff0c<code>%T</code>\u76f8\u5f53\u4e8e<code>%H : %M : %S</code>\u3002</p> <p>\u53ea\u8981\u8bbe\u7f6e<code>HISTTIMEFORMAT</code>\u8fd9\u4e2a\u73af\u5883\u53d8\u91cf\uff0c\u5c31\u4f1a\u5728<code>.bash_history</code>\u6587\u4ef6\u4fdd\u5b58\u547d\u4ee4\u7684\u6267\u884c\u65f6\u95f4\u6233\u3002\u5982\u679c\u4e0d\u8bbe\u7f6e\uff0c\u5c31\u4e0d\u4f1a\u4fdd\u5b58\u65f6\u95f4\u6233\u3002</p> <p>\u5982\u679c\u4e0d\u5e0c\u671b\u4fdd\u5b58\u672c\u6b21\u64cd\u4f5c\u7684\u5386\u53f2\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf<code>HISTSIZE</code>\u7b49\u4e8e0\u3002</p> <pre><code>export HISTSIZE=0\n</code></pre> <p>\u5982\u679c<code>HISTSIZE=0</code>\u5199\u5165\u7528\u6237\u4e3b\u76ee\u5f55\u7684<code>~/.bashrc</code>\u6587\u4ef6\uff0c\u90a3\u4e48\u5c31\u4e0d\u4f1a\u4fdd\u7559\u8be5\u7528\u6237\u7684\u64cd\u4f5c\u5386\u53f2\u3002\u5982\u679c\u5199\u5165<code>/etc/profile</code>\uff0c\u6574\u4e2a\u7cfb\u7edf\u90fd\u4e0d\u4f1a\u4fdd\u7559\u64cd\u4f5c\u5386\u53f2\u3002</p> <p>\u5982\u679c\u60f3\u641c\u7d22\u67d0\u4e2a\u4ee5\u524d\u6267\u884c\u7684\u547d\u4ee4\uff0c\u53ef\u4ee5\u914d\u5408<code>grep</code>\u547d\u4ee4\u641c\u7d22\u64cd\u4f5c\u5386\u53f2\u3002</p> <pre><code>$ history | grep /usr/bin\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u8fd4\u56de<code>.bash_history</code>\u6587\u4ef6\u91cc\u9762\uff0c\u90a3\u4e9b\u5305\u542b<code>/usr/bin</code>\u7684\u547d\u4ee4\u3002</p> <p>\u64cd\u4f5c\u5386\u53f2\u7684\u6bcf\u4e00\u6761\u8bb0\u5f55\u90fd\u6709\u7f16\u53f7\u3002\u77e5\u9053\u4e86\u547d\u4ee4\u7684\u7f16\u53f7\u4ee5\u540e\uff0c\u53ef\u4ee5\u7528<code>\u611f\u53f9\u53f7 + \u7f16\u53f7</code>\u6267\u884c\u8be5\u547d\u4ee4\u3002\u5982\u679c\u60f3\u8981\u6267\u884c<code>.bash_history</code>\u91cc\u9762\u7684\u7b2c8\u6761\u547d\u4ee4\uff0c\u53ef\u4ee5\u50cf\u4e0b\u9762\u8fd9\u6837\u64cd\u4f5c\u3002</p> <pre><code>$ !8\n</code></pre> <p><code>history</code>\u547d\u4ee4\u7684<code>-c</code>\u53c2\u6570\u53ef\u4ee5\u6e05\u9664\u64cd\u4f5c\u5386\u53f2\u3002</p> <pre><code>$ history -c\n</code></pre>"},{"location":"linux/bash/readline/#_8","title":"\u76f8\u5173\u5feb\u6377\u952e","text":"<p>\u4e0b\u9762\u662f\u4e00\u4e9b\u4e0e\u64cd\u4f5c\u5386\u53f2\u76f8\u5173\u7684\u5feb\u6377\u952e\u3002</p> <ul> <li><code>Ctrl + p</code>\uff1a\u663e\u793a\u4e0a\u4e00\u4e2a\u547d\u4ee4\uff0c\u4e0e\u5411\u4e0a\u7bad\u5934\u6548\u679c\u76f8\u540c\uff08previous\uff09\u3002</li> <li><code>Ctrl + n</code>\uff1a\u663e\u793a\u4e0b\u4e00\u4e2a\u547d\u4ee4\uff0c\u4e0e\u5411\u4e0b\u7bad\u5934\u6548\u679c\u76f8\u540c\uff08next\uff09\u3002</li> <li><code>Alt + &lt;</code>\uff1a\u663e\u793a\u7b2c\u4e00\u4e2a\u547d\u4ee4\u3002</li> <li><code>Alt + &gt;</code>\uff1a\u663e\u793a\u6700\u540e\u4e00\u4e2a\u547d\u4ee4\uff0c\u5373\u5f53\u524d\u7684\u547d\u4ee4\u3002</li> <li><code>Ctrl + o</code>\uff1a\u6267\u884c\u5386\u53f2\u6587\u4ef6\u91cc\u9762\u7684\u5f53\u524d\u6761\u76ee\uff0c\u5e76\u81ea\u52a8\u663e\u793a\u4e0b\u4e00\u6761\u547d\u4ee4\u3002\u8fd9\u5bf9\u91cd\u590d\u6267\u884c\u67d0\u4e2a\u5e8f\u5217\u7684\u547d\u4ee4\u5f88\u6709\u5e2e\u52a9\u3002</li> </ul> <p>\u611f\u53f9\u53f7<code>!</code>\u7684\u5feb\u6377\u952e\u5982\u4e0b\u3002</p> <ul> <li><code>!!</code>\uff1a\u6267\u884c\u4e0a\u4e00\u4e2a\u547d\u4ee4\u3002</li> <li><code>!n</code>\uff1a\u6267\u884c\u5386\u53f2\u6587\u4ef6\u91cc\u9762\u884c\u53f7\u4e3a<code>n</code>\u7684\u547d\u4ee4\u3002</li> <li><code>!-n</code>\uff1a\u6267\u884c\u5f53\u524d\u547d\u4ee4\u4e4b\u524d<code>n</code>\u6761\u7684\u547d\u4ee4\u3002</li> <li><code>!string</code>\uff1a\u6267\u884c\u6700\u8fd1\u4e00\u4e2a\u4ee5\u6307\u5b9a\u5b57\u7b26\u4e32<code>string</code>\u5f00\u5934\u7684\u547d\u4ee4\u3002</li> <li><code>!?string</code>\uff1a\u6267\u884c\u6700\u8fd1\u4e00\u6761\u5305\u542b\u5b57\u7b26\u4e32<code>string</code>\u7684\u547d\u4ee4\u3002</li> <li><code>^string1^string2</code>\uff1a\u6267\u884c\u6700\u8fd1\u4e00\u6761\u5305\u542b<code>string1</code>\u7684\u547d\u4ee4\uff0c\u5c06\u5176\u66ff\u6362\u6210<code>string2</code>\u3002</li> </ul>"},{"location":"linux/bash/readline/#_9","title":"\u5176\u4ed6\u5feb\u6377\u952e","text":"<ul> <li><code>Ctrl + j</code>\uff1a\u7b49\u540c\u4e8e\u56de\u8f66\u952e\uff08LINEFEED\uff09\u3002</li> <li><code>Ctrl + m</code>\uff1a\u7b49\u540c\u4e8e\u56de\u8f66\u952e\uff08CARRIAGE RETURN\uff09\u3002</li> <li><code>Ctrl + o</code>\uff1a\u7b49\u540c\u4e8e\u56de\u8f66\u952e\uff0c\u5e76\u5c55\u793a\u64cd\u4f5c\u5386\u53f2\u7684\u4e0b\u4e00\u4e2a\u547d\u4ee4\u3002\u00a0</li> <li><code>Ctrl + v</code>\uff1a\u5c06\u4e0b\u4e00\u4e2a\u8f93\u5165\u7684\u7279\u6b8a\u5b57\u7b26\u53d8\u6210\u5b57\u9762\u91cf\uff0c\u6bd4\u5982\u56de\u8f66\u53d8\u6210<code>^M</code>\u3002</li> <li><code>Ctrl + [</code>\uff1a\u7b49\u540c\u4e8e ESC\u3002\u00a0</li> <li><code>Alt + .</code>\uff1a\u63d2\u5165\u4e0a\u4e00\u4e2a\u547d\u4ee4\u7684\u6700\u540e\u4e00\u4e2a\u8bcd\u3002</li> <li><code>Alt + _</code>\uff1a\u7b49\u540c\u4e8e<code>Alt + .</code>\u3002</li> </ul> <p>\u4e0a\u9762\u7684<code>Alt + .</code>\u5feb\u6377\u952e\uff0c\u5bf9\u4e8e\u5f88\u957f\u7684\u6587\u4ef6\u8def\u5f84\uff0c\u6709\u65f6\u4f1a\u975e\u5e38\u65b9\u4fbf\u3002\u56e0\u4e3a Unix \u547d\u4ee4\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u901a\u5e38\u662f\u6587\u4ef6\u8def\u5f84\u3002</p> <pre><code>$ mkdir foo_bar\n$ cd #\u6309\u4e0b Alt + .\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5728<code>cd</code>\u547d\u4ee4\u540e\u6309\u4e0b<code>Alt + .</code>\uff0c\u5c31\u4f1a\u81ea\u52a8\u63d2\u5165<code>foo_bar</code>\u3002</p>"},{"location":"linux/bash/script/","title":"Bash \u811a\u672c\u5165\u95e8","text":"<p>\u811a\u672c\uff08script\uff09\u5c31\u662f\u5305\u542b\u4e00\u7cfb\u5217\u547d\u4ee4\u7684\u4e00\u4e2a\u6587\u672c\u6587\u4ef6\u3002Shell \u8bfb\u53d6\u8fd9\u4e2a\u6587\u4ef6\uff0c\u4f9d\u6b21\u6267\u884c\u91cc\u9762\u7684\u6240\u6709\u547d\u4ee4\uff0c\u5c31\u597d\u50cf\u8fd9\u4e9b\u547d\u4ee4\u76f4\u63a5\u8f93\u5165\u5230\u547d\u4ee4\u884c\u4e00\u6837\u3002\u6240\u6709\u80fd\u591f\u5728\u547d\u4ee4\u884c\u5b8c\u6210\u7684\u4efb\u52a1\uff0c\u90fd\u80fd\u591f\u7528\u811a\u672c\u5b8c\u6210\u3002</p> <p>\u811a\u672c\u7684\u597d\u5904\u662f\u53ef\u4ee5\u91cd\u590d\u4f7f\u7528\uff0c\u4e5f\u53ef\u4ee5\u6307\u5b9a\u5728\u7279\u5b9a\u573a\u5408\u81ea\u52a8\u8c03\u7528\uff0c\u6bd4\u5982\u7cfb\u7edf\u542f\u52a8\u6216\u5173\u95ed\u65f6\u81ea\u52a8\u6267\u884c\u811a\u672c\u3002</p>"},{"location":"linux/bash/script/#shebang","title":"Shebang \u884c","text":"<p>\u811a\u672c\u7684\u7b2c\u4e00\u884c\u901a\u5e38\u662f\u6307\u5b9a\u89e3\u91ca\u5668\uff0c\u5373\u8fd9\u4e2a\u811a\u672c\u5fc5\u987b\u901a\u8fc7\u4ec0\u4e48\u89e3\u91ca\u5668\u6267\u884c\u3002\u8fd9\u4e00\u884c\u4ee5<code>#!</code>\u5b57\u7b26\u5f00\u5934\uff0c\u8fd9\u4e2a\u5b57\u7b26\u79f0\u4e3a Shebang\uff0c\u6240\u4ee5\u8fd9\u4e00\u884c\u5c31\u53eb\u505a Shebang \u884c\u3002</p> <p><code>#!</code>\u540e\u9762\u5c31\u662f\u811a\u672c\u89e3\u91ca\u5668\u7684\u4f4d\u7f6e\uff0cBash \u811a\u672c\u7684\u89e3\u91ca\u5668\u4e00\u822c\u662f<code>/bin/sh</code>\u6216<code>/bin/bash</code>\u3002</p> <pre><code>#!/bin/sh\n# \u6216\u8005\n#!/bin/bash\n</code></pre> <p><code>#!</code>\u4e0e\u811a\u672c\u89e3\u91ca\u5668\u4e4b\u95f4\u6709\u6ca1\u6709\u7a7a\u683c\uff0c\u90fd\u662f\u53ef\u4ee5\u7684\u3002</p> <p>\u5982\u679c Bash \u89e3\u91ca\u5668\u4e0d\u653e\u5728\u76ee\u5f55<code>/bin</code>\uff0c\u811a\u672c\u5c31\u65e0\u6cd5\u6267\u884c\u4e86\u3002\u4e3a\u4e86\u4fdd\u9669\uff0c\u53ef\u4ee5\u5199\u6210\u4e0b\u9762\u8fd9\u6837\u3002</p> <pre><code>#!/usr/bin/env bash\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4f7f\u7528<code>env</code>\u547d\u4ee4\uff08\u8fd9\u4e2a\u547d\u4ee4\u603b\u662f\u5728<code>/usr/bin</code>\u76ee\u5f55\uff09\uff0c\u8fd4\u56de Bash \u53ef\u6267\u884c\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002<code>env</code>\u547d\u4ee4\u7684\u8be6\u7ec6\u4ecb\u7ecd\uff0c\u8bf7\u770b\u540e\u6587\u3002</p> <p>Shebang \u884c\u4e0d\u662f\u5fc5\u9700\u7684\uff0c\u4f46\u662f\u5efa\u8bae\u52a0\u4e0a\u8fd9\u884c\u3002\u5982\u679c\u7f3a\u5c11\u8be5\u884c\uff0c\u5c31\u9700\u8981\u624b\u52a8\u5c06\u811a\u672c\u4f20\u7ed9\u89e3\u91ca\u5668\u3002\u4e3e\u4f8b\u6765\u8bf4\uff0c\u811a\u672c\u662f<code>script.sh</code>\uff0c\u6709 Shebang \u884c\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u76f4\u63a5\u8c03\u7528\u6267\u884c\u3002</p> <pre><code>$ ./script.sh\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>script.sh</code>\u662f\u811a\u672c\u6587\u4ef6\u540d\u3002\u811a\u672c\u901a\u5e38\u4f7f\u7528<code>.sh</code>\u540e\u7f00\u540d\uff0c\u4e0d\u8fc7\u8fd9\u4e0d\u662f\u5fc5\u9700\u7684\u3002</p> <p>\u5982\u679c\u6ca1\u6709 Shebang \u884c\uff0c\u5c31\u53ea\u80fd\u624b\u52a8\u5c06\u811a\u672c\u4f20\u7ed9\u89e3\u91ca\u5668\u6765\u6267\u884c\u3002</p> <pre><code>$ /bin/sh ./script.sh\n# \u6216\u8005\n$ bash ./script.sh\n</code></pre>"},{"location":"linux/bash/script/#_1","title":"\u6267\u884c\u6743\u9650\u548c\u8def\u5f84","text":"<p>\u524d\u9762\u8bf4\u8fc7\uff0c\u53ea\u8981\u6307\u5b9a\u4e86 Shebang \u884c\u7684\u811a\u672c\uff0c\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u3002\u8fd9\u6709\u4e00\u4e2a\u524d\u63d0\u6761\u4ef6\uff0c\u5c31\u662f\u811a\u672c\u9700\u8981\u6709\u6267\u884c\u6743\u9650\u3002\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\uff0c\u8d4b\u4e88\u811a\u672c\u6267\u884c\u6743\u9650\u3002</p> <pre><code># \u7ed9\u6240\u6709\u7528\u6237\u6267\u884c\u6743\u9650\n$ chmod +x script.sh\n\n# \u7ed9\u6240\u6709\u7528\u6237\u8bfb\u6743\u9650\u548c\u6267\u884c\u6743\u9650\n$ chmod +rx script.sh\n# \u6216\u8005\n$ chmod 755 script.sh\n\n# \u53ea\u7ed9\u811a\u672c\u62e5\u6709\u8005\u8bfb\u6743\u9650\u548c\u6267\u884c\u6743\u9650\n$ chmod u+rx script.sh\n</code></pre> <p>\u811a\u672c\u7684\u6743\u9650\u901a\u5e38\u8bbe\u4e3a<code>755</code>\uff08\u62e5\u6709\u8005\u6709\u6240\u6709\u6743\u9650\uff0c\u5176\u4ed6\u4eba\u6709\u8bfb\u548c\u6267\u884c\u6743\u9650\uff09\u6216\u8005<code>700</code>\uff08\u53ea\u6709\u62e5\u6709\u8005\u53ef\u4ee5\u6267\u884c\uff09\u3002</p> <p>\u9664\u4e86\u6267\u884c\u6743\u9650\uff0c\u811a\u672c\u8c03\u7528\u65f6\uff0c\u4e00\u822c\u9700\u8981\u6307\u5b9a\u811a\u672c\u7684\u8def\u5f84\uff08\u6bd4\u5982<code>path/script.sh</code>\uff09\u3002\u5982\u679c\u5c06\u811a\u672c\u653e\u5728\u73af\u5883\u53d8\u91cf<code>$PATH</code>\u6307\u5b9a\u7684\u76ee\u5f55\u4e2d\uff0c\u5c31\u4e0d\u9700\u8981\u6307\u5b9a\u8def\u5f84\u4e86\u3002\u56e0\u4e3a Bash \u4f1a\u81ea\u52a8\u5230\u8fd9\u4e9b\u76ee\u5f55\u4e2d\uff0c\u5bfb\u627e\u662f\u5426\u5b58\u5728\u540c\u540d\u7684\u53ef\u6267\u884c\u6587\u4ef6\u3002</p> <p>\u5efa\u8bae\u5728\u4e3b\u76ee\u5f55\u65b0\u5efa\u4e00\u4e2a<code>~/bin</code>\u5b50\u76ee\u5f55\uff0c\u4e13\u95e8\u5b58\u653e\u53ef\u6267\u884c\u811a\u672c\uff0c\u7136\u540e\u628a<code>~/bin</code>\u52a0\u5165<code>$PATH</code>\u3002</p> <pre><code>export PATH=$PATH:~/bin\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u6539\u53d8\u73af\u5883\u53d8\u91cf<code>$PATH</code>\uff0c\u5c06<code>~/bin</code>\u6dfb\u52a0\u5230<code>$PATH</code>\u7684\u672b\u5c3e\u3002\u53ef\u4ee5\u5c06\u8fd9\u4e00\u884c\u52a0\u5230<code>~/.bashrc</code>\u6587\u4ef6\u91cc\u9762\uff0c\u7136\u540e\u91cd\u65b0\u52a0\u8f7d\u4e00\u6b21<code>.bashrc</code>\uff0c\u8fd9\u4e2a\u914d\u7f6e\u5c31\u53ef\u4ee5\u751f\u6548\u4e86\u3002</p> <pre><code>$ source ~/.bashrc\n</code></pre> <p>\u4ee5\u540e\u4e0d\u7ba1\u5728\u4ec0\u4e48\u76ee\u5f55\uff0c\u76f4\u63a5\u8f93\u5165\u811a\u672c\u6587\u4ef6\u540d\uff0c\u811a\u672c\u5c31\u4f1a\u6267\u884c\u3002</p> <pre><code>$ script.sh\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u6ca1\u6709\u6307\u5b9a\u811a\u672c\u8def\u5f84\uff0c\u56e0\u4e3a<code>script.sh</code>\u5728<code>$PATH</code>\u6307\u5b9a\u7684\u76ee\u5f55\u4e2d\u3002</p>"},{"location":"linux/bash/script/#env","title":"env \u547d\u4ee4","text":"<p><code>env</code>\u547d\u4ee4\u603b\u662f\u6307\u5411<code>/usr/bin/env</code>\u6587\u4ef6\uff0c\u6216\u8005\u8bf4\uff0c\u8fd9\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\u603b\u662f\u5728\u76ee\u5f55<code>/usr/bin</code>\u3002</p> <p><code>#!/usr/bin/env NAME</code>\u8fd9\u4e2a\u8bed\u6cd5\u7684\u610f\u601d\u662f\uff0c\u8ba9 Shell \u67e5\u627e<code>$PATH</code>\u73af\u5883\u53d8\u91cf\u91cc\u9762\u7b2c\u4e00\u4e2a\u5339\u914d\u7684<code>NAME</code>\u3002\u5982\u679c\u4f60\u4e0d\u77e5\u9053\u67d0\u4e2a\u547d\u4ee4\u7684\u5177\u4f53\u8def\u5f84\uff0c\u6216\u8005\u5e0c\u671b\u517c\u5bb9\u5176\u4ed6\u7528\u6237\u7684\u673a\u5668\uff0c\u8fd9\u6837\u7684\u5199\u6cd5\u5c31\u5f88\u6709\u7528\u3002</p> <p><code>/usr/bin/env bash</code>\u7684\u610f\u601d\u5c31\u662f\uff0c\u8fd4\u56de<code>bash</code>\u53ef\u6267\u884c\u6587\u4ef6\u7684\u4f4d\u7f6e\uff0c\u524d\u63d0\u662f<code>bash</code>\u7684\u8def\u5f84\u662f\u5728<code>$PATH</code>\u91cc\u9762\u3002\u5176\u4ed6\u811a\u672c\u6587\u4ef6\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e2a\u547d\u4ee4\u3002\u6bd4\u5982 Node.js \u811a\u672c\u7684 Shebang \u884c\uff0c\u53ef\u4ee5\u5199\u6210\u4e0b\u9762\u8fd9\u6837\u3002</p> <pre><code>#!/usr/bin/env node\n</code></pre> <p><code>env</code>\u547d\u4ee4\u7684\u53c2\u6570\u5982\u4e0b\u3002</p> <ul> <li><code>-i</code>, <code>--ignore-environment</code>\uff1a\u4e0d\u5e26\u73af\u5883\u53d8\u91cf\u542f\u52a8\u3002</li> <li><code>-u</code>, <code>--unset=NAME</code>\uff1a\u4ece\u73af\u5883\u53d8\u91cf\u4e2d\u5220\u9664\u4e00\u4e2a\u53d8\u91cf\u3002</li> <li><code>--help</code>\uff1a\u663e\u793a\u5e2e\u52a9\u3002</li> <li><code>--version</code>\uff1a\u8f93\u51fa\u7248\u672c\u4fe1\u606f\u3002</li> </ul> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\uff0c\u65b0\u5efa\u4e00\u4e2a\u4e0d\u5e26\u4efb\u4f55\u73af\u5883\u53d8\u91cf\u7684 Shell\u3002</p> <pre><code>$ env -i /bin/sh\n</code></pre>"},{"location":"linux/bash/script/#_2","title":"\u6ce8\u91ca","text":"<p>Bash \u811a\u672c\u4e2d\uff0c<code>#</code>\u8868\u793a\u6ce8\u91ca\uff0c\u53ef\u4ee5\u653e\u5728\u884c\u9996\uff0c\u4e5f\u53ef\u4ee5\u653e\u5728\u884c\u5c3e\u3002</p> <pre><code># \u672c\u884c\u662f\u6ce8\u91ca\necho 'Hello World!'\n\necho 'Hello World!' # \u4e95\u53f7\u540e\u9762\u7684\u90e8\u5206\u4e5f\u662f\u6ce8\u91ca\n</code></pre> <p>\u5efa\u8bae\u5728\u811a\u672c\u5f00\u5934\uff0c\u4f7f\u7528\u6ce8\u91ca\u8bf4\u660e\u5f53\u524d\u811a\u672c\u7684\u4f5c\u7528\uff0c\u8fd9\u6837\u6709\u5229\u4e8e\u65e5\u540e\u7684\u7ef4\u62a4\u3002</p>"},{"location":"linux/bash/script/#_3","title":"\u811a\u672c\u53c2\u6570","text":"<p>\u8c03\u7528\u811a\u672c\u7684\u65f6\u5019\uff0c\u811a\u672c\u6587\u4ef6\u540d\u540e\u9762\u53ef\u4ee5\u5e26\u6709\u53c2\u6570\u3002</p> <pre><code>$ script.sh word1 word2 word3\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>script.sh</code>\u662f\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\uff0c<code>word1</code>\u3001<code>word2</code>\u548c<code>word3</code>\u662f\u4e09\u4e2a\u53c2\u6570\u3002</p> <p>\u811a\u672c\u6587\u4ef6\u5185\u90e8\uff0c\u53ef\u4ee5\u4f7f\u7528\u7279\u6b8a\u53d8\u91cf\uff0c\u5f15\u7528\u8fd9\u4e9b\u53c2\u6570\u3002</p> <ul> <li><code>$0</code>\uff1a\u811a\u672c\u6587\u4ef6\u540d\uff0c\u5373<code>script.sh</code>\u3002</li> <li><code>$1</code>~<code>$9</code>\uff1a\u5bf9\u5e94\u811a\u672c\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u5230\u7b2c\u4e5d\u4e2a\u53c2\u6570\u3002</li> <li><code>$#</code>\uff1a\u53c2\u6570\u7684\u603b\u6570\u3002</li> <li><code>$@</code>\uff1a\u5168\u90e8\u7684\u53c2\u6570\uff0c\u53c2\u6570\u4e4b\u95f4\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u3002</li> <li><code>$*</code>\uff1a\u5168\u90e8\u7684\u53c2\u6570\uff0c\u53c2\u6570\u4e4b\u95f4\u4f7f\u7528\u53d8\u91cf<code>$IFS</code>\u503c\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u5206\u9694\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u683c\uff0c\u4f46\u662f\u53ef\u4ee5\u81ea\u5b9a\u4e49\u3002</li> </ul> <p>\u5982\u679c\u811a\u672c\u7684\u53c2\u6570\u591a\u4e8e9\u4e2a\uff0c\u90a3\u4e48\u7b2c10\u4e2a\u53c2\u6570\u53ef\u4ee5\u7528<code>${10}</code>\u7684\u5f62\u5f0f\u5f15\u7528\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <p>\u6ce8\u610f\uff0c\u5982\u679c\u547d\u4ee4\u662f<code>command -o foo bar</code>\uff0c\u90a3\u4e48<code>-o</code>\u662f<code>$1</code>\uff0c<code>foo</code>\u662f<code>$2</code>\uff0c<code>bar</code>\u662f<code>$3</code>\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u811a\u672c\u5185\u90e8\u8bfb\u53d6\u547d\u4ee4\u884c\u53c2\u6570\u7684\u4f8b\u5b50\u3002</p> <pre><code>#!/bin/bash\n# script.sh\n\necho \"\u5168\u90e8\u53c2\u6570\uff1a\" $@\necho \"\u547d\u4ee4\u884c\u53c2\u6570\u6570\u91cf\uff1a\" $#\necho '$0 = ' $0\necho '$1 = ' $1\necho '$2 = ' $2\necho '$3 = ' $3\n</code></pre> <p>\u6267\u884c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ ./script.sh a b c\n\u5168\u90e8\u53c2\u6570\uff1aa b c\n\u547d\u4ee4\u884c\u53c2\u6570\u6570\u91cf\uff1a3\n$0 =  script.sh\n$1 =  a\n$2 =  b\n$3 =  c\n</code></pre> <p>\u7528\u6237\u53ef\u4ee5\u8f93\u5165\u4efb\u610f\u6570\u91cf\u7684\u53c2\u6570\uff0c\u5229\u7528<code>for</code>\u5faa\u73af\uff0c\u53ef\u4ee5\u8bfb\u53d6\u6bcf\u4e00\u4e2a\u53c2\u6570\u3002</p> <pre><code>#!/bin/bash\n\nfor i in \"$@\"; do\n  echo $i\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>$@</code>\u8fd4\u56de\u4e00\u4e2a\u5168\u90e8\u53c2\u6570\u7684\u5217\u8868\uff0c\u7136\u540e\u4f7f\u7528<code>for</code>\u5faa\u73af\u904d\u5386\u3002</p> <p>\u5982\u679c\u591a\u4e2a\u53c2\u6570\u653e\u5728\u53cc\u5f15\u53f7\u91cc\u9762\uff0c\u89c6\u4e3a\u4e00\u4e2a\u53c2\u6570\u3002</p> <pre><code>$ ./script.sh \"a b\"\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0cBash \u4f1a\u8ba4\u4e3a<code>\"a b\"</code>\u662f\u4e00\u4e2a\u53c2\u6570\uff0c<code>$1</code>\u4f1a\u8fd4\u56de<code>a b</code>\u3002\u6ce8\u610f\uff0c\u8fd4\u56de\u65f6\u4e0d\u5305\u62ec\u53cc\u5f15\u53f7\u3002</p>"},{"location":"linux/bash/script/#shift","title":"shift \u547d\u4ee4","text":"<p><code>shift</code>\u547d\u4ee4\u53ef\u4ee5\u6539\u53d8\u811a\u672c\u53c2\u6570\uff0c\u6bcf\u6b21\u6267\u884c\u90fd\u4f1a\u79fb\u9664\u811a\u672c\u5f53\u524d\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff08<code>$1</code>\uff09\uff0c\u4f7f\u5f97\u540e\u9762\u7684\u53c2\u6570\u5411\u524d\u4e00\u4f4d\uff0c\u5373<code>$2</code>\u53d8\u6210<code>$1</code>\u3001<code>$3</code>\u53d8\u6210<code>$2</code>\u3001<code>$4</code>\u53d8\u6210<code>$3</code>\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <p><code>while</code>\u5faa\u73af\u7ed3\u5408<code>shift</code>\u547d\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u8bfb\u53d6\u6bcf\u4e00\u4e2a\u53c2\u6570\u3002</p> <pre><code>#!/bin/bash\n\necho \"\u4e00\u5171\u8f93\u5165\u4e86 $# \u4e2a\u53c2\u6570\"\n\nwhile [ \"$1\" != \"\" ]; do\n  echo \"\u5269\u4e0b $# \u4e2a\u53c2\u6570\"\n  echo \"\u53c2\u6570\uff1a$1\"\n  shift\ndone\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>shift</code>\u547d\u4ee4\u6bcf\u6b21\u79fb\u9664\u5f53\u524d\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u4ece\u800c\u901a\u8fc7<code>while</code>\u5faa\u73af\u904d\u5386\u6240\u6709\u53c2\u6570\u3002</p> <p><code>shift</code>\u547d\u4ee4\u53ef\u4ee5\u63a5\u53d7\u4e00\u4e2a\u6574\u6570\u4f5c\u4e3a\u53c2\u6570\uff0c\u6307\u5b9a\u6240\u8981\u79fb\u9664\u7684\u53c2\u6570\u4e2a\u6570\uff0c\u9ed8\u8ba4\u4e3a<code>1</code>\u3002</p> <pre><code>shift 3\n</code></pre> <p>\u4e0a\u9762\u7684\u547d\u4ee4\u79fb\u9664\u524d\u4e09\u4e2a\u53c2\u6570\uff0c\u539f\u6765\u7684<code>$4</code>\u53d8\u6210<code>$1</code>\u3002</p>"},{"location":"linux/bash/script/#getopts","title":"getopts \u547d\u4ee4","text":"<p><code>getopts</code>\u547d\u4ee4\u7528\u5728\u811a\u672c\u5185\u90e8\uff0c\u53ef\u4ee5\u89e3\u6790\u590d\u6742\u7684\u811a\u672c\u547d\u4ee4\u884c\u53c2\u6570\uff0c\u901a\u5e38\u4e0e<code>while</code>\u5faa\u73af\u4e00\u8d77\u4f7f\u7528\uff0c\u53d6\u51fa\u811a\u672c\u6240\u6709\u7684\u5e26\u6709\u524d\u7f6e\u8fde\u8bcd\u7ebf\uff08<code>-</code>\uff09\u7684\u53c2\u6570\u3002</p> <pre><code>getopts optstring name\n</code></pre> <p>\u5b83\u5e26\u6709\u4e24\u4e2a\u53c2\u6570\u3002\u7b2c\u4e00\u4e2a\u53c2\u6570<code>optstring</code>\u662f\u5b57\u7b26\u4e32\uff0c\u7ed9\u51fa\u811a\u672c\u6240\u6709\u7684\u8fde\u8bcd\u7ebf\u53c2\u6570\u3002\u6bd4\u5982\uff0c\u67d0\u4e2a\u811a\u672c\u53ef\u4ee5\u6709\u4e09\u4e2a\u914d\u7f6e\u9879\u53c2\u6570<code>-l</code>\u3001<code>-h</code>\u3001<code>-a</code>\uff0c\u5176\u4e2d\u53ea\u6709<code>-a</code>\u53ef\u4ee5\u5e26\u6709\u53c2\u6570\u503c\uff0c\u800c<code>-l</code>\u548c<code>-h</code>\u662f\u5f00\u5173\u53c2\u6570\uff0c\u90a3\u4e48<code>getopts</code>\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u5199\u6210<code>lha:</code>\uff0c\u987a\u5e8f\u4e0d\u91cd\u8981\u3002\u6ce8\u610f\uff0c<code>a</code>\u540e\u9762\u6709\u4e00\u4e2a\u5192\u53f7\uff0c\u8868\u793a\u8be5\u53c2\u6570\u5e26\u6709\u53c2\u6570\u503c\uff0c<code>getopts</code>\u89c4\u5b9a\u5e26\u6709\u53c2\u6570\u503c\u7684\u914d\u7f6e\u9879\u53c2\u6570\uff0c\u540e\u9762\u5fc5\u987b\u5e26\u6709\u4e00\u4e2a\u5192\u53f7\uff08<code>:</code>\uff09\u3002<code>getopts</code>\u7684\u7b2c\u4e8c\u4e2a\u53c2\u6570<code>name</code>\u662f\u4e00\u4e2a\u53d8\u91cf\u540d\uff0c\u7528\u6765\u4fdd\u5b58\u5f53\u524d\u53d6\u5230\u7684\u914d\u7f6e\u9879\u53c2\u6570\uff0c\u5373<code>l</code>\u3001<code>h</code>\u6216<code>a</code>\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>while getopts 'lha:' OPTION; do\n  case \"$OPTION\" in\n    l)\n      echo \"linuxconfig\"\n      ;;\n\n    h)\n      echo \"h stands for h\"\n      ;;\n\n    a)\n      avalue=\"$OPTARG\"\n      echo \"The value provided is $OPTARG\"\n      ;;\n    ?)\n      echo \"script usage: $(basename $0) [-l] [-h] [-a somevalue]\" &gt;&amp;2\n      exit 1\n      ;;\n  esac\ndone\nshift \"$(($OPTIND - 1))\"\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>while</code>\u5faa\u73af\u4e0d\u65ad\u6267\u884c<code>getopts 'lha:' OPTION</code>\u547d\u4ee4\uff0c\u6bcf\u6b21\u6267\u884c\u5c31\u4f1a\u8bfb\u53d6\u4e00\u4e2a\u8fde\u8bcd\u7ebf\u53c2\u6570\uff08\u4ee5\u53ca\u5bf9\u5e94\u7684\u53c2\u6570\u503c\uff09\uff0c\u7136\u540e\u8fdb\u5165\u5faa\u73af\u4f53\u3002\u53d8\u91cf<code>OPTION</code>\u4fdd\u5b58\u7684\u662f\uff0c\u5f53\u524d\u5904\u7406\u7684\u90a3\u4e00\u4e2a\u8fde\u8bcd\u7ebf\u53c2\u6570\uff08\u5373<code>l</code>\u3001<code>h</code>\u6216<code>a</code>\uff09\u3002\u5982\u679c\u7528\u6237\u8f93\u5165\u4e86\u6ca1\u6709\u6307\u5b9a\u7684\u53c2\u6570\uff08\u6bd4\u5982<code>-x</code>\uff09\uff0c\u90a3\u4e48<code>OPTION</code>\u7b49\u4e8e<code>?</code>\u3002\u5faa\u73af\u4f53\u5185\u4f7f\u7528<code>case</code>\u5224\u65ad\uff0c\u5904\u7406\u8fd9\u56db\u79cd\u4e0d\u540c\u7684\u60c5\u51b5\u3002</p> <p>\u5982\u679c\u67d0\u4e2a\u8fde\u8bcd\u7ebf\u53c2\u6570\u5e26\u6709\u53c2\u6570\u503c\uff0c\u6bd4\u5982<code>-a foo</code>\uff0c\u90a3\u4e48\u5904\u7406<code>a</code>\u53c2\u6570\u7684\u65f6\u5019\uff0c\u73af\u5883\u53d8\u91cf<code>$OPTARG</code>\u4fdd\u5b58\u7684\u5c31\u662f\u53c2\u6570\u503c\u3002</p> <p>\u6ce8\u610f\uff0c\u53ea\u8981\u9047\u5230\u4e0d\u5e26\u8fde\u8bcd\u7ebf\u7684\u53c2\u6570\uff0c<code>getopts</code>\u5c31\u4f1a\u6267\u884c\u5931\u8d25\uff0c\u4ece\u800c\u9000\u51fa<code>while</code>\u5faa\u73af\u3002\u6bd4\u5982\uff0c<code>getopts</code>\u53ef\u4ee5\u89e3\u6790<code>command -l foo</code>\uff0c\u4f46\u4e0d\u53ef\u4ee5\u89e3\u6790<code>command foo -l</code>\u3002\u53e6\u5916\uff0c\u591a\u4e2a\u8fde\u8bcd\u7ebf\u53c2\u6570\u5199\u5728\u4e00\u8d77\u7684\u5f62\u5f0f\uff0c\u6bd4\u5982<code>command -lh</code>\uff0c<code>getopts</code>\u4e5f\u53ef\u4ee5\u6b63\u786e\u5904\u7406\u3002</p> <p>\u53d8\u91cf<code>$OPTIND</code>\u5728<code>getopts</code>\u5f00\u59cb\u6267\u884c\u524d\u662f<code>1</code>\uff0c\u7136\u540e\u6bcf\u6b21\u6267\u884c\u5c31\u4f1a\u52a0<code>1</code>\u3002\u7b49\u5230\u9000\u51fa<code>while</code>\u5faa\u73af\uff0c\u5c31\u610f\u5473\u7740\u8fde\u8bcd\u7ebf\u53c2\u6570\u5168\u90e8\u5904\u7406\u5b8c\u6bd5\u3002\u8fd9\u65f6\uff0c<code>$OPTIND - 1</code>\u5c31\u662f\u5df2\u7ecf\u5904\u7406\u7684\u8fde\u8bcd\u7ebf\u53c2\u6570\u4e2a\u6570\uff0c\u4f7f\u7528<code>shift</code>\u547d\u4ee4\u5c06\u8fd9\u4e9b\u53c2\u6570\u79fb\u9664\uff0c\u4fdd\u8bc1\u540e\u9762\u7684\u4ee3\u7801\u53ef\u4ee5\u7528<code>$1</code>\u3001<code>$2</code>\u7b49\u5904\u7406\u547d\u4ee4\u7684\u4e3b\u53c2\u6570\u3002</p>"},{"location":"linux/bash/script/#-","title":"\u914d\u7f6e\u9879\u53c2\u6570\u7ec8\u6b62\u7b26 <code>--</code>","text":"<p>\u53d8\u91cf\u5f53\u4f5c\u547d\u4ee4\u7684\u53c2\u6570\u65f6\uff0c\u6709\u65f6\u5e0c\u671b\u6307\u5b9a\u53d8\u91cf\u53ea\u80fd\u4f5c\u4e3a\u5b9e\u4f53\u53c2\u6570\uff0c\u4e0d\u80fd\u5f53\u4f5c\u914d\u7f6e\u9879\u53c2\u6570\uff0c\u8fd9\u65f6\u53ef\u4ee5\u4f7f\u7528\u914d\u7f6e\u9879\u53c2\u6570\u7ec8\u6b62\u7b26<code>--</code>\u3002</p> <pre><code>$ myPath=\"~/docs\"\n$ ls -- $myPath\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>--</code>\u5f3a\u5236\u53d8\u91cf<code>$myPath</code>\u53ea\u80fd\u5f53\u4f5c\u5b9e\u4f53\u53c2\u6570\uff08\u5373\u8def\u5f84\u540d\uff09\u89e3\u91ca\u3002</p> <p>\u5982\u679c\u53d8\u91cf\u4e0d\u662f\u8def\u5f84\u540d\uff0c\u5c31\u4f1a\u62a5\u9519\u3002</p> <pre><code>$ myPath=\"-l\"\n$ ls -- $myPath\nls: \u65e0\u6cd5\u8bbf\u95ee'-l': \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53d8\u91cf<code>myPath</code>\u7684\u503c\u4e3a<code>-l</code>\uff0c\u4e0d\u662f\u8def\u5f84\u3002\u4f46\u662f\uff0c<code>--</code>\u5f3a\u5236<code>$myPath</code>\u53ea\u80fd\u4f5c\u4e3a\u8def\u5f84\u89e3\u91ca\uff0c\u5bfc\u81f4\u62a5\u9519\u201c\u4e0d\u5b58\u5728\u8be5\u8def\u5f84\u201d\u3002</p> <p>\u53c2\u6570\u7ec8\u6b62\u7b26\u7684\u4f5c\u7528\u4e3b\u8981\u662f\uff0c\u5982\u679c\u7834\u6298\u53f7\u5f00\u5934\u7684\u53c2\u6570\u8981\u7528\u4f5c\u5b9e\u4f53\u53c2\u6570\uff0c\u5c31\u9700\u8981\u7528\u5230\u5b83\u3002</p> <pre><code>$ grep -- \"--hello\" example.txt\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u5728<code>example.txt</code>\u6587\u4ef6\u91cc\u9762\uff0c\u641c\u7d22\u5b57\u7b26\u4e32<code>--hello</code>\u3002\u8fd9\u4e2a\u5b57\u7b26\u4e32\u662f\u7834\u6298\u53f7\u5f00\u5934\uff0c\u5982\u679c\u4e0d\u7528\u53c2\u6570\u7ec8\u6b62\u7b26\uff0c<code>grep</code>\u547d\u4ee4\u5c31\u4f1a\u628a<code>--hello</code>\u5f53\u4f5c\u914d\u7f6e\u9879\u53c2\u6570\uff0c\u4ece\u800c\u62a5\u9519\u3002</p>"},{"location":"linux/bash/script/#exit","title":"exit \u547d\u4ee4","text":"<p><code>exit</code>\u547d\u4ee4\u7528\u4e8e\u7ec8\u6b62\u5f53\u524d\u811a\u672c\u7684\u6267\u884c\uff0c\u5e76\u5411 Shell \u8fd4\u56de\u4e00\u4e2a\u9000\u51fa\u503c\u3002</p> <pre><code>$ exit\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\u6b62\u5f53\u524d\u811a\u672c\uff0c\u5c06\u6700\u540e\u4e00\u6761\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\uff0c\u4f5c\u4e3a\u6574\u4e2a\u811a\u672c\u7684\u9000\u51fa\u72b6\u6001\u3002</p> <p><code>exit</code>\u547d\u4ee4\u540e\u9762\u53ef\u4ee5\u8ddf\u53c2\u6570\uff0c\u8be5\u53c2\u6570\u5c31\u662f\u9000\u51fa\u72b6\u6001\u3002</p> <pre><code># \u9000\u51fa\u503c\u4e3a0\uff08\u6210\u529f\uff09\n$ exit 0\n\n# \u9000\u51fa\u503c\u4e3a1\uff08\u5931\u8d25\uff09\n$ exit 1\n</code></pre> <p>\u9000\u51fa\u65f6\uff0c\u811a\u672c\u4f1a\u8fd4\u56de\u4e00\u4e2a\u9000\u51fa\u503c\u3002\u811a\u672c\u7684\u9000\u51fa\u503c\uff0c<code>0</code>\u8868\u793a\u6b63\u5e38\uff0c<code>1</code>\u8868\u793a\u53d1\u751f\u9519\u8bef\uff0c<code>2</code>\u8868\u793a\u7528\u6cd5\u4e0d\u5bf9\uff0c<code>126</code>\u8868\u793a\u4e0d\u662f\u53ef\u6267\u884c\u811a\u672c\uff0c<code>127</code>\u8868\u793a\u547d\u4ee4\u6ca1\u6709\u53d1\u73b0\u3002\u5982\u679c\u811a\u672c\u88ab\u4fe1\u53f7<code>N</code>\u7ec8\u6b62\uff0c\u5219\u9000\u51fa\u503c\u4e3a<code>128 + N</code>\u3002\u7b80\u5355\u6765\u8bf4\uff0c\u53ea\u8981\u9000\u51fa\u503c\u975e0\uff0c\u5c31\u8ba4\u4e3a\u6267\u884c\u51fa\u9519\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>if [ $(id -u) != \"0\" ]; then\n  echo \"\u6839\u7528\u6237\u624d\u80fd\u6267\u884c\u5f53\u524d\u811a\u672c\"\n  exit 1\nfi\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c<code>id -u</code>\u547d\u4ee4\u8fd4\u56de\u7528\u6237\u7684 ID\uff0c\u4e00\u65e6\u7528\u6237\u7684 ID \u4e0d\u7b49\u4e8e<code>0</code>\uff08\u6839\u7528\u6237\u7684 ID\uff09\uff0c\u811a\u672c\u5c31\u4f1a\u9000\u51fa\uff0c\u5e76\u4e14\u9000\u51fa\u7801\u4e3a<code>1</code>\uff0c\u8868\u793a\u8fd0\u884c\u5931\u8d25\u3002</p> <p><code>exit</code>\u4e0e<code>return</code>\u547d\u4ee4\u7684\u5dee\u522b\u662f\uff0c<code>return</code>\u547d\u4ee4\u662f\u51fd\u6570\u7684\u9000\u51fa\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u503c\u7ed9\u8c03\u7528\u8005\uff0c\u811a\u672c\u4f9d\u7136\u6267\u884c\u3002<code>exit</code>\u662f\u6574\u4e2a\u811a\u672c\u7684\u9000\u51fa\uff0c\u5982\u679c\u5728\u51fd\u6570\u4e4b\u4e2d\u8c03\u7528<code>exit</code>\uff0c\u5219\u9000\u51fa\u51fd\u6570\uff0c\u5e76\u7ec8\u6b62\u811a\u672c\u6267\u884c\u3002</p>"},{"location":"linux/bash/script/#_4","title":"\u547d\u4ee4\u6267\u884c\u7ed3\u679c","text":"<p>\u547d\u4ee4\u6267\u884c\u7ed3\u675f\u540e\uff0c\u4f1a\u6709\u4e00\u4e2a\u8fd4\u56de\u503c\u3002<code>0</code>\u8868\u793a\u6267\u884c\u6210\u529f\uff0c\u975e<code>0</code>\uff08\u901a\u5e38\u662f<code>1</code>\uff09\u8868\u793a\u6267\u884c\u5931\u8d25\u3002\u73af\u5883\u53d8\u91cf<code>$?</code>\u53ef\u4ee5\u8bfb\u53d6\u524d\u4e00\u4e2a\u547d\u4ee4\u7684\u8fd4\u56de\u503c\u3002</p> <p>\u5229\u7528\u8fd9\u4e00\u70b9\uff0c\u53ef\u4ee5\u5728\u811a\u672c\u4e2d\u5bf9\u547d\u4ee4\u6267\u884c\u7ed3\u679c\u8fdb\u884c\u5224\u65ad\u3002</p> <pre><code>cd $some_directory\nif [ \"$?\" = \"0\" ]; then\n  rm *\nelse\n  echo \"\u65e0\u6cd5\u5207\u6362\u76ee\u5f55\uff01\" 1&gt;&amp;2\n  exit 1\nfi\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>cd $some_directory</code>\u8fd9\u4e2a\u547d\u4ee4\u5982\u679c\u6267\u884c\u6210\u529f\uff08\u8fd4\u56de\u503c\u7b49\u4e8e<code>0</code>\uff09\uff0c\u5c31\u5220\u9664\u8be5\u76ee\u5f55\u91cc\u9762\u7684\u6587\u4ef6\uff0c\u5426\u5219\u9000\u51fa\u811a\u672c\uff0c\u6574\u4e2a\u811a\u672c\u7684\u8fd4\u56de\u503c\u53d8\u4e3a<code>1</code>\uff0c\u8868\u793a\u6267\u884c\u5931\u8d25\u3002</p> <p>\u7531\u4e8e<code>if</code>\u53ef\u4ee5\u76f4\u63a5\u5224\u65ad\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\uff0c\u6267\u884c\u76f8\u5e94\u7684\u64cd\u4f5c\uff0c\u4e0a\u9762\u7684\u811a\u672c\u53ef\u4ee5\u6539\u5199\u6210\u4e0b\u9762\u7684\u6837\u5b50\u3002</p> <pre><code>if cd $some_directory; then\n  rm *\nelse\n  echo \"Could not change directory! Aborting.\" 1&gt;&amp;2\n  exit 1\nfi\n</code></pre> <p>\u66f4\u7b80\u6d01\u7684\u5199\u6cd5\u662f\u5229\u7528\u4e24\u4e2a\u903b\u8f91\u8fd0\u7b97\u7b26<code>&amp;&amp;</code>\uff08\u4e14\uff09\u548c<code>||</code>\uff08\u6216\uff09\u3002</p> <pre><code># \u7b2c\u4e00\u6b65\u6267\u884c\u6210\u529f\uff0c\u624d\u4f1a\u6267\u884c\u7b2c\u4e8c\u6b65\ncd $some_directory &amp;&amp; rm *\n\n# \u7b2c\u4e00\u6b65\u6267\u884c\u5931\u8d25\uff0c\u624d\u4f1a\u6267\u884c\u7b2c\u4e8c\u6b65\ncd $some_directory || exit 1\n</code></pre>"},{"location":"linux/bash/script/#source","title":"source \u547d\u4ee4","text":"<p><code>source</code>\u547d\u4ee4\u7528\u4e8e\u6267\u884c\u4e00\u4e2a\u811a\u672c\uff0c\u901a\u5e38\u7528\u4e8e\u91cd\u65b0\u52a0\u8f7d\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u3002</p> <pre><code>$ source .bashrc\n</code></pre> <p><code>source</code>\u547d\u4ee4\u6700\u5927\u7684\u7279\u70b9\u662f\u5728\u5f53\u524d Shell \u6267\u884c\u811a\u672c\uff0c\u4e0d\u50cf\u76f4\u63a5\u6267\u884c\u811a\u672c\u65f6\uff0c\u4f1a\u65b0\u5efa\u4e00\u4e2a\u5b50 Shell\u3002\u6240\u4ee5\uff0c<code>source</code>\u547d\u4ee4\u6267\u884c\u811a\u672c\u65f6\uff0c\u4e0d\u9700\u8981<code>export</code>\u53d8\u91cf\u3002</p> <pre><code>#!/bin/bash\n# test.sh\necho $foo\n</code></pre> <p>\u4e0a\u9762\u811a\u672c\u8f93\u51fa<code>$foo</code>\u53d8\u91cf\u7684\u503c\u3002</p> <pre><code># \u5f53\u524d Shell \u65b0\u5efa\u4e00\u4e2a\u53d8\u91cf foo\n$ foo=1\n\n# \u6253\u5370\u8f93\u51fa 1\n$ source test.sh\n1\n\n# \u6253\u5370\u8f93\u51fa\u7a7a\u5b57\u7b26\u4e32\n$ bash test.sh\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5f53\u524d Shell \u7684\u53d8\u91cf<code>foo</code>\u5e76\u6ca1\u6709<code>export</code>\uff0c\u6240\u4ee5\u76f4\u63a5\u6267\u884c\u65e0\u6cd5\u8bfb\u53d6\uff0c\u4f46\u662f<code>source</code>\u6267\u884c\u53ef\u4ee5\u8bfb\u53d6\u3002</p> <p><code>source</code>\u547d\u4ee4\u7684\u53e6\u4e00\u4e2a\u7528\u9014\uff0c\u662f\u5728\u811a\u672c\u5185\u90e8\u52a0\u8f7d\u5916\u90e8\u5e93\u3002</p> <pre><code>#!/bin/bash\n\nsource ./lib.sh\n\nfunction_from_lib\n</code></pre> <p>\u4e0a\u9762\u811a\u672c\u5728\u5185\u90e8\u4f7f\u7528<code>source</code>\u547d\u4ee4\u52a0\u8f7d\u4e86\u4e00\u4e2a\u5916\u90e8\u5e93\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5728\u811a\u672c\u91cc\u9762\uff0c\u4f7f\u7528\u8fd9\u4e2a\u5916\u90e8\u5e93\u5b9a\u4e49\u7684\u51fd\u6570\u3002</p> <p><code>source</code>\u6709\u4e00\u4e2a\u7b80\u5199\u5f62\u5f0f\uff0c\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u70b9\uff08<code>.</code>\uff09\u6765\u8868\u793a\u3002</p> <pre><code>$ . .bashrc\n</code></pre>"},{"location":"linux/bash/script/#alias","title":"\u522b\u540d\uff0calias \u547d\u4ee4","text":"<p><code>alias</code>\u547d\u4ee4\u7528\u6765\u4e3a\u4e00\u4e2a\u547d\u4ee4\u6307\u5b9a\u522b\u540d\uff0c\u8fd9\u6837\u66f4\u4fbf\u4e8e\u8bb0\u5fc6\u3002\u4e0b\u9762\u662f<code>alias</code>\u7684\u683c\u5f0f\u3002</p> <pre><code>alias NAME=DEFINITION\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c<code>NAME</code>\u662f\u522b\u540d\u7684\u540d\u79f0\uff0c<code>DEFINITION</code>\u662f\u522b\u540d\u5bf9\u5e94\u7684\u539f\u59cb\u547d\u4ee4\u3002\u6ce8\u610f\uff0c\u7b49\u53f7\u4e24\u4fa7\u4e0d\u80fd\u6709\u7a7a\u683c\uff0c\u5426\u5219\u4f1a\u62a5\u9519\u3002</p> <p>\u4e00\u4e2a\u5e38\u89c1\u7684\u4f8b\u5b50\u662f\u4e3a<code>grep</code>\u547d\u4ee4\u8d77\u4e00\u4e2a<code>search</code>\u7684\u522b\u540d\u3002</p> <pre><code>alias search=grep\n</code></pre> <p><code>alias</code>\u4e5f\u53ef\u4ee5\u7528\u6765\u4e3a\u957f\u547d\u4ee4\u6307\u5b9a\u4e00\u4e2a\u66f4\u77ed\u7684\u522b\u540d\u3002\u4e0b\u9762\u662f\u901a\u8fc7\u522b\u540d\u5b9a\u4e49\u4e00\u4e2a<code>today</code>\u7684\u547d\u4ee4\u3002</p> <pre><code>$ alias today='date +\"%A, %B %-d, %Y\"'\n$ today\n\u661f\u671f\u4e00, \u4e00\u6708 6, 2020\n</code></pre> <p>\u6709\u65f6\u4e3a\u4e86\u9632\u6b62\u8bef\u5220\u9664\u6587\u4ef6\uff0c\u53ef\u4ee5\u6307\u5b9a<code>rm</code>\u547d\u4ee4\u7684\u522b\u540d\u3002</p> <pre><code>$ alias rm='rm -i'\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u6307\u5b9a<code>rm</code>\u547d\u4ee4\u662f<code>rm -i</code>\uff0c\u6bcf\u6b21\u5220\u9664\u6587\u4ef6\u4e4b\u524d\uff0c\u90fd\u4f1a\u8ba9\u7528\u6237\u786e\u8ba4\u3002</p> <p><code>alias</code>\u5b9a\u4e49\u7684\u522b\u540d\u4e5f\u53ef\u4ee5\u63a5\u53d7\u53c2\u6570\uff0c\u53c2\u6570\u4f1a\u76f4\u63a5\u4f20\u5165\u539f\u59cb\u547d\u4ee4\u3002</p> <pre><code>$ alias echo='echo It says: '\n$ echo hello world\nIt says: hello world\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u522b\u540d\u5b9a\u4e49\u4e86<code>echo</code>\u547d\u4ee4\u7684\u524d\u4e24\u4e2a\u53c2\u6570\uff0c\u7b49\u540c\u4e8e\u4fee\u6539\u4e86<code>echo</code>\u547d\u4ee4\u7684\u9ed8\u8ba4\u884c\u4e3a\u3002</p> <p>\u6307\u5b9a\u522b\u540d\u4ee5\u540e\uff0c\u5c31\u53ef\u4ee5\u50cf\u4f7f\u7528\u5176\u4ed6\u547d\u4ee4\u4e00\u6837\u4f7f\u7528\u522b\u540d\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u90fd\u4f1a\u628a\u5e38\u7528\u7684\u522b\u540d\u5199\u5728<code>~/.bashrc</code>\u7684\u672b\u5c3e\u3002\u53e6\u5916\uff0c\u53ea\u80fd\u4e3a\u547d\u4ee4\u5b9a\u4e49\u522b\u540d\uff0c\u4e3a\u5176\u4ed6\u90e8\u5206\uff08\u6bd4\u5982\u5f88\u957f\u7684\u8def\u5f84\uff09\u5b9a\u4e49\u522b\u540d\u662f\u65e0\u6548\u7684\u3002</p> <p>\u76f4\u63a5\u8c03\u7528<code>alias</code>\u547d\u4ee4\uff0c\u53ef\u4ee5\u663e\u793a\u6240\u6709\u522b\u540d\u3002</p> <pre><code>$ alias\n</code></pre> <p><code>unalias</code>\u547d\u4ee4\u53ef\u4ee5\u89e3\u9664\u522b\u540d\u3002</p> <pre><code>$ unalias lt\n</code></pre>"},{"location":"linux/bash/script/#_5","title":"\u53c2\u8003\u94fe\u63a5","text":"<ul> <li>How to use getopts to parse a script options, Egidio Docile</li> </ul>"},{"location":"linux/bash/set/","title":"set \u547d\u4ee4\uff0cshopt \u547d\u4ee4","text":"<p><code>set</code>\u547d\u4ee4\u662f Bash \u811a\u672c\u7684\u91cd\u8981\u73af\u8282\uff0c\u5374\u5e38\u5e38\u88ab\u5ffd\u89c6\uff0c\u5bfc\u81f4\u811a\u672c\u7684\u5b89\u5168\u6027\u548c\u53ef\u7ef4\u62a4\u6027\u51fa\u95ee\u9898\u3002\u672c\u7ae0\u4ecb\u7ecd<code>set</code>\u7684\u57fa\u672c\u7528\u6cd5\uff0c\u5e2e\u52a9\u4f60\u5199\u51fa\u66f4\u5b89\u5168\u7684 Bash \u811a\u672c\u3002</p>"},{"location":"linux/bash/set/#_1","title":"\u7b80\u4ecb","text":"<p>\u6211\u4eec\u77e5\u9053\uff0cBash \u6267\u884c\u811a\u672c\u65f6\uff0c\u4f1a\u521b\u5efa\u4e00\u4e2a\u5b50 Shell\u3002</p> <pre><code>$ bash script.sh\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>script.sh</code>\u662f\u5728\u4e00\u4e2a\u5b50 Shell \u91cc\u9762\u6267\u884c\u3002\u8fd9\u4e2a\u5b50 Shell \u5c31\u662f\u811a\u672c\u7684\u6267\u884c\u73af\u5883\uff0cBash \u9ed8\u8ba4\u7ed9\u5b9a\u4e86\u8fd9\u4e2a\u73af\u5883\u7684\u5404\u79cd\u53c2\u6570\u3002</p> <p><code>set</code>\u547d\u4ee4\u7528\u6765\u4fee\u6539\u5b50 Shell \u73af\u5883\u7684\u8fd0\u884c\u53c2\u6570\uff0c\u5373\u5b9a\u5236\u73af\u5883\u3002\u4e00\u5171\u6709\u5341\u51e0\u4e2a\u53c2\u6570\u53ef\u4ee5\u5b9a\u5236\uff0c\u5b98\u65b9\u624b\u518c\u6709\u5b8c\u6574\u6e05\u5355\uff0c\u672c\u7ae0\u4ecb\u7ecd\u5176\u4e2d\u6700\u5e38\u7528\u7684\u51e0\u4e2a\u3002</p> <p>\u987a\u4fbf\u63d0\u4e00\u4e0b\uff0c\u5982\u679c\u547d\u4ee4\u884c\u4e0b\u4e0d\u5e26\u4efb\u4f55\u53c2\u6570\uff0c\u76f4\u63a5\u8fd0\u884c<code>set</code>\uff0c\u4f1a\u663e\u793a\u6240\u6709\u7684\u73af\u5883\u53d8\u91cf\u548c Shell \u51fd\u6570\u3002</p> <pre><code>$ set\n</code></pre>"},{"location":"linux/bash/set/#set-u","title":"set -u","text":"<p>\u6267\u884c\u811a\u672c\u65f6\uff0c\u5982\u679c\u9047\u5230\u4e0d\u5b58\u5728\u7684\u53d8\u91cf\uff0cBash \u9ed8\u8ba4\u5ffd\u7565\u5b83\u3002</p> <pre><code>#!/usr/bin/env bash\n\necho $a\necho bar\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>$a</code>\u662f\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u53d8\u91cf\u3002\u6267\u884c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ bash script.sh\n\nbar\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c<code>echo $a</code>\u8f93\u51fa\u4e86\u4e00\u4e2a\u7a7a\u884c\uff0cBash \u5ffd\u7565\u4e86\u4e0d\u5b58\u5728\u7684<code>$a</code>\uff0c\u7136\u540e\u7ee7\u7eed\u6267\u884c<code>echo bar</code>\u3002\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u8fd9\u4e0d\u662f\u5f00\u53d1\u8005\u60f3\u8981\u7684\u884c\u4e3a\uff0c\u9047\u5230\u53d8\u91cf\u4e0d\u5b58\u5728\uff0c\u811a\u672c\u5e94\u8be5\u62a5\u9519\uff0c\u800c\u4e0d\u662f\u4e00\u58f0\u4e0d\u54cd\u5730\u5f80\u4e0b\u6267\u884c\u3002</p> <p><code>set -u</code>\u5c31\u7528\u6765\u6539\u53d8\u8fd9\u79cd\u884c\u4e3a\u3002\u811a\u672c\u5728\u5934\u90e8\u52a0\u4e0a\u5b83\uff0c\u9047\u5230\u4e0d\u5b58\u5728\u7684\u53d8\u91cf\u5c31\u4f1a\u62a5\u9519\uff0c\u5e76\u505c\u6b62\u6267\u884c\u3002</p> <pre><code>#!/usr/bin/env bash\nset -u\n\necho $a\necho bar\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ bash script.sh\nbash: script.sh:\u884c4: a: \u672a\u7ed1\u5b9a\u7684\u53d8\u91cf\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u811a\u672c\u62a5\u9519\u4e86\uff0c\u5e76\u4e14\u4e0d\u518d\u6267\u884c\u540e\u9762\u7684\u8bed\u53e5\u3002</p> <p><code>-u</code>\u8fd8\u6709\u53e6\u4e00\u79cd\u5199\u6cd5<code>-o nounset</code>\uff0c\u4e24\u8005\u662f\u7b49\u4ef7\u7684\u3002</p> <pre><code>set -o nounset\n</code></pre>"},{"location":"linux/bash/set/#set-x","title":"set -x","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u811a\u672c\u6267\u884c\u540e\uff0c\u53ea\u8f93\u51fa\u8fd0\u884c\u7ed3\u679c\uff0c\u6ca1\u6709\u5176\u4ed6\u5185\u5bb9\u3002\u5982\u679c\u591a\u4e2a\u547d\u4ee4\u8fde\u7eed\u6267\u884c\uff0c\u5b83\u4eec\u7684\u8fd0\u884c\u7ed3\u679c\u5c31\u4f1a\u8fde\u7eed\u8f93\u51fa\u3002\u6709\u65f6\u4f1a\u5206\u4e0d\u6e05\uff0c\u67d0\u4e00\u6bb5\u5185\u5bb9\u662f\u4ec0\u4e48\u547d\u4ee4\u4ea7\u751f\u7684\u3002</p> <p><code>set -x</code>\u7528\u6765\u5728\u8fd0\u884c\u7ed3\u679c\u4e4b\u524d\uff0c\u5148\u8f93\u51fa\u6267\u884c\u7684\u90a3\u4e00\u884c\u547d\u4ee4\u3002</p> <pre><code>#!/usr/bin/env bash\nset -x\n\necho bar\n</code></pre> <p>\u6267\u884c\u4e0a\u9762\u7684\u811a\u672c\uff0c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ bash script.sh\n+ echo bar\nbar\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u6267\u884c<code>echo bar</code>\u4e4b\u524d\uff0c\u8be5\u547d\u4ee4\u4f1a\u5148\u6253\u5370\u51fa\u6765\uff0c\u884c\u9996\u4ee5<code>+</code>\u8868\u793a\u3002\u8fd9\u5bf9\u4e8e\u8c03\u8bd5\u590d\u6742\u7684\u811a\u672c\u662f\u5f88\u6709\u7528\u7684\u3002</p> <p><code>-x</code>\u8fd8\u6709\u53e6\u4e00\u79cd\u5199\u6cd5<code>-o xtrace</code>\u3002</p> <pre><code>set -o xtrace\n</code></pre> <p>\u811a\u672c\u5f53\u4e2d\u5982\u679c\u8981\u5173\u95ed\u547d\u4ee4\u8f93\u51fa\uff0c\u53ef\u4ee5\u4f7f\u7528<code>set +x</code>\u3002</p> <pre><code>#!/bin/bash\n\nnumber=1\n\nset -x\nif [ $number = \"1\" ]; then\n  echo \"Number equals 1\"\nelse\n  echo \"Number does not equal 1\"\nfi\nset +x\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u53ea\u5bf9\u7279\u5b9a\u7684\u4ee3\u7801\u6bb5\u6253\u5f00\u547d\u4ee4\u8f93\u51fa\u3002</p>"},{"location":"linux/bash/set/#bash","title":"Bash \u7684\u9519\u8bef\u5904\u7406","text":"<p>\u5982\u679c\u811a\u672c\u91cc\u9762\u6709\u8fd0\u884c\u5931\u8d25\u7684\u547d\u4ee4\uff08\u8fd4\u56de\u503c\u975e<code>0</code>\uff09\uff0cBash \u9ed8\u8ba4\u4f1a\u7ee7\u7eed\u6267\u884c\u540e\u9762\u7684\u547d\u4ee4\u3002</p> <pre><code>#!/usr/bin/env bash\n\nfoo\necho bar\n</code></pre> <p>\u4e0a\u9762\u811a\u672c\u4e2d\uff0c<code>foo</code>\u662f\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u547d\u4ee4\uff0c\u6267\u884c\u65f6\u4f1a\u62a5\u9519\u3002\u4f46\u662f\uff0cBash \u4f1a\u5ffd\u7565\u8fd9\u4e2a\u9519\u8bef\uff0c\u7ee7\u7eed\u5f80\u4e0b\u6267\u884c\u3002</p> <pre><code>$ bash script.sh\nscript.sh:\u884c3: foo: \u672a\u627e\u5230\u547d\u4ee4\nbar\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0cBash \u53ea\u662f\u663e\u793a\u6709\u9519\u8bef\uff0c\u5e76\u6ca1\u6709\u7ec8\u6b62\u6267\u884c\u3002</p> <p>\u8fd9\u79cd\u884c\u4e3a\u5f88\u4e0d\u5229\u4e8e\u811a\u672c\u5b89\u5168\u548c\u9664\u9519\u3002\u5b9e\u9645\u5f00\u53d1\u4e2d\uff0c\u5982\u679c\u67d0\u4e2a\u547d\u4ee4\u5931\u8d25\uff0c\u5f80\u5f80\u9700\u8981\u811a\u672c\u505c\u6b62\u6267\u884c\uff0c\u9632\u6b62\u9519\u8bef\u7d2f\u79ef\u3002\u8fd9\u65f6\uff0c\u4e00\u822c\u91c7\u7528\u4e0b\u9762\u7684\u5199\u6cd5\u3002</p> <pre><code>command || exit 1\n</code></pre> <p>\u4e0a\u9762\u7684\u5199\u6cd5\u8868\u793a\u53ea\u8981<code>command</code>\u6709\u975e\u96f6\u8fd4\u56de\u503c\uff0c\u811a\u672c\u5c31\u4f1a\u505c\u6b62\u6267\u884c\u3002</p> <p>\u5982\u679c\u505c\u6b62\u6267\u884c\u4e4b\u524d\u9700\u8981\u5b8c\u6210\u591a\u4e2a\u64cd\u4f5c\uff0c\u5c31\u8981\u91c7\u7528\u4e0b\u9762\u4e09\u79cd\u5199\u6cd5\u3002</p> <pre><code># \u5199\u6cd5\u4e00\ncommand || { echo \"command failed\"; exit 1; }\n\n# \u5199\u6cd5\u4e8c\nif ! command; then echo \"command failed\"; exit 1; fi\n\n# \u5199\u6cd5\u4e09\ncommand\nif [ \"$?\" -ne 0 ]; then echo \"command failed\"; exit 1; fi\n</code></pre> <p>\u53e6\u5916\uff0c\u9664\u4e86\u505c\u6b62\u6267\u884c\uff0c\u8fd8\u6709\u4e00\u79cd\u60c5\u51b5\u3002\u5982\u679c\u4e24\u4e2a\u547d\u4ee4\u6709\u7ee7\u627f\u5173\u7cfb\uff0c\u53ea\u6709\u7b2c\u4e00\u4e2a\u547d\u4ee4\u6210\u529f\u4e86\uff0c\u624d\u80fd\u7ee7\u7eed\u6267\u884c\u7b2c\u4e8c\u4e2a\u547d\u4ee4\uff0c\u90a3\u4e48\u5c31\u8981\u91c7\u7528\u4e0b\u9762\u7684\u5199\u6cd5\u3002</p> <pre><code>command1 &amp;&amp; command2\n</code></pre>"},{"location":"linux/bash/set/#set-e","title":"set -e","text":"<p>\u4e0a\u9762\u8fd9\u4e9b\u5199\u6cd5\u591a\u5c11\u6709\u4e9b\u9ebb\u70e6\uff0c\u5bb9\u6613\u758f\u5ffd\u3002<code>set -e</code>\u4ece\u6839\u672c\u4e0a\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\uff0c\u5b83\u4f7f\u5f97\u811a\u672c\u53ea\u8981\u53d1\u751f\u9519\u8bef\uff0c\u5c31\u7ec8\u6b62\u6267\u884c\u3002</p> <pre><code>#!/usr/bin/env bash\nset -e\n\nfoo\necho bar\n</code></pre> <p>\u6267\u884c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ bash script.sh\nscript.sh:\u884c4: foo: \u672a\u627e\u5230\u547d\u4ee4\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u7b2c4\u884c\u6267\u884c\u5931\u8d25\u4ee5\u540e\uff0c\u811a\u672c\u5c31\u7ec8\u6b62\u6267\u884c\u4e86\u3002</p> <p><code>set -e</code>\u6839\u636e\u8fd4\u56de\u503c\u6765\u5224\u65ad\uff0c\u4e00\u4e2a\u547d\u4ee4\u662f\u5426\u8fd0\u884c\u5931\u8d25\u3002\u4f46\u662f\uff0c\u67d0\u4e9b\u547d\u4ee4\u7684\u975e\u96f6\u8fd4\u56de\u503c\u53ef\u80fd\u4e0d\u8868\u793a\u5931\u8d25\uff0c\u6216\u8005\u5f00\u53d1\u8005\u5e0c\u671b\u5728\u547d\u4ee4\u5931\u8d25\u7684\u60c5\u51b5\u4e0b\uff0c\u811a\u672c\u7ee7\u7eed\u6267\u884c\u4e0b\u53bb\u3002\u8fd9\u65f6\u53ef\u4ee5\u6682\u65f6\u5173\u95ed<code>set -e</code>\uff0c\u8be5\u547d\u4ee4\u6267\u884c\u7ed3\u675f\u540e\uff0c\u518d\u91cd\u65b0\u6253\u5f00<code>set -e</code>\u3002</p> <pre><code>set +e\ncommand1\ncommand2\nset -e\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>set +e</code>\u8868\u793a\u5173\u95ed<code>-e</code>\u9009\u9879\uff0c<code>set -e</code>\u8868\u793a\u91cd\u65b0\u6253\u5f00<code>-e</code>\u9009\u9879\u3002</p> <p>\u8fd8\u6709\u4e00\u79cd\u65b9\u6cd5\u662f\u4f7f\u7528<code>command || true</code>\uff0c\u4f7f\u5f97\u8be5\u547d\u4ee4\u5373\u4f7f\u6267\u884c\u5931\u8d25\uff0c\u811a\u672c\u4e5f\u4e0d\u4f1a\u7ec8\u6b62\u6267\u884c\u3002</p> <pre><code>#!/bin/bash\nset -e\n\nfoo || true\necho bar\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>true</code>\u4f7f\u5f97\u8fd9\u4e00\u884c\u8bed\u53e5\u603b\u662f\u4f1a\u6267\u884c\u6210\u529f\uff0c\u540e\u9762\u7684<code>echo bar</code>\u4f1a\u6267\u884c\u3002</p> <p><code>-e</code>\u8fd8\u6709\u53e6\u4e00\u79cd\u5199\u6cd5<code>-o errexit</code>\u3002</p> <pre><code>set -o errexit\n</code></pre>"},{"location":"linux/bash/set/#set-o-pipefail","title":"set -o pipefail","text":"<p><code>set -e</code>\u6709\u4e00\u4e2a\u4f8b\u5916\u60c5\u51b5\uff0c\u5c31\u662f\u4e0d\u9002\u7528\u4e8e\u7ba1\u9053\u547d\u4ee4\u3002</p> <p>\u6240\u8c13\u7ba1\u9053\u547d\u4ee4\uff0c\u5c31\u662f\u591a\u4e2a\u5b50\u547d\u4ee4\u901a\u8fc7\u7ba1\u9053\u8fd0\u7b97\u7b26\uff08<code>|</code>\uff09\u7ec4\u5408\u6210\u4e3a\u4e00\u4e2a\u5927\u7684\u547d\u4ee4\u3002Bash \u4f1a\u628a\u6700\u540e\u4e00\u4e2a\u5b50\u547d\u4ee4\u7684\u8fd4\u56de\u503c\uff0c\u4f5c\u4e3a\u6574\u4e2a\u547d\u4ee4\u7684\u8fd4\u56de\u503c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ea\u8981\u6700\u540e\u4e00\u4e2a\u5b50\u547d\u4ee4\u4e0d\u5931\u8d25\uff0c\u7ba1\u9053\u547d\u4ee4\u603b\u662f\u4f1a\u6267\u884c\u6210\u529f\uff0c\u56e0\u6b64\u5b83\u540e\u9762\u547d\u4ee4\u4f9d\u7136\u4f1a\u6267\u884c\uff0c<code>set -e</code>\u5c31\u5931\u6548\u4e86\u3002</p> <p>\u8bf7\u770b\u4e0b\u9762\u8fd9\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>#!/usr/bin/env bash\nset -e\n\nfoo | echo a\necho bar\n</code></pre> <p>\u6267\u884c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ bash script.sh\na\nscript.sh:\u884c4: foo: \u672a\u627e\u5230\u547d\u4ee4\nbar\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c<code>foo</code>\u662f\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u547d\u4ee4\uff0c\u4f46\u662f<code>foo | echo a</code>\u8fd9\u4e2a\u7ba1\u9053\u547d\u4ee4\u4f1a\u6267\u884c\u6210\u529f\uff0c\u5bfc\u81f4\u540e\u9762\u7684<code>echo bar</code>\u4f1a\u7ee7\u7eed\u6267\u884c\u3002</p> <p><code>set -o pipefail</code>\u7528\u6765\u89e3\u51b3\u8fd9\u79cd\u60c5\u51b5\uff0c\u53ea\u8981\u4e00\u4e2a\u5b50\u547d\u4ee4\u5931\u8d25\uff0c\u6574\u4e2a\u7ba1\u9053\u547d\u4ee4\u5c31\u5931\u8d25\uff0c\u811a\u672c\u5c31\u4f1a\u7ec8\u6b62\u6267\u884c\u3002</p> <pre><code>#!/usr/bin/env bash\nset -eo pipefail\n\nfoo | echo a\necho bar\n</code></pre> <p>\u8fd0\u884c\u540e\uff0c\u7ed3\u679c\u5982\u4e0b\u3002</p> <pre><code>$ bash script.sh\na\nscript.sh:\u884c4: foo: \u672a\u627e\u5230\u547d\u4ee4\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c<code>echo bar</code>\u6ca1\u6709\u6267\u884c\u3002</p>"},{"location":"linux/bash/set/#set-e_1","title":"set -E","text":"<p>\u4e00\u65e6\u8bbe\u7f6e\u4e86<code>-e</code>\u53c2\u6570\uff0c\u4f1a\u5bfc\u81f4\u51fd\u6570\u5185\u7684\u9519\u8bef\u4e0d\u4f1a\u88ab<code>trap</code>\u547d\u4ee4\u6355\u83b7\uff08\u53c2\u8003\u300atrap \u547d\u4ee4\u300b\u4e00\u7ae0\uff09\u3002<code>-E</code>\u53c2\u6570\u53ef\u4ee5\u7ea0\u6b63\u8fd9\u4e2a\u884c\u4e3a\uff0c\u4f7f\u5f97\u51fd\u6570\u4e5f\u80fd\u7ee7\u627f<code>trap</code>\u547d\u4ee4\u3002</p> <pre><code>#!/bin/bash\nset -e\n\ntrap \"echo ERR trap fired!\" ERR\n\nmyfunc()\n{\n  # 'foo' \u662f\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u547d\u4ee4\n  foo\n}\n\nmyfunc\n</code></pre> <p>\u4e0a\u9762\u793a\u4f8b\u4e2d\uff0c<code>myfunc</code>\u51fd\u6570\u5185\u90e8\u8c03\u7528\u4e86\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u547d\u4ee4<code>foo</code>\uff0c\u5bfc\u81f4\u6267\u884c\u8fd9\u4e2a\u51fd\u6570\u4f1a\u62a5\u9519\u3002</p> <pre><code>$ bash test.sh\ntest.sh:\u884c9: foo\uff1a\u672a\u627e\u5230\u547d\u4ee4\n</code></pre> <p>\u4f46\u662f\uff0c\u7531\u4e8e\u8bbe\u7f6e\u4e86<code>set -e</code>\uff0c\u51fd\u6570\u5185\u90e8\u7684\u62a5\u9519\u5e76\u6ca1\u6709\u88ab<code>trap</code>\u547d\u4ee4\u6355\u83b7\uff0c\u9700\u8981\u52a0\u4e0a<code>-E</code>\u53c2\u6570\u624d\u53ef\u4ee5\u3002</p> <pre><code>#!/bin/bash\nset -Eeuo pipefail\n\ntrap \"echo ERR trap fired!\" ERR\n\nmyfunc()\n{\n  # 'foo' \u662f\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u547d\u4ee4\n  foo\n}\n\nmyfunc\n</code></pre> <p>\u6267\u884c\u4e0a\u9762\u8fd9\u4e2a\u811a\u672c\uff0c\u5c31\u53ef\u4ee5\u770b\u5230<code>trap</code>\u547d\u4ee4\u751f\u6548\u4e86\u3002</p> <pre><code>$ bash test.sh\ntest.sh:\u884c9: foo\uff1a\u672a\u627e\u5230\u547d\u4ee4\nERR trap fired!\n</code></pre>"},{"location":"linux/bash/set/#_2","title":"\u5176\u4ed6\u53c2\u6570","text":"<p><code>set</code>\u547d\u4ee4\u8fd8\u6709\u4e00\u4e9b\u5176\u4ed6\u53c2\u6570\u3002</p> <ul> <li><code>set -n</code>\uff1a\u7b49\u540c\u4e8e<code>set -o noexec</code>\uff0c\u4e0d\u8fd0\u884c\u547d\u4ee4\uff0c\u53ea\u68c0\u67e5\u8bed\u6cd5\u662f\u5426\u6b63\u786e\u3002</li> <li><code>set -f</code>\uff1a\u7b49\u540c\u4e8e<code>set -o noglob</code>\uff0c\u8868\u793a\u4e0d\u5bf9\u901a\u914d\u7b26\u8fdb\u884c\u6587\u4ef6\u540d\u6269\u5c55\u3002</li> <li><code>set -v</code>\uff1a\u7b49\u540c\u4e8e<code>set -o verbose</code>\uff0c\u8868\u793a\u6253\u5370 Shell \u63a5\u6536\u5230\u7684\u6bcf\u4e00\u884c\u8f93\u5165\u3002</li> <li><code>set -o noclobber</code>\uff1a\u9632\u6b62\u4f7f\u7528\u91cd\u5b9a\u5411\u8fd0\u7b97\u7b26<code>&gt;</code>\u8986\u76d6\u5df2\u7ecf\u5b58\u5728\u7684\u6587\u4ef6\u3002</li> </ul> <p>\u4e0a\u9762\u7684<code>-f</code>\u548c<code>-v</code>\u53c2\u6570\uff0c\u53ef\u4ee5\u5206\u522b\u4f7f\u7528<code>set +f</code>\u3001<code>set +v</code>\u5173\u95ed\u3002</p>"},{"location":"linux/bash/set/#set","title":"set \u547d\u4ee4\u603b\u7ed3","text":"<p>\u4e0a\u9762\u91cd\u70b9\u4ecb\u7ecd\u7684<code>set</code>\u547d\u4ee4\u7684\u51e0\u4e2a\u53c2\u6570\uff0c\u4e00\u822c\u90fd\u653e\u5728\u4e00\u8d77\u4f7f\u7528\u3002</p> <pre><code># \u5199\u6cd5\u4e00\nset -Eeuxo pipefail\n\n# \u5199\u6cd5\u4e8c\nset -Eeux\nset -o pipefail\n</code></pre> <p>\u8fd9\u4e24\u79cd\u5199\u6cd5\u5efa\u8bae\u653e\u5728\u6240\u6709 Bash \u811a\u672c\u7684\u5934\u90e8\u3002</p> <p>\u53e6\u4e00\u79cd\u529e\u6cd5\u662f\u5728\u6267\u884c Bash \u811a\u672c\u7684\u65f6\u5019\uff0c\u4ece\u547d\u4ee4\u884c\u4f20\u5165\u8fd9\u4e9b\u53c2\u6570\u3002</p> <pre><code>$ bash -euxo pipefail script.sh\n</code></pre>"},{"location":"linux/bash/set/#shopt","title":"shopt \u547d\u4ee4","text":"<p><code>shopt</code>\u547d\u4ee4\u7528\u6765\u8c03\u6574 Shell \u7684\u53c2\u6570\uff0c\u8ddf<code>set</code>\u547d\u4ee4\u7684\u4f5c\u7528\u5f88\u7c7b\u4f3c\u3002\u4e4b\u6240\u4ee5\u4f1a\u6709\u8fd9\u4e24\u4e2a\u7c7b\u4f3c\u547d\u4ee4\u7684\u4e3b\u8981\u539f\u56e0\u662f\uff0c<code>set</code>\u662f\u4ece Ksh \u7ee7\u627f\u7684\uff0c\u5c5e\u4e8e POSIX \u89c4\u8303\u7684\u4e00\u90e8\u5206\uff0c\u800c<code>shopt</code>\u662f Bash \u7279\u6709\u7684\u3002</p> <p>\u76f4\u63a5\u8f93\u5165<code>shopt</code>\u53ef\u4ee5\u67e5\u770b\u6240\u6709\u53c2\u6570\uff0c\u4ee5\u53ca\u5b83\u4eec\u5404\u81ea\u6253\u5f00\u548c\u5173\u95ed\u7684\u72b6\u6001\u3002</p> <pre><code>$ shopt\n</code></pre> <p><code>shopt</code>\u547d\u4ee4\u540e\u9762\u8ddf\u7740\u53c2\u6570\u540d\uff0c\u53ef\u4ee5\u67e5\u8be2\u8be5\u53c2\u6570\u662f\u5426\u6253\u5f00\u3002</p> <pre><code>$ shopt globstar\nglobstar  off\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u8868\u793a<code>globstar</code>\u53c2\u6570\u9ed8\u8ba4\u662f\u5173\u95ed\u7684\u3002</p> <p>\uff081\uff09-s</p> <p><code>-s</code>\u7528\u6765\u6253\u5f00\u67d0\u4e2a\u53c2\u6570\u3002</p> <pre><code>$ shopt -s optionNameHere\n</code></pre> <p>\uff082\uff09-u</p> <p><code>-u</code>\u7528\u6765\u5173\u95ed\u67d0\u4e2a\u53c2\u6570\u3002</p> <pre><code>$ shopt -u optionNameHere\n</code></pre> <p>\u4e3e\u4f8b\u6765\u8bf4\uff0c<code>histappend</code>\u8fd9\u4e2a\u53c2\u6570\u8868\u793a\u9000\u51fa\u5f53\u524d Shell \u65f6\uff0c\u5c06\u64cd\u4f5c\u5386\u53f2\u8ffd\u52a0\u5230\u5386\u53f2\u6587\u4ef6\u4e2d\u3002\u8fd9\u4e2a\u53c2\u6570\u9ed8\u8ba4\u662f\u6253\u5f00\u7684\uff0c\u5982\u679c\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u5c06\u5176\u5173\u95ed\uff0c\u90a3\u4e48\u5f53\u524d Shell \u7684\u64cd\u4f5c\u5386\u53f2\u5c06\u66ff\u6362\u6389\u6574\u4e2a\u5386\u53f2\u6587\u4ef6\u3002</p> <pre><code>$ shopt -u histappend\n</code></pre> <p>\uff083\uff09-q</p> <p><code>-q</code>\u7684\u4f5c\u7528\u4e5f\u662f\u67e5\u8be2\u67d0\u4e2a\u53c2\u6570\u662f\u5426\u6253\u5f00\uff0c\u4f46\u4e0d\u662f\u76f4\u63a5\u8f93\u51fa\u67e5\u8be2\u7ed3\u679c\uff0c\u800c\u662f\u901a\u8fc7\u547d\u4ee4\u7684\u6267\u884c\u72b6\u6001\uff08<code>$?</code>\uff09\u8868\u793a\u67e5\u8be2\u7ed3\u679c\u3002\u5982\u679c\u72b6\u6001\u4e3a<code>0</code>\uff0c\u8868\u793a\u8be5\u53c2\u6570\u6253\u5f00\uff1b\u5982\u679c\u4e3a<code>1</code>\uff0c\u8868\u793a\u8be5\u53c2\u6570\u5173\u95ed\u3002</p> <pre><code>$ shopt -q globstar\n$ echo $?\n1\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u67e5\u8be2<code>globstar</code>\u53c2\u6570\u662f\u5426\u6253\u5f00\u3002\u8fd4\u56de\u72b6\u6001\u4e3a<code>1</code>\uff0c\u8868\u793a\u8be5\u53c2\u6570\u662f\u5173\u95ed\u7684\u3002</p> <p>\u8fd9\u4e2a\u7528\u6cd5\u4e3b\u8981\u7528\u4e8e\u811a\u672c\uff0c\u4f9b<code>if</code>\u6761\u4ef6\u7ed3\u6784\u4f7f\u7528\u3002\u4e0b\u9762\u4f8b\u5b50\u662f\u5982\u679c\u6253\u5f00\u4e86\u8fd9\u4e2a\u53c2\u6570\uff0c\u5c31\u6267\u884c<code>if</code>\u7ed3\u6784\u5185\u90e8\u7684\u8bed\u53e5\u3002</p> <pre><code>if !(shopt -q globstar); then\n  ...\nfi\n</code></pre>"},{"location":"linux/bash/set/#_3","title":"\u53c2\u8003\u94fe\u63a5","text":"<ul> <li>The Set Builtin</li> <li>Safer bash scripts with 'set -euxo pipefail'</li> <li>Writing Robust Bash Shell Scripts</li> </ul>"},{"location":"linux/bash/stack/","title":"\u76ee\u5f55\u5806\u6808","text":"<p>\u4e3a\u4e86\u65b9\u4fbf\u7528\u6237\u5728\u4e0d\u540c\u76ee\u5f55\u4e4b\u95f4\u5207\u6362\uff0cBash \u63d0\u4f9b\u4e86\u76ee\u5f55\u5806\u6808\u529f\u80fd\u3002</p>"},{"location":"linux/bash/stack/#cd-","title":"cd -","text":"<p>Bash \u53ef\u4ee5\u8bb0\u5fc6\u7528\u6237\u8fdb\u5165\u8fc7\u7684\u76ee\u5f55\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53ea\u8bb0\u5fc6\u524d\u4e00\u6b21\u6240\u5728\u7684\u76ee\u5f55\uff0c<code>cd -</code>\u547d\u4ee4\u53ef\u4ee5\u8fd4\u56de\u524d\u4e00\u6b21\u7684\u76ee\u5f55\u3002</p> <pre><code># \u5f53\u524d\u76ee\u5f55\u662f /path/to/foo\n$ cd bar\n\n# \u91cd\u65b0\u56de\u5230 /path/to/foo\n$ cd -\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7528\u6237\u539f\u6765\u6240\u5728\u7684\u76ee\u5f55\u662f<code>/path/to/foo</code>\uff0c\u8fdb\u5165\u5b50\u76ee\u5f55<code>bar</code>\u4ee5\u540e\uff0c\u4f7f\u7528<code>cd -</code>\u53ef\u4ee5\u56de\u5230\u539f\u6765\u7684\u76ee\u5f55\u3002</p>"},{"location":"linux/bash/stack/#pushdpopd","title":"pushd\uff0cpopd","text":"<p>\u5982\u679c\u5e0c\u671b\u8bb0\u5fc6\u591a\u91cd\u76ee\u5f55\uff0c\u53ef\u4ee5\u4f7f\u7528<code>pushd</code>\u547d\u4ee4\u548c<code>popd</code>\u547d\u4ee4\u3002\u5b83\u4eec\u7528\u6765\u64cd\u4f5c\u76ee\u5f55\u5806\u6808\u3002</p> <p><code>pushd</code>\u547d\u4ee4\u7684\u7528\u6cd5\u7c7b\u4f3c<code>cd</code>\u547d\u4ee4\uff0c\u53ef\u4ee5\u8fdb\u5165\u6307\u5b9a\u7684\u76ee\u5f55\u3002</p> <pre><code>$ pushd dirname\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4f1a\u8fdb\u5165\u76ee\u5f55<code>dirname</code>\uff0c\u5e76\u5c06\u8be5\u76ee\u5f55\u653e\u5165\u5806\u6808\u3002</p> <p>\u7b2c\u4e00\u6b21\u4f7f\u7528<code>pushd</code>\u547d\u4ee4\u65f6\uff0c\u4f1a\u5c06\u5f53\u524d\u76ee\u5f55\u5148\u653e\u5165\u5806\u6808\uff0c\u7136\u540e\u5c06\u6240\u8981\u8fdb\u5165\u7684\u76ee\u5f55\u4e5f\u653e\u5165\u5806\u6808\uff0c\u4f4d\u7f6e\u5728\u524d\u4e00\u4e2a\u8bb0\u5f55\u7684\u4e0a\u65b9\u3002\u4ee5\u540e\u6bcf\u6b21\u4f7f\u7528<code>pushd</code>\u547d\u4ee4\uff0c\u90fd\u4f1a\u5c06\u6240\u8981\u8fdb\u5165\u7684\u76ee\u5f55\uff0c\u653e\u5728\u5806\u6808\u7684\u9876\u90e8\u3002</p> <p><code>popd</code>\u547d\u4ee4\u4e0d\u5e26\u6709\u53c2\u6570\u65f6\uff0c\u4f1a\u79fb\u9664\u5806\u6808\u7684\u9876\u90e8\u8bb0\u5f55\uff0c\u5e76\u8fdb\u5165\u65b0\u7684\u5806\u6808\u9876\u90e8\u76ee\u5f55\uff08\u5373\u539f\u6765\u7684\u7b2c\u4e8c\u6761\u76ee\u5f55\uff09\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code># \u5f53\u524d\u5904\u5728\u4e3b\u76ee\u5f55\uff0c\u5806\u6808\u4e3a\u7a7a\n$ pwd\n/home/me\n\n# \u8fdb\u5165 /home/me/foo\n# \u5f53\u524d\u5806\u6808\u4e3a /home/me/foo /home/me\n$ pushd ~/foo\n\n# \u8fdb\u5165 /etc\n# \u5f53\u524d\u5806\u6808\u4e3a /etc /home/me/foo /home/me\n$ pushd /etc\n\n# \u8fdb\u5165 /home/me/foo\n# \u5f53\u524d\u5806\u6808\u4e3a /home/me/foo /home/me\n$ popd\n\n# \u8fdb\u5165 /home/me\n# \u5f53\u524d\u5806\u6808\u4e3a /home/me\n$ popd\n\n# \u76ee\u5f55\u4e0d\u53d8\uff0c\u5f53\u524d\u5806\u6808\u4e3a\u7a7a\n$ popd\n</code></pre> <p>\u8fd9\u4e24\u4e2a\u547d\u4ee4\u7684\u53c2\u6570\u5982\u4e0b\u3002</p> <p>\uff081\uff09-n \u53c2\u6570</p> <p><code>-n</code>\u7684\u53c2\u6570\u8868\u793a\u4ec5\u64cd\u4f5c\u5806\u6808\uff0c\u4e0d\u6539\u53d8\u76ee\u5f55\u3002</p> <pre><code>$ popd -n\n</code></pre> <p>\u4e0a\u9762\u7684\u547d\u4ee4\u4ec5\u5220\u9664\u5806\u6808\u9876\u90e8\u7684\u8bb0\u5f55\uff0c\u4e0d\u6539\u53d8\u76ee\u5f55\uff0c\u6267\u884c\u5b8c\u6210\u540e\u8fd8\u505c\u7559\u5728\u5f53\u524d\u76ee\u5f55\u3002</p> <p>\uff082\uff09\u6574\u6570\u53c2\u6570</p> <p>\u8fd9\u4e24\u4e2a\u547d\u4ee4\u8fd8\u53ef\u4ee5\u63a5\u53d7\u4e00\u4e2a\u6574\u6570\u4f5c\u4e3a\u53c2\u6570\uff0c\u8be5\u6574\u6570\u8868\u793a\u5806\u6808\u4e2d\u6307\u5b9a\u4f4d\u7f6e\u7684\u8bb0\u5f55\uff08\u4ece0\u5f00\u59cb\uff09\uff0c\u4f5c\u4e3a\u64cd\u4f5c\u5bf9\u8c61\u3002\u8fd9\u65f6\u4e0d\u4f1a\u5207\u6362\u76ee\u5f55\u3002</p> <pre><code># \u4ece\u6808\u9876\u7b97\u8d77\u76843\u53f7\u76ee\u5f55\uff08\u4ece0\u5f00\u59cb\uff09\uff0c\u79fb\u52a8\u5230\u6808\u9876\n$ pushd +3\n\n# \u4ece\u6808\u5e95\u7b97\u8d77\u76843\u53f7\u76ee\u5f55\uff08\u4ece0\u5f00\u59cb\uff09\uff0c\u79fb\u52a8\u5230\u6808\u9876\n$ pushd -3\n\n# \u5220\u9664\u4ece\u6808\u9876\u7b97\u8d77\u76843\u53f7\u76ee\u5f55\uff08\u4ece0\u5f00\u59cb\uff09\n$ popd +3\n\n# \u5220\u9664\u4ece\u6808\u5e95\u7b97\u8d77\u76843\u53f7\u76ee\u5f55\uff08\u4ece0\u5f00\u59cb\uff09\n$ popd -3\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u7684\u6574\u6570\u7f16\u53f7\u90fd\u662f\u4ece0\u5f00\u59cb\u8ba1\u7b97\uff0c<code>popd +0</code>\u662f\u5220\u9664\u7b2c\u4e00\u4e2a\u76ee\u5f55\uff0c<code>popd +1</code>\u662f\u5220\u9664\u7b2c\u4e8c\u4e2a\uff0c<code>popd -0</code>\u662f\u5220\u9664\u6700\u540e\u4e00\u4e2a\u76ee\u5f55\uff0c\uff0c<code>popd -1</code>\u662f\u5220\u9664\u5012\u6570\u7b2c\u4e8c\u4e2a\u3002</p> <p>\uff083\uff09\u76ee\u5f55\u53c2\u6570</p> <p><code>pushd</code>\u53ef\u4ee5\u63a5\u53d7\u4e00\u4e2a\u76ee\u5f55\u4f5c\u4e3a\u53c2\u6570\uff0c\u8868\u793a\u5c06\u8be5\u76ee\u5f55\u653e\u5230\u5806\u6808\u9876\u90e8\uff0c\u5e76\u8fdb\u5165\u8be5\u76ee\u5f55\u3002</p> <pre><code>$ pushd dir\n</code></pre> <p><code>popd</code>\u6ca1\u6709\u8fd9\u4e2a\u53c2\u6570\u3002</p>"},{"location":"linux/bash/stack/#dirs","title":"dirs \u547d\u4ee4","text":"<p><code>dirs</code>\u547d\u4ee4\u53ef\u4ee5\u663e\u793a\u76ee\u5f55\u5806\u6808\u7684\u5185\u5bb9\uff0c\u4e00\u822c\u7528\u6765\u67e5\u770b<code>pushd</code>\u548c<code>popd</code>\u64cd\u4f5c\u540e\u7684\u7ed3\u679c\u3002</p> <pre><code>$ dirs\n</code></pre> <p>\u5b83\u6709\u4ee5\u4e0b\u53c2\u6570\u3002</p> <ul> <li><code>-c</code>\uff1a\u6e05\u7a7a\u76ee\u5f55\u6808\u3002</li> <li><code>-l</code>\uff1a\u7528\u6237\u4e3b\u76ee\u5f55\u4e0d\u663e\u793a\u6ce2\u6d6a\u53f7\u524d\u7f00\uff0c\u800c\u6253\u5370\u5b8c\u6574\u7684\u76ee\u5f55\u3002</li> <li><code>-p</code>\uff1a\u6bcf\u884c\u4e00\u4e2a\u6761\u76ee\u6253\u5370\u76ee\u5f55\u6808\uff0c\u9ed8\u8ba4\u662f\u6253\u5370\u5728\u4e00\u884c\u3002</li> <li><code>-v</code>\uff1a\u6bcf\u884c\u4e00\u4e2a\u6761\u76ee\uff0c\u6bcf\u4e2a\u6761\u76ee\u4e4b\u524d\u663e\u793a\u4f4d\u7f6e\u7f16\u53f7\uff08\u4ece0\u5f00\u59cb\uff09\u3002</li> <li><code>+N</code>\uff1a<code>N</code>\u4e3a\u6574\u6570\uff0c\u8868\u793a\u663e\u793a\u5806\u9876\u7b97\u8d77\u7684\u7b2c N \u4e2a\u76ee\u5f55\uff0c\u4ece\u96f6\u5f00\u59cb\u3002</li> <li><code>-N</code>\uff1a<code>N</code>\u4e3a\u6574\u6570\uff0c\u8868\u793a\u663e\u793a\u5806\u5e95\u7b97\u8d77\u7684\u7b2c N \u4e2a\u76ee\u5f55\uff0c\u4ece\u96f6\u5f00\u59cb\u3002</li> </ul>"},{"location":"linux/bash/startup/","title":"Bash \u542f\u52a8\u73af\u5883","text":""},{"location":"linux/bash/startup/#session","title":"Session","text":"<p>\u7528\u6237\u6bcf\u6b21\u4f7f\u7528 Shell\uff0c\u90fd\u4f1a\u5f00\u542f\u4e00\u4e2a\u4e0e Shell \u7684 Session\uff08\u5bf9\u8bdd\uff09\u3002</p> <p>Session \u6709\u4e24\u79cd\u7c7b\u578b\uff1a\u767b\u5f55 Session \u548c\u975e\u767b\u5f55 Session\uff0c\u4e5f\u53ef\u4ee5\u53eb\u505a login shell \u548c non-login shell\u3002</p>"},{"location":"linux/bash/startup/#session_1","title":"\u767b\u5f55 Session","text":"<p>\u767b\u5f55 Session \u662f\u7528\u6237\u767b\u5f55\u7cfb\u7edf\u4ee5\u540e\uff0c\u7cfb\u7edf\u4e3a\u7528\u6237\u5f00\u542f\u7684\u539f\u59cb Session\uff0c\u901a\u5e38\u9700\u8981\u7528\u6237\u8f93\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\u8fdb\u884c\u767b\u5f55\u3002</p> <p>\u767b\u5f55 Session \u4e00\u822c\u8fdb\u884c\u6574\u4e2a\u7cfb\u7edf\u73af\u5883\u7684\u521d\u59cb\u5316\uff0c\u542f\u52a8\u7684\u521d\u59cb\u5316\u811a\u672c\u4f9d\u6b21\u5982\u4e0b\u3002</p> <ul> <li><code>/etc/profile</code>\uff1a\u6240\u6709\u7528\u6237\u7684\u5168\u5c40\u914d\u7f6e\u811a\u672c\u3002</li> <li><code>/etc/profile.d</code>\u76ee\u5f55\u91cc\u9762\u6240\u6709<code>.sh</code>\u6587\u4ef6</li> <li><code>~/.bash_profile</code>\uff1a\u7528\u6237\u7684\u4e2a\u4eba\u914d\u7f6e\u811a\u672c\u3002\u5982\u679c\u8be5\u811a\u672c\u5b58\u5728\uff0c\u5219\u6267\u884c\u5b8c\u5c31\u4e0d\u518d\u5f80\u4e0b\u6267\u884c\u3002</li> <li><code>~/.bash_login</code>\uff1a\u5982\u679c<code>~/.bash_profile</code>\u6ca1\u627e\u5230\uff0c\u5219\u5c1d\u8bd5\u6267\u884c\u8fd9\u4e2a\u811a\u672c\uff08C shell \u7684\u521d\u59cb\u5316\u811a\u672c\uff09\u3002\u5982\u679c\u8be5\u811a\u672c\u5b58\u5728\uff0c\u5219\u6267\u884c\u5b8c\u5c31\u4e0d\u518d\u5f80\u4e0b\u6267\u884c\u3002</li> <li><code>~/.profile</code>\uff1a\u5982\u679c<code>~/.bash_profile</code>\u548c<code>~/.bash_login</code>\u90fd\u6ca1\u627e\u5230\uff0c\u5219\u5c1d\u8bd5\u8bfb\u53d6\u8fd9\u4e2a\u811a\u672c\uff08Bourne shell \u548c Korn shell \u7684\u521d\u59cb\u5316\u811a\u672c\uff09\u3002</li> </ul> <p>Linux \u53d1\u884c\u7248\u66f4\u65b0\u7684\u65f6\u5019\uff0c\u4f1a\u66f4\u65b0<code>/etc</code>\u91cc\u9762\u7684\u6587\u4ef6\uff0c\u6bd4\u5982<code>/etc/profile</code>\uff0c\u56e0\u6b64\u4e0d\u8981\u76f4\u63a5\u4fee\u6539\u8fd9\u4e2a\u6587\u4ef6\u3002\u5982\u679c\u60f3\u4fee\u6539\u6240\u6709\u7528\u6237\u7684\u767b\u9646\u73af\u5883\uff0c\u5c31\u5728<code>/etc/profile.d</code>\u76ee\u5f55\u91cc\u9762\u65b0\u5efa<code>.sh</code>\u811a\u672c\u3002</p> <p>\u5982\u679c\u60f3\u4fee\u6539\u4f60\u4e2a\u4eba\u7684\u767b\u5f55\u73af\u5883\uff0c\u4e00\u822c\u662f\u5199\u5728<code>~/.bash_profile</code>\u91cc\u9762\u3002\u4e0b\u9762\u662f\u4e00\u4e2a\u5178\u578b\u7684<code>.bash_profile</code>\u6587\u4ef6\u3002</p> <pre><code># .bash_profile\nPATH=/sbin:/usr/sbin:/bin:/usr/bin:/usr/local/bin\nPATH=$PATH:$HOME/bin\n\nSHELL=/bin/bash\nMANPATH=/usr/man:/usr/X11/man\nEDITOR=/usr/bin/vi\nPS1='\\h:\\w\\$ '\nPS2='&gt; '\n\nif [ -f ~/.bashrc ]; then\n. ~/.bashrc\nfi\n\nexport PATH\nexport EDITOR\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u8fd9\u4e2a\u811a\u672c\u5b9a\u4e49\u4e86\u4e00\u4e9b\u6700\u57fa\u672c\u7684\u73af\u5883\u53d8\u91cf\uff0c\u7136\u540e\u6267\u884c\u4e86<code>~/.bashrc</code>\u3002</p> <p><code>bash</code>\u547d\u4ee4\u7684<code>--login</code>\u53c2\u6570\uff0c\u4f1a\u5f3a\u5236\u6267\u884c\u767b\u5f55 Session \u4f1a\u6267\u884c\u7684\u811a\u672c\u3002</p> <pre><code>$ bash --login\n</code></pre> <p><code>bash</code>\u547d\u4ee4\u7684<code>--noprofile</code>\u53c2\u6570\uff0c\u4f1a\u8df3\u8fc7\u4e0a\u9762\u8fd9\u4e9b Profile \u811a\u672c\u3002</p> <pre><code>$ bash --noprofile\n</code></pre>"},{"location":"linux/bash/startup/#session_2","title":"\u975e\u767b\u5f55 Session","text":"<p>\u975e\u767b\u5f55 Session \u662f\u7528\u6237\u8fdb\u5165\u7cfb\u7edf\u4ee5\u540e\uff0c\u624b\u52a8\u65b0\u5efa\u7684 Session\uff0c\u8fd9\u65f6\u4e0d\u4f1a\u8fdb\u884c\u73af\u5883\u521d\u59cb\u5316\u3002\u6bd4\u5982\uff0c\u5728\u547d\u4ee4\u884c\u6267\u884c<code>bash</code>\u547d\u4ee4\uff0c\u5c31\u4f1a\u65b0\u5efa\u4e00\u4e2a\u975e\u767b\u5f55 Session\u3002</p> <p>\u975e\u767b\u5f55 Session \u7684\u521d\u59cb\u5316\u811a\u672c\u4f9d\u6b21\u5982\u4e0b\u3002</p> <ul> <li><code>/etc/bash.bashrc</code>\uff1a\u5bf9\u5168\u4f53\u7528\u6237\u6709\u6548\u3002</li> <li><code>~/.bashrc</code>\uff1a\u4ec5\u5bf9\u5f53\u524d\u7528\u6237\u6709\u6548\u3002</li> </ul> <p>\u5bf9\u7528\u6237\u6765\u8bf4\uff0c<code>~/.bashrc</code>\u901a\u5e38\u662f\u6700\u91cd\u8981\u7684\u811a\u672c\u3002\u975e\u767b\u5f55 Session \u9ed8\u8ba4\u4f1a\u6267\u884c\u5b83\uff0c\u800c\u767b\u5f55 Session \u4e00\u822c\u4e5f\u4f1a\u901a\u8fc7\u8c03\u7528\u6267\u884c\u5b83\u3002\u6bcf\u6b21\u65b0\u5efa\u4e00\u4e2a Bash \u7a97\u53e3\uff0c\u5c31\u76f8\u5f53\u4e8e\u65b0\u5efa\u4e00\u4e2a\u975e\u767b\u5f55 Session\uff0c\u6240\u4ee5<code>~/.bashrc</code>\u6bcf\u6b21\u90fd\u4f1a\u6267\u884c\u3002\u6ce8\u610f\uff0c\u6267\u884c\u811a\u672c\u76f8\u5f53\u4e8e\u65b0\u5efa\u4e00\u4e2a\u975e\u4e92\u52a8\u7684 Bash \u73af\u5883\uff0c\u4f46\u662f\u8fd9\u79cd\u60c5\u51b5\u4e0d\u4f1a\u8c03\u7528<code>~/.bashrc</code>\u3002</p> <p><code>bash</code>\u547d\u4ee4\u7684<code>--norc</code>\u53c2\u6570\uff0c\u53ef\u4ee5\u7981\u6b62\u5728\u975e\u767b\u5f55 Session \u6267\u884c<code>~/.bashrc</code>\u811a\u672c\u3002</p> <pre><code>$ bash --norc\n</code></pre> <p><code>bash</code>\u547d\u4ee4\u7684<code>--rcfile</code>\u53c2\u6570\uff0c\u6307\u5b9a\u53e6\u4e00\u4e2a\u811a\u672c\u4ee3\u66ff<code>.bashrc</code>\u3002</p> <pre><code>$ bash --rcfile testrc\n</code></pre>"},{"location":"linux/bash/startup/#bash_logout","title":".bash_logout","text":"<p><code>~/.bash_logout</code>\u811a\u672c\u5728\u6bcf\u6b21\u9000\u51fa Session \u65f6\u6267\u884c\uff0c\u901a\u5e38\u7528\u6765\u505a\u4e00\u4e9b\u6e05\u7406\u5de5\u4f5c\u548c\u8bb0\u5f55\u5de5\u4f5c\uff0c\u6bd4\u5982\u5220\u9664\u4e34\u65f6\u6587\u4ef6\uff0c\u8bb0\u5f55\u7528\u6237\u5728\u672c\u6b21 Session \u82b1\u8d39\u7684\u65f6\u95f4\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u9000\u51fa\u65f6\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u8fd9\u4e2a\u6587\u4ef6\u4e5f\u53ef\u4ee5\u4e0d\u5b58\u5728\u3002</p>"},{"location":"linux/bash/startup/#_1","title":"\u542f\u52a8\u9009\u9879","text":"<p>\u4e3a\u4e86\u65b9\u4fbf Debug\uff0c\u6709\u65f6\u5728\u542f\u52a8 Bash \u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u52a0\u4e0a\u542f\u52a8\u53c2\u6570\u3002</p> <ul> <li><code>-n</code>\uff1a\u4e0d\u8fd0\u884c\u811a\u672c\uff0c\u53ea\u68c0\u67e5\u662f\u5426\u6709\u8bed\u6cd5\u9519\u8bef\u3002</li> <li><code>-v</code>\uff1a\u8f93\u51fa\u6bcf\u4e00\u884c\u8bed\u53e5\u8fd0\u884c\u7ed3\u679c\u524d\uff0c\u4f1a\u5148\u8f93\u51fa\u8be5\u884c\u8bed\u53e5\u3002</li> <li><code>-x</code>\uff1a\u6bcf\u4e00\u4e2a\u547d\u4ee4\u5904\u7406\u4e4b\u524d\uff0c\u5148\u8f93\u51fa\u8be5\u547d\u4ee4\uff0c\u518d\u6267\u884c\u8be5\u547d\u4ee4\u3002</li> </ul> <pre><code>$ bash -n scriptname\n$ bash -v scriptname\n$ bash -x scriptname\n</code></pre>"},{"location":"linux/bash/startup/#_2","title":"\u952e\u76d8\u7ed1\u5b9a","text":"<p>Bash \u5141\u8bb8\u7528\u6237\u5b9a\u4e49\u81ea\u5df1\u7684\u5feb\u6377\u952e\u3002\u5168\u5c40\u7684\u952e\u76d8\u7ed1\u5b9a\u6587\u4ef6\u9ed8\u8ba4\u4e3a<code>/etc/inputrc</code>\uff0c\u4f60\u53ef\u4ee5\u5728\u4e3b\u76ee\u5f55\u521b\u5efa\u81ea\u5df1\u7684\u952e\u76d8\u7ed1\u5b9a\u6587\u4ef6<code>.inputrc</code>\u6587\u4ef6\u3002\u5982\u679c\u5b9a\u4e49\u4e86\u8fd9\u4e2a\u6587\u4ef6\uff0c\u9700\u8981\u5728\u5176\u4e2d\u52a0\u5165\u4e0b\u9762\u8fd9\u884c\uff0c\u4fdd\u8bc1\u5168\u5c40\u7ed1\u5b9a\u4e0d\u4f1a\u88ab\u9057\u6f0f\u3002</p> <pre><code>$include /etc/inputrc\n</code></pre> <p><code>.inputrc</code>\u6587\u4ef6\u91cc\u9762\u7684\u5feb\u6377\u952e\uff0c\u53ef\u4ee5\u50cf\u8fd9\u6837\u5b9a\u4e49\uff0c<code>\"\\C-t\":\"pwd\\n\"</code>\u8868\u793a\u5c06<code>Ctrl + t</code>\u7ed1\u5b9a\u4e3a\u8fd0\u884c<code>pwd</code>\u547d\u4ee4\u3002</p>"},{"location":"linux/bash/string/","title":"\u5b57\u7b26\u4e32\u64cd\u4f5c","text":"<p>\u672c\u7ae0\u4ecb\u7ecd Bash \u5b57\u7b26\u4e32\u64cd\u4f5c\u7684\u8bed\u6cd5\u3002</p>"},{"location":"linux/bash/string/#_2","title":"\u5b57\u7b26\u4e32\u7684\u957f\u5ea6","text":"<p>\u83b7\u53d6\u5b57\u7b26\u4e32\u957f\u5ea6\u7684\u8bed\u6cd5\u5982\u4e0b\u3002</p> <pre><code>${#varname}\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>$ myPath=/home/cam/book/long.file.name\n$ echo ${#myPath}\n29\n</code></pre> <p>\u5927\u62ec\u53f7<code>{}</code>\u662f\u5fc5\u9700\u7684\uff0c\u5426\u5219 Bash \u4f1a\u5c06<code>$#</code>\u7406\u89e3\u6210\u811a\u672c\u7684\u53c2\u6570\u4e2a\u6570\uff0c\u5c06\u53d8\u91cf\u540d\u7406\u89e3\u6210\u6587\u672c\u3002</p> <pre><code>$ echo $#myvar\n0myvar\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0cBash \u5c06<code>$#</code>\u548c<code>myvar</code>\u5206\u5f00\u89e3\u91ca\u4e86\u3002</p>"},{"location":"linux/bash/string/#_3","title":"\u5b50\u5b57\u7b26\u4e32","text":"<p>\u5b57\u7b26\u4e32\u63d0\u53d6\u5b50\u4e32\u7684\u8bed\u6cd5\u5982\u4e0b\u3002</p> <pre><code>${varname:offset:length}\n</code></pre> <p>\u4e0a\u9762\u8bed\u6cd5\u7684\u542b\u4e49\u662f\u8fd4\u56de\u53d8\u91cf<code>$varname</code>\u7684\u5b50\u5b57\u7b26\u4e32\uff0c\u4ece\u4f4d\u7f6e<code>offset</code>\u5f00\u59cb\uff08\u4ece<code>0</code>\u5f00\u59cb\u8ba1\u7b97\uff09\uff0c\u957f\u5ea6\u4e3a<code>length</code>\u3002</p> <pre><code>$ count=frogfootman\n$ echo ${count:4:4}\nfoot\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u8fd4\u56de\u5b57\u7b26\u4e32<code>frogfootman</code>\u4ece4\u53f7\u4f4d\u7f6e\u5f00\u59cb\u7684\u957f\u5ea6\u4e3a4\u7684\u5b50\u5b57\u7b26\u4e32<code>foot</code>\u3002</p> <p>\u8fd9\u79cd\u8bed\u6cd5\u4e0d\u80fd\u76f4\u63a5\u64cd\u4f5c\u5b57\u7b26\u4e32\uff0c\u53ea\u80fd\u901a\u8fc7\u53d8\u91cf\u6765\u8bfb\u53d6\u5b57\u7b26\u4e32\uff0c\u5e76\u4e14\u4e0d\u4f1a\u6539\u53d8\u539f\u59cb\u5b57\u7b26\u4e32\u3002\u53d8\u91cf\u524d\u9762\u7684\u7f8e\u5143\u7b26\u53f7\u53ef\u4ee5\u7701\u7565\u3002</p> <pre><code># \u62a5\u9519\n$ echo ${\"hello\":2:3}\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>\"hello\"</code>\u4e0d\u662f\u53d8\u91cf\u540d\uff0c\u5bfc\u81f4 Bash \u62a5\u9519\u3002</p> <p>\u5982\u679c\u7701\u7565<code>length</code>\uff0c\u5219\u4ece\u4f4d\u7f6e<code>offset</code>\u5f00\u59cb\uff0c\u4e00\u76f4\u8fd4\u56de\u5230\u5b57\u7b26\u4e32\u7684\u7ed3\u5c3e\u3002</p> <pre><code>$ count=frogfootman\n$ echo ${count:4}\nfootman\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u662f\u8fd4\u56de\u53d8\u91cf<code>count</code>\u4ece4\u53f7\u4f4d\u7f6e\u4e00\u76f4\u5230\u7ed3\u5c3e\u7684\u5b50\u5b57\u7b26\u4e32\u3002</p> <p>\u5982\u679c<code>offset</code>\u4e3a\u8d1f\u503c\uff0c\u8868\u793a\u4ece\u5b57\u7b26\u4e32\u7684\u672b\u5c3e\u5f00\u59cb\u7b97\u8d77\u3002\u6ce8\u610f\uff0c\u8d1f\u6570\u524d\u9762\u5fc5\u987b\u6709\u4e00\u4e2a\u7a7a\u683c\uff0c \u4ee5\u9632\u6b62\u4e0e<code>${variable:-word}</code>\u7684\u53d8\u91cf\u7684\u8bbe\u7f6e\u9ed8\u8ba4\u503c\u8bed\u6cd5\u6df7\u6dc6\u3002\u8fd9\u65f6\u8fd8\u53ef\u4ee5\u6307\u5b9a<code>length</code>\uff0c<code>length</code>\u53ef\u4ee5\u662f\u6b63\u503c\uff0c\u4e5f\u53ef\u4ee5\u662f\u8d1f\u503c\uff08\u8d1f\u503c\u4e0d\u80fd\u8d85\u8fc7<code>offset</code>\u7684\u957f\u5ea6\uff09\u3002</p> <pre><code>$ foo=\"This string is long.\"\n$ echo ${foo: -5}\nlong.\n$ echo ${foo: -5:2}\nlo\n$ echo ${foo: -5:-2}\nlon\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>offset</code>\u4e3a<code>-5</code>\uff0c\u8868\u793a\u4ece\u5012\u6570\u7b2c5\u4e2a\u5b57\u7b26\u5f00\u59cb\u622a\u53d6\uff0c\u6240\u4ee5\u8fd4\u56de<code>long.</code>\u3002\u5982\u679c\u6307\u5b9a\u957f\u5ea6<code>length</code>\u4e3a<code>2</code>\uff0c\u5219\u8fd4\u56de<code>lo</code>\uff1b\u5982\u679c<code>length</code>\u4e3a<code>-2</code>\uff0c\u8868\u793a\u8981\u6392\u9664\u4ece\u5b57\u7b26\u4e32\u672b\u5c3e\u5f00\u59cb\u76842\u4e2a\u5b57\u7b26\uff0c\u6240\u4ee5\u8fd4\u56de<code>lon</code>\u3002</p>"},{"location":"linux/bash/string/#_4","title":"\u641c\u7d22\u548c\u66ff\u6362","text":"<p>Bash \u63d0\u4f9b\u5b57\u7b26\u4e32\u641c\u7d22\u548c\u66ff\u6362\u7684\u591a\u79cd\u65b9\u6cd5\u3002</p> <p>\uff081\uff09\u5b57\u7b26\u4e32\u5934\u90e8\u7684\u6a21\u5f0f\u5339\u914d\u3002</p> <p>\u4ee5\u4e0b\u4e24\u79cd\u8bed\u6cd5\u53ef\u4ee5\u68c0\u67e5\u5b57\u7b26\u4e32\u5f00\u5934\uff0c\u662f\u5426\u5339\u914d\u7ed9\u5b9a\u7684\u6a21\u5f0f\u3002\u5982\u679c\u5339\u914d\u6210\u529f\uff0c\u5c31\u5220\u9664\u5339\u914d\u7684\u90e8\u5206\uff0c\u8fd4\u56de\u5269\u4e0b\u7684\u90e8\u5206\u3002\u539f\u59cb\u53d8\u91cf\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\u3002</p> <pre><code># \u5982\u679c pattern \u5339\u914d\u53d8\u91cf variable \u7684\u5f00\u5934\uff0c\n# \u5220\u9664\u6700\u77ed\u5339\u914d\uff08\u975e\u8d2a\u5a6a\u5339\u914d\uff09\u7684\u90e8\u5206\uff0c\u8fd4\u56de\u5269\u4f59\u90e8\u5206\n${variable#pattern}\n\n# \u5982\u679c pattern \u5339\u914d\u53d8\u91cf variable \u7684\u5f00\u5934\uff0c\n# \u5220\u9664\u6700\u957f\u5339\u914d\uff08\u8d2a\u5a6a\u5339\u914d\uff09\u7684\u90e8\u5206\uff0c\u8fd4\u56de\u5269\u4f59\u90e8\u5206\n${variable##pattern}\n</code></pre> <p>\u4e0a\u9762\u4e24\u79cd\u8bed\u6cd5\u4f1a\u5220\u9664\u53d8\u91cf\u5b57\u7b26\u4e32\u5f00\u5934\u7684\u5339\u914d\u90e8\u5206\uff08\u5c06\u5176\u66ff\u6362\u4e3a\u7a7a\uff09\uff0c\u8fd4\u56de\u5269\u4e0b\u7684\u90e8\u5206\u3002\u533a\u522b\u662f\u4e00\u4e2a\u662f\u6700\u77ed\u5339\u914d\uff08\u53c8\u79f0\u975e\u8d2a\u5a6a\u5339\u914d\uff09\uff0c\u53e6\u4e00\u4e2a\u662f\u6700\u957f\u5339\u914d\uff08\u53c8\u79f0\u8d2a\u5a6a\u5339\u914d\uff09\u3002</p> <p>\u5339\u914d\u6a21\u5f0f<code>pattern</code>\u53ef\u4ee5\u4f7f\u7528<code>*</code>\u3001<code>?</code>\u3001<code>[]</code>\u7b49\u901a\u914d\u7b26\u3002</p> <pre><code>$ myPath=/home/cam/book/long.file.name\n\n$ echo ${myPath#/*/}\ncam/book/long.file.name\n\n$ echo ${myPath##/*/}\nlong.file.name\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5339\u914d\u7684\u6a21\u5f0f\u662f<code>/*/</code>\uff0c\u5176\u4e2d<code>*</code>\u53ef\u4ee5\u5339\u914d\u4efb\u610f\u6570\u91cf\u7684\u5b57\u7b26\uff0c\u6240\u4ee5\u6700\u77ed\u5339\u914d\u662f<code>/home/</code>\uff0c\u6700\u957f\u5339\u914d\u662f<code>/home/cam/book/</code>\u3002</p> <p>\u4e0b\u9762\u5199\u6cd5\u53ef\u4ee5\u5220\u9664\u6587\u4ef6\u8def\u5f84\u7684\u76ee\u5f55\u90e8\u5206\uff0c\u53ea\u7559\u4e0b\u6587\u4ef6\u540d\u3002</p> <pre><code>$ path=/home/cam/book/long.file.name\n\n$ echo ${path##*/}\nlong.file.name\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u6a21\u5f0f<code>*/</code>\u5339\u914d\u76ee\u5f55\u90e8\u5206\uff0c\u6240\u4ee5\u53ea\u8fd4\u56de\u6587\u4ef6\u540d\u3002</p> <p>\u4e0b\u9762\u518d\u770b\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>$ phone=\"555-456-1414\"\n$ echo ${phone#*-}\n456-1414\n$ echo ${phone##*-}\n1414\n</code></pre> <p>\u5982\u679c\u5339\u914d\u4e0d\u6210\u529f\uff0c\u5219\u8fd4\u56de\u539f\u59cb\u5b57\u7b26\u4e32\u3002</p> <pre><code>$ phone=\"555-456-1414\"\n$ echo ${phone#444}\n555-456-1414\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u539f\u59cb\u5b57\u7b26\u4e32\u91cc\u9762\u65e0\u6cd5\u5339\u914d\u6a21\u5f0f<code>444</code>\uff0c\u6240\u4ee5\u539f\u6837\u8fd4\u56de\u3002</p> <p>\u5982\u679c\u8981\u5c06\u5934\u90e8\u5339\u914d\u7684\u90e8\u5206\uff0c\u66ff\u6362\u6210\u5176\u4ed6\u5185\u5bb9\uff0c\u91c7\u7528\u4e0b\u9762\u7684\u5199\u6cd5\u3002</p> <pre><code># \u6a21\u5f0f\u5fc5\u987b\u51fa\u73b0\u5728\u5b57\u7b26\u4e32\u7684\u5f00\u5934\n${variable/#pattern/string}\n\n# \u793a\u4f8b\n$ foo=JPG.JPG\n$ echo ${foo/#JPG/jpg}\njpg.JPG\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u88ab\u66ff\u6362\u7684<code>JPG</code>\u5fc5\u987b\u51fa\u73b0\u5728\u5b57\u7b26\u4e32\u5934\u90e8\uff0c\u6240\u4ee5\u8fd4\u56de<code>jpg.JPG</code>\u3002</p> <p>\uff082\uff09\u5b57\u7b26\u4e32\u5c3e\u90e8\u7684\u6a21\u5f0f\u5339\u914d\u3002</p> <p>\u4ee5\u4e0b\u4e24\u79cd\u8bed\u6cd5\u53ef\u4ee5\u68c0\u67e5\u5b57\u7b26\u4e32\u7ed3\u5c3e\uff0c\u662f\u5426\u5339\u914d\u7ed9\u5b9a\u7684\u6a21\u5f0f\u3002\u5982\u679c\u5339\u914d\u6210\u529f\uff0c\u5c31\u5220\u9664\u5339\u914d\u7684\u90e8\u5206\uff0c\u8fd4\u56de\u5269\u4e0b\u7684\u90e8\u5206\u3002\u539f\u59cb\u53d8\u91cf\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\u3002</p> <pre><code># \u5982\u679c pattern \u5339\u914d\u53d8\u91cf variable \u7684\u7ed3\u5c3e\uff0c\n# \u5220\u9664\u6700\u77ed\u5339\u914d\uff08\u975e\u8d2a\u5a6a\u5339\u914d\uff09\u7684\u90e8\u5206\uff0c\u8fd4\u56de\u5269\u4f59\u90e8\u5206\n${variable%pattern}\n\n# \u5982\u679c pattern \u5339\u914d\u53d8\u91cf variable \u7684\u7ed3\u5c3e\uff0c\n# \u5220\u9664\u6700\u957f\u5339\u914d\uff08\u8d2a\u5a6a\u5339\u914d\uff09\u7684\u90e8\u5206\uff0c\u8fd4\u56de\u5269\u4f59\u90e8\u5206\n${variable%%pattern}\n</code></pre> <p>\u4e0a\u9762\u4e24\u79cd\u8bed\u6cd5\u4f1a\u5220\u9664\u53d8\u91cf\u5b57\u7b26\u4e32\u7ed3\u5c3e\u7684\u5339\u914d\u90e8\u5206\uff08\u5c06\u5176\u66ff\u6362\u4e3a\u7a7a\uff09\uff0c\u8fd4\u56de\u5269\u4e0b\u7684\u90e8\u5206\u3002\u533a\u522b\u662f\u4e00\u4e2a\u662f\u6700\u77ed\u5339\u914d\uff08\u53c8\u79f0\u975e\u8d2a\u5a6a\u5339\u914d\uff09\uff0c\u53e6\u4e00\u4e2a\u662f\u6700\u957f\u5339\u914d\uff08\u53c8\u79f0\u8d2a\u5a6a\u5339\u914d\uff09\u3002</p> <pre><code>$ path=/home/cam/book/long.file.name\n\n$ echo ${path%.*}\n/home/cam/book/long.file\n\n$ echo ${path%%.*}\n/home/cam/book/long\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5339\u914d\u6a21\u5f0f\u662f<code>.*</code>\uff0c\u5176\u4e2d<code>*</code>\u53ef\u4ee5\u5339\u914d\u4efb\u610f\u6570\u91cf\u7684\u5b57\u7b26\uff0c\u6240\u4ee5\u6700\u77ed\u5339\u914d\u662f<code>.name</code>\uff0c\u6700\u957f\u5339\u914d\u662f<code>.file.name</code>\u3002</p> <p>\u4e0b\u9762\u5199\u6cd5\u53ef\u4ee5\u5220\u9664\u8def\u5f84\u7684\u6587\u4ef6\u540d\u90e8\u5206\uff0c\u53ea\u7559\u4e0b\u76ee\u5f55\u90e8\u5206\u3002</p> <pre><code>$ path=/home/cam/book/long.file.name\n\n$ echo ${path%/*}\n/home/cam/book\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u6a21\u5f0f<code>/*</code>\u5339\u914d\u6587\u4ef6\u540d\u90e8\u5206\uff0c\u6240\u4ee5\u53ea\u8fd4\u56de\u76ee\u5f55\u90e8\u5206\u3002</p> <p>\u4e0b\u9762\u7684\u5199\u6cd5\u53ef\u4ee5\u66ff\u6362\u6587\u4ef6\u7684\u540e\u7f00\u540d\u3002</p> <pre><code>$ file=foo.png\n$ echo ${file%.png}.jpg\nfoo.jpg\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u5c06\u6587\u4ef6\u7684\u540e\u7f00\u540d\uff0c\u4ece<code>.png</code>\u6539\u6210\u4e86<code>.jpg</code>\u3002</p> <p>\u4e0b\u9762\u518d\u770b\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>$ phone=\"555-456-1414\"\n$ echo ${phone%-*}\n555-456\n$ echo ${phone%%-*}\n555\n</code></pre> <p>\u5982\u679c\u5339\u914d\u4e0d\u6210\u529f\uff0c\u5219\u8fd4\u56de\u539f\u59cb\u5b57\u7b26\u4e32\u3002</p> <p>\u5982\u679c\u8981\u5c06\u5c3e\u90e8\u5339\u914d\u7684\u90e8\u5206\uff0c\u66ff\u6362\u6210\u5176\u4ed6\u5185\u5bb9\uff0c\u91c7\u7528\u4e0b\u9762\u7684\u5199\u6cd5\u3002</p> <pre><code># \u6a21\u5f0f\u5fc5\u987b\u51fa\u73b0\u5728\u5b57\u7b26\u4e32\u7684\u7ed3\u5c3e\n${variable/%pattern/string}\n\n# \u793a\u4f8b\n$ foo=JPG.JPG\n$ echo ${foo/%JPG/jpg}\nJPG.jpg\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u88ab\u66ff\u6362\u7684<code>JPG</code>\u5fc5\u987b\u51fa\u73b0\u5728\u5b57\u7b26\u4e32\u5c3e\u90e8\uff0c\u6240\u4ee5\u8fd4\u56de<code>JPG.jpg</code>\u3002</p> <p>\uff083\uff09\u4efb\u610f\u4f4d\u7f6e\u7684\u6a21\u5f0f\u5339\u914d\u3002</p> <p>\u4ee5\u4e0b\u4e24\u79cd\u8bed\u6cd5\u53ef\u4ee5\u68c0\u67e5\u5b57\u7b26\u4e32\u5185\u90e8\uff0c\u662f\u5426\u5339\u914d\u7ed9\u5b9a\u7684\u6a21\u5f0f\u3002\u5982\u679c\u5339\u914d\u6210\u529f\uff0c\u5c31\u5220\u9664\u5339\u914d\u7684\u90e8\u5206\uff0c\u6362\u6210\u5176\u4ed6\u7684\u5b57\u7b26\u4e32\u8fd4\u56de\u3002\u539f\u59cb\u53d8\u91cf\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\u3002</p> <pre><code># \u5982\u679c pattern \u5339\u914d\u53d8\u91cf variable \u7684\u4e00\u90e8\u5206\uff0c\n# \u6700\u957f\u5339\u914d\uff08\u8d2a\u5a6a\u5339\u914d\uff09\u7684\u90a3\u90e8\u5206\u88ab string \u66ff\u6362\uff0c\u4f46\u4ec5\u66ff\u6362\u7b2c\u4e00\u4e2a\u5339\u914d\n${variable/pattern/string}\n\n# \u5982\u679c pattern \u5339\u914d\u53d8\u91cf variable \u7684\u4e00\u90e8\u5206\uff0c\n# \u6700\u957f\u5339\u914d\uff08\u8d2a\u5a6a\u5339\u914d\uff09\u7684\u90a3\u90e8\u5206\u88ab string \u66ff\u6362\uff0c\u6240\u6709\u5339\u914d\u90fd\u66ff\u6362\n${variable//pattern/string}\n</code></pre> <p>\u4e0a\u9762\u4e24\u79cd\u8bed\u6cd5\u90fd\u662f\u6700\u957f\u5339\u914d\uff08\u8d2a\u5a6a\u5339\u914d\uff09\u4e0b\u7684\u66ff\u6362\uff0c\u533a\u522b\u662f\u524d\u4e00\u4e2a\u8bed\u6cd5\u4ec5\u4ec5\u66ff\u6362\u7b2c\u4e00\u4e2a\u5339\u914d\uff0c\u540e\u4e00\u4e2a\u8bed\u6cd5\u66ff\u6362\u6240\u6709\u5339\u914d\u3002</p> <pre><code>$ path=/home/cam/foo/foo.name\n\n$ echo ${path/foo/bar}\n/home/cam/bar/foo.name\n\n$ echo ${path//foo/bar}\n/home/cam/bar/bar.name\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u524d\u4e00\u4e2a\u547d\u4ee4\u53ea\u66ff\u6362\u4e86\u7b2c\u4e00\u4e2a<code>foo</code>\uff0c\u540e\u4e00\u4e2a\u547d\u4ee4\u5c06\u4e24\u4e2a<code>foo</code>\u90fd\u66ff\u6362\u4e86\u3002</p> <p>\u4e0b\u9762\u7684\u4f8b\u5b50\u5c06\u5206\u9694\u7b26\u4ece<code>:</code>\u6362\u6210\u6362\u884c\u7b26\u3002</p> <pre><code>$ echo -e ${PATH//:/'\\n'}\n/usr/local/bin\n/usr/bin\n/bin\n...\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>echo</code>\u547d\u4ee4\u7684<code>-e</code>\u53c2\u6570\uff0c\u8868\u793a\u5c06\u66ff\u6362\u540e\u7684\u5b57\u7b26\u4e32\u7684<code>\\n</code>\u5b57\u7b26\uff0c\u89e3\u91ca\u4e3a\u6362\u884c\u7b26\u3002</p> <p>\u6a21\u5f0f\u90e8\u5206\u53ef\u4ee5\u4f7f\u7528\u901a\u914d\u7b26\u3002</p> <pre><code>$ phone=\"555-456-1414\"\n$ echo ${phone/5?4/-}\n55-56-1414\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u5c06<code>5-4</code>\u66ff\u6362\u6210<code>-</code>\u3002</p> <p>\u5982\u679c\u7701\u7565\u4e86<code>string</code>\u90e8\u5206\uff0c\u90a3\u4e48\u5c31\u76f8\u5f53\u4e8e\u5339\u914d\u7684\u90e8\u5206\u66ff\u6362\u6210\u7a7a\u5b57\u7b26\u4e32\uff0c\u5373\u5220\u9664\u5339\u914d\u7684\u90e8\u5206\u3002</p> <pre><code>$ path=/home/cam/foo/foo.name\n\n$ echo ${path/.*/}\n/home/cam/foo/foo\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u7b2c\u4e8c\u4e2a\u659c\u6760\u540e\u9762\u7684<code>string</code>\u90e8\u5206\u7701\u7565\u4e86\uff0c\u6240\u4ee5\u6a21\u5f0f<code>.*</code>\u5339\u914d\u7684\u90e8\u5206<code>.name</code>\u88ab\u5220\u9664\u540e\u8fd4\u56de\u3002</p> <p>\u524d\u9762\u63d0\u5230\u8fc7\uff0c\u8fd9\u4e2a\u8bed\u6cd5\u8fd8\u6709\u4e24\u79cd\u6269\u5c55\u5f62\u5f0f\u3002</p> <pre><code># \u6a21\u5f0f\u5fc5\u987b\u51fa\u73b0\u5728\u5b57\u7b26\u4e32\u7684\u5f00\u5934\n${variable/#pattern/string}\n\n# \u6a21\u5f0f\u5fc5\u987b\u51fa\u73b0\u5728\u5b57\u7b26\u4e32\u7684\u7ed3\u5c3e\n${variable/%pattern/string}\n</code></pre>"},{"location":"linux/bash/string/#_5","title":"\u6539\u53d8\u5927\u5c0f\u5199","text":"<p>\u4e0b\u9762\u7684\u8bed\u6cd5\u53ef\u4ee5\u6539\u53d8\u53d8\u91cf\u7684\u5927\u5c0f\u5199\u3002</p> <pre><code># \u8f6c\u4e3a\u5927\u5199\n${varname^^}\n\n# \u8f6c\u4e3a\u5c0f\u5199\n${varname,,}\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e2a\u4f8b\u5b50\u3002</p> <pre><code>$ foo=heLLo\n$ echo ${foo^^}\nHELLO\n$ echo ${foo,,}\nhello\n</code></pre>"},{"location":"linux/bash/variable/","title":"Bash \u53d8\u91cf","text":""},{"location":"linux/bash/variable/#_1","title":"\u7b80\u4ecb","text":"<p>Bash \u53d8\u91cf\u5206\u6210\u73af\u5883\u53d8\u91cf\u548c\u81ea\u5b9a\u4e49\u53d8\u91cf\u4e24\u7c7b\u3002</p>"},{"location":"linux/bash/variable/#_2","title":"\u73af\u5883\u53d8\u91cf","text":"<p>\u73af\u5883\u53d8\u91cf\u662f Bash \u73af\u5883\u81ea\u5e26\u7684\u53d8\u91cf\uff0c\u8fdb\u5165 Shell \u65f6\u5df2\u7ecf\u5b9a\u4e49\u597d\u4e86\uff0c\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u3002\u5b83\u4eec\u901a\u5e38\u662f\u7cfb\u7edf\u5b9a\u4e49\u597d\u7684\uff0c\u4e5f\u53ef\u4ee5\u7531\u7528\u6237\u4ece\u7236 Shell \u4f20\u5165\u5b50 Shell\u3002</p> <p><code>env</code>\u547d\u4ee4\u6216<code>printenv</code>\u547d\u4ee4\uff0c\u53ef\u4ee5\u663e\u793a\u6240\u6709\u73af\u5883\u53d8\u91cf\u3002</p> <pre><code>$ env\n# \u6216\u8005\n$ printenv\n</code></pre> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u5e38\u89c1\u7684\u73af\u5883\u53d8\u91cf\u3002</p> <ul> <li><code>BASHPID</code>\uff1aBash \u8fdb\u7a0b\u7684\u8fdb\u7a0b ID\u3002</li> <li><code>BASHOPTS</code>\uff1a\u5f53\u524d Shell \u7684\u53c2\u6570\uff0c\u53ef\u4ee5\u7528<code>shopt</code>\u547d\u4ee4\u4fee\u6539\u3002</li> <li><code>DISPLAY</code>\uff1a\u56fe\u5f62\u73af\u5883\u7684\u663e\u793a\u5668\u540d\u5b57\uff0c\u901a\u5e38\u662f<code>:0</code>\uff0c\u8868\u793a X Server \u7684\u7b2c\u4e00\u4e2a\u663e\u793a\u5668\u3002</li> <li><code>EDITOR</code>\uff1a\u9ed8\u8ba4\u7684\u6587\u672c\u7f16\u8f91\u5668\u3002</li> <li><code>HOME</code>\uff1a\u7528\u6237\u7684\u4e3b\u76ee\u5f55\u3002</li> <li><code>HOST</code>\uff1a\u5f53\u524d\u4e3b\u673a\u7684\u540d\u79f0\u3002</li> <li><code>IFS</code>\uff1a\u8bcd\u4e0e\u8bcd\u4e4b\u95f4\u7684\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u4e3a\u7a7a\u683c\u3002</li> <li><code>LANG</code>\uff1a\u5b57\u7b26\u96c6\u4ee5\u53ca\u8bed\u8a00\u7f16\u7801\uff0c\u6bd4\u5982<code>zh_CN.UTF-8</code>\u3002</li> <li><code>PATH</code>\uff1a\u7531\u5192\u53f7\u5206\u5f00\u7684\u76ee\u5f55\u5217\u8868\uff0c\u5f53\u8f93\u5165\u53ef\u6267\u884c\u7a0b\u5e8f\u540d\u540e\uff0c\u4f1a\u641c\u7d22\u8fd9\u4e2a\u76ee\u5f55\u5217\u8868\u3002</li> <li><code>PS1</code>\uff1aShell \u63d0\u793a\u7b26\u3002</li> <li><code>PS2</code>\uff1a \u8f93\u5165\u591a\u884c\u547d\u4ee4\u65f6\uff0c\u6b21\u8981\u7684 Shell \u63d0\u793a\u7b26\u3002</li> <li><code>PWD</code>\uff1a\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u3002</li> <li><code>RANDOM</code>\uff1a\u8fd4\u56de\u4e00\u4e2a0\u523032767\u4e4b\u95f4\u7684\u968f\u673a\u6570\u3002</li> <li><code>SHELL</code>\uff1aShell \u7684\u540d\u5b57\u3002</li> <li><code>SHELLOPTS</code>\uff1a\u542f\u52a8\u5f53\u524d Shell \u7684<code>set</code>\u547d\u4ee4\u7684\u53c2\u6570\uff0c\u53c2\u89c1\u300aset \u547d\u4ee4\u300b\u4e00\u7ae0\u3002</li> <li><code>TERM</code>\uff1a\u7ec8\u7aef\u7c7b\u578b\u540d\uff0c\u5373\u7ec8\u7aef\u4eff\u771f\u5668\u6240\u7528\u7684\u534f\u8bae\u3002</li> <li><code>UID</code>\uff1a\u5f53\u524d\u7528\u6237\u7684 ID \u7f16\u53f7\u3002</li> <li><code>USER</code>\uff1a\u5f53\u524d\u7528\u6237\u7684\u7528\u6237\u540d\u3002</li> </ul> <p>\u5f88\u591a\u73af\u5883\u53d8\u91cf\u5f88\u5c11\u53d1\u751f\u53d8\u5316\uff0c\u800c\u4e14\u662f\u53ea\u8bfb\u7684\uff0c\u53ef\u4ee5\u89c6\u4e3a\u5e38\u91cf\u3002\u7531\u4e8e\u5b83\u4eec\u7684\u53d8\u91cf\u540d\u5168\u90e8\u90fd\u662f\u5927\u5199\uff0c\u6240\u4ee5\u4f20\u7edf\u4e0a\uff0c\u5982\u679c\u7528\u6237\u8981\u81ea\u5df1\u5b9a\u4e49\u4e00\u4e2a\u5e38\u91cf\uff0c\u4e5f\u4f1a\u4f7f\u7528\u5168\u90e8\u5927\u5199\u7684\u53d8\u91cf\u540d\u3002</p> <p>\u6ce8\u610f\uff0cBash \u53d8\u91cf\u540d\u533a\u5206\u5927\u5c0f\u5199\uff0c<code>HOME</code>\u548c<code>home</code>\u662f\u4e24\u4e2a\u4e0d\u540c\u7684\u53d8\u91cf\u3002</p> <p>\u67e5\u770b\u5355\u4e2a\u73af\u5883\u53d8\u91cf\u7684\u503c\uff0c\u53ef\u4ee5\u4f7f\u7528<code>printenv</code>\u547d\u4ee4\u6216<code>echo</code>\u547d\u4ee4\u3002</p> <pre><code>$ printenv PATH\n# \u6216\u8005\n$ echo $PATH\n</code></pre> <p>\u6ce8\u610f\uff0c<code>printenv</code>\u547d\u4ee4\u540e\u9762\u7684\u53d8\u91cf\u540d\uff0c\u4e0d\u7528\u52a0\u524d\u7f00<code>$</code>\u3002</p>"},{"location":"linux/bash/variable/#_3","title":"\u81ea\u5b9a\u4e49\u53d8\u91cf","text":"<p>\u81ea\u5b9a\u4e49\u53d8\u91cf\u662f\u7528\u6237\u5728\u5f53\u524d Shell \u91cc\u9762\u81ea\u5df1\u5b9a\u4e49\u7684\u53d8\u91cf\uff0c\u5fc5\u987b\u5148\u5b9a\u4e49\u540e\u4f7f\u7528\uff0c\u800c\u4e14\u4ec5\u5728\u5f53\u524d Shell \u53ef\u7528\u3002\u4e00\u65e6\u9000\u51fa\u5f53\u524d Shell\uff0c\u8be5\u53d8\u91cf\u5c31\u4e0d\u5b58\u5728\u4e86\u3002</p> <p><code>set</code>\u547d\u4ee4\u53ef\u4ee5\u663e\u793a\u6240\u6709\u53d8\u91cf\uff08\u5305\u62ec\u73af\u5883\u53d8\u91cf\u548c\u81ea\u5b9a\u4e49\u53d8\u91cf\uff09\uff0c\u4ee5\u53ca\u6240\u6709\u7684 Bash \u51fd\u6570\u3002</p> <pre><code>$ set\n</code></pre>"},{"location":"linux/bash/variable/#_4","title":"\u521b\u5efa\u53d8\u91cf","text":"<p>\u7528\u6237\u521b\u5efa\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u53d8\u91cf\u540d\u5fc5\u987b\u9075\u5b88\u4e0b\u9762\u7684\u89c4\u5219\u3002</p> <ul> <li>\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\u5b57\u7b26\u7ec4\u6210\u3002</li> <li>\u7b2c\u4e00\u4e2a\u5b57\u7b26\u5fc5\u987b\u662f\u4e00\u4e2a\u5b57\u6bcd\u6216\u4e00\u4e2a\u4e0b\u5212\u7ebf\uff0c\u4e0d\u80fd\u662f\u6570\u5b57\u3002</li> <li>\u4e0d\u5141\u8bb8\u51fa\u73b0\u7a7a\u683c\u548c\u6807\u70b9\u7b26\u53f7\u3002</li> </ul> <p>\u53d8\u91cf\u58f0\u660e\u7684\u8bed\u6cd5\u5982\u4e0b\u3002</p> <pre><code>variable=value\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u4e2d\uff0c\u7b49\u53f7\u5de6\u8fb9\u662f\u53d8\u91cf\u540d\uff0c\u53f3\u8fb9\u662f\u53d8\u91cf\u3002\u6ce8\u610f\uff0c\u7b49\u53f7\u4e24\u8fb9\u4e0d\u80fd\u6709\u7a7a\u683c\u3002</p> <p>\u5982\u679c\u53d8\u91cf\u7684\u503c\u5305\u542b\u7a7a\u683c\uff0c\u5219\u5fc5\u987b\u5c06\u503c\u653e\u5728\u5f15\u53f7\u4e2d\u3002</p> <pre><code>myvar=\"hello world\"\n</code></pre> <p>Bash \u6ca1\u6709\u6570\u636e\u7c7b\u578b\u7684\u6982\u5ff5\uff0c\u6240\u6709\u7684\u53d8\u91cf\u503c\u90fd\u662f\u5b57\u7b26\u4e32\u3002</p> <p>\u4e0b\u9762\u662f\u4e00\u4e9b\u81ea\u5b9a\u4e49\u53d8\u91cf\u7684\u4f8b\u5b50\u3002</p> <pre><code>a=z                     # \u53d8\u91cf a \u8d4b\u503c\u4e3a\u5b57\u7b26\u4e32 z\nb=\"a string\"            # \u53d8\u91cf\u503c\u5305\u542b\u7a7a\u683c\uff0c\u5c31\u5fc5\u987b\u653e\u5728\u5f15\u53f7\u91cc\u9762\nc=\"a string and $b\"     # \u53d8\u91cf\u503c\u53ef\u4ee5\u5f15\u7528\u5176\u4ed6\u53d8\u91cf\u7684\u503c\nd=\"\\t\\ta string\\n\"      # \u53d8\u91cf\u503c\u53ef\u4ee5\u4f7f\u7528\u8f6c\u4e49\u5b57\u7b26\ne=$(ls -l foo.txt)      # \u53d8\u91cf\u503c\u53ef\u4ee5\u662f\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\nf=$((5 * 7))            # \u53d8\u91cf\u503c\u53ef\u4ee5\u662f\u6570\u5b66\u8fd0\u7b97\u7684\u7ed3\u679c\n</code></pre> <p>\u53d8\u91cf\u53ef\u4ee5\u91cd\u590d\u8d4b\u503c\uff0c\u540e\u9762\u7684\u8d4b\u503c\u4f1a\u8986\u76d6\u524d\u9762\u7684\u8d4b\u503c\u3002</p> <pre><code>$ foo=1\n$ foo=2\n$ echo $foo\n2\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53d8\u91cf<code>foo</code>\u7684\u7b2c\u4e8c\u6b21\u8d4b\u503c\u4f1a\u8986\u76d6\u7b2c\u4e00\u6b21\u8d4b\u503c\u3002</p> <p>\u5982\u679c\u540c\u4e00\u884c\u5b9a\u4e49\u591a\u4e2a\u53d8\u91cf\uff0c\u5fc5\u987b\u4f7f\u7528\u5206\u53f7\uff08<code>;</code>\uff09\u5206\u9694\u3002</p> <pre><code>$ foo=1;bar=2\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u540c\u4e00\u884c\u5b9a\u4e49\u4e86<code>foo</code>\u548c<code>bar</code>\u4e24\u4e2a\u53d8\u91cf\u3002</p>"},{"location":"linux/bash/variable/#_5","title":"\u8bfb\u53d6\u53d8\u91cf","text":"<p>\u8bfb\u53d6\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u76f4\u63a5\u5728\u53d8\u91cf\u540d\u524d\u52a0\u4e0a<code>$</code>\u5c31\u53ef\u4ee5\u4e86\u3002</p> <pre><code>$ foo=bar\n$ echo $foo\nbar\n</code></pre> <p>\u6bcf\u5f53 Shell \u770b\u5230\u4ee5<code>$</code>\u5f00\u5934\u7684\u5355\u8bcd\u65f6\uff0c\u5c31\u4f1a\u5c1d\u8bd5\u8bfb\u53d6\u8fd9\u4e2a\u53d8\u91cf\u540d\u5bf9\u5e94\u7684\u503c\u3002</p> <p>\u5982\u679c\u53d8\u91cf\u4e0d\u5b58\u5728\uff0cBash \u4e0d\u4f1a\u62a5\u9519\uff0c\u800c\u4f1a\u8f93\u51fa\u7a7a\u5b57\u7b26\u3002</p> <p>\u7531\u4e8e<code>$</code>\u5728 Bash \u4e2d\u6709\u7279\u6b8a\u542b\u4e49\uff0c\u628a\u5b83\u5f53\u4f5c\u7f8e\u5143\u7b26\u53f7\u4f7f\u7528\u65f6\uff0c\u4e00\u5b9a\u8981\u975e\u5e38\u5c0f\u5fc3\uff0c</p> <pre><code>$ echo The total is $100.00\nThe total is 00.00\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u7684\u539f\u610f\u662f\u8f93\u5165<code>$100</code>\uff0c\u4f46\u662f Bash \u5c06<code>$1</code>\u89e3\u91ca\u6210\u4e86\u53d8\u91cf\uff0c\u8be5\u53d8\u91cf\u4e3a\u7a7a\uff0c\u56e0\u6b64\u8f93\u5165\u5c31\u53d8\u6210\u4e86<code>00.00</code>\u3002\u6240\u4ee5\uff0c\u5982\u679c\u8981\u4f7f\u7528<code>$</code>\u7684\u539f\u4e49\uff0c\u9700\u8981\u5728<code>$</code>\u524d\u9762\u653e\u4e0a\u53cd\u659c\u6760\uff0c\u8fdb\u884c\u8f6c\u4e49\u3002</p> <pre><code>$ echo The total is \\$100.00\nThe total is $100.00\n</code></pre> <p>\u8bfb\u53d6\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u53d8\u91cf\u540d\u4e5f\u53ef\u4ee5\u4f7f\u7528\u82b1\u62ec\u53f7<code>{}</code>\u5305\u56f4\uff0c\u6bd4\u5982<code>$a</code>\u4e5f\u53ef\u4ee5\u5199\u6210<code>${a}</code>\u3002\u8fd9\u79cd\u5199\u6cd5\u53ef\u4ee5\u7528\u4e8e\u53d8\u91cf\u540d\u4e0e\u5176\u4ed6\u5b57\u7b26\u8fde\u7528\u7684\u60c5\u51b5\u3002</p> <pre><code>$ a=foo\n$ echo $a_file\n\n$ echo ${a}_file\nfoo_file\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u4e2d\uff0c\u53d8\u91cf\u540d<code>a_file</code>\u4e0d\u4f1a\u6709\u4efb\u4f55\u8f93\u51fa\uff0c\u56e0\u4e3a Bash \u5c06\u5176\u6574\u4e2a\u89e3\u91ca\u4e3a\u53d8\u91cf\uff0c\u800c\u8fd9\u4e2a\u53d8\u91cf\u662f\u4e0d\u5b58\u5728\u7684\u3002\u53ea\u6709\u7528\u82b1\u62ec\u53f7\u533a\u5206<code>$a</code>\uff0cBash \u624d\u80fd\u6b63\u786e\u89e3\u8bfb\u3002</p> <p>\u4e8b\u5b9e\u4e0a\uff0c\u8bfb\u53d6\u53d8\u91cf\u7684\u8bed\u6cd5<code>$foo</code>\uff0c\u53ef\u4ee5\u770b\u4f5c\u662f<code>${foo}</code>\u7684\u7b80\u5199\u5f62\u5f0f\u3002</p> <p>\u5982\u679c\u53d8\u91cf\u7684\u503c\u672c\u8eab\u4e5f\u662f\u53d8\u91cf\uff0c\u53ef\u4ee5\u4f7f\u7528<code>${!varname}</code>\u7684\u8bed\u6cd5\uff0c\u8bfb\u53d6\u6700\u7ec8\u7684\u503c\u3002</p> <pre><code>$ myvar=USER\n$ echo ${!myvar}\nruanyf\n</code></pre> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u53d8\u91cf<code>myvar</code>\u7684\u503c\u662f<code>USER</code>\uff0c<code>${!myvar}</code>\u7684\u5199\u6cd5\u5c06\u5176\u5c55\u5f00\u6210\u6700\u7ec8\u7684\u503c\u3002</p> <p>\u5982\u679c\u53d8\u91cf\u503c\u5305\u542b\u8fde\u7eed\u7a7a\u683c\uff08\u6216\u5236\u8868\u7b26\u548c\u6362\u884c\u7b26\uff09\uff0c\u6700\u597d\u653e\u5728\u53cc\u5f15\u53f7\u91cc\u9762\u8bfb\u53d6\u3002</p> <pre><code>$ a=\"1 2  3\"\n$ echo $a\n1 2 3\n$ echo \"$a\"\n1 2  3\n</code></pre> <p>\u4e0a\u9762\u793a\u4f8b\u4e2d\uff0c\u53d8\u91cf<code>a</code>\u7684\u503c\u5305\u542b\u4e24\u4e2a\u8fde\u7eed\u7a7a\u683c\u3002\u5982\u679c\u76f4\u63a5\u8bfb\u53d6\uff0cShell \u4f1a\u5c06\u8fde\u7eed\u7a7a\u683c\u5408\u5e76\u6210\u4e00\u4e2a\u3002\u53ea\u6709\u653e\u5728\u53cc\u5f15\u53f7\u91cc\u9762\u8bfb\u53d6\uff0c\u624d\u80fd\u4fdd\u6301\u539f\u6765\u7684\u683c\u5f0f\u3002</p>"},{"location":"linux/bash/variable/#_6","title":"\u5220\u9664\u53d8\u91cf","text":"<p><code>unset</code>\u547d\u4ee4\u7528\u6765\u5220\u9664\u4e00\u4e2a\u53d8\u91cf\u3002</p> <pre><code>unset NAME\n</code></pre> <p>\u8fd9\u4e2a\u547d\u4ee4\u4e0d\u662f\u5f88\u6709\u7528\u3002\u56e0\u4e3a\u4e0d\u5b58\u5728\u7684 Bash \u53d8\u91cf\u4e00\u5f8b\u7b49\u4e8e\u7a7a\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u5373\u4f7f<code>unset</code>\u547d\u4ee4\u5220\u9664\u4e86\u53d8\u91cf\uff0c\u8fd8\u662f\u53ef\u4ee5\u8bfb\u53d6\u8fd9\u4e2a\u53d8\u91cf\uff0c\u503c\u4e3a\u7a7a\u5b57\u7b26\u4e32\u3002</p> <p>\u6240\u4ee5\uff0c\u5220\u9664\u4e00\u4e2a\u53d8\u91cf\uff0c\u4e5f\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u53d8\u91cf\u8bbe\u6210\u7a7a\u5b57\u7b26\u4e32\u3002</p> <pre><code>$ foo=''\n$ foo=\n</code></pre> <p>\u4e0a\u9762\u4e24\u79cd\u5199\u6cd5\uff0c\u90fd\u662f\u5220\u9664\u4e86\u53d8\u91cf<code>foo</code>\u3002\u7531\u4e8e\u4e0d\u5b58\u5728\u7684\u503c\u9ed8\u8ba4\u4e3a\u7a7a\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5\u540e\u4e00\u79cd\u5199\u6cd5\u53ef\u4ee5\u5728\u7b49\u53f7\u53f3\u8fb9\u4e0d\u5199\u4efb\u4f55\u503c\u3002</p>"},{"location":"linux/bash/variable/#export","title":"\u8f93\u51fa\u53d8\u91cf\uff0cexport \u547d\u4ee4","text":"<p>\u7528\u6237\u521b\u5efa\u7684\u53d8\u91cf\u4ec5\u53ef\u7528\u4e8e\u5f53\u524d Shell\uff0c\u5b50 Shell \u9ed8\u8ba4\u8bfb\u53d6\u4e0d\u5230\u7236 Shell \u5b9a\u4e49\u7684\u53d8\u91cf\u3002\u4e3a\u4e86\u628a\u53d8\u91cf\u4f20\u9012\u7ed9\u5b50 Shell\uff0c\u9700\u8981\u4f7f\u7528<code>export</code>\u547d\u4ee4\u3002\u8fd9\u6837\u8f93\u51fa\u7684\u53d8\u91cf\uff0c\u5bf9\u4e8e\u5b50 Shell \u6765\u8bf4\u5c31\u662f\u73af\u5883\u53d8\u91cf\u3002</p> <p><code>export</code>\u547d\u4ee4\u7528\u6765\u5411\u5b50 Shell \u8f93\u51fa\u53d8\u91cf\u3002</p> <pre><code>NAME=foo\nexport NAME\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u8f93\u51fa\u4e86\u53d8\u91cf<code>NAME</code>\u3002\u53d8\u91cf\u7684\u8d4b\u503c\u548c\u8f93\u51fa\u4e5f\u53ef\u4ee5\u5728\u4e00\u4e2a\u6b65\u9aa4\u4e2d\u5b8c\u6210\u3002</p> <pre><code>export NAME=value\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u6267\u884c\u540e\uff0c\u5f53\u524d Shell \u53ca\u968f\u540e\u65b0\u5efa\u7684\u5b50 Shell\uff0c\u90fd\u53ef\u4ee5\u8bfb\u53d6\u53d8\u91cf<code>$NAME</code>\u3002</p> <p>\u5b50 Shell \u5982\u679c\u4fee\u6539\u7ee7\u627f\u7684\u53d8\u91cf\uff0c\u4e0d\u4f1a\u5f71\u54cd\u7236 Shell\u3002</p> <pre><code># \u8f93\u51fa\u53d8\u91cf $foo\n$ export foo=bar\n\n# \u65b0\u5efa\u5b50 Shell\n$ bash\n\n# \u8bfb\u53d6 $foo\n$ echo $foo\nbar\n\n# \u4fee\u6539\u7ee7\u627f\u7684\u53d8\u91cf\n$ foo=baz\n\n# \u9000\u51fa\u5b50 Shell\n$ exit\n\n# \u8bfb\u53d6 $foo\n$ echo $foo\nbar\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5b50 Shell \u4fee\u6539\u4e86\u7ee7\u627f\u7684\u53d8\u91cf<code>$foo</code>\uff0c\u5bf9\u7236 Shell \u6ca1\u6709\u5f71\u54cd\u3002</p>"},{"location":"linux/bash/variable/#_7","title":"\u7279\u6b8a\u53d8\u91cf","text":"<p>Bash \u63d0\u4f9b\u4e00\u4e9b\u7279\u6b8a\u53d8\u91cf\u3002\u8fd9\u4e9b\u53d8\u91cf\u7684\u503c\u7531 Shell \u63d0\u4f9b\uff0c\u7528\u6237\u4e0d\u80fd\u8fdb\u884c\u8d4b\u503c\u3002</p> <p>\uff081\uff09<code>$?</code></p> <p><code>$?</code>\u4e3a\u4e0a\u4e00\u4e2a\u547d\u4ee4\u7684\u9000\u51fa\u7801\uff0c\u7528\u6765\u5224\u65ad\u4e0a\u4e00\u4e2a\u547d\u4ee4\u662f\u5426\u6267\u884c\u6210\u529f\u3002\u8fd4\u56de\u503c\u662f<code>0</code>\uff0c\u8868\u793a\u4e0a\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u6210\u529f\uff1b\u5982\u679c\u662f\u975e\u96f6\uff0c\u4e0a\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u5931\u8d25\u3002</p> <pre><code>$ ls doesnotexist\nls: doesnotexist: No such file or directory\n\n$ echo $?\n1\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>ls</code>\u547d\u4ee4\u67e5\u770b\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u5bfc\u81f4\u62a5\u9519\u3002<code>$?</code>\u4e3a1\uff0c\u8868\u793a\u4e0a\u4e00\u4e2a\u547d\u4ee4\u6267\u884c\u5931\u8d25\u3002</p> <p>\uff082\uff09<code>$$</code></p> <p><code>$$</code>\u4e3a\u5f53\u524d Shell \u7684\u8fdb\u7a0b ID\u3002</p> <pre><code>$ echo $$\n10662\n</code></pre> <p>\u8fd9\u4e2a\u7279\u6b8a\u53d8\u91cf\u53ef\u4ee5\u7528\u6765\u547d\u540d\u4e34\u65f6\u6587\u4ef6\u3002</p> <pre><code>LOGFILE=/tmp/output_log.$$\n</code></pre> <p>\uff083\uff09<code>$_</code></p> <p><code>$_</code>\u4e3a\u4e0a\u4e00\u4e2a\u547d\u4ee4\u7684\u6700\u540e\u4e00\u4e2a\u53c2\u6570\u3002</p> <pre><code>$ grep dictionary /usr/share/dict/words\ndictionary\n\n$ echo $_\n/usr/share/dict/words\n</code></pre> <p>\uff084\uff09<code>$!</code></p> <p><code>$!</code>\u4e3a\u6700\u8fd1\u4e00\u4e2a\u540e\u53f0\u6267\u884c\u7684\u5f02\u6b65\u547d\u4ee4\u7684\u8fdb\u7a0b ID\u3002</p> <pre><code>$ firefox &amp;\n[1] 11064\n\n$ echo $!\n11064\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>firefox</code>\u662f\u540e\u53f0\u8fd0\u884c\u7684\u547d\u4ee4\uff0c<code>$!</code>\u8fd4\u56de\u8be5\u547d\u4ee4\u7684\u8fdb\u7a0b ID\u3002</p> <p>\uff085\uff09<code>$0</code></p> <p><code>$0</code>\u4e3a\u5f53\u524d Shell \u7684\u540d\u79f0\uff08\u5728\u547d\u4ee4\u884c\u76f4\u63a5\u6267\u884c\u65f6\uff09\u6216\u8005\u811a\u672c\u540d\uff08\u5728\u811a\u672c\u4e2d\u6267\u884c\u65f6\uff09\u3002</p> <pre><code>$ echo $0\nbash\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>$0</code>\u8fd4\u56de\u5f53\u524d\u8fd0\u884c\u7684\u662f Bash\u3002</p> <p>\uff086\uff09<code>$-</code></p> <p><code>$-</code>\u4e3a\u5f53\u524d Shell \u7684\u542f\u52a8\u53c2\u6570\u3002</p> <pre><code>$ echo $-\nhimBHs\n</code></pre> <p>\uff087\uff09<code>$@</code>\u548c<code>$#</code></p> <p><code>$@</code>\u548c<code>$#</code>\u8868\u793a\u811a\u672c\u7684\u53c2\u6570\u6570\u91cf\uff0c\u53c2\u89c1\u811a\u672c\u4e00\u7ae0\u3002</p>"},{"location":"linux/bash/variable/#_8","title":"\u53d8\u91cf\u7684\u9ed8\u8ba4\u503c","text":"<p>Bash \u63d0\u4f9b\u56db\u4e2a\u7279\u6b8a\u8bed\u6cd5\uff0c\u8ddf\u53d8\u91cf\u7684\u9ed8\u8ba4\u503c\u6709\u5173\uff0c\u76ee\u7684\u662f\u4fdd\u8bc1\u53d8\u91cf\u4e0d\u4e3a\u7a7a\u3002</p> <pre><code>${varname:-word}\n</code></pre> <p>\u4e0a\u9762\u8bed\u6cd5\u7684\u542b\u4e49\u662f\uff0c\u5982\u679c\u53d8\u91cf<code>varname</code>\u5b58\u5728\u4e14\u4e0d\u4e3a\u7a7a\uff0c\u5219\u8fd4\u56de\u5b83\u7684\u503c\uff0c\u5426\u5219\u8fd4\u56de<code>word</code>\u3002\u5b83\u7684\u76ee\u7684\u662f\u8fd4\u56de\u4e00\u4e2a\u9ed8\u8ba4\u503c\uff0c\u6bd4\u5982<code>${count:-0}</code>\u8868\u793a\u53d8\u91cf<code>count</code>\u4e0d\u5b58\u5728\u65f6\u8fd4\u56de<code>0</code>\u3002</p> <pre><code>${varname:=word}\n</code></pre> <p>\u4e0a\u9762\u8bed\u6cd5\u7684\u542b\u4e49\u662f\uff0c\u5982\u679c\u53d8\u91cf<code>varname</code>\u5b58\u5728\u4e14\u4e0d\u4e3a\u7a7a\uff0c\u5219\u8fd4\u56de\u5b83\u7684\u503c\uff0c\u5426\u5219\u5c06\u5b83\u8bbe\u4e3a<code>word</code>\uff0c\u5e76\u4e14\u8fd4\u56de<code>word</code>\u3002\u5b83\u7684\u76ee\u7684\u662f\u8bbe\u7f6e\u53d8\u91cf\u7684\u9ed8\u8ba4\u503c\uff0c\u6bd4\u5982<code>${count:=0}</code>\u8868\u793a\u53d8\u91cf<code>count</code>\u4e0d\u5b58\u5728\u65f6\u8fd4\u56de<code>0</code>\uff0c\u4e14\u5c06<code>count</code>\u8bbe\u4e3a<code>0</code>\u3002</p> <pre><code>${varname:+word}\n</code></pre> <p>\u4e0a\u9762\u8bed\u6cd5\u7684\u542b\u4e49\u662f\uff0c\u5982\u679c\u53d8\u91cf\u540d\u5b58\u5728\u4e14\u4e0d\u4e3a\u7a7a\uff0c\u5219\u8fd4\u56de<code>word</code>\uff0c\u5426\u5219\u8fd4\u56de\u7a7a\u503c\u3002\u5b83\u7684\u76ee\u7684\u662f\u6d4b\u8bd5\u53d8\u91cf\u662f\u5426\u5b58\u5728\uff0c\u6bd4\u5982<code>${count:+1}</code>\u8868\u793a\u53d8\u91cf<code>count</code>\u5b58\u5728\u65f6\u8fd4\u56de<code>1</code>\uff08\u8868\u793a<code>true</code>\uff09\uff0c\u5426\u5219\u8fd4\u56de\u7a7a\u503c\u3002</p> <pre><code>${varname:?message}\n</code></pre> <p>\u4e0a\u9762\u8bed\u6cd5\u7684\u542b\u4e49\u662f\uff0c\u5982\u679c\u53d8\u91cf<code>varname</code>\u5b58\u5728\u4e14\u4e0d\u4e3a\u7a7a\uff0c\u5219\u8fd4\u56de\u5b83\u7684\u503c\uff0c\u5426\u5219\u6253\u5370\u51fa<code>varname: message</code>\uff0c\u5e76\u4e2d\u65ad\u811a\u672c\u7684\u6267\u884c\u3002\u5982\u679c\u7701\u7565\u4e86<code>message</code>\uff0c\u5219\u8f93\u51fa\u9ed8\u8ba4\u7684\u4fe1\u606f\u201cparameter null or not set.\u201d\u3002\u5b83\u7684\u76ee\u7684\u662f\u9632\u6b62\u53d8\u91cf\u672a\u5b9a\u4e49\uff0c\u6bd4\u5982<code>${count:?\"undefined!\"}</code>\u8868\u793a\u53d8\u91cf<code>count</code>\u672a\u5b9a\u4e49\u65f6\u5c31\u4e2d\u65ad\u6267\u884c\uff0c\u629b\u51fa\u9519\u8bef\uff0c\u8fd4\u56de\u7ed9\u5b9a\u7684\u62a5\u9519\u4fe1\u606f<code>undefined!</code>\u3002</p> <p>\u4e0a\u9762\u56db\u79cd\u8bed\u6cd5\u5982\u679c\u7528\u5728\u811a\u672c\u4e2d\uff0c\u53d8\u91cf\u540d\u7684\u90e8\u5206\u53ef\u4ee5\u7528\u6570\u5b57<code>1</code>\u5230<code>9</code>\uff0c\u8868\u793a\u811a\u672c\u7684\u53c2\u6570\u3002</p> <pre><code>filename=${1:?\"filename missing.\"}\n</code></pre> <p>\u4e0a\u9762\u4ee3\u7801\u51fa\u73b0\u5728\u811a\u672c\u4e2d\uff0c<code>1</code>\u8868\u793a\u811a\u672c\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u3002\u5982\u679c\u8be5\u53c2\u6570\u4e0d\u5b58\u5728\uff0c\u5c31\u9000\u51fa\u811a\u672c\u5e76\u62a5\u9519\u3002</p>"},{"location":"linux/bash/variable/#declare","title":"declare \u547d\u4ee4","text":"<p><code>declare</code>\u547d\u4ee4\u53ef\u4ee5\u58f0\u660e\u4e00\u4e9b\u7279\u6b8a\u7c7b\u578b\u7684\u53d8\u91cf\uff0c\u4e3a\u53d8\u91cf\u8bbe\u7f6e\u4e00\u4e9b\u9650\u5236\uff0c\u6bd4\u5982\u58f0\u660e\u53ea\u8bfb\u7c7b\u578b\u7684\u53d8\u91cf\u548c\u6574\u6570\u7c7b\u578b\u7684\u53d8\u91cf\u3002</p> <p>\u5b83\u7684\u8bed\u6cd5\u5f62\u5f0f\u5982\u4e0b\u3002</p> <pre><code>declare OPTION VARIABLE=value\n</code></pre> <p><code>declare</code>\u547d\u4ee4\u7684\u4e3b\u8981\u53c2\u6570\uff08OPTION\uff09\u5982\u4e0b\u3002</p> <ul> <li><code>-a</code>\uff1a\u58f0\u660e\u6570\u7ec4\u53d8\u91cf\u3002</li> <li><code>-f</code>\uff1a\u8f93\u51fa\u6240\u6709\u51fd\u6570\u5b9a\u4e49\u3002</li> <li><code>-F</code>\uff1a\u8f93\u51fa\u6240\u6709\u51fd\u6570\u540d\u3002</li> <li><code>-i</code>\uff1a\u58f0\u660e\u6574\u6570\u53d8\u91cf\u3002</li> <li><code>-l</code>\uff1a\u58f0\u660e\u53d8\u91cf\u4e3a\u5c0f\u5199\u5b57\u6bcd\u3002</li> <li><code>-p</code>\uff1a\u67e5\u770b\u53d8\u91cf\u4fe1\u606f\u3002</li> <li><code>-r</code>\uff1a\u58f0\u660e\u53ea\u8bfb\u53d8\u91cf\u3002</li> <li><code>-u</code>\uff1a\u58f0\u660e\u53d8\u91cf\u4e3a\u5927\u5199\u5b57\u6bcd\u3002</li> <li><code>-x</code>\uff1a\u8be5\u53d8\u91cf\u8f93\u51fa\u4e3a\u73af\u5883\u53d8\u91cf\u3002</li> </ul> <p><code>declare</code>\u547d\u4ee4\u5982\u679c\u7528\u5728\u51fd\u6570\u4e2d\uff0c\u58f0\u660e\u7684\u53d8\u91cf\u53ea\u5728\u51fd\u6570\u5185\u90e8\u6709\u6548\uff0c\u7b49\u540c\u4e8e<code>local</code>\u547d\u4ee4\u3002</p> <p>\u4e0d\u5e26\u4efb\u4f55\u53c2\u6570\u65f6\uff0c<code>declare</code>\u547d\u4ee4\u8f93\u51fa\u5f53\u524d\u73af\u5883\u7684\u6240\u6709\u53d8\u91cf\uff0c\u5305\u62ec\u51fd\u6570\u5728\u5185\uff0c\u7b49\u540c\u4e8e\u4e0d\u5e26\u6709\u4efb\u4f55\u53c2\u6570\u7684<code>set</code>\u547d\u4ee4\u3002</p> <pre><code>$ declare\n</code></pre> <p>\uff081\uff09<code>-i</code>\u53c2\u6570</p> <p><code>-i</code>\u53c2\u6570\u58f0\u660e\u6574\u6570\u53d8\u91cf\u4ee5\u540e\uff0c\u53ef\u4ee5\u76f4\u63a5\u8fdb\u884c\u6570\u5b66\u8fd0\u7b97\u3002</p> <pre><code>$ declare -i val1=12 val2=5\n$ declare -i result\n$ result=val1*val2\n$ echo $result\n60\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u5982\u679c\u53d8\u91cf<code>result</code>\u4e0d\u58f0\u660e\u4e3a\u6574\u6570\uff0c<code>val1*val2</code>\u4f1a\u88ab\u5f53\u4f5c\u5b57\u9762\u91cf\uff0c\u4e0d\u4f1a\u8fdb\u884c\u6574\u6570\u8fd0\u7b97\u3002\u53e6\u5916\uff0c<code>val1</code>\u548c<code>val2</code>\u5176\u5b9e\u4e0d\u9700\u8981\u58f0\u660e\u4e3a\u6574\u6570\uff0c\u56e0\u4e3a\u53ea\u8981<code>result</code>\u58f0\u660e\u4e3a\u6574\u6570\uff0c\u5b83\u7684\u8d4b\u503c\u5c31\u4f1a\u81ea\u52a8\u89e3\u91ca\u4e3a\u6574\u6570\u8fd0\u7b97\u3002</p> <p>\u6ce8\u610f\uff0c\u4e00\u4e2a\u53d8\u91cf\u58f0\u660e\u4e3a\u6574\u6570\u4ee5\u540e\uff0c\u4f9d\u7136\u53ef\u4ee5\u88ab\u6539\u5199\u4e3a\u5b57\u7b26\u4e32\u3002</p> <pre><code>$ declare -i var=12\n$ var=foo\n$ echo $var\n0\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u53d8\u91cf<code>var</code>\u58f0\u660e\u4e3a\u6574\u6570\uff0c\u8986\u76d6\u4ee5\u540e\uff0cBash \u4e0d\u4f1a\u62a5\u9519\uff0c\u4f46\u4f1a\u8d4b\u4ee5\u4e0d\u786e\u5b9a\u7684\u503c\uff0c\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u53ef\u80fd\u8f93\u51fa0\uff0c\u4e5f\u53ef\u80fd\u8f93\u51fa\u7684\u662f3\u3002</p> <p>\uff082\uff09<code>-x</code>\u53c2\u6570</p> <p><code>-x</code>\u53c2\u6570\u7b49\u540c\u4e8e<code>export</code>\u547d\u4ee4\uff0c\u53ef\u4ee5\u8f93\u51fa\u4e00\u4e2a\u53d8\u91cf\u4e3a\u5b50 Shell \u7684\u73af\u5883\u53d8\u91cf\u3002</p> <pre><code>$ declare -x foo\n# \u7b49\u540c\u4e8e\n$ export foo\n</code></pre> <p>\uff083\uff09<code>-r</code>\u53c2\u6570</p> <p><code>-r</code>\u53c2\u6570\u53ef\u4ee5\u58f0\u660e\u53ea\u8bfb\u53d8\u91cf\uff0c\u65e0\u6cd5\u6539\u53d8\u53d8\u91cf\u503c\uff0c\u4e5f\u4e0d\u80fd<code>unset</code>\u53d8\u91cf\u3002</p> <pre><code>$ declare -r bar=1\n\n$ bar=2\nbash: bar\uff1a\u53ea\u8bfb\u53d8\u91cf\n$ echo $?\n1\n\n$ unset bar\nbash: bar\uff1a\u53ea\u8bfb\u53d8\u91cf\n$ echo $?\n1\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u540e\u4e24\u4e2a\u8d4b\u503c\u8bed\u53e5\u90fd\u4f1a\u62a5\u9519\uff0c\u547d\u4ee4\u6267\u884c\u5931\u8d25\u3002</p> <p>\uff084\uff09<code>-u</code>\u53c2\u6570</p> <p><code>-u</code>\u53c2\u6570\u58f0\u660e\u53d8\u91cf\u4e3a\u5927\u5199\u5b57\u6bcd\uff0c\u53ef\u4ee5\u81ea\u52a8\u628a\u53d8\u91cf\u503c\u8f6c\u6210\u5927\u5199\u5b57\u6bcd\u3002</p> <pre><code>$ declare -u foo\n$ foo=upper\n$ echo $foo\nUPPER\n</code></pre> <p>\uff085\uff09<code>-l</code>\u53c2\u6570</p> <p><code>-l</code>\u53c2\u6570\u58f0\u660e\u53d8\u91cf\u4e3a\u5c0f\u5199\u5b57\u6bcd\uff0c\u53ef\u4ee5\u81ea\u52a8\u628a\u53d8\u91cf\u503c\u8f6c\u6210\u5c0f\u5199\u5b57\u6bcd\u3002</p> <pre><code>$ declare -l bar\n$ bar=LOWER\n$ echo $bar\nlower\n</code></pre> <p>\uff086\uff09<code>-p</code>\u53c2\u6570</p> <p><code>-p</code>\u53c2\u6570\u8f93\u51fa\u53d8\u91cf\u4fe1\u606f\u3002</p> <pre><code>$ foo=hello\n$ declare -p foo\ndeclare -- foo=\"hello\"\n$ declare -p bar\nbar\uff1a\u672a\u627e\u5230\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>declare -p</code>\u53ef\u4ee5\u8f93\u51fa\u5df2\u5b9a\u4e49\u53d8\u91cf\u7684\u503c\uff0c\u5bf9\u4e8e\u672a\u5b9a\u4e49\u7684\u53d8\u91cf\uff0c\u4f1a\u63d0\u793a\u627e\u4e0d\u5230\u3002</p> <p>\u5982\u679c\u4e0d\u63d0\u4f9b\u53d8\u91cf\u540d\uff0c<code>declare -p</code>\u8f93\u51fa\u6240\u6709\u53d8\u91cf\u7684\u4fe1\u606f\u3002</p> <pre><code>$ declare -p\n</code></pre> <p>\uff087\uff09<code>-f</code>\u53c2\u6570</p> <p><code>-f</code>\u53c2\u6570\u8f93\u51fa\u5f53\u524d\u73af\u5883\u7684\u6240\u6709\u51fd\u6570\uff0c\u5305\u62ec\u5b83\u7684\u5b9a\u4e49\u3002</p> <pre><code>$ declare -f\n</code></pre> <p>\uff088\uff09<code>-F</code>\u53c2\u6570</p> <p><code>-F</code>\u53c2\u6570\u8f93\u51fa\u5f53\u524d\u73af\u5883\u7684\u6240\u6709\u51fd\u6570\u540d\uff0c\u4e0d\u5305\u542b\u51fd\u6570\u5b9a\u4e49\u3002</p> <pre><code>$ declare -F\n</code></pre>"},{"location":"linux/bash/variable/#readonly","title":"readonly \u547d\u4ee4","text":"<p><code>readonly</code>\u547d\u4ee4\u7b49\u540c\u4e8e<code>declare -r</code>\uff0c\u7528\u6765\u58f0\u660e\u53ea\u8bfb\u53d8\u91cf\uff0c\u4e0d\u80fd\u6539\u53d8\u53d8\u91cf\u503c\uff0c\u4e5f\u4e0d\u80fd<code>unset</code>\u53d8\u91cf\u3002</p> <pre><code>$ readonly foo=1\n$ foo=2\nbash: foo\uff1a\u53ea\u8bfb\u53d8\u91cf\n$ echo $?\n1\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c\u66f4\u6539\u53ea\u8bfb\u53d8\u91cf<code>foo</code>\u4f1a\u62a5\u9519\uff0c\u547d\u4ee4\u6267\u884c\u5931\u8d25\u3002</p> <p><code>readonly</code>\u547d\u4ee4\u6709\u4e09\u4e2a\u53c2\u6570\u3002</p> <ul> <li><code>-f</code>\uff1a\u58f0\u660e\u7684\u53d8\u91cf\u4e3a\u51fd\u6570\u540d\u3002</li> <li><code>-p</code>\uff1a\u6253\u5370\u51fa\u6240\u6709\u7684\u53ea\u8bfb\u53d8\u91cf\u3002</li> <li><code>-a</code>\uff1a\u58f0\u660e\u7684\u53d8\u91cf\u4e3a\u6570\u7ec4\u3002</li> </ul>"},{"location":"linux/bash/variable/#let","title":"let \u547d\u4ee4","text":"<p><code>let</code>\u547d\u4ee4\u58f0\u660e\u53d8\u91cf\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u7b97\u672f\u8868\u8fbe\u5f0f\u3002</p> <pre><code>$ let foo=1+2\n$ echo $foo\n3\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>let</code>\u547d\u4ee4\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97<code>1 + 2</code>\u3002</p> <p><code>let</code>\u547d\u4ee4\u7684\u53c2\u6570\u8868\u8fbe\u5f0f\u5982\u679c\u5305\u542b\u7a7a\u683c\uff0c\u5c31\u9700\u8981\u4f7f\u7528\u5f15\u53f7\u3002</p> <pre><code>$ let \"foo = 1 + 2\"\n</code></pre> <p><code>let</code>\u53ef\u4ee5\u540c\u65f6\u5bf9\u591a\u4e2a\u53d8\u91cf\u8d4b\u503c\uff0c\u8d4b\u503c\u8868\u8fbe\u5f0f\u4e4b\u95f4\u4f7f\u7528\u7a7a\u683c\u5206\u9694\u3002</p> <pre><code>$ let \"v1 = 1\" \"v2 = v1++\"\n$ echo $v1,$v2\n2,1\n</code></pre> <p>\u4e0a\u9762\u4f8b\u5b50\u4e2d\uff0c<code>let</code>\u58f0\u660e\u4e86\u4e24\u4e2a\u53d8\u91cf<code>v1</code>\u548c<code>v2</code>\uff0c\u5176\u4e2d<code>v2</code>\u7b49\u4e8e<code>v1++</code>\uff0c\u8868\u793a\u5148\u8fd4\u56de<code>v1</code>\u7684\u503c\uff0c\u7136\u540e<code>v1</code>\u81ea\u589e\u3002</p> <p>\u8fd9\u79cd\u8bed\u6cd5\u652f\u6301\u7684\u8fd0\u7b97\u7b26\uff0c\u53c2\u8003\u300aBash \u7684\u7b97\u672f\u8fd0\u7b97\u300b\u4e00\u7ae0\u3002</p>"},{"location":"linux/faq/recovery-of-glibc-deleted-by-centos/","title":"CentOS \u8bef\u5220 glibc \u6062\u590d","text":""},{"location":"linux/faq/recovery-of-glibc-deleted-by-centos/#1","title":"1. \u8bef\u5220\u64cd\u4f5c","text":"<pre><code>rpm -e --nodeps glibc\n</code></pre>"},{"location":"linux/faq/recovery-of-glibc-deleted-by-centos/#2","title":"2. \u62a5\u9519\u4fe1\u606f","text":"<p>\u9664 cd\u3001 echo \u547d\u4ee4\uff0c\u5176\u5b83\u547d\u4ee4\u90fd\u63d0\u793a\u627e\u4e0d\u5230 /lib64/ld-linux-x86-64.so.2\u3002</p> <pre><code>-bash: /usr/bin/ls: /lib64/ld-linux-x86-64.so.2: bad ELF interpreter: \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\n</code></pre>"},{"location":"linux/faq/recovery-of-glibc-deleted-by-centos/#3","title":"3. \u89e3\u51b3\u65b9\u6cd5","text":""},{"location":"linux/faq/recovery-of-glibc-deleted-by-centos/#31","title":"3.1 \u6551\u63f4\u6a21\u5f0f","text":"<p>\u5173\u8fdb\uff0c\u6302\u8f7d\u5bf9\u5e94\u7248\u672c\u6216\u9ad8\u7248\u672c\u955c\u50cf\uff0c\u5f00\u673a\u8fdb\u5165\u6551\u63f4\u6a21\u5f0f\u3002</p>"},{"location":"linux/faq/recovery-of-glibc-deleted-by-centos/#32","title":"3.2 \u6302\u8f7d\u955c\u50cf","text":"<p>\u955c\u50cf\u7248\u672c\uff1aCentOS-7-x86_64-Minimal-1708.iso</p> <pre><code>mkdir /media\nmount /dev/sr0 /media\n</code></pre>"},{"location":"linux/faq/recovery-of-glibc-deleted-by-centos/#33-glibc","title":"3.3 \u5b89\u88c5 glibc","text":"<pre><code>rpm -ivh --force -r /mnt/sysimage /media/Packages/glibc-2.17-196.el7.x86_64.rpm\nreboot\n</code></pre> <p>\u91cd\u542f\u540e\u95ee\u9898\u89e3\u51b3\u3002</p>"},{"location":"linux/service/autofs/","title":"Autofs","text":""},{"location":"linux/service/autofs/#autofs","title":"AutoFs \u81ea\u52a8\u6302\u8f7d\u670d\u52a1","text":"<p>Autofs \u4e0e Mount/Umount \u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u5b83\u662f\u4e00\u79cd\u770b\u5b88\u7a0b\u5e8f\u3002</p> <p>\u5982\u679c\u68c0\u6d4b\u5230\u7528\u6237\u6b63\u8bd5\u56fe\u8bbf\u95ee\u4e00\u4e2a\u5c1a\u672a\u6302\u63a5\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b83\u5c31\u4f1a\u81ea\u52a8\u68c0\u6d4b\u8be5\u6587\u4ef6\u7cfb\u7edf\uff0c\u5982\u679c\u5b58\u5728\uff0c\u90a3\u4e48Autofs\u4f1a\u81ea\u52a8\u5c06\u5176\u6302\u8f7d\u3002</p> <p>\u5982\u679c\u5b83\u68c0\u6d4b\u5230\u67d0\u4e2a\u5df2\u6302\u63a5\u7684\u6587\u4ef6\u7cfb\u7edf\u5728\u4e00\u6bb5\u65f6\u95f4\u5185\u6ca1\u6709\u88ab\u4f7f\u7528\uff0c\u90a3\u4e48Autofs\u4f1a\u81ea\u52a8\u5c06\u5176\u5378\u8f7d\u3002</p> <p>\u56e0\u6b64\u4e00\u65e6\u8fd0\u884c\u4e86Autofs\u540e\uff0c\u7528\u6237\u5c31\u4e0d\u518d\u9700\u8981\u624b\u52a8\u5b8c\u6210\u6587\u4ef6\u7cfb\u7edf\u7684\u6302\u8f7d\u548c\u5378\u8f7d\u3002</p>"},{"location":"linux/service/autofs/#_1","title":"\u5b89\u88c5","text":"<pre><code>yum install -y autofs\nsystemctl start autofs\nsystemctl enable autofs\n</code></pre>"},{"location":"linux/service/autofs/#_2","title":"\u914d\u7f6e","text":"<p>\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u5982\u4e0b\uff1a</p> <pre><code>cat /etc/auto.master |grep -Ev '^$|#'\n/misc    /etc/auto.misc\n/net    -hosts\n+dir:/etc/auto.master.d\n+auto.master\n</code></pre> <p>\u5728autofs\u670d\u52a1\u7a0b\u5e8f\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\u4e2d\u9700\u8981\u6309\u7167 <code>\u6302\u8f7d\u76ee\u5f55 \u5b50\u914d\u7f6e\u6587\u4ef6</code> \u7684\u683c\u5f0f\u8fdb\u884c\u586b\u5199\u3002\u6302\u8f7d\u76ee\u5f55\u662f\u8bbe\u5907\u6302\u8f7d\u4f4d\u7f6e\u7684\u4e0a\u4e00\u7ea7\u76ee\u5f55\u3002</p> <p>\u5b50\u914d\u7f6e\u6587\u4ef6\u683c\u5f0f\uff1a<code>\u6302\u8f7d\u70b9 -fstype=\u6587\u4ef6\u7c7b\u578b,\u6743\u9650 \u6302\u8f7d\u76ee\u6807</code>\u3002</p> <ul> <li>\u6302\u8f7d iso</li> </ul> <p>\u4f8b\u5982\uff0c\u5149\u76d8\u8bbe\u5907\u4e00\u822c\u6302\u8f7d\u5230 /media/cdrom \u76ee\u5f55\u4e2d\uff0c\u90a3\u4e48\u6302\u8f7d\u76ee\u5f55\u5199\u6210 /media \u5373\u53ef\u3002\u5bf9\u5e94\u7684\u5b50\u914d\u7f6e\u6587\u4ef6\u5219\u662f\u5bf9\u8fd9\u4e2a\u6302\u8f7d\u76ee\u5f55\u5185\u7684\u6302\u8f7d\u8bbe\u5907\u4fe1\u606f\u4f5c\u8fdb\u4e00\u6b65\u7684\u8bf4\u660e\u3002\u5b50\u914d\u7f6e\u6587\u4ef6\u9700\u8981\u7528\u6237\u81ea\u884c\u5b9a\u4e49\uff0c\u6587\u4ef6\u540d\u5b57\u6ca1\u6709\u4e25\u683c\u8981\u6c42\uff0c\u4f46\u540e\u7f00\u5efa\u8bae\u4ee5.misc\u7ed3\u675f\u3002</p> <pre><code>cat &lt;&lt;EOF&gt;&gt; /etc/auto.master\n/media /etc/auto.master.d/iso.misc\nEOF\n\ncat &lt;&lt;EOF&gt;&gt; /etc/auto.master.d/iso.misc\niso -fstype=iso9660,ro,nosuid,nodev :/dev/cdrom\nEOF\n\nsystemctl restart autofs\n\ndf -h\ncd /media/iso\ndf -h\n</code></pre> <ul> <li>\u6302\u8f7d nfs</li> </ul> <pre><code>cat &lt;&lt;EOF&gt;&gt; /etc/auto.master\n/home /etc/nfs.mics\nEOF\n\ncat &lt;&lt;EOF&gt;&gt; /etc/nfs.misc\nnfs -fstype=nfs 192.168.11.130:/home/nfsfiles\nEOF\n\nsystemctl restart autofs\n</code></pre> <ul> <li>\u6302\u8f7d cifs</li> </ul> <pre><code>cat &lt;&lt;EOF&gt;&gt; /etc/auto.master\n/home /etc/cifs.mics\nEOF\n\ncat &lt;&lt;EOF&gt;&gt; /etc/samba.misc\nsamba -fstype=cifs,credentials=/home/auth.smb ://192.168.11.130/share\nEOF\n\nsystemctl restart autofs\n</code></pre>"},{"location":"linux/service/bind/","title":"Bind","text":""},{"location":"linux/service/bind/#bind","title":"Bind \u57df\u540d\u89e3\u6790\u670d\u52a1","text":""},{"location":"linux/service/bind/#dns","title":"DNS \u57df\u540d\u89e3\u6790\u670d\u52a1","text":"<p>DNS (Domain Name System\uff0c\u57df\u540d\u7cfb\u7edf) \u57df\u540d\u89e3\u6790\u670d\u52a1\uff0c\u7528\u4e8e\u7ba1\u7406\u548c\u89e3\u6790\u57df\u540d\u4e0eIP\u5730\u5740\u5bf9\u5e94\u5173\u7cfb\u7684\u6280\u672f\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u80fd\u591f\u63a5\u53d7\u7528\u6237\u8f93\u5165\u7684\u57df\u540d\u6216IP\u5730\u5740\uff0c\u7136\u540e\u81ea\u52a8\u67e5\u627e\u4e0e\u4e4b\u5339\u914d\uff08\u6216\u8005\u8bf4\u5177\u6709\u6620\u5c04\u5173\u7cfb\uff09\u7684IP\u5730\u5740\u6216\u57df\u540d\uff0c\u5373\u5c06\u57df\u540d\u89e3\u6790\u4e3aIP\u5730\u5740\uff08\u6b63\u5411\u89e3\u6790\uff09\uff0c\u6216\u5c06IP\u5730\u5740\u89e3\u6790\u4e3a\u57df\u540d\uff08\u53cd\u5411\u89e3\u6790\uff09\u3002</p> <p>DNS \u5171\u5206\u4e3a\u4e0b\u9762\u4e09\u79cd\u7c7b\u578b\u7684\u670d\u52a1\u5668\uff1a</p> <ul> <li><code>\u4e3b\u670d\u52a1\u5668</code>: \u5728\u7279\u5b9a\u533a\u57df\u5185\u5177\u6709\u552f\u4e00\u6027\uff0c\u8d1f\u8d23\u7ef4\u62a4\u8be5\u533a\u57df\u5185\u7684\u57df\u540d\u4e0eIP\u5730\u5740\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u3002</li> <li><code>\u4ece\u670d\u52a1\u5668</code>: \u4ece\u4e3b\u670d\u52a1\u5668\u4e2d\u83b7\u5f97\u57df\u540d\u4e0eIP\u5730\u5740\u7684\u5bf9\u5e94\u5173\u7cfb\u5e76\u8fdb\u884c\u7ef4\u62a4\uff0c\u4ee5\u9632\u4e3b\u670d\u52a1\u5668\u5b95\u673a\u7b49\u60c5\u51b5\u3002</li> <li><code>\u7f13\u5b58\u670d\u52a1\u5668</code>: \u901a\u8fc7\u5411\u5176\u4ed6\u57df\u540d\u89e3\u6790\u670d\u52a1\u5668\u67e5\u8be2\u83b7\u5f97\u57df\u540d\u4e0eIP\u5730\u5740\u7684\u5bf9\u5e94\u5173\u7cfb\uff0c\u5e76\u5c06\u7ecf\u5e38\u67e5\u8be2\u7684\u57df\u540d\u4fe1\u606f\u4fdd\u5b58\u5230\u670d\u52a1\u5668\u672c\u5730\uff0c\u4ee5\u6b64\u6765\u63d0\u9ad8\u91cd\u590d\u67e5\u8be2\u65f6\u7684\u6548</li> <li><code>\u8f6c\u53d1\u670d\u52a1\u5668</code></li> </ul> <p>DNS\u57df\u540d\u89e3\u6790\u670d\u52a1\u91c7\u7528\u5206\u5e03\u5f0f\u7684\u6570\u636e\u7ed3\u6784\u6765\u5b58\u653e\u6d77\u91cf\u7684\u201c\u533a\u57df\u6570\u636e\u201d\u4fe1\u606f\uff0c\u5728\u6267\u884c\u7528\u6237\u53d1\u8d77\u7684\u57df\u540d\u67e5\u8be2\u8bf7\u6c42\u65f6\uff0c\u5177\u6709\u9012\u5f52\u67e5\u8be2\u548c\u8fed\u4ee3\u67e5\u8be2\u4e24\u79cd\u65b9\u5f0f</p> <ul> <li><code>\u9012\u5f52\u67e5\u8be2</code>: DNS\u670d\u52a1\u5668\u5728\u6536\u5230\u7528\u6237\u53d1\u8d77\u7684\u8bf7\u6c42\u65f6\uff0c\u5fc5\u987b\u5411\u7528\u6237\u8fd4\u56de\u4e00\u4e2a\u51c6\u786e\u7684\u67e5\u8be2\u7ed3\u679c\u3002\u5982\u679cDNS\u670d\u52a1\u5668\u672c\u5730\u6ca1\u6709\u5b58\u50a8\u4e0e\u4e4b\u5bf9\u5e94\u7684\u4fe1\u606f\uff0c\u5219\u8be5\u670d\u52a1\u5668\u9700\u8981\u8be2\u95ee\u5176\u4ed6\u670d\u52a1\u5668\uff0c\u5e76\u5c06\u8fd4\u56de\u7684\u67e5\u8be2\u7ed3\u679c\u63d0\u4ea4\u7ed9\u7528\u6237\u3002</li> <li><code>\u8fed\u4ee3\u67e5\u8be2</code>: DNS\u670d\u52a1\u5668\u5728\u6536\u5230\u7528\u6237\u53d1\u8d77\u7684\u8bf7\u6c42\u65f6\uff0c\u5e76\u4e0d\u76f4\u63a5\u56de\u590d\u67e5\u8be2\u7ed3\u679c\uff0c\u800c\u662f\u544a\u8bc9\u53e6\u4e00\u53f0DNS\u670d\u52a1\u5668\u7684\u5730\u5740\uff0c\u7528\u6237\u518d\u5411\u8fd9\u53f0DNS\u670d\u52a1\u5668\u63d0\u4ea4\u8bf7\u6c42\uff0c\u8fd9\u6837\u4f9d\u6b21\u53cd\u590d\uff0c\u76f4\u5230\u8fd4\u56de\u67e5\u8be2\u7ed3\u679c\u3002</li> </ul> <p>DNS \u57df\u540d\u89e3\u6790\u8fc7\u7a0b\uff0c\u4f8b\u5982\u5728\u8bbf\u95ee\u7f51\u7ad9\uff1awww.linuxprobe.com \u65f6\uff0c\u5176\u5927\u81f4\u67e5\u8be2\u6d41\u7a0b\u5982\u4e0b\u56fe\uff1a</p> <p></p>"},{"location":"linux/service/bind/#bind_1","title":"\u5b89\u88c5 Bind \u670d\u52a1","text":"<p>BIND\uff08Berkeley Internet Name Domain\uff0c\u4f2f\u514b\u5229\u56e0\u7279\u7f51\u540d\u79f0\u57df\uff09\uff0c\u4f7f\u7528\u6700\u5e7f\u6cdb\u7684 DNS \u670d\u52a1\u5668\u8f6f\u4ef6\uff0c\u6700\u65e9\u7531\u4f2f\u514b\u5229\u5927\u5b66\u7684\u4e00\u540d\u5b66\u751f\u7f16\u5199\u3002</p> <pre><code>yum install -y bind-chroot bind-utils\nfirewall-cmd --add-service=dhcp --add-service=dhcpv6\nfirewall-cmd --reload\n</code></pre> <p>\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u5b89\u88c5\u90e8\u7f72bind\u670d\u52a1\u7a0b\u5e8f\u65f6\u52a0\u4e0achroot\uff08\u4fd7\u79f0\u7262\u7b3c\u673a\u5236\uff09\u6269\u5c55\u5305\uff0c\u4ee5\u4fbf\u6709\u6548\u5730\u9650\u5236bind\u670d\u52a1\u7a0b\u5e8f\u4ec5\u80fd\u5bf9\u81ea\u8eab\u7684\u914d\u7f6e\u6587\u4ef6\u8fdb\u884c\u64cd\u4f5c\uff0c\u4ee5\u786e\u4fdd\u6574\u4e2a\u670d\u52a1\u5668\u7684\u5b89\u5168\u3002</p>"},{"location":"linux/service/bind/#bind_2","title":"Bind \u670d\u52a1\u76f8\u5173\u6587\u4ef6","text":"<ul> <li>\u4e3b\u914d\u7f6e\u6587\u4ef6: <code>/etc/named.conf</code></li> <li>\u533a\u57df\u914d\u7f6e\u6587\u4ef6: <code>/etc/named.rfc1912.zones</code> \u5b9a\u4e49\u4e86\u57df\u540d\u4e0e IP \u5730\u5740\u89e3\u6790\u89c4\u5219\u4fdd\u5b58\u7684\u6587\u4ef6\u4f4d\u7f6e\u4ee5\u53ca\u670d\u52a1\u7c7b\u578b\u3002</li> <li>\u6570\u636e\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55: <code>/var/named</code> \u7528\u6765\u4fdd\u5b58\u57df\u540d\u548c ip \u5730\u5740\u771f\u662f\u5bf9\u5e94\u5173\u7cfb\u7684\u6570\u636e\u914d\u7f6e\u6587\u4ef6\u3002</li> <li>\u65e5\u5fd7: <code>/var/log/named.log</code></li> <li>rdnc\u914d\u7f6e\u6587\u4ef6: <code>/etc/rndc.conf</code></li> <li>rdnc\u79d8\u94a5\u6587\u4ef6: <code>/etc/rndc.key</code> \u7528\u6765\u8fdc\u7a0b\u63a7\u5236DNS\u670d\u52a1\u7684\u5bc6\u94a5\u6587\u4ef6</li> </ul>"},{"location":"linux/service/bind/#_1","title":"\u4e3b\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>cat /etc/named.conf\noptions {\n    listen-on port 53 { 127.0.0.1; };\n    # IPv4 \u5730\u5740\u76d1\u542c\u7aef\u53e3\u53ca\u76d1\u542c\u7684\u4e3b\u673a\u5217\u8868\n    listen-on-v6 port 53 { ::1; };\n    # IPv6 \u5730\u5740\u76d1\u542c\u7aef\u53e3\u53ca\u76d1\u542c\u7684\u4e3b\u673a\u5217\u8868\n    directory     \"/var/named\";\n    # \u670d\u52a1\u5668\u7684\u5de5\u4f5c\u76ee\u5f55\n    dump-file     \"/var/named/data/cache_dump.db\";\n    # \u5f53\u6267\u884c rndc dumpdb \u65f6\u670d\u52a1\u5668 dump\u6587\u4ef6\u7684\u8def\u5f84\n    statistics-file \"/var/named/data/named_stats.txt\";\n    # \u6267\u884c rndc stats\u5c06\u670d\u52a1\u5668\u7684\u7edf\u8ba1\u4fe1\u606f\u5199\u5165\u6587\u4ef6,\u9ed8\u8ba4\u4e3anamed.stats\n    memstatistics-file \"/var/named/data/named_mem_stats.txt\";\n    # \u9ed8\u8ba4\u4e3a named.memestats,\u5f53\u9000\u51fa\u7684\u670d\u52a1\u7684\u65f6\u5019\u5c06\u670d\u52a1\u5668\u7684\u7edf\u8ba1\u4fe1\u606f\u5199\u5230\u6587\u4ef6\u4e2d\n    masterfile-format text;\n    # \u540c\u6b65\u7684\u6587\u4ef6\u683c\u5f0f\uff0c\u9632\u6b62\u4e71\u7801\n    recursing-file  \"/var/named/data/named.recursing\";\n    secroots-file   \"/var/named/data/named.secroots\";\n    allow-query     { localhost; };\n    # \u5141\u8bb8\u5411\u6211\u67e5\u8be2\u7684\u4e3b\u673a\u5217\u8868\uff0c\u8868\u793a\u53ef\u4ee5\u5bf9\u4e3b\u673a\u5217\u8868\u91cc\u7684\u4e3b\u673a\u63d0\u4f9b\u670d\u52a1\n    allow-transfer { any\uff1b};\n    # \u6307\u5b9a\u54ea\u4e9b\u4e3b\u673a\u53ef\u4ee5\u4ece\u670d\u52a1\u5668\u4e0a\u63a5\u6536\u533a\u57df\u4f20\u8f93,\u672a\u6307\u5b9a\u5c06\u5141\u8bb8\u4f20\u8f93\u5230\u6240\u6709\u7684\u4e3b\u673a\n    # \u9ed8\u8ba4 any\uff0c\u6781\u5176\u4e0d\u5b89\u5168\uff0c\u901a\u5e38\u4fee\u6539\u4e3a\u6307\u5b9a\u4e3b\u673a\u6216 none\n\n    recursion yes;\n    # \u662f\u5426\u5f00\u542f\u9012\u5f52\u67e5\u8be2\u8bf7\u6c42\uff0c\u8bbe\u7f6e\u4e3a no \u7684\u8bdd\uff0c\u4e0d\u53bb\u5bfb\u6839\n    forwarders { 114.114.114.114; 8.8.8.8; };\n    #\u5f00\u542f\u8f6c\u53d1\uff0c\u542f\u7528 forwarders \u67e5\u8be2\u4f1a\u51cf\u5c11\u672c\u5730\u6d41\u91cf\u7684\u6d6a\u8d39\uff0c\u76f4\u63a5\u4ece\u8f6c\u53d1\u7684\u670d\u52a1\u5668\u4e0a\u67e5\u8be2\u7684\u7ed3\u679c\u8fd4\u56de\uff1b\n\n    dnssec-enable yes;\n    # dns \u5b89\u5168\u7b56\u7565\uff0c\u5efa\u8bae\u5173\u95ed\n    dnssec-validation yes;\n    # dns \u5b89\u5168\u7b56\u7565\uff0c\u5efa\u8bae\u5173\u95ed\n\n    bindkeys-file \"/etc/named.iscdlv.key\";\n    managed-keys-directory \"/var/named/dynamic\";\n    pid-file \"/run/named/named.pid\";\n    session-keyfile \"/run/named/session.key\";\n};\nlogging {\n        channel default_debug {\n                file \"data/named.run\";\n                severity dynamic;\n        };\n};\nzone \".\" IN {\n    type hint;\n    file \"named.ca\";\n};\ninclude \"/etc/named.rfc1912.zones\";\ninclude \"/etc/named.root.key\";\n</code></pre>"},{"location":"linux/service/bind/#_2","title":"\u533a\u57df\u914d\u7f6e\u6587\u4ef6","text":"<p>\u5b9a\u4e49\u4e86\u57df\u540d\u4e0eIP\u5730\u5740\u89e3\u6790\u89c4\u5219\u4fdd\u5b58\u7684\u6587\u4ef6\u4f4d\u7f6e\u4ee5\u53ca\u670d\u52a1\u7c7b\u578b\u7b49\u5185\u5bb9\u3002</p> <p>\u670d\u52a1\u7c7b\u578b\u6709\u4e09\u79cd\uff1a</p> <ul> <li><code>hint</code>: \u6839\u533a\u57df</li> <li><code>master</code>: \u4e3b\u533a\u57df</li> <li><code>slave</code>: \u8f85\u52a9\u533a\u57df</li> </ul> <pre><code>cat /etc/named.rfc1912.zones\nzone \"localhost.localdomain\" IN {\n    # \u6b63\u5411\u89e3\u6790\n    type master;\n    # \u670d\u52a1\u7c7b\u578b\n    file \"named.localhost\";\n    # \u57df\u540d\u4e0e ip \u5730\u5740\u89e3\u6790\u89c4\u5219\u4fdd\u5b58\u7684\u6587\u4ef6\u4f4d\u7f6e\n    allow-update { none; };\n    # \u5141\u8bb8\u54ea\u4e9b\u5ba2\u6237\u52a8\u6001\u66f4\u65b0\u89e3\u6790\u4fe1\u606f\n};\n\nzone \"localhost\" IN {\n    type master;\n    file \"named.localhost\";\n    allow-update { none; };\n};\n\nzone \"1.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.0.ip6.arpa\" IN {\n    type master;\n    file \"named.loopback\";\n    allow-update { none; };\n};\n\nzone \"1.0.0.127.in-addr.arpa\" IN {\n    # \u53cd\u5411\u89e3\u6790\n    type master;\n    file \"named.loopback\";\n    allow-update { none; };\n};\n\nzone \"0.in-addr.arpa\" IN {\n    type master;\n    file \"named.empty\";\n    allow-update { none; };\n};\n</code></pre>"},{"location":"linux/service/bind/#_3","title":"\u6570\u636e\u914d\u7f6e\u6587\u4ef6","text":"<ul> <li>\u6b63\u5411\u89e3\u6790</li> </ul> <pre><code>$TTL 1D #\u751f\u5b58\u5468\u671f\u4e3a1\u5929        \n@       IN SOA      linuxprobe.com.         root.linuxprobe.com.    (   \n        #\u6388\u6743\u4fe1\u606f\u5f00\u59cb #DNS\u533a\u57df\u7684\u5730\u5740            #\u57df\u540d\u7ba1\u7406\u5458\u7684\u90ae\u7bb1(\u4e0d\u8981\u7528@\u7b26\u53f7)  \n                                                                        0;serial    #\u66f4\u65b0\u5e8f\u5217\u53f7\n                                                                        1D;refresh  #\u66f4\u65b0\u65f6\u95f4\n                                                                        1H;retry    #\u91cd\u8bd5\u5ef6\u65f6\n                                                                        1W;expire   #\u5931\u6548\u65f6\u95f4\n                                                                        3H;)minimum #\u65e0\u6548\u89e3\u6790\u8bb0\u5f55\u7684\u7f13\u5b58\u65f6\u95f4\n        NS          ns.linuxprobe.com.      #\u57df\u540d\u670d\u52a1\u5668\u8bb0\u5f55\nns      IN A        192.168.10.10           #\u5730\u5740\u8bb0\u5f55(ns.linuxprobe.com.)\n        IN MX 10    mail.linuxprobe.com.    #\u90ae\u7bb1\u4ea4\u6362\u8bb0\u5f55\nmail    IN A        192.168.10.10           #\u5730\u5740\u8bb0\u5f55(mail.linuxprobe.com.)\nwww     IN A        192.168.10.10           #\u5730\u5740\u8bb0\u5f55(www.linuxprobe.com.)\nbbs     IN A        192.168.10.20           #\u5730\u5740\u8bb0\u5f55(bbs.linuxprobe.com.)\n</code></pre> <p>\u7b2c\u516d\u5217\u4f7f\u7528\u62ec\u53f7\u5c06\u51e0\u4e2a\u503c\u5305\u56f4\u8d77\u6765\u3002</p> <p><code>0;serial</code>: \u533a\u57df\u6570\u636e\u6587\u4ef6\u7684\u5e8f\u5217\u7f16\u53f7 serial\uff0c\u6bcf\u6b21\u4fee\u6539\u6b64\u533a\u57df\u6570\u636e\u6587\u4ef6\u90fd\u9700\u8981\u4fee\u6539\u8be5\u7f16\u53f7\u503c\u4ee5\u4fbf\u8ba9 slave dns \u670d\u52a1\u5668\u540c\u6b65\u8be5\u533a\u57df\u6570\u636e\u6587\u4ef6\u3002</p> <p><code>1D;refresh</code>: \u5237\u65b0 refresh \u65f6\u95f4\u95f4\u9694\uff0c\u8868\u793a slave dns \u670d\u52a1\u5668\u627e master dns \u670d\u52a1\u5668\u66f4\u65b0\u533a\u57df\u6570\u636e\u6587\u4ef6\u7684\u65f6\u95f4\u95f4\u9694\u3002</p> <p><code>1H;retry</code>: \u7b2c\u4e09\u4e2a\u503c\u662f\u91cd\u8bd5 retry \u65f6\u95f4\u95f4\u9694\uff0c\u8868\u793a slave dns \u670d\u52a1\u5668\u627e master dns \u670d\u52a1\u5668\u66f4\u65b0\u533a\u57df\u6570\u636e\u6587\u4ef6\u65f6\uff0c\u5982\u679c\u8054\u7cfb\u4e0d\u4e0amaster\uff0c\u5219\u7b49\u5f85\u591a\u4e45\u518d\u91cd\u8bd5\u8054\u7cfb\uff0c\u8be5\u503c\u4e00\u822c\u6bd4 refresh \u65f6\u95f4\u77ed\uff0c\u5426\u5219\u8be5\u503c\u8868\u793a\u7684\u91cd\u8bd5\u5c31\u5931\u53bb\u4e86\u610f\u4e49\u3002</p> <p><code>1W;expire</code>: \u8fc7\u671f expire \u65f6\u95f4\u503c\uff0c\u8868\u793a slave dns \u670d\u52a1\u5668\u4e0a\u7684\u533a\u57df\u6570\u636e\u6587\u4ef6\u591a\u4e45\u8fc7\u671f\u3002</p> <p><code>3H;minimum</code>: negative ttl\uff0c\u8868\u793a\u5ba2\u6237\u7aef\u627e dns \u670d\u52a1\u5668\u89e3\u6790\u65f6\uff0c\u5426\u5b9a\u7b54\u6848\u7684\u7f13\u5b58\u65f6\u95f4\u957f\u5ea6\u3002</p> <p>\u8fd9\u51e0\u4e2a\u503c\u53ef\u4ee5\u5206\u884c\u5199\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5199\u5728\u540c\u4e00\u884c\u4e2d\u4f7f\u7528\u7a7a\u683c\u5206\u5f00\uff0c<code>(0 1D 1H 1W 3H);</code>\u3002</p> <ul> <li>\u53cd\u5411\u89e3\u6790</li> </ul> <pre><code>$TTL 1D\n@   IN SOA  linuxprobe.com.     root.linuxprobe.com. (\n                                                            0       ; serial\n                                                            1D      ; refresh\n                                                            1H      ; retry\n                                                            1W      ; expire\n                                                            3H )    ; minimum\n    NS      ns.linuxprobe.com.\nns  A       192.168.10.10\n10  PTR     ns.linuxprobe.com.      # PTR\u4e3a\u6307\u9488\u8bb0\u5f55\uff0c\u4ec5\u7528\u4e8e\u53cd\u5411\u89e3\u6790\u4e2d\u3002\n10  PTR     mail.linuxprobe.com.\n10  PTR     www.linuxprobe.com.     # ip \u4e3b\u673a\u4f4d\u5bf9\u5e94\u57df\u540d\n20  PTR     bbs.linuxprobe.com.\n</code></pre>"},{"location":"linux/service/bind/#acl","title":"ACL","text":"<p>\u628a\u4e00\u4e2a\u6216\u591a\u4e2a\u5730\u5740\u5f52\u5e76\u4e3a\u4e00\u4e2a\u96c6\u5408\uff0c\u5e76\u901a\u8fc7\u4e00\u4e2a\u7edf\u4e00\u7684\u540d\u79f0\u8c03\u7528</p> <p>\u56db\u4e2a\u5185\u7f6e ACL:</p> <ul> <li><code>none</code>: \u6ca1\u6709\u4e00\u4e2a\u4e3b\u673a</li> <li><code>any</code>: \u4efb\u610f\u4e3b\u673a</li> <li><code>localhost</code>: \u672c\u673a</li> <li><code>localnet</code>: \u672c\u673a\u7684IP\u540c\u63a9\u7801\u8fd0\u7b97\u540e\u5f97\u5230\u7684\u7f51\u7edc\u5730\u5740\uff0c\u5373\u672c\u673a ip \u6240\u5728\u7684\u7f51\u6bb5</li> </ul> <p>\u6ce8\u610f\uff1a\u53ea\u80fd\u5148\u5b9a\u4e49\uff0c\u540e\u4f7f\u7528\uff1b\u56e0\u6b64\u4e00\u822c\u5b9a\u4e49\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u5904\u4e8eoptions\u7684\u524d\u9762</p> <p>\u8bbf\u95ee\u63a7\u5236\u7684\u6307\u4ee4\uff1a</p> <ul> <li><code>allow-query {}</code>: \u5141\u8bb8\u67e5\u8be2\u7684\u4e3b\u673a\uff1b\u767d\u540d\u5355</li> <li><code>allow-transfer {}</code>: \u5141\u8bb8\u533a\u57df\u4f20\u9001\u7684\u4e3b\u673a\uff1b\u767d\u540d\u5355</li> <li><code>allow-recursion {}</code>: \u5141\u8bb8\u9012\u5f52\u7684\u4e3b\u673a,\u5efa\u8bae\u5168\u5c40\u4f7f\u7528</li> <li><code>allow-update {}</code>: \u5141\u8bb8\u66f4\u65b0\u533a\u57df\u6570\u636e\u5e93\u4e2d\u7684\u5185\u5bb9</li> </ul>"},{"location":"linux/service/bind/#_4","title":"\u6b63\u5411\u89e3\u6790","text":"<ol> <li>\u4fee\u6539\u4e3b\u914d\u7f6e\u6587\u4ef6</li> </ol> <p>\u5141\u8bb8\u6240\u6709\u4eba\u5bf9\u672c\u670d\u52a1\u5668\u53d1\u9001DNS\u67e5\u8be2\u8bf7\u6c42\u3002</p> <pre><code>sed -i -e 's,localhost,any,g' -e 's,127.0.0.1,any,g' /etc/named.conf\n</code></pre> <ol> <li>\u7f16\u8f91\u533a\u57df\u6587\u4ef6</li> </ol> <p>\u6dfb\u52a0 linuxprobe.com \u57df\u540d\u89e3\u6790\u4fe1\u606f\u3002</p> <pre><code>cat &lt;&lt;EOF&gt; /etc/named.rfc1912.zones\nzone \"linuxprobe.com\" IN {\n    type master;\n    file \"linuxprobe.com.zone\";\n    allow-update { none; };\n};\nEOF\n</code></pre> <ol> <li>\u7f16\u8f91\u6570\u636e\u914d\u7f6e\u6587\u4ef6</li> </ol> <pre><code>cat &lt;&lt;EOF&gt; /var/named/linuxprobe.com.zone\n\\$TTL 1D\n@       IN SOA     linuxprobe.com.      root.linuxprobe.com.    (\n                                                                    0   ; serial\n                                                                    1D  ; refresh\n                                                                    1H  ; retry\n                                                                    1W  ; expire\n                                                                    3H )    ; minimum\n        NS         ns.linuxprobe.com.\nns      IN A       192.168.10.10\n        IN MX 10   mail.linuxprobe.com.\nmail    IN A       192.168.10.10\nwww     IN A       192.168.10.10\nbbs     IN A       192.168.10.20\nEOF\ncat /var/named/linuxprobe.com.zone\n\nnmcli con show\nnmcli con mod ens32 ipv4.dns \"192.168.10.10\"\nnmcli con up ens32\n\nsystemctl restart named\nsystemctl enable named\n\nnslookup www.linuxprobe.com\n</code></pre> <p>\u8003\u8651\u8303\u56f4\uff1a\u5e94\u7531\u672c\u673a\u63d0\u4f9b DNS \u67e5\u8be2\u670d\u52a1</p> <p><code>nslookup</code>: \u7528\u4e8e\u68c0\u6d4b\u80fd\u5426\u4ece DNS \u670d\u52a1\u5668\u4e2d\u67e5\u8be2\u5230\u57df\u540d\u4e0eIP\u5730\u5740\u7684\u89e3\u6790\u8bb0\u5f55\u3002</p>"},{"location":"linux/service/bind/#_5","title":"\u53cd\u5411\u89e3\u6790","text":"<p>\u5728 DNS \u57df\u540d\u89e3\u6790\u670d\u52a1\u4e2d\uff0c\u53cd\u5411\u89e3\u6790\u7684\u4f5c\u7528\u662f\u5c06\u7528\u6237\u63d0\u4ea4\u7684 IP \u5730\u5740\u89e3\u6790\u4e3a\u5bf9\u5e94\u7684\u57df\u540d\u4fe1\u606f\uff0c\u5b83\u4e00\u822c\u7528\u4e8e\u5bf9\u67d0\u4e2a IP \u5730\u5740\u4e0a\u7ed1\u5b9a\u7684\u6240\u6709\u57df\u540d\u8fdb\u884c\u6574\u4f53\u5c4f\u853d\uff0c\u5c4f\u853d\u7531\u67d0\u4e9b\u57df\u540d\u53d1\u9001\u7684\u5783\u573e\u90ae\u4ef6\u3002\u4e5f\u53ef\u4ee5\u9488\u5bf9\u67d0\u4e2a IP \u5730\u5740\u8fdb\u884c\u53cd\u5411\u89e3\u6790\uff0c\u5927\u81f4\u5224\u65ad\u51fa\u6709\u591a\u5c11\u4e2a\u7f51\u7ad9\u8fd0\u884c\u5728\u4e0a\u9762\u3002</p> <ol> <li>\u533a\u57df\u6587\u4ef6</li> </ol> <pre><code>cat &lt;&lt;EOF&gt;&gt; /etc/named.rfc1912.zones\nzone \"10.168.192.in-addr.arpa\" IN {\n    type master;\n    file \"192.168.10.arpa\";\n};\nEOF\n</code></pre> <ol> <li>\u6570\u636e\u914d\u7f6e\u6587\u4ef6</li> </ol> <pre><code>cat &lt;&lt;EOF&gt; /var/named/192.168.10.arpa\n\\$TTL 1D\n@   IN SOA  linuxprobe.com.     root@linuxprobe.com. (\n                                                    0   ; serial\n                                                    1D  ; refresh\n                                                    1H  ; retry\n                                                    1W  ; expire\n                                                    3H) ; minimum\n    NS      ns.linuxprobe.com.\nns  A       192.168.10.10\n10  PTR     ns.linuxprobe.com.\n10  PTR     mail.linuxprobe.com.\n10  PTR     www.linuxprobe.com.\n20  PTR     bbs.linuxprobe.com.\nEOF\n\nsystemctl restart named\n\nnslookup 192.168.10.10 127.0.0.1\n</code></pre>"},{"location":"linux/service/bind/#_6","title":"\u4ece\u670d\u52a1\u5668","text":"\u4e3b\u673a\u540d\u79f0 IP\u5730\u5740 \u4e3b\u670d\u52a1\u5668 192.168.10.10 \u4ece\u670d\u52a1\u5668 192.168.10.20 <ol> <li>\u4e3b\u670d\u52a1\u5668\u7684\u533a\u57df\u914d\u7f6e</li> </ol> <p>\u5e94\u5141\u8bb8\u4ece\u670d\u52a1\u5668\u7684\u66f4\u65b0\u8bf7\u6c42\u3002</p> <pre><code>cat &lt;&lt;EOF&gt; /etc/named.rfc1912.zones\nzone \"linuxprobe.com\" IN {\n    type master;\n    file \"linuxprobe.com.zone\";\n    masterfile-format text;\n    # \u540c\u6b65\u7684\u6587\u4ef6\u683c\u5f0f\uff0c\u4e0d\u7136\u4f1a\u4e71\u7801\n    allow-update { 192.168.10.20; };\n};\nzone \"10.168.192.in-addr.arpa\" IN {\n    type master;\n    file \"192.168.10.arpa\";\n    masterfile-format text;\n    allow-update { 192.168.10.20; };\n};\nEOF\n\nsystemctl restart named\n</code></pre> <ol> <li>\u4ece\u670d\u52a1\u5668\u4e3b\u914d\u7f6e</li> </ol> <pre><code>sed -i 's,127.0.0.1,localhost,' /etc/named.conf\n</code></pre> <p>127.0.0.1 \u662f ipv4 \u5730\u5740\uff1blocalhost \u662f\u57df\u540d\uff0c\u540c\u65f6\u8fd8\u6307\u5411 ipv6 \u7684 <code>::1</code>\uff1b</p> <ol> <li>\u4ece\u670d\u52a1\u5668\u7684\u533a\u57df\u914d\u7f6e</li> </ol> <p>\u670d\u52a1\u7c7b\u578b\u5e94\u662f <code>slave</code>\uff1b\u914d\u7f6e\u4e3b\u670d\u52a1\u5668\u7684 <code>IP\u5730\u5740</code>\u3001\u8981\u6293\u53d6\u7684<code>\u533a\u57df\u4fe1\u606f</code>\u4ee5\u53ca<code>\u5b58\u653e\u4f4d\u7f6e</code>\u3002</p> <pre><code>cat &lt;&lt;EOF&gt; /etc/named.rfc1912.zones\nzone \"linuxprobe.com\" IN {\n    type slave;\n    masters { 192.168.10.10; };\n    masterfile-format text;\n    file \"slaves/linuxprobe.com.zone\";\n};\nzone \"10.168.192.in-addr.arpa\" IN {\n    type slave;\n    masters { 192.168.10.10; };\n    masterfile-format text;\n    file \"slaves/192.168.10.arpa\";\n};\nEOF\n\nnmcli con show\nnmcli con mod ens32 ipv4.dns \"192.168.10.20\"\nnmcli con up ens32\n\nsystemctl restart named\n\nnslookup www.linuxprobe.com\nnslookup 192.168.10.10\n</code></pre>"},{"location":"linux/service/bind/#_7","title":"\u52a0\u5bc6\u4f20\u8f93","text":"<p>\u52a0\u5bc6\u65b9\u5f0f\uff1a</p> <ul> <li><code>DES</code> (\u5bf9\u79f0\u52a0\u5bc6): \u6587\u4ef6\u52a0\u5bc6\u548c\u89e3\u5bc6\u4f7f\u7528\u76f8\u540c\u7684\u5bc6\u94a5\uff0c\u7b80\u5355\u5feb\u6377\u3002</li> <li> <p>\u5047\u5b9a\u6709\u53d1\u9001\u65b9 A \u548c\u63a5\u6536\u65b9 B\uff0cA \u548c B \u6709\u76f8\u540c\u7684\u5bc6\u94a5\uff0cA \u53d1\u9001\u660e\u6587\u7ed9 B \u4e4b\u524d\uff0c\u901a\u8fc7\u5bc6\u94a5\u548c\u52a0\u5bc6\u7b97\u6cd5\uff0c\u5c06\u660e\u6587\u52a0\u5bc6\u6210\u5bc6\u6587\uff0c\u53d1\u9001\u7ed9 B\uff0cB \u518d\u901a\u8fc7\u5bc6\u94a5\u548c\u89e3\u5bc6\u7b97\u6cd5\uff0c\u5c06\u5bc6\u6587\u89e3\u5bc6\u6210\u660e\u6587\u3002</p> </li> <li> <p><code>IDEA</code> (\u975e\u5bf9\u79f0\u52a0\u5bc6): \u5bc6\u94a5\u5305\u62ec\u516c\u94a5\u548c\u79c1\u94a5\uff0c\u5b89\u5168\u6027\u8f83 DES \u65b9\u5f0f\u9ad8\u3002</p> </li> <li>\u5047\u5b9a\u6709\u53d1\u9001\u65b9 A \u548c\u63a5\u6536\u65b9 B\uff0cB \u6709\u81ea\u5df1\u7684\u79c1\u94a5\u548c\u516c\u94a5\uff0cA \u9700\u8981\u83b7\u53d6 B \u7684\u516c\u94a5\uff0c\u83b7\u53d6\u4e4b\u540e\uff0cA \u9996\u5148\u81ea\u5df1\u751f\u6210\u4e00\u4e2a\u4f1a\u8bdd\u5bc6\u94a5\uff0c\u7136\u540e\u8fd9\u4e2a\u4f1a\u8bdd\u5bc6\u94a5\u901a\u8fc7 B \u7684\u516c\u94a5\u8fdb\u884c\u52a0\u5bc6\uff0c\u52a0\u5bc6\u540e\u53d1\u9001\u7ed9 B\uff0cB \u518d\u901a\u8fc7\u81ea\u5df1\u7684\u79c1\u94a5\u5bf9\u5b83\u8fdb\u884c\u89e3\u5bc6\uff0c\u4ece\u800c\u5f97\u5230 A \u751f\u6210\u7684\u4f1a\u8bdd\u5bc6\u94a5\u3002\u4e4b\u540e\uff0cA \u901a\u8fc7\u81ea\u5df1\u7684\u4f1a\u8bdd\u5bc6\u94a5\u5c06\u8981\u53d1\u9001\u7684\u660e\u6587\u8fdb\u884c\u52a0\u5bc6\uff0c\u53d1\u9001\u7ed9 B\uff0cB \u901a\u8fc7\u4e8b\u5148\u5f97\u5230\u7684\u4f1a\u8bdd\u5bc6\u94a5\u5bf9\u53d1\u9001\u8fc7\u6765\u7684\u5bc6\u6587\u8fdb\u884c\u89e3\u5bc6\u4ece\u800c\u5f97\u5230\u660e\u6587\u3002</li> </ul> <p>DNS\u4e8b\u52a1\u7b7e\u540d:</p> <p>\u4e8b\u52a1\u7b7e\u540d\u53ef\u4ee5\u901a\u8fc7\u4e24\u79cd\u52a0\u5bc6\u65b9\u5f0f\u6765\u5b9e\u73b0\uff0c\u5206\u522b\u662f\uff1a</p> <ul> <li><code>TSIG</code>: \u5bf9\u79f0\u65b9\u5f0f</li> <li><code>SIGO</code>: \u975e\u5bf9\u79f0\u65b9\u5f0f</li> </ul> <p>\u73b0\u5728\u6bd4\u8f83\u5e38\u7528\u7684\u662f TSIG \u8fd9\u79cd\u65b9\u6cd5\u3002</p>"},{"location":"linux/service/bind/#_8","title":"\u4e3b\u4ece\u670d\u52a1\u4e4b\u95f4\u52a0\u5bc6\u4f20\u8f93","text":"<ol> <li>\u4e3b\u670d\u52a1\u5668\u751f\u6210\u79d8\u94a5\u3002</li> </ol> <pre><code>dnssec-keygen -a HMAC-MD5 -b 128 -n HOST master-slave\nls -l\n-rw-------. 1 root root   56 7\u6708   1 13:17 Kmaster-slave.+157+64465.key\n-rw-------. 1 root root  165 7\u6708   1 13:17 Kmaster-slave.+157+64465.private\ncat Kmaster-slave.+157+64465.key\nmaster-slave. IN KEY 512 3 157 O4KHJyU/PDS/TsEqMSogdA==\n</code></pre> <p><code>dnssec-keygen</code>: \u7528\u4e8e\u751f\u6210\u5b89\u5168\u7684DNS\u670d\u52a1\u5bc6\u94a5\uff1b</p> <p><code>-a</code> : \u52a0\u5bc6\u7b97\u6cd5;</p> <p><code>-b</code> : \u52a0\u5bc6\u4f4d\u6570;</p> <p><code>-n</code> : \u53ef\u4ee5\u9009\u62e9ZONE\u6216\u8005HOST;</p> <p><code>master-slave</code>: \u5bc6\u94a5\u540d\u79f0;</p> <ol> <li>\u5728\u4e3b\u670d\u52a1\u5668\u4e2d\u521b\u5efa\u5bc6\u94a5\u9a8c\u8bc1\u6587\u4ef6\u3002</li> </ol> <pre><code>cat &lt;&lt;EOF&gt; /var/named/chroot/etc/transfer.key\nkey \"master-slave\" {                    # \u4e3b\u4ece\u670d\u52a1\u5b9a\u4e49\u5e94\u76f8\u540c\n    algorithm hmac-md5;                 # \u52a0\u5bc6\u7b97\u6cd5\n    secret \"O4KHJyU/PDS/TsEqMSogdA==\";  # \u5bc6\u94a5\u6587\u4ef6\u4e2d\u7684 key \u503c\n};\nEOF\n\nchown root.named /var/named/chroot/etc/transfer.key\nchmod 640 /var/named/chroot/etc/transfer.key\n</code></pre> <p>\u5bc6\u94a5\u6743\u9650\u5e94\u5f88\u5c0f\u3002</p> <ol> <li>\u5f00\u542f bind \u670d\u52a1\u5bc6\u94a5\u9a8c\u8bc1\u3002</li> </ol> <pre><code>sed -i '/options/i\\include \"/var/named/chroot/etc/transfer.key\";' /etc/named.conf\nsed -i '/allow-query/a\\\\tallow-transfer { key master-slave; };' /etc/named.conf\n\nrm -rf /var/named/slaves/*\nnamed-checkconf\nsystemctl restart named\nls /var/named/slaves/\n</code></pre> <ol> <li>\u4ece\u670d\u52a1\u5668\u5f00\u542f\u5bc6\u94a5\u9a8c\u8bc1\u3002</li> </ol> <pre><code>scp root@192.168.10.10:/var/named/chroot/etc/transfer.key /var/named/chroot/etc/\n\nchown root.named /var/named/chroot/etc/transfer.key\nchmod 640 /var/named/chroot/etc/transfer.key\n\nsed -i '/options/i\\include \"/var/named/chroot/etc/transfer.key\";' /etc/named.conf\nsed -i '/dnssec-validation/a\\\\tdnssec-lookaside auto;' /etc/named.conf\nsed -i '/logging/i\\server 192.168.10.10{ keys { master-slave; }; };' /etc/named.conf\n\nrm -rf /var/named/slaves/*\nnamed-checkconf\nsystemctl restart named\nls /var/named/slaves/\n\ndig www.linuxprobe.com  @127.0.0.1 -k /var/named/chroot/etc/transfer.key\n</code></pre>"},{"location":"linux/service/bind/#_9","title":"\u7f13\u5b58\u670d\u52a1\u5668","text":"<p>DNS\u7f13\u5b58\u670d\u52a1\u5668\uff08Caching DNS Server\uff09\u662f\u4e00\u79cd\u4e0d\u8d1f\u8d23\u57df\u540d\u6570\u636e\u7ef4\u62a4\u7684DNS\u670d\u52a1\u5668\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c\u7f13\u5b58\u670d\u52a1\u5668\u5c31\u662f\u628a\u7528\u6237\u7ecf\u5e38\u4f7f\u7528\u5230\u7684\u57df\u540d\u4e0eIP\u5730\u5740\u7684\u89e3\u6790\u8bb0\u5f55\u4fdd\u5b58\u5728\u4e3b\u673a\u672c\u5730\uff0c\u4ece\u800c\u63d0\u5347\u4e0b\u6b21\u89e3\u6790\u7684\u6548\u7387\u3002DNS\u7f13\u5b58\u670d\u52a1\u5668\u4e00\u822c\u7528\u4e8e\u7ecf\u5e38\u8bbf\u95ee\u67d0\u4e9b\u56fa\u5b9a\u7ad9\u70b9\u800c\u4e14\u5bf9\u8fd9\u4e9b\u7f51\u7ad9\u7684\u8bbf\u95ee\u901f\u5ea6\u6709\u8f83\u9ad8\u8981\u6c42\u7684\u4f01\u4e1a\u5185\u7f51\u4e2d\uff0c\u4f46\u5b9e\u9645\u7684\u5e94\u7528\u5e76\u4e0d\u5e7f\u6cdb\u3002\u800c\u4e14\uff0c\u7f13\u5b58\u670d\u52a1\u5668\u662f\u5426\u53ef\u4ee5\u6210\u529f\u89e3\u6790\u8fd8\u4e0e\u6307\u5b9a\u7684\u4e0a\u7ea7DNS\u670d\u52a1\u5668\u7684\u5141\u8bb8\u7b56\u7565\u6709\u5173\u3002</p> <pre><code>ping -c4 114.114.114.114\nsed -i '/recursion yes/a\\\\tforwarders { 114.114.114.114; 8.8.8.8; };' /etc/named.conf\n\nnmcli con show\nnmcli con show ens32 |grep ipv4.dns:\n\nsystemctl restart named\n\nnslookup 8.8.8.8\n</code></pre> <p>\u8003\u8651\u8303\u56f4\uff1a\u5e94\u7531 dns \u7f13\u5b58\u670d\u52a1\u5668\u63d0\u4f9b DNS \u67e5\u8be2\u670d\u52a1</p>"},{"location":"linux/service/bind/#_10","title":"\u5206\u79bb\u89e3\u6790","text":"<p>\u53ef\u8ba9\u4f4d\u4e8e\u4e0d\u540c\u5730\u7406\u4f4d\u7f6e\u7684\u7528\u6237\u901a\u8fc7\u8bbf\u95ee\u76f8\u540c\u7684\u57df\u540d\uff0c\u4ece\u4e0d\u540c\u7684\u670d\u52a1\u5668\u83b7\u53d6\u5230\u76f8\u540c\u7684\u6570\u636e\u3002</p> <p>\u865a\u62df\u673a\u6a21\u62df\u4e0d\u540c\u4f4d\u7f6e\u7684\u670d\u52a1\u5668\u548c\u4e0d\u540c\u4f4d\u7f6e\u7684\u7528\u6237\uff1a</p> \u7f51\u5361\u540d \u4e3b\u673a\u540d\u79f0 ip \u5730\u5740 ens32 DNS \u670d\u52a1\u5668 192.168.10.10 \u5927\u9646 DNS \u8bb0\u5f55 122.71.115.15 \u7f8e\u56fd DNS \u8bb0\u5f55 106.185.25.15 ens33 \u5927\u9646\u7528\u6237 192.168.11.130 ens34 \u7f8e\u56fd\u7528\u6237 192.168.22.140 <ol> <li>\u4e3b\u914d\u7f6e\u6587\u4ef6</li> </ol> <pre><code>cat &lt;&lt;EOF&gt; /etc/named.conf\noptions {\n    listen-on port 53 { localhost; };\n    listen-on-v6 port 53 { ::1; };\n    directory   \"/var/named\";\n    dump-file   \"/var/named/data/cache_dump.db\";\n    statistics-file \"/var/named/data/named_stats.txt\";\n    memstatistics-file \"/var/named/data/named_mem_stats.txt\";\n    recursing-file  \"/var/named/data/named.recursing\";\n    secroots-file   \"/var/named/data/named.secroots\";\n    allow-query     { localhost; };\n    recursion yes;\n    dnssec-enable yes;\n    dnssec-validation yes;\n    bindkeys-file \"/etc/named.iscdlv.key\";\n    managed-keys-directory \"/var/named/dynamic\";\n    pid-file \"/run/named/named.pid\";\n    session-keyfile \"/run/named/session.key\";\n};\nlogging {\n        channel default_debug {\n                file \"data/named.run\";\n                severity dynamic;\n        };\n};\ninclude \"/etc/named.rfc1912.zones\";\ninclude \"/etc/named.root.key\";\nEOF\n</code></pre> <ol> <li>\u533a\u57df\u914d\u7f6e\u6587\u4ef6</li> </ol> <pre><code>cat &lt;&lt;EOF&gt; /etc/named.rfc1912.zones\nacl \"china\" { 192.168.11.0/24; };\nacl \"american\" { 192.168.22.0/24; };\nview \"china\" {\n    match-clients { \"china\"; };\n    zone \"linuxprobe.com\" {\n        type master;\n        file \"linuxprobe.com.china\";\n    };\n};\nview \"american\" {\n    match-clients { \"american\"; };\n    zone \"linuxprobe.com\" {\n        type master;\n        file \"linuxprobe.com.american\";\n    };\n};\nEOF\n</code></pre> <ol> <li>\u6570\u636e\u914d\u7f6e\u6587\u4ef6</li> </ol> <pre><code>cat &lt;&lt;EOF&gt; /var/named/linuxprobe.com.china\n\\$TTL 1D\n@       IN SOA     linuxprobe.com.      root.linuxprobe.com.    (\n                                                                    0    ; serial\n                                                                    1D   ; refresh\n                                                                    1H   ; retry\n                                                                    1W   ; expire\n                                                                    3H)  ; minimum\n        NS         ns.linuxprobe.com.\nns      IN A       122.71.115.10\nwww     IN A       122.71.115.15\nEOF\n\ncat &lt;&lt;EOF&gt; /var/named/linuxprobe.com.american\n\\$TTL 1D\n@       IN SOA     linuxprobe.com.      root.linuxprobe.com.    (\n                                                                    0    ; serial\n                                                                    1D   ; refresh\n                                                                    1H   ; retry\n                                                                    1W   ; expire\n                                                                    3H)  ; minimum\n        NS         ns.linuxprobe.com.\nns      IN A       106.185.25.10\nwww     IN A       106.185.25.15\nEOF\n\nsystemctl restart named\n</code></pre> <ol> <li>\u6a21\u62df\u7528\u6237\u8bbf\u95ee</li> </ol> <p>\u865a\u62df\u673a\u518d\u6dfb\u52a0\u4e24\u5757\u7f51\u5361\uff0c\u81ea\u5b9a\u4e49\u5206\u914d\u7f51\u7edc\u6bb5\u5206\u522b\u4e3a <code>192.168.11.0/24</code> \u548c <code>192.168.22.0/24</code>\u3002</p> <pre><code>nmcli con show\nnmcli con mod ens34 ipv4.method manual ipv4.addr 192.168.11.130/24 gw4 192.168.11.2 ipv4.dns 192.168.11.2\nnmcli con mod ens35 ipv4.method manual ipv4.addr 192.168.22.140/24 gw4 192.168.22.2 ipv4.dns 192.168.22.2\nnmcli con up ens34\nnmcli con up ens35\n\nnslookup www.linuxprobe.com 192.168.11.130\nnslookup www.linuxprobe.com 192.168.22.140\n</code></pre>"},{"location":"linux/service/dhcp/","title":"Dhcp","text":""},{"location":"linux/service/dhcp/#dhcp","title":"DHCP \u52a8\u6001\u5206\u914d\u4e3b\u673a\u5730\u5740","text":"<p>\u52a8\u6001\u5206\u914d IP (Dynamic Host Configuration Protocol)</p>"},{"location":"linux/service/dhcp/#_1","title":"\u4e3b\u8981\u7528\u9014","text":"<ul> <li>\u7528\u4e8e\u5185\u90e8\u7f51\u7edc\u548c\u7f51\u7edc\u670d\u52a1\u4f9b\u5e94\u5546\u81ea\u52a8\u5206\u914dIP\u5730\u5740\u7ed9\u7528\u6237</li> <li>\u7528\u4e8e\u5185\u90e8\u7f51\u7edc\u7ba1\u7406\u5458\u4f5c\u4e3a\u5bf9\u6240\u6709\u7535\u8111\u4f5c\u96c6\u4e2d\u7ba1\u7406\u7684\u624b\u6bb5</li> <li>\u4f7f\u7528\u573a\u666f</li> <li>\u81ea\u52a8\u5316\u5b89\u88c5\u7cfb\u7edf</li> <li>\u89e3\u51b3IPV4\u8d44\u6e90\u4e0d\u8db3\u95ee\u9898</li> </ul>"},{"location":"linux/service/dhcp/#_2","title":"\u540d\u8bcd","text":"<ul> <li><code>dhcp\u5ba2\u6237\u7aef</code>\uff1a\u9700\u8981\u83b7\u53d6ip\u7b49\u4fe1\u606f</li> <li><code>dhcp\u670d\u52a1\u7aef</code>\uff1a\u63d0\u4f9bip\u7b49\u4fe1\u606f</li> <li><code>\u4f5c\u7528\u57df</code>\uff1a\u4e00\u4e2a\u5b8c\u6574\u7684IP\u5730\u5740\u6bb5\uff0cDHCP\u534f\u8bae\u6839\u636e\u4f5c\u7528\u57df\u6765\u7ba1\u7406\u7f51\u7edc\u7684\u5206\u5e03\u3001\u5206\u914dIP\u5730\u5740\u53ca\u5176\u4ed6\u914d\u7f6e\u53c2\u6570\u3002</li> <li><code>\u8d85\u7ea7\u4f5c\u7528\u57df</code>\uff1a\u7528\u4e8e\u7ba1\u7406\u5904\u4e8e\u540c\u4e00\u4e2a\u7269\u7406\u7f51\u7edc\u4e2d\u7684\u591a\u4e2a\u903b\u8f91\u5b50\u7f51\u6bb5\u3002\u8d85\u7ea7\u4f5c\u7528\u57df\u4e2d\u5305\u542b\u4e86\u53ef\u4ee5\u7edf\u4e00\u7ba1\u7406\u7684\u4f5c\u7528\u57df\u5217\u8868\u3002</li> <li><code>\u6392\u9664\u8303\u56f4</code>\uff1a\u628a\u4f5c\u7528\u57df\u4e2d\u7684\u67d0\u4e9bIP\u5730\u5740\u6392\u9664\uff0c\u786e\u4fdd\u8fd9\u4e9bIP\u5730\u5740\u4e0d\u4f1a\u5206\u914d\u7ed9DHCP\u5ba2\u6237\u7aef\u3002</li> <li><code>\u4fdd\u7559\u5730\u5740</code>\uff1a\uff08\u5730\u5740\u7ed1\u5b9a\uff09\u5c06ip\u548cmac\u5730\u5740\u7ed1\u5b9a</li> <li><code>\u5171\u4eab\u4f5c\u7528\u57df</code>\uff1a\uff08dhcp\u8d85\u7ea7\u4f5c\u7528\u57df\uff09\u4e00\u5806\u4f5c\u7528\u57df\u7684\u96c6\u5408</li> <li><code>\u5730\u5740\u6c60</code>\uff1a\u5728\u5b9a\u4e49\u4e86DHCP\u7684\u4f5c\u7528\u57df\u5e76\u5e94\u7528\u4e86\u6392\u9664\u8303\u56f4\u540e\uff0c\u5269\u4f59\u7684\u7528\u6765\u52a8\u6001\u5206\u914d\u7ed9DHCP\u5ba2\u6237\u7aef\u7684IP\u5730\u5740\u8303\u56f4\u3002</li> <li><code>\u79df\u7ea6</code>\uff1aDHCP\u5ba2\u6237\u7aef\u80fd\u591f\u4f7f\u7528\u52a8\u6001\u5206\u914d\u7684IP\u5730\u5740\u7684\u65f6\u95f4\u3002\u79df\u7ea6\u65f6\u95f4\u5230\u671f\u540e\u81ea\u52a8\u56de\u6536\u4e3b\u673a\u7684IP\u5730\u5740\uff0c\u4ee5\u514d\u9020\u6210IP\u5730\u5740\u7684\u6d6a\u8d39\u3002</li> <li><code>\u9884\u7ea6</code>\uff1a\u4fdd\u8bc1\u7f51\u7edc\u4e2d\u7684\u7279\u5b9a\u8bbe\u5907\u603b\u662f\u83b7\u53d6\u5230\u76f8\u540c\u7684IP\u5730\u5740\u3002</li> <li><code>\u4e2d\u7ee7\u4ee3\u7406</code>\uff1a\u7528\u4e8e\u5728\u4e0d\u540c\u7f51\u6bb5\u4e2d\uff0c\u8f6c\u53d1DHCP\u8bf7\u6c42\u4fe1\u606f\u7684\u8bbe\u5907</li> </ul>"},{"location":"linux/service/dhcp/#_3","title":"\u79df\u7ea6\u66f4\u65b0","text":"<ul> <li><code>\u8fc7\u53bb50%\u65f6</code>\uff1a\u5ba2\u6237\u7aef\u4e3b\u52a8\u8054\u7cfb\u670d\u52a1\u7aef\uff0c\u5982\u679c\u6536\u5230\u56de\u5e94\uff0c\u4f1a\u4f7f\u7528\u670d\u52a1\u7aef\u91cd\u65b0\u5206\u914d\u7684ip\uff08\u53ef\u80fd\u662f\u4e4b\u524d\u7684\uff0c\u53ef\u80fd\u4e3a\u65b0\uff09\uff0c\u5982\u679c\u6ca1\u6709\u6536\u5230\u56de\u5e94\uff0c\u7ee7\u7eed\u4f7f\u7528</li> <li><code>\u8fc7\u53bb75%\u65f6</code>\uff1a\u5ba2\u6237\u7aef\u4e3b\u52a8\u8054\u7cfb\u670d\u52a1\u7aef\uff0c\u5982\u679c\u6536\u5230\u56de\u5e94\uff0c\u4f1a\u4f7f\u7528\u670d\u52a1\u7aef\u91cd\u65b0\u5206\u914d\u7684ip\uff08\u53ef\u80fd\u662f\u4e4b\u524d\u7684\uff0c\u53ef\u80fd\u4e3a\u65b0\uff09\uff0c\u5982\u679c\u6ca1\u6709\u6536\u5230\u56de\u5e94\uff0c\u7ee7\u7eed\u4f7f\u7528</li> <li> <p><code>\u8fc7\u53bb87.5%\u65f6</code>\uff1a\u5ba2\u6237\u7aef\u4e3b\u52a8\u8054\u7cfb\u670d\u52a1\u7aef\uff0c\u5982\u679c\u6536\u5230\u56de\u5e94\uff0c\u4f1a\u4f7f\u7528\u670d\u52a1\u7aef\u91cd\u65b0\u5206\u914d\u7684ip\uff08\u53ef\u80fd\u662f\u4e4b\u524d\u7684\uff0c\u53ef\u80fd\u4e3a\u65b0\uff09\uff0c\u5982\u679c\u6ca1\u6709\u6536\u5230\u56de\u5e94\uff0c\u5ba2\u6237\u7aef\u4f1a\u91cd\u65b0\u5f00\u59cb\u79df\u7ea6\u8fc7\u7a0b\uff0c\u4f7f\u7528\u7f51\u5185\u5176\u5b83dhcp\u670d\u52a1\u7aef\u63d0\u4f9b\u7684ip\u3002\u5982\u679c\u7f51\u5185\u6ca1\u6709dhcp\u670d\u52a1\u7aef\u56de\u5e94\uff0c\u5ba2\u6237\u7aef\u4ecd\u53ef\u4f7f\u7528\u4e4b\u524d\u7684\u5730\u5740\uff0c\u76f4\u5230\u79df\u7ea6\u5230\u671f</p> <p><code>\u6ce8\u610f</code>\uff1a\u5ba2\u6237\u7aef\u91cd\u542f\u65f6\u4f1a\u81ea\u52a8\u91ca\u653e\u6389\u83b7\u53d6\u7684 IP\uff0c\u91cd\u542f\u540e\u4f1a\u4e3b\u52a8\u8054\u7cfb dhcp \u670d\u52a1\u7aef\uff0c\u5982\u679c\u79df\u7ea6\u6ca1\u6709\u5230\u671f\uff0c\u4e14\u5f97\u5230\u670d\u52a1\u7aef\u56de\u5e94\uff0c\u5ba2\u6237\u673a\u4f1a\u7ee7\u7eed\u4f7f\u7528\u4e4b\u524d\u7684 IP\uff0c\u5426\u5219\u4f1a\u6bcf\u4e94\u5206\u949f\u5c1d\u8bd5\u4e00\u6b21 IP \u79df\u7528\u3002</p> </li> </ul> <p><code>\u79df\u7528\u5931\u8d25</code>\uff1awindows \u4f1a\u81ea\u52a8\u8bbe\u7f6e\u6210169.254..</p>"},{"location":"linux/service/dhcp/#dhcp_1","title":"\u5b89\u88c5 dhcp \u670d\u52a1","text":"<pre><code>yum install -y dhcp\nsystemctl start dhcpd\n</code></pre>"},{"location":"linux/service/dhcp/#_4","title":"\u9ed8\u8ba4\u914d\u7f6e\u793a\u4f8b\u6587\u4ef6","text":"<pre><code>cat /usr/share/doc/dhcp-4.2.5/dhcpd.conf.example\n#\n# DHCP Server Configuration file.\n#   see /usr/share/doc/dhcp*/dhcpd.conf.example\n#   see dhcpd.conf(5) man page\n#\noption domain-name \"example.org\";\n# \u5b9a\u4e49\u9ed8\u8ba4\u7684\u641c\u7d22\u57df\noption domain-name-servers ns1.example.org, ns2.example.org;\n# \u5b9a\u4e49\u5ba2\u6237\u7aef\u7684 DNS \u5730\u5740\uff0c\u8fd9\u91cc\u6211\u4eec\u8bbe\u4e3aDHCP\u670d\u52a1\u5668\u7684IP\u5730\u5740\n#option subnet-mask 255.255.255.0;\n# \u5b9a\u4e49\u5ba2\u6237\u7aef\u9ed8\u8ba4\u7684\u5b50\u7f51\u63a9\u7801\ndefault-lease-time 600;\n# \u9ed8\u8ba4\u7684\u79df\u7ea6\u65f6\u95f4\uff0c\u79d2\u4e3a\u5355\u4f4d\nmax-lease-time 7200;\n# \u6700\u5927\u7684\u79df\u7ea6\u65f6\u95f4\uff0c\u79d2\u4e3a\u5355\u4f4d\n#ddns-update-style none;\n# \u5b9a\u4e49DNS\u670d\u52a1\u52a8\u6001\u66f4\u65b0\u7684\u7c7b\u578b\uff0c\u7c7b\u578b\u5305\u62ec\uff1anone\uff08\u4e0d\u652f\u6301\u52a8\u6001\u66f4\u65b0\uff09\u3001interim\uff08\u4e92\u52a8\u66f4\u65b0\u6a21\u5f0f\uff09\u4e0e ad-hoc\uff08\u7279\u6b8a\u66f4\u65b0\u6a21\u5f0f\uff09\n#authoritative;\n# \u6307\u5b9a\u5f53\u4e00\u4e2a\u5ba2\u6237\u7aef\u8bd5\u56fe\u83b7\u5f97\u4e00\u4e2a\u4e0d\u662f\u8be5DHCP\u670d\u52a1\u5668\u5206\u914d\u7684IP\u4fe1\u606f\uff0cDHCP\u5c06\u53d1\u9001\u4e00\u4e2a\u62d2\u7edd\u6d88\u606f\uff0c\u800c\u4e0d\u4f1a\u7b49\u5f85\u8bf7\u6c42\u8d85\u65f6\u3002\u5f53\u8bf7\u6c42\u88ab\u62d2\u7edd\uff0c\u5ba2\u6237\u7aef\u4f1a\u91cd\u65b0\u5411\u5f53\u524dDHCP\u53d1\u9001IP\u8bf7\u6c42\u83b7\u5f97\u65b0\u5730\u5740\u3002\n#ignore client-updates;\n# \u5ffd\u7565\u5ba2\u6237\u7aef\u66f4\u65b0DNS\u8bb0\u5f55\nlog-facility local7;\n# \u5b9a\u4e49\u65e5\u5fd7\u670d\u52a1\uff0c\u53ef\u4ee5\u5728\u65e5\u5fd7\u914d\u7f6e\u6587\u4ef6\u4e2d\u67e5\u770b\u5177\u4f53\u65e5\u5fd7\u4f4d\u7f6e\uff0c\u9ed8\u8ba4\u662f\uff1a/var/log/boog.log\uff0c\u4f46\u662f\u5728/var/log/messages\u91cc\u9762\u4e5f\u4f1a\u8bb0\u5f55dhcp\u65e5\u5fd7\n\n# \u5b50\u7f51\u7f51\u6bb5\u58f0\u660e\nsubnet 10.152.187.0 netmask 255.255.255.0 {\n}\nsubnet 10.254.239.0 netmask 255.255.255.224 {\n# \u5206\u914d\u7684\u7f51\u6bb5\u53ca\u5b50\u7f51\u63a9\u7801\uff0c\u4ee3\u8868\u53ea\u5728 10.254.239.0 \u8fd9\u4e2a C \u7c7b\u7f51\u6bb5\u91cc\u751f\u6548\uff0c\u5b50\u7f51\u63a9\u7801\u8bbe\u4e3a255.255.255.0\n  range 10.254.239.10 10.254.239.20;\n  # \u5b9a\u4e49\u7528\u4e8e\u5206\u914d\u7684 IP \u5730\u5740\u6c60\uff0c\u8d77\u59cb\u5230\u7ed3\u675f,\u5c3d\u91cf\u4e0d\u8981\u5305\u542bDHCP\u670d\u52a1\u5668\u7684IP\u5730\u5740\n  option routers rtr-239-0-1.example.org, rtr-239-0-2.example.org;\n  # \u5b9a\u4e49\u5ba2\u6237\u7aef\u7684\u7f51\u5173\u5730\u5740\n}\nsubnet 10.254.239.32 netmask 255.255.255.224 {\n  range dynamic-bootp 10.254.239.40 10.254.239.60;\n  option broadcast-address 10.254.239.31;\n  # \u5b9a\u4e49\u5ba2\u6237\u7aef\u7684\u5e7f\u64ad\u5730\u5740\n  option routers rtr-239-32-1.example.org;\n}\nsubnet 10.5.5.0 netmask 255.255.255.224 {\n  range 10.5.5.26 10.5.5.30;\n  option domain-name-servers ns1.internal.example.org;\n  option domain-name \"internal.example.org\";\n  option routers 10.5.5.1;\n  option broadcast-address 10.5.5.31;\n  default-lease-time 600;\n  max-lease-time 7200;\n}\nhost passacaglia {\n  hardware ethernet 0:0:c0:5d:bd:95;\n  # \u6307\u5b9a\u7f51\u5361\u63a5\u53e3\u7684\u7c7b\u578b\u4e0e MAC \u5730\u5740\n  filename \"vmunix.passacaglia\";\n  # \u542f\u52a8\u6587\u4ef6\u540d\u79f0\uff0c\u7528\u4e8e\u65e0\u76d8\u5de5\u4f5c\u7ad9\n  server-name \"toccata.fugue.com\";\n  # \u5411 DHCP \u5ba2\u6237\u7aef\u901a\u77e5 DHCP \u670d\u52a1\u5668\u7684\u4e3b\u673a\u540d\n}\nhost fantasia {\n  hardware ethernet 08:00:07:26:c0:a5;\n  fixed-address fantasia.fugue.com;\n  # \u5c06\u67d0\u4e2a\u56fa\u5b9a\u7684 IP \u5730\u5740\u5206\u914d\u7ed9\u6307\u5b9a\u4e3b\u673a\n}\nclass \"foo\" {\n# \u5b9a\u4e49\u591a\u4e2a\u5b50\u7f51\uff0cclass \u540e\u9762\u5199\u7ec4\u540d\n  match if substring (option vendor-class-identifier, 0, 4) = \"SUNW\";\n}\nshared-network 224-29 {\n# \u5b9a\u4e49\u591a\u4e2a\u5b50\u7f51\uff0c\u8981\u4ece\u5927\u5f80\u5c0f\u5199\n  subnet 10.17.224.0 netmask 255.255.255.0 {\n    option routers rtr-224.example.org;\n  }\n  subnet 10.0.29.0 netmask 255.255.255.0 {\n    option routers rtr-29.example.org;\n  }\n  pool {\n    allow members of \"foo\";\n    # \u5141\u8bb8\u8303\u56f4\n    range 10.17.224.10 10.17.224.250;\n  }\n  pool {\n    deny members of \"foo\";\n    # \u62d2\u7edd\u8303\u56f4\n    range 10.0.29.10 10.0.29.230;\n  }\n}\n</code></pre>"},{"location":"linux/service/dhcp/#dhcp_2","title":"\u865a\u62df\u673a\u6a21\u62df dhcp","text":"<p>\u5173\u95ed\u865a\u62df\u673a\u81ea\u5e26 dhcp \u529f\u80fd\uff0c\u6dfb\u4e24\u5757\u7f51\u5361\uff0c\u4e24\u5757\u7f51\u5361\u6a21\u5f0f\u5747\u8bbe\u7f6e\u4e3a\u4ec5\u4e3b\u673a\u6a21\u5f0f\uff0c\u4e00\u5757\u7f51\u5361\u4f5c\u4e3a dhcp \u670d\u52a1\u5668\u7f51\u5361\uff0c\u53e6\u4e00\u5f20\u4f5c\u4e3a\u5ba2\u6237\u7aef\u6d4b\u8bd5\u7f51\u5361\u3002</p>"},{"location":"linux/service/dhcp/#ip","title":"\u81ea\u52a8 ip \u5206\u914d","text":"<pre><code>nmcli con show\nnmcli con mod ens32 ipv4.addr 192.168.10.10/24 gw4 192.168.10.2 ipv4.dns 192.168.10.2\nnmcli con up ens32\n\ncat &lt;&lt;EOF&gt; /etc/dhcp/dhcpd.conf\nddns-update-style none;\nignore client-updates;\nsubnet 192.168.10.0 netmask 255.255.255.0 {\n    range 192.168.10.50 192.168.10.150;\n    option routers 192.168.10.1;\n    option domain-name \"linuxprobe.com\";\n    option domain-name-servers 192.168.10.1;\n    default-lease-time 21600;\n    max-lease-time 43200;\n}\nEOF\n\nsystemctl start dhcpd\nsystemctl enable dhcpd\n\nnmcli con mod ens34 ipv4.method auto\nnmcli con up ens34\nip addr\n</code></pre>"},{"location":"linux/service/dhcp/#ip_1","title":"\u56fa\u5b9a ip \u5206\u914d","text":"<pre><code>ip link show ens34|grep link|awk '{print $2}'\ncat &lt;&lt;EOF&gt; /etc/dhcp/dhcpd.conf \nddns-update-style none;\nignore client-updates;\nsubnet 192.168.10.0 netmask 255.255.255.0 {\n    range 192.168.10.50 192.168.10.150;\n    option routers 192.168.10.1;\n    option domain-name \"linuxprobe.com\";\n    option domain-name-servers 192.168.10.1;\n    default-lease-time 21600;\n    max-lease-time 43200;\n    host linuxprobe {\n        hardware ethernet 00:0c:29:27:c6:12;\n        fixed-address 192.168.10.88;\n    }\n}\nEOF\n\nsystemctl start dhcpd\n\nnmcli con del ens34\nnmcli con add con-name ens34 type ethernet ifname ens34 ipv4.method auto\nnmcli con up ens34\nip addr\n</code></pre>"},{"location":"linux/service/ftp/","title":"Ftp","text":""},{"location":"linux/service/ftp/#ftp","title":"FTP \u6587\u4ef6\u4f20\u8f93\u670d\u52a1","text":"<p>FTP\u662f\u4e00\u79cd\u5728\u4e92\u8054\u7f51\u4e2d\u8fdb\u884c\u6587\u4ef6\u4f20\u8f93\u7684\u534f\u8bae\uff0c\u57fa\u4e8e\u5ba2\u6237\u7aef/\u670d\u52a1\u5668\u6a21\u5f0f\uff0c\u9ed8\u8ba4\u4f7f\u752820\u300121\u53f7\u7aef\u53e3\uff0c\u5176\u4e2d\u7aef\u53e320\uff08\u6570\u636e\u7aef\u53e3\uff09\u7528\u4e8e\u8fdb\u884c\u6570\u636e\u4f20\u8f93\uff0c\u7aef\u53e321\uff08\u547d\u4ee4\u7aef\u53e3\uff09\u7528\u4e8e\u63a5\u53d7\u5ba2\u6237\u7aef\u53d1\u51fa\u7684\u76f8\u5173FTP\u547d\u4ee4\u4e0e\u53c2\u6570\u3002FTP\u670d\u52a1\u5668\u666e\u904d\u90e8\u7f72\u4e8e\u5185\u7f51\u4e2d\uff0c\u5177\u6709\u5bb9\u6613\u642d\u5efa\u3001\u65b9\u4fbf\u7ba1\u7406\u7684\u7279\u70b9\u3002\u800c\u4e14\u6709\u4e9bFTP\u5ba2\u6237\u7aef\u5de5\u5177\u8fd8\u53ef\u4ee5\u652f\u6301\u6587\u4ef6\u7684\u591a\u70b9\u4e0b\u8f7d\u4ee5\u53ca\u65ad\u70b9\u7eed\u4f20\u6280\u672f\uff0c\u56e0\u6b64FTP\u670d\u52a1\u5f97\u5230\u4e86\u5e7f\u5927\u7528\u6237\u7684\u9752\u7750\u3002</p> <p></p> <p>FTP\u534f\u8bae\u6709\u4e24\u79cd\u5de5\u4f5c\u6a21\u5f0f</p> <ul> <li>\u4e3b\u52a8\u6a21\u5f0f\uff1aFTP \u670d\u52a1\u5668\u4e3b\u52a8\u5411\u5ba2\u6237\u7aef\u53d1\u8d77\u8fde\u63a5\u8bf7\u6c42\u3002</li> <li>\u88ab\u52a8\u6a21\u5f0f\uff1aFTP \u670d\u52a1\u5668\u7b49\u5f85\u5ba2\u6237\u7aef\u53d1\u8d77\u8fde\u63a5\u8bf7\u6c42\uff08FTP \u9ed8\u8ba4\u5de5\u4f5c\u6a21\u5f0f\uff09\u3002</li> </ul>"},{"location":"linux/service/ftp/#ftp_1","title":"\u5b89\u88c5 FTP \u670d\u52a1","text":"<ul> <li><code>vsftpd</code>\uff08very secure ftp daemon\uff0c\u975e\u5e38\u5b89\u5168\u7684FTP\u5b88\u62a4\u8fdb\u7a0b\uff09\u662f\u4e00\u6b3e\u8fd0\u884c\u5728Linux\u64cd\u4f5c\u7cfb\u7edf\u4e0a\u7684FTP\u670d\u52a1\u7a0b\u5e8f\uff0c\u4e0d\u4ec5\u5b8c\u5168\u5f00\u6e90\u800c\u4e14\u514d\u8d39\uff0c\u6b64\u5916\uff0c\u8fd8\u5177\u6709\u5f88\u9ad8\u7684\u5b89\u5168\u6027\u3001\u4f20\u8f93\u901f\u5ea6\uff0c\u4ee5\u53ca\u652f\u6301\u865a\u62df\u7528\u6237\u9a8c\u8bc1\u7b49\u5176\u4ed6FTP\u670d\u52a1\u7a0b\u5e8f\u4e0d\u5177\u5907\u7684\u7279\u70b9\u3002</li> </ul> <pre><code>[root@localhost ~]# hostname\nlocalhost.localdomain\n[root@localhost ~]# yum install -y vsftpd\n\u5df2\u52a0\u8f7d\u63d2\u4ef6\uff1afastestmirror\nLoading mirror speeds from cached hostfile\n * base: centos.ustc.edu.cn\n * extras: mirrors.163.com\n * updates: mirrors.163.com\n\u6b63\u5728\u89e3\u51b3\u4f9d\u8d56\u5173\u7cfb\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 vsftpd.x86_64.0.3.0.2-25.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u89e3\u51b3\u4f9d\u8d56\u5173\u7cfb\u5b8c\u6210\n\n\u4f9d\u8d56\u5173\u7cfb\u89e3\u51b3\n\n===============================================================================================================\n Package                  \u67b6\u6784                     \u7248\u672c                           \u6e90                      \u5927\u5c0f\n===============================================================================================================\n\u6b63\u5728\u5b89\u88c5:\n vsftpd                   x86_64                   3.0.2-25.el7                   base                   171 k\n\n\u4e8b\u52a1\u6982\u8981\n===============================================================================================================\n\u5b89\u88c5  1 \u8f6f\u4ef6\u5305\n\n\u603b\u4e0b\u8f7d\u91cf\uff1a171 k\n\u5b89\u88c5\u5927\u5c0f\uff1a353 k\nDownloading packages:\nvsftpd-3.0.2-25.el7.x86_64.rpm                                                          | 171 kB  00:00:01\nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  \u6b63\u5728\u5b89\u88c5    : vsftpd-3.0.2-25.el7.x86_64                                                                 1/1\n  \u9a8c\u8bc1\u4e2d      : vsftpd-3.0.2-25.el7.x86_64                                                                 1/1\n\n\u5df2\u5b89\u88c5:\n  vsftpd.x86_64 0:3.0.2-25.el7\n\n\u5b8c\u6bd5\uff01\n[root@localhost ~]# systemctl start vsftpd\n[root@localhost ~]# netstat -lntp|grep vsftpd\ntcp6       0      0 :::21                   :::*                    LISTEN      49228/vsftpd\n</code></pre> <p>\u9632\u706b\u5899\u653e\u884c</p> <pre><code>[root@localhost ~]# firewall-cmd --add-service=ftp\nsuccess\n[root@localhost ~]# firewall-cmd --add-service=ftp --permanent\nsuccess\n[root@localhost ~]# firewall-cmd --list-all\npublic (active)\n  target: default\n  icmp-block-inversion: no\n  interfaces: ens32\n  sources:\n  services: ssh dhcpv6-client ftp\n  ports:\n  protocols:\n  masquerade: no\n  forward-ports:\n  source-ports:\n  icmp-blocks:\n  rich rules:\n\n[root@localhost ~]#\n</code></pre> <ul> <li><code>ftp</code> \u662f Linux \u7cfb\u7edf\u4e2d\u4ee5\u547d\u4ee4\u884c\u754c\u9762\u7684\u65b9\u5f0f\u6765\u7ba1\u7406 FTP \u4f20\u8f93\u670d\u52a1\u7684\u5ba2\u6237\u7aef\u5de5\u5177\u3002</li> </ul> <p>\u5b89\u88c5 ftp \u5ba2\u6237\u7aef\u5e76\u6d4b\u8bd5 vsftp \u670d\u52a1</p> <pre><code>[root@client ~]# hostname\nclient\n[root@client ~]# yum install -y ftp\n\u5df2\u52a0\u8f7d\u63d2\u4ef6\uff1afastestmirror\nLoading mirror speeds from cached hostfile\n * base: mirrors.aliyun.com\n * elrepo: hkg.mirror.rackspace.com\n * elrepo-kernel: hkg.mirror.rackspace.com\n * epel: hkg.mirror.rackspace.com\n * extras: mirrors.aliyun.com\n * updates: mirror.jdcloud.com\n\u6b63\u5728\u89e3\u51b3\u4f9d\u8d56\u5173\u7cfb\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 ftp.x86_64.0.0.17-67.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u89e3\u51b3\u4f9d\u8d56\u5173\u7cfb\u5b8c\u6210\n\n\u4f9d\u8d56\u5173\u7cfb\u89e3\u51b3\n\n===============================================================================================================\n Package                \u67b6\u6784                      \u7248\u672c                           \u6e90                       \u5927\u5c0f\n===============================================================================================================\n\u6b63\u5728\u5b89\u88c5:\n ftp                    x86_64                    0.17-67.el7                    base                     61 k\n\n\u4e8b\u52a1\u6982\u8981\n===============================================================================================================\n\u5b89\u88c5  1 \u8f6f\u4ef6\u5305\n\n\u603b\u4e0b\u8f7d\u91cf\uff1a61 k\n\u5b89\u88c5\u5927\u5c0f\uff1a96 k\nDownloading packages:\nftp-0.17-67.el7.x86_64.rpm                                                              |  61 kB  00:00:00\nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  \u6b63\u5728\u5b89\u88c5    : ftp-0.17-67.el7.x86_64                                                                     1/1\n  \u9a8c\u8bc1\u4e2d      : ftp-0.17-67.el7.x86_64                                                                     1/1\n\n\u5df2\u5b89\u88c5:\n  ftp.x86_64 0:0.17-67.el7\n\n\u5b8c\u6bd5\uff01\n[root@client ~]# ftp 192.168.11.130\nConnected to 192.168.11.130 (192.168.11.130).\n220 (vsFTPd 3.0.2)\nName (192.168.11.130:root): anonymous\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp&gt; ls\n227 Entering Passive Mode (192,168,11,130,80,13).\n150 Here comes the directory listing.\ndrwxr-xr-x    2 0        0               6 Oct 30  2018 pub\n226 Directory send OK.\nftp&gt; exit\n221 Goodbye.\n</code></pre>"},{"location":"linux/service/ftp/#vsftpd","title":"vsftpd \u914d\u7f6e\u8bf4\u660e","text":"<p>vsftpd \u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6</p> <pre><code>[root@localhost ~]# cat /etc/vsftpd/vsftpd.conf |grep -v '^$'|grep -v '#'\nanonymous_enable=YES\nlocal_enable=YES\nwrite_enable=YES\nlocal_umask=022\ndirmessage_enable=YES\nxferlog_enable=YES\nconnect_from_port_20=YES\nxferlog_std_format=YES\nlisten=NO\nlisten_ipv6=YES\npam_service_name=vsftpd\nuserlist_enable=YES\ntcp_wrappers=YES\n</code></pre> <p>\u5e38\u7528\u53c2\u6570\u53ca\u4f5c\u7528\uff1a</p> \u53c2\u6570 \u4f5c\u7528 listen=<code>[YES\u3001NO]</code> \u662f\u5426\u4ee5\u72ec\u7acb\u8fd0\u884c\u7684\u65b9\u5f0f\u76d1\u542c\u670d\u52a1 listen_address=<code>IP</code> \u8bbe\u7f6e\u8981\u76d1\u542c\u7684IP\u5730\u5740 listen_port=<code>21</code> \u8bbe\u7f6eFTP\u670d\u52a1\u7684\u76d1\u542c\u7aef\u53e3 download_enable\uff1d<code>[YES\u3001NO]</code> \u662f\u5426\u5141\u8bb8\u4e0b\u8f7d\u6587\u4ef6 userlist_enable=<code>[YES\u3001NO]</code> \u662f\u5426\u8bbe\u7f6e\u7528\u6237\u5217\u8868\u4e3a\u201c\u5141\u8bb8\u201d\u64cd\u4f5c userlist_deny=<code>[YES\u3001NO]</code> \u662f\u5426\u8bbe\u7f6e\u7528\u6237\u5217\u8868\u4e3a\u201c\u7981\u6b62\u201d\u64cd\u4f5c max_clients=<code>0</code> \u6700\u5927\u5ba2\u6237\u7aef\u8fde\u63a5\u6570\uff0c0\u4e3a\u4e0d\u9650\u5236 max_per_ip=<code>0</code> \u540c\u4e00IP\u5730\u5740\u7684\u6700\u5927\u8fde\u63a5\u6570\uff0c0\u4e3a\u4e0d\u9650\u5236 anonymous_enable=<code>[YES\u3001NO]</code> \u662f\u5426\u5141\u8bb8\u533f\u540d\u7528\u6237\u8bbf\u95ee anon_upload_enable=<code>[YES\u3001NO]</code> \u662f\u5426\u5141\u8bb8\u533f\u540d\u7528\u6237\u4e0a\u4f20\u6587\u4ef6 anon_umask=<code>022</code> \u533f\u540d\u7528\u6237\u4e0a\u4f20\u6587\u4ef6\u7684umask\u503c anon_root=<code>/var/ftp</code> \u533f\u540d\u7528\u6237\u7684FTP\u6839\u76ee\u5f55 anon_mkdir_write_enable=<code>[YES\u3001NO]</code> \u662f\u5426\u5141\u8bb8\u533f\u540d\u7528\u6237\u521b\u5efa\u76ee\u5f55 anon_other_write_enable=<code>[YES\u3001NO]</code> \u662f\u5426\u5f00\u653e\u533f\u540d\u7528\u6237\u7684\u5176\u4ed6\u5199\u5165\u6743\u9650\uff08\u5305\u62ec\u91cd\u547d\u540d\u3001\u5220\u9664\u7b49\u64cd\u4f5c\u6743\u9650\uff09 anon_max_rate=<code>0</code> \u533f\u540d\u7528\u6237\u7684\u6700\u5927\u4f20\u8f93\u901f\u7387\uff08\u5b57\u8282/\u79d2\uff09\uff0c0\u4e3a\u4e0d\u9650\u5236 local_enable=<code>[YES\u3001NO]</code> \u662f\u5426\u5141\u8bb8\u672c\u5730\u7528\u6237\u767b\u5f55FTP local_umask=<code>022</code> \u672c\u5730\u7528\u6237\u4e0a\u4f20\u6587\u4ef6\u7684umask\u503c local_root=<code>/var/ftp</code> \u672c\u5730\u7528\u6237\u7684FTP\u6839\u76ee\u5f55 chroot_local_user=<code>[YES\u3001NO]</code> \u662f\u5426\u5c06\u7528\u6237\u6743\u9650\u7981\u9522\u5728FTP\u76ee\u5f55\uff0c\u4ee5\u786e\u4fdd\u5b89\u5168 local_max_rate=<code>0</code> \u672c\u5730\u7528\u6237\u6700\u5927\u4f20\u8f93\u901f\u7387\uff08\u5b57\u8282/\u79d2\uff09\uff0c0\u4e3a\u4e0d\u9650\u5236"},{"location":"linux/service/ftp/#_1","title":"\u8ba4\u8bc1\u6a21\u5f0f","text":"<p>vsftpd\u4f5c\u4e3a\u66f4\u52a0\u5b89\u5168\u7684\u6587\u4ef6\u4f20\u8f93\u7684\u670d\u52a1\u7a0b\u5e8f\uff0c\u5141\u8bb8\u7528\u6237\u4ee5\u4e09\u79cd\u8ba4\u8bc1\u6a21\u5f0f\u767b\u5f55\u5230FTP\u670d\u52a1\u5668\u4e0a\u3002</p> <ul> <li> <p><code>\u533f\u540d\u5f00\u653e\u6a21\u5f0f</code>\uff1a\u662f\u4e00\u79cd\u6700\u4e0d\u5b89\u5168\u7684\u8ba4\u8bc1\u6a21\u5f0f\uff0c\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u65e0\u9700\u5bc6\u7801\u9a8c\u8bc1\u800c\u76f4\u63a5\u767b\u5f55\u5230FTP\u670d\u52a1\u5668\u3002</p> </li> <li> <p><code>\u672c\u5730\u7528\u6237\u6a21\u5f0f</code>\uff1a\u662f\u901a\u8fc7Linux\u7cfb\u7edf\u672c\u5730\u7684\u8d26\u6237\u5bc6\u7801\u4fe1\u606f\u8fdb\u884c\u8ba4\u8bc1\u7684\u6a21\u5f0f\uff0c\u76f8\u8f83\u4e8e\u533f\u540d\u5f00\u653e\u6a21\u5f0f\u66f4\u5b89\u5168\uff0c\u800c\u4e14\u914d\u7f6e\u8d77\u6765\u4e5f\u5f88\u7b80\u5355\u3002\u4f46\u662f\u5982\u679c\u88ab\u9ed1\u5ba2\u7834\u89e3\u4e86\u8d26\u6237\u7684\u4fe1\u606f\uff0c\u5c31\u53ef\u4ee5\u7545\u901a\u65e0\u963b\u5730\u767b\u5f55FTP\u670d\u52a1\u5668\uff0c\u4ece\u800c\u5b8c\u5168\u63a7\u5236\u6574\u53f0\u670d\u52a1\u5668\u3002</p> </li> <li> <p><code>\u865a\u62df\u7528\u6237\u6a21\u5f0f</code>\uff1a\u662f\u8fd9\u4e09\u79cd\u6a21\u5f0f\u4e2d\u6700\u5b89\u5168\u7684\u4e00\u79cd\u8ba4\u8bc1\u6a21\u5f0f\uff0c\u5b83\u9700\u8981\u4e3aFTP\u670d\u52a1\u5355\u72ec\u5efa\u7acb\u7528\u6237\u6570\u636e\u5e93\u6587\u4ef6\uff0c\u865a\u62df\u51fa\u7528\u6765\u8fdb\u884c\u53e3\u4ee4\u9a8c\u8bc1\u7684\u8d26\u6237\u4fe1\u606f\uff0c\u800c\u8fd9\u4e9b\u8d26\u6237\u4fe1\u606f\u5728\u670d\u52a1\u5668\u7cfb\u7edf\u4e2d\u5b9e\u9645\u4e0a\u662f\u4e0d\u5b58\u5728\u7684\uff0c\u4ec5\u4f9bFTP\u670d\u52a1\u7a0b\u5e8f\u8fdb\u884c\u8ba4\u8bc1\u4f7f\u7528\u3002\u8fd9\u6837\uff0c\u5373\u4f7f\u9ed1\u5ba2\u7834\u89e3\u4e86\u8d26\u6237\u4fe1\u606f\u4e5f\u65e0\u6cd5\u767b\u5f55\u670d\u52a1\u5668\uff0c\u4ece\u800c\u6709\u6548\u964d\u4f4e\u4e86\u7834\u574f\u8303\u56f4\u548c\u5f71\u54cd\u3002</p> </li> </ul>"},{"location":"linux/service/ftp/#_2","title":"\u533f\u540d\u8bbf\u95ee\u6a21\u5f0f","text":"<p>\u4e00\u822c\u7528\u6765\u8bbf\u95ee\u4e0d\u91cd\u8981\u7684\u516c\u5f00\u6587\u4ef6\u3002</p> <p>vsftpd\u670d\u52a1\u7a0b\u5e8f\u9ed8\u8ba4\u5f00\u542f\u4e86\u533f\u540d\u5f00\u653e\u6a21\u5f0f\uff0c\u6211\u4eec\u9700\u8981\u505a\u7684\u5c31\u662f\u5f00\u653e\u533f\u540d\u7528\u6237\u7684\u4e0a\u4f20\u3001\u4e0b\u8f7d\u6587\u4ef6\u7684\u6743\u9650\uff0c\u4ee5\u53ca\u8ba9\u533f\u540d\u7528\u6237\u521b\u5efa\u3001\u5220\u9664\u3001\u66f4\u540d\u6587\u4ef6\u7684\u6743\u9650\u3002</p> <p>\u53ef\u4ee5\u5411\u533f\u540d\u7528\u6237\u5f00\u653e\u7684\u6743\u9650\u53c2\u6570\u4ee5\u53ca\u4f5c\u7528\uff1a</p> \u53c2\u6570 \u4f5c\u7528 anonymous_enable=<code>YES</code> \u5141\u8bb8\u533f\u540d\u8bbf\u95ee\u6a21\u5f0f anon_umask=<code>022</code> \u533f\u540d\u7528\u6237\u4e0a\u4f20\u6587\u4ef6\u7684umask\u503c anon_upload_enable=<code>YES</code> \u5141\u8bb8\u533f\u540d\u7528\u6237\u4e0a\u4f20\u6587\u4ef6 anon_mkdir_write_enable=<code>YES</code> \u5141\u8bb8\u533f\u540d\u7528\u6237\u521b\u5efa\u76ee\u5f55 anon_other_write_enable=<code>YES</code> \u5141\u8bb8\u533f\u540d\u7528\u6237\u4fee\u6539\u76ee\u5f55\u540d\u79f0\u6216\u5220\u9664\u76ee\u5f55 <pre><code>[root@localhost ~]# cat &lt;&lt;EOF&gt;&gt; /etc/vsftpd/vsftpd.conf\n&gt; anon_umask=022\n&gt; anon_upload_enable=YES\n&gt; anon_mkdir_write_enable=YES\n&gt; anon_other_write_enable=YES\n&gt; EOF\n[root@localhost ~]# cat /etc/vsftpd/vsftpd.conf\nanonymous_enable=YES\nlocal_enable=YES\nwrite_enable=YES\nlocal_umask=022\ndirmessage_enable=YES\nxferlog_enable=YES\nconnect_from_port_20=YES\nxferlog_std_format=YES\nlisten=NO\nlisten_ipv6=YES\npam_service_name=vsftpd\nuserlist_enable=YES\ntcp_wrappers=YES\n\nanon_umask=022\nanon_upload_enable=YES\nanon_mkdir_write_enable=YES\nanon_other_write_enable=YES\n[root@localhost ~]# systemctl restart vsftpd\n</code></pre> <p>\u5ba2\u6237\u7aef\u6d4b\u8bd5\uff1a</p> <p>\u533f\u540d\u5f00\u653e\u8ba4\u8bc1\u6a21\u5f0f\u4e0b\uff0c\u5176\u8d26\u6237\u7edf\u4e00\u4e3aanonymous\uff0c\u5bc6\u7801\u4e3a\u7a7a\u3002\u800c\u4e14\u5728\u8fde\u63a5\u5230FTP\u670d\u52a1\u5668\u540e\uff0c\u9ed8\u8ba4\u8bbf\u95ee\u7684\u662f/var/ftp\u76ee\u5f55\u3002</p> <pre><code>[root@client ~]# ftp 192.168.11.130\nConnected to 192.168.11.130 (192.168.11.130).\n220 (vsFTPd 3.0.2)\nName (192.168.11.130:root): anonymous\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp&gt; ls\n227 Entering Passive Mode (192,168,11,130,245,214).\n150 Here comes the directory listing.\ndrwxr-xr-x    2 0        0               6 Oct 30  2018 pub\n226 Directory send OK.\nftp&gt; cd pub\n250 Directory successfully changed.\nftp&gt; mkdir files\n550 Create directory operation failed.\nftp&gt;\n</code></pre> <p>\u7cfb\u7edf\u63d0\u793a\u521b\u5efa\u76ee\u5f55\u64cd\u4f5c\u5931\u8d25\u3002</p> <p>\u67e5\u770b <code>/var/ftp/pub</code> \u76ee\u5f55\u5c5e\u6027\uff0c\u4ee5\u53ca\u5173\u95ed SELinux \u670d\u52a1</p> <pre><code>[root@localhost ~]# ll -ld /var/ftp/\ndrwxr-xr-x. 3 root root 17 7\u6708   1 04:16 /var/ftp/\n[root@localhost ~]# ll -ld /var/ftp/pub/\ndrwxr-xr-x. 3 root root 19 7\u6708   1 05:06 /var/ftp/pub/\n[root@localhost ~]# chown -R ftp /var/ftp/pub/\n[root@localhost ~]# ll -ld /var/ftp/pub/\ndrwxr-xr-x. 3 ftp root 19 7\u6708   1 05:06 /var/ftp/pub/\n[root@localhost ~]# getenforce\nEnforcing\n[root@localhost ~]# setenforce 0\n</code></pre> <p>\u518d\u6b21\u6d4b\u8bd5\u521b\u5efa\u6587\u4ef6</p> <pre><code>ftp&gt; mkdir files\n257 \"/pub/files\" created\nftp&gt; ls\n227 Entering Passive Mode (192,168,11,130,135,155).\n150 Here comes the directory listing.\ndrwxr-xr-x    2 14       50              6 Jun 30 21:06 files\n226 Directory send OK.\nftp&gt;\n</code></pre>"},{"location":"linux/service/ftp/#_3","title":"\u672c\u5730\u7528\u6237\u6a21\u5f0f","text":"<p>\u76f8\u8f83\u4e8e\u533f\u540d\u5f00\u653e\u6a21\u5f0f\uff0c\u672c\u5730\u7528\u6237\u6a21\u5f0f\u8981\u66f4\u5b89\u5168\uff0c\u800c\u4e14\u914d\u7f6e\u8d77\u6765\u4e5f\u5f88\u7b80\u5355\u3002</p> <p>\u672c\u5730\u7528\u6237\u6a21\u5f0f\u4f7f\u7528\u7684\u6743\u9650\u53c2\u6570\u4ee5\u53ca\u4f5c\u7528\uff1a</p> \u53c2\u6570 \u4f5c\u7528 anonymous_enable=<code>NO</code> \u7981\u6b62\u533f\u540d\u8bbf\u95ee\u6a21\u5f0f local_enable=<code>YES</code> \u5141\u8bb8\u672c\u5730\u7528\u6237\u6a21\u5f0f write_enable=<code>YES</code> \u8bbe\u7f6e\u53ef\u5199\u6743\u9650 local_umask=<code>022</code> \u672c\u5730\u7528\u6237\u6a21\u5f0f\u521b\u5efa\u6587\u4ef6\u7684umask\u503c userlist_deny=<code>YES</code> \u542f\u7528\u201c\u7981\u6b62\u7528\u6237\u540d\u5355\u201d\uff0c\u540d\u5355\u6587\u4ef6\u4e3aftpusers\u548cuser_list userlist_enable=<code>YES</code> \u5f00\u542f\u7528\u6237\u4f5c\u7528\u540d\u5355\u6587\u4ef6\u529f\u80fd <p>\u865a\u62df\u673a\u6062\u590d\u9ed8\u8ba4\u5b89\u88c5\u72b6\u6001\u3002</p> <pre><code>[root@localhost ~]# cat &lt;&lt;EOF&gt; /etc/vsftpd/vsftpd.conf\n&gt; anonymous_enable=NO\n&gt; local_enable=YES\n&gt; write_enable=YES\n&gt; local_umask=022\n&gt; dirmessage_enable=YES\n&gt; xferlog_enable=YES\n&gt; connect_from_port_20=YES\n&gt; xferlog_std_format=YES\n&gt; listen=NO\n&gt; listen_ipv6=YES\n&gt; pam_service_name=vsftpd\n&gt; userlist_enable=YES\n&gt; tcp_wrappers=YES\n&gt; EOF\n[root@localhost ~]# cat /etc/vsftpd/vsftpd.conf\nanonymous_enable=NO\nlocal_enable=YES\nwrite_enable=YES\nlocal_umask=022\ndirmessage_enable=YES\nxferlog_enable=YES\nconnect_from_port_20=YES\nxferlog_std_format=YES\nlisten=NO\nlisten_ipv6=YES\npam_service_name=vsftpd\nuserlist_enable=YES\ntcp_wrappers=YES\n[root@localhost ~]# systemctl restart vsftpd\n[root@localhost ~]# systemctl enable vsftpd\nCreated symlink from /etc/systemd/system/multi-user.target.wants/vsftpd.service to /usr/lib/systemd/system/vsftpd.service.\n[root@localhost ~]# firewall-cmd --add-service=ftp --permanent\nsuccess\n[root@localhost ~]# firewall-cmd --reload\nsuccess\n[root@localhost ~]# getenforce\nEnforcing\n[root@localhost ~]#\n</code></pre> <p>\u5ba2\u6237\u7aef\u6d4b\u8bd5\uff1a</p> <pre><code>[root@client ~]# ftp 192.168.11.130\nConnected to 192.168.11.130 (192.168.11.130).\n220 (vsFTPd 3.0.2)\nName (192.168.11.130:root): root\n530 Permission denied.\nLogin failed.\nftp&gt;\n</code></pre> <p>\u7cfb\u7edf\u63d0\u793a\u62d2\u7edd\u8bbf\u95ee\u3002</p> <p>\u8fd9\u662f\u56e0\u4e3a vsftpd \u670d\u52a1\u7a0b\u5e8f\u6240\u5728\u7684\u76ee\u5f55\u4e2d\u9ed8\u8ba4\u5b58\u653e\u7740\u4e24\u4e2a\u540d\u4e3a\u201c\u7528\u6237\u540d\u5355\u201d\u7684\u6587\u4ef6 <code>ftpusers</code> \u548c <code>user_list</code>:</p> <pre><code>[root@localhost ~]# cat /etc/vsftpd/ftpusers\n# Users that are not allowed to login via ftp\nroot\nbin\ndaemon\nadm\nlp\nsync\nshutdown\nhalt\nmail\nnews\nuucp\noperator\ngames\nnobody\n[root@localhost ~]# cat /etc/vsftpd/user_list\n# vsftpd userlist\n# If userlist_deny=NO, only allow users in this file\n# If userlist_deny=YES (default), never allow users in this file, and\n# do not even prompt for a password.\n# Note that the default vsftpd pam config also checks /etc/vsftpd/ftpusers\n# for users that are denied.\nroot\nbin\ndaemon\nadm\nlp\nsync\nshutdown\nhalt\nmail\nnews\nuucp\noperator\ngames\nnobody\n[root@localhost ~]#\n</code></pre> <p>vsftpd\u670d\u52a1\u7a0b\u5e8f\u4e3a\u4e86\u4fdd\u8bc1\u670d\u52a1\u5668\u7684\u5b89\u5168\u6027\u800c\u9ed8\u8ba4\u7981\u6b62\u4e86root\u7ba1\u7406\u5458\u548c\u5927\u591a\u6570\u7cfb\u7edf\u7528\u6237\u7684\u767b\u5f55\u884c\u4e3a\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u9009\u62e9ftpusers\u548cuser_list\u6587\u4ef6\u4e2d\u6ca1\u6709\u7684\u4e00\u4e2a\u666e\u901a\u7528\u6237\u5c1d\u8bd5\u767b\u5f55FTP\u670d\u52a1\u5668\uff1a</p> <pre><code>[root@client ~]# ftp 192.168.11.130\nConnected to 192.168.11.130 (192.168.11.130).\n220 (vsFTPd 3.0.2)\nName (192.168.11.130:root): jangrui\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp&gt; ls\n227 Entering Passive Mode (192,168,11,130,84,105).\n150 Here comes the directory listing.\n226 Directory send OK.\nftp&gt; mkdir 123\n257 \"/home/jangrui/123\" created\nftp&gt; ls\n227 Entering Passive Mode (192,168,11,130,135,156).\n150 Here comes the directory listing.\ndrwxr-xr-x    2 1000     1000            6 Jun 30 20:34 123\n226 Directory send OK.\nftp&gt;\n</code></pre> <p>\u91c7\u7528\u672c\u5730\u7528\u6237\u6a21\u5f0f\u767b\u5f55FTP\u670d\u52a1\u5668\u540e\uff0c\u9ed8\u8ba4\u8bbf\u95ee\u7684\u662f\u8be5\u7528\u6237\u7684\u5bb6\u76ee\u5f55</p>"},{"location":"linux/service/ftp/#_4","title":"\u865a\u62df\u7528\u6237\u6a21\u5f0f","text":"<p>\u865a\u62df\u7528\u6237\u662fFTP\u670d\u52a1\u5668\u7684\u4e13\u6709\u7528\u6237\uff0c\u4f7f\u7528\u865a\u62df\u7528\u6237\u767b\u5f55FTP\uff0c\u53ea\u80fd\u8bbf\u95eeFTP\u670d\u52a1\u5668\u63d0\u4f9b\u7684\u8d44\u6e90\uff0c\u5927\u5927\u589e\u5f3a\u4e86\u7cfb\u7edf\u7684\u5b89\u5168\u3002</p> <p>\u6709\u4e24\u79cd\u65b9\u5f0f\u5b9e\u73b0\u865a\u62df\u7528\u6237\uff0c\u672c\u5730\u6570\u636e\u6587\u4ef6\u548c\u6570\u636e\u5e93\u670d\u52a1\u5668\u3002</p> <p>\u865a\u62df\u673a\u6062\u590d\u9ed8\u8ba4\u5b89\u88c5\u72b6\u6001\u3002</p>"},{"location":"linux/service/ftp/#_5","title":"\u672c\u5730\u6570\u636e\u6587\u4ef6\u65b9\u5f0f","text":"<p>1\u3001 \u6dfb\u52a0\u865a\u62df\u7528\u6237\u540d\u548c\u5bc6\u7801\uff0c\u4e00\u884c\u7528\u6237\u540d\uff0c\u4e00\u884c\u5bc6\u7801\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u5947\u6570\u884c\u4e3a\u7528\u6237\u540d\uff0c\u5076\u6570\u884c\u4e3a\u5bc6\u7801\u3002</p> <pre><code>[root@localhost ~]# cat &lt;&lt;end&gt; /etc/vsftpd/vsftpduser.txt\n&gt; userone\n&gt; passwdone\n&gt; usertwo\n&gt; passwdtwo\n&gt; end\n[root@localhost ~]#\n</code></pre> <p>2\u3001 \u751f\u6210\u865a\u62df\u7528\u6237\u53e3\u4ee4\u8ba4\u8bc1\u6587\u4ef6</p> <p>\u660e\u6587\u4fe1\u606f\u65e2\u4e0d\u5b89\u5168\uff0c\u4e5f\u4e0d\u7b26\u5408\u8ba9vsftpd\u670d\u52a1\u7a0b\u5e8f\u76f4\u63a5\u52a0\u8f7d\u7684\u683c\u5f0f\uff0c\u56e0\u6b64\u9700\u8981\u4f7f\u7528db_load\u547d\u4ee4\u7528\u54c8\u5e0c\uff08hash\uff09\u7b97\u6cd5\u5c06\u539f\u59cb\u7684\u660e\u6587\u4fe1\u606f\u6587\u4ef6\u8f6c\u6362\u6210\u6570\u636e\u5e93\u6587\u4ef6\uff0c\u5e76\u4e14\u964d\u4f4e\u6570\u636e\u5e93\u6587\u4ef6\u7684\u6743\u9650\uff08\u907f\u514d\u5176\u4ed6\u4eba\u770b\u5230\u6570\u636e\u5e93\u6587\u4ef6\u7684\u5185\u5bb9\uff09\uff0c\u7136\u540e\u518d\u628a\u539f\u59cb\u7684\u660e\u6587\u4fe1\u606f\u6587\u4ef6\u5220\u9664\u3002</p> <pre><code>[root@localhost ~]# db_load -T -t hash -f /etc/vsftpd/vsftpduser.txt /etc/vsftpd/vsftpduser.db\n[root@localhost ~]#\n</code></pre> <p>3\u3001 \u521b\u5efa vsftpd \u7684 PAM \u8ba4\u8bc1\u6587\u4ef6</p> <pre><code>[root@localhost ~]# cat &lt;&lt;end&gt; /etc/pam.d/vsftpd.vuser\n&gt; auth required /lib/security/pam_userdb.so db=/etc/vsftpd/vsftpduser\n&gt; account required /lib/security/pam_userdb.so db=/etc/vsftpd/vsftpduser\n&gt; end\n[root@localhost ~]# cat /etc/pam.d/vsftpd.vuser\nauth required /lib/security/pam_userdb.so db=/etc/vsftpd/vsftpduser\naccount required /lib/security/pam_userdb.so db=/etc/vsftpd/vsftpduser\n[root@localhost ~]#\n</code></pre> <p>4\u3001 \u5efa\u7acb\u672c\u5730\u6620\u5c04\u7528\u6237\u5e76\u8bbe\u7f6e\u5bbf\u4e3b\u76ee\u5f55\u6743\u9650</p> <p>\u521b\u5efa\u4e00\u4e2a\u53ef\u4ee5\u6620\u5c04\u5230\u865a\u62df\u7528\u6237\u7684\u7cfb\u7edf\u672c\u5730\u7528\u6237\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u8ba9\u865a\u62df\u7528\u6237\u9ed8\u8ba4\u767b\u5f55\u5230\u4e0e\u4e4b\u6709\u6620\u5c04\u5173\u7cfb\u7684\u8fd9\u4e2a\u7cfb\u7edf\u672c\u5730\u7528\u6237\u7684\u5bb6\u76ee\u5f55\u4e2d\uff0c\u865a\u62df\u7528\u6237\u521b\u5efa\u7684\u6587\u4ef6\u7684\u5c5e\u6027\u4e5f\u90fd\u5f52\u5c5e\u4e8e\u8fd9\u4e2a\u7cfb\u7edf\u672c\u5730\u7528\u6237\uff0c\u4ece\u800c\u907f\u514dLinux\u7cfb\u7edf\u65e0\u6cd5\u5904\u7406\u865a\u62df\u7528\u6237\u6240\u521b\u5efa\u6587\u4ef6\u7684\u5c5e\u6027\u6743\u9650\u3002</p> <pre><code>[root@localhost ~]# id vsftpuser\nid: vsftpuser: no such user\n[root@localhost ~]# useradd -s /sbin/nologin vsftpuser\n[root@localhost ~]# ll -ld /home/vsftpuser/\ndrwx------. 2 vsftpuser vsftpuser 62 7\u6708   1 05:01 /home/vsftpuser/\n[root@localhost ~]# chmod -R 755 /home/vsftpuser/\n[root@localhost ~]#\n</code></pre> <p>5\u3001 \u8bbe\u7f6e\u865a\u62df\u7528\u6237\u8ba4\u8bc1</p> <p>\u5728 vsftpd \u670d\u52a1\u7a0b\u5e8f\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\u4e2d\u901a\u8fc7 pam_service_name \u53c2\u6570\u5c06 PAM \u8ba4\u8bc1\u6587\u4ef6\u7684\u540d\u79f0\u4fee\u6539\u4e3a vsftpd.vuser\u3002</p> <p>\u5229\u7528 PAM \u6587\u4ef6\u8fdb\u884c\u8ba4\u8bc1\u65f6\u4f7f\u7528\u7684\u53c2\u6570\u4ee5\u53ca\u4f5c\u7528\uff1a</p> \u53c2\u6570 \u4f5c\u7528 anonymous_enable=<code>NO</code> \u7981\u6b62\u533f\u540d\u5f00\u653e\u6a21\u5f0f local_enable=<code>YES</code> \u5141\u8bb8\u672c\u5730\u7528\u6237\u6a21\u5f0f guest_enable=<code>YES</code> \u5f00\u542f\u865a\u62df\u7528\u6237\u6a21\u5f0f guest_username=<code>virtual</code> \u6307\u5b9a\u865a\u62df\u7528\u6237\u8d26\u6237 pam_service_name=<code>vsftpd.vu</code> \u6307\u5b9aPAM\u6587\u4ef6 allow_writeable_chroot=<code>YES</code> \u5141\u8bb8\u5bf9\u7981\u9522\u7684FTP\u6839\u76ee\u5f55\u6267\u884c\u5199\u5165\u64cd\u4f5c\uff0c\u800c\u4e14\u4e0d\u62d2\u7edd\u7528\u6237\u7684\u767b\u5f55\u8bf7\u6c42 <pre><code>[root@localhost ~]# cat &lt;&lt;end&gt; /etc/vsftpd/vsftpd.conf\n&gt; anonymous_enable=NO\n&gt; local_enable=YES\n&gt; guest_enable=YES\n&gt; guest_username=vsftpuser\n&gt; allow_writeable_chroot=YES\n&gt; write_enable=YES\n&gt; local_umask=022\n&gt; dirmessage_enable=YES\n&gt; xferlog_enable=YES\n&gt; connect_from_port_20=YES\n&gt; xferlog_std_format=YES\n&gt; listen=NO\n&gt; listen_ipv6=YES\n&gt; pam_service_name=vsftpd.vuser\n&gt; userlist_enable=YES\n&gt; tcp_wrappers=YES\n&gt; end\n[root@localhost ~]# systemctl restart vsftpd\n[root@localhost ~]# firewall-cmd --add-service=ftp --permanent\nsuccess\n[root@localhost ~]# firewall-cmd --reload\nsuccess\n[root@localhost ~]# getenforce\nEnforcing\n[root@localhost ~]#\n</code></pre> <p>\u5ba2\u6237\u7aef\u6d4b\u8bd5\uff1a</p> <pre><code>[root@client ~]# ftp 192.168.11.130\nConnected to 192.168.11.130 (192.168.11.130).\n220 (vsFTPd 3.0.2)\nName (192.168.11.130:root): userone\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp&gt;\n</code></pre> <p>6\u3001 \u4e3a\u865a\u62df\u7528\u6237\u8bbe\u7f6e\u4e0d\u540c\u7684\u6743\u9650\u3002</p> <pre><code>[root@localhost ~]# mkdir /etc/vsftpd/vsftpuser\n[root@localhost ~]# cat &lt;&lt;end&gt; /etc/vsftpd/vsftpuser/userone\n&gt; anon_upload_enable=YES\n&gt; anon_mkdir_write_enable=YES\n&gt; anon_other_write_enable=YES\n&gt; end\n[root@localhost ~]# touch /etc/vsftpd/vsftpuser/usertwo\n[root@localhost ~]# cat &lt;&lt;end&gt;&gt; /etc/vsftpd/vsftpd.conf\n&gt; user_config_dir=/etc/vsftpd/vsftpuser\n&gt; end\n[root@localhost ~]# systemctl restart vsftpd\n[root@localhost ~]#\n</code></pre> <p>\u5ba2\u6237\u7aef\u6d4b\u8bd5\uff1a</p> <pre><code>[root@client ~]# ftp 192.168.11.130\nConnected to 192.168.11.130 (192.168.11.130).\n220 (vsFTPd 3.0.2)\nName (192.168.11.130:root): userone\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp&gt; ls\n227 Entering Passive Mode (192,168,11,130,233,3).\n150 Here comes the directory listing.\n226 Directory send OK.\nftp&gt; mkdir one\n257 \"/one\" created\nftp&gt; exit\n221 Goodbye.\n[root@client ~]# ftp 192.168.11.130\nConnected to 192.168.11.130 (192.168.11.130).\n220 (vsFTPd 3.0.2)\nName (192.168.11.130:root): usertwo\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp&gt; ls\n227 Entering Passive Mode (192,168,11,130,102,90).\n150 Here comes the directory listing.\ndrwx------    2 1001     1001            6 Jun 30 20:40 one\n226 Directory send OK.\nftp&gt; mkdir two\n550 Permission denied.\nftp&gt;\n</code></pre>"},{"location":"linux/service/ftp/#_6","title":"\u6570\u636e\u5e93\u670d\u52a1\u8ba4\u8bc1\u65b9\u5f0f","text":"<p>\u4ee5 mariadb \u4e3a\u4f8b\uff1a</p> <p>\u865a\u62df\u673a\u6062\u590d\u9ed8\u8ba4\u5b89\u88c5\u72b6\u6001\u3002</p> <p>1\u3001 \u5b89\u88c5 mariadb \u4ee5\u53ca vsftpd</p> <pre><code>[root@localhost ~]# yum install -y mariadb-server.x86_64 vsftpd\n\u5df2\u52a0\u8f7d\u63d2\u4ef6\uff1afastestmirror\nLoading mirror speeds from cached hostfile\n * base: centos.ustc.edu.cn\n * extras: mirrors.163.com\n * updates: mirrors.163.com\n\u6b63\u5728\u89e3\u51b3\u4f9d\u8d56\u5173\u7cfb\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 mariadb-server.x86_64.1.5.5.60-1.el7_5 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb mariadb(x86-64) = 1:5.5.60-1.el7_5\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 1:mariadb-server-5.5.60-1.el7_5.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb perl-DBI\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 1:mariadb-server-5.5.60-1.el7_5.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb perl-DBD-MySQL\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 1:mariadb-server-5.5.60-1.el7_5.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb perl(DBI)\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 1:mariadb-server-5.5.60-1.el7_5.x86_64 \u9700\u8981\n---&gt; \u8f6f\u4ef6\u5305 vsftpd.x86_64.0.3.0.2-25.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 mariadb.x86_64.1.5.5.60-1.el7_5 \u5c06\u88ab \u5b89\u88c5\n---&gt; \u8f6f\u4ef6\u5305 perl-DBD-MySQL.x86_64.0.4.023-6.el7 \u5c06\u88ab \u5b89\u88c5\n---&gt; \u8f6f\u4ef6\u5305 perl-DBI.x86_64.0.1.627-4.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb perl(RPC::PlServer) &gt;= 0.2001\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 perl-DBI-1.627-4.el7.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb perl(RPC::PlClient) &gt;= 0.2000\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 perl-DBI-1.627-4.el7.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 perl-PlRPC.noarch.0.0.2020-14.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb perl(Net::Daemon) &gt;= 0.13\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 perl-PlRPC-0.2020-14.el7.noarch \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb perl(Net::Daemon::Test)\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 perl-PlRPC-0.2020-14.el7.noarch \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb perl(Net::Daemon::Log)\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 perl-PlRPC-0.2020-14.el7.noarch \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb perl(Compress::Zlib)\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 perl-PlRPC-0.2020-14.el7.noarch \u9700\u8981\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 perl-IO-Compress.noarch.0.2.061-2.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb perl(Compress::Raw::Zlib) &gt;= 2.061\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 perl-IO-Compress-2.061-2.el7.noarch \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb perl(Compress::Raw::Bzip2) &gt;= 2.061\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 perl-IO-Compress-2.061-2.el7.noarch \u9700\u8981\n---&gt; \u8f6f\u4ef6\u5305 perl-Net-Daemon.noarch.0.0.48-5.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 perl-Compress-Raw-Bzip2.x86_64.0.2.061-3.el7 \u5c06\u88ab \u5b89\u88c5\n---&gt; \u8f6f\u4ef6\u5305 perl-Compress-Raw-Zlib.x86_64.1.2.061-4.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u89e3\u51b3\u4f9d\u8d56\u5173\u7cfb\u5b8c\u6210\n\n\u4f9d\u8d56\u5173\u7cfb\u89e3\u51b3\n\n===============================================================================================================\n Package                             \u67b6\u6784               \u7248\u672c                            \u6e90                \u5927\u5c0f\n===============================================================================================================\n\u6b63\u5728\u5b89\u88c5:\n mariadb-server                      x86_64             1:5.5.60-1.el7_5                base              11 M\n vsftpd                              x86_64             3.0.2-25.el7                    base             171 k\n\u4e3a\u4f9d\u8d56\u800c\u5b89\u88c5:\n mariadb                             x86_64             1:5.5.60-1.el7_5                base             8.9 M\n perl-Compress-Raw-Bzip2             x86_64             2.061-3.el7                     base              32 k\n perl-Compress-Raw-Zlib              x86_64             1:2.061-4.el7                   base              57 k\n perl-DBD-MySQL                      x86_64             4.023-6.el7                     base             140 k\n perl-DBI                            x86_64             1.627-4.el7                     base             802 k\n perl-IO-Compress                    noarch             2.061-2.el7                     base             260 k\n perl-Net-Daemon                     noarch             0.48-5.el7                      base              51 k\n perl-PlRPC                          noarch             0.2020-14.el7                   base              36 k\n\n\u4e8b\u52a1\u6982\u8981\n===============================================================================================================\n\u5b89\u88c5  2 \u8f6f\u4ef6\u5305 (+8 \u4f9d\u8d56\u8f6f\u4ef6\u5305)\n\n\u603b\u4e0b\u8f7d\u91cf\uff1a21 M\n\u5b89\u88c5\u5927\u5c0f\uff1a111 M\nDownloading packages:\n(1/10): perl-Compress-Raw-Bzip2-2.061-3.el7.x86_64.rpm                                  |  32 kB  00:00:00\n(2/10): perl-Compress-Raw-Zlib-2.061-4.el7.x86_64.rpm                                   |  57 kB  00:00:00\n(3/10): perl-DBD-MySQL-4.023-6.el7.x86_64.rpm                                           | 140 kB  00:00:00\n(4/10): perl-Net-Daemon-0.48-5.el7.noarch.rpm                                           |  51 kB  00:00:00\n(5/10): perl-PlRPC-0.2020-14.el7.noarch.rpm                                             |  36 kB  00:00:00\n(6/10): perl-IO-Compress-2.061-2.el7.noarch.rpm                                         | 260 kB  00:00:00\n(7/10): perl-DBI-1.627-4.el7.x86_64.rpm                                                 | 802 kB  00:00:00\n(8/10): vsftpd-3.0.2-25.el7.x86_64.rpm                                                  | 171 kB  00:00:01\n(9/10): mariadb-server-5.5.60-1.el7_5.x86_64.rpm                                        |  11 MB  00:00:02\n(10/10): mariadb-5.5.60-1.el7_5.x86_64.rpm                                              | 8.9 MB  00:00:03\n---------------------------------------------------------------------------------------------------------------\n\u603b\u8ba1                                                                           6.7 MB/s |  21 MB  00:00:03\nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  \u6b63\u5728\u5b89\u88c5    : perl-Compress-Raw-Bzip2-2.061-3.el7.x86_64                                                1/10\n  \u6b63\u5728\u5b89\u88c5    : 1:mariadb-5.5.60-1.el7_5.x86_64                                                           2/10\n  \u6b63\u5728\u5b89\u88c5    : 1:perl-Compress-Raw-Zlib-2.061-4.el7.x86_64                                               3/10\n  \u6b63\u5728\u5b89\u88c5    : perl-IO-Compress-2.061-2.el7.noarch                                                       4/10\n  \u6b63\u5728\u5b89\u88c5    : perl-Net-Daemon-0.48-5.el7.noarch                                                         5/10\n  \u6b63\u5728\u5b89\u88c5    : perl-PlRPC-0.2020-14.el7.noarch                                                           6/10\n  \u6b63\u5728\u5b89\u88c5    : perl-DBI-1.627-4.el7.x86_64                                                               7/10\n  \u6b63\u5728\u5b89\u88c5    : perl-DBD-MySQL-4.023-6.el7.x86_64                                                         8/10\n  \u6b63\u5728\u5b89\u88c5    : 1:mariadb-server-5.5.60-1.el7_5.x86_64                                                    9/10\n  \u6b63\u5728\u5b89\u88c5    : vsftpd-3.0.2-25.el7.x86_64                                                               10/10\n  \u9a8c\u8bc1\u4e2d      : 1:mariadb-server-5.5.60-1.el7_5.x86_64                                                    1/10\n  \u9a8c\u8bc1\u4e2d      : vsftpd-3.0.2-25.el7.x86_64                                                                2/10\n  \u9a8c\u8bc1\u4e2d      : perl-Net-Daemon-0.48-5.el7.noarch                                                         3/10\n  \u9a8c\u8bc1\u4e2d      : perl-DBD-MySQL-4.023-6.el7.x86_64                                                         4/10\n  \u9a8c\u8bc1\u4e2d      : perl-IO-Compress-2.061-2.el7.noarch                                                       5/10\n  \u9a8c\u8bc1\u4e2d      : 1:perl-Compress-Raw-Zlib-2.061-4.el7.x86_64                                               6/10\n  \u9a8c\u8bc1\u4e2d      : 1:mariadb-5.5.60-1.el7_5.x86_64                                                           7/10\n  \u9a8c\u8bc1\u4e2d      : perl-DBI-1.627-4.el7.x86_64                                                               8/10\n  \u9a8c\u8bc1\u4e2d      : perl-Compress-Raw-Bzip2-2.061-3.el7.x86_64                                                9/10\n  \u9a8c\u8bc1\u4e2d      : perl-PlRPC-0.2020-14.el7.noarch                                                          10/10\n\n\u5df2\u5b89\u88c5:\n  mariadb-server.x86_64 1:5.5.60-1.el7_5                      vsftpd.x86_64 0:3.0.2-25.el7\n\n\u4f5c\u4e3a\u4f9d\u8d56\u88ab\u5b89\u88c5:\n  mariadb.x86_64 1:5.5.60-1.el7_5                       perl-Compress-Raw-Bzip2.x86_64 0:2.061-3.el7\n  perl-Compress-Raw-Zlib.x86_64 1:2.061-4.el7           perl-DBD-MySQL.x86_64 0:4.023-6.el7\n  perl-DBI.x86_64 0:1.627-4.el7                         perl-IO-Compress.noarch 0:2.061-2.el7\n  perl-Net-Daemon.noarch 0:0.48-5.el7                   perl-PlRPC.noarch 0:0.2020-14.el7\n\n\u5b8c\u6bd5\uff01\n[root@localhost ~]# systemctl start mariadb.service vsftpd\n[root@localhost ~]#\n</code></pre> <p>2\u3001 \u5efa\u7acb\u7528\u6237\u53e3\u4ee4\u6570\u636e\u5e93</p> <pre><code>[root@localhost ~]# mysql -uroot -p\nEnter password:\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 3\nServer version: 5.5.60-MariaDB MariaDB Server\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [(none)]&gt; create database vsftpuser;\nQuery OK, 1 row affected (0.00 sec)\n\nMariaDB [(none)]&gt; use vsftpuser;\nDatabase changed\nMariaDB [vsftpuser]&gt; create table users(name char(16) binary, passwd char(16) binary);\nQuery OK, 0 rows affected (0.00 sec)\n\nMariaDB [vsftpuser]&gt; insert into users(name, passwd) values('userone',password('passwdone'));\nQuery OK, 1 row affected, 1 warning (0.00 sec)\n\nMariaDB [vsftpuser]&gt; insert into users(name,passwd) values('usertwo',password('passwdtwo'));\nQuery OK, 1 row affected, 1 warning (0.00 sec)\n\nMariaDB [vsftpuser]&gt; grant select on vsftpuser.users to vsftpuser@'192.168.11.%' identified by 'vsftppasswd';\nQuery OK, 0 rows affected (0.00 sec)\n\nMariaDB [vsftpuser]&gt; flush privileges;\nQuery OK, 0 rows affected (0.01 sec)\n\nMariaDB [vsftpuser]&gt; show tables;\n+---------------------+\n| Tables_in_vsftpuser |\n+---------------------+\n| users               |\n+---------------------+\n1 row in set (0.00 sec)\n\nMariaDB [vsftpuser]&gt; select * from users;\n+---------+------------------+\n| name    | passwd           |\n+---------+------------------+\n| userone | *6336F1A3C79741C |\n| usertwo | *804FA602F20405D |\n+---------+------------------+\n2 rows in set (0.00 sec)\n\nMariaDB [vsftpuser]&gt; exit\nBye\n[root@localhost ~]#\n</code></pre> <p>\u7531\u4e8emariadb\u7684\u5b89\u88c5\u65b9\u5f0f\u4e0d\u540c\uff0cpam_mysql.so\u57fa\u4e8eunix sock\u8fde\u63a5mariadb\u670d\u52a1\u5668\u65f6\u53ef\u80fd\u4f1a\u51fa\u95ee\u9898\uff0c\u53ef\u6388\u6743\u4e00\u4e2a\u53ef\u8fdc\u7a0b\u8fde\u63a5\u7684mariadb\u5e76\u8bbf\u95eevsftpd\u6570\u636e\u5e93\u7684\u7528\u6237\u3002</p> <p>3\u3001 \u5b89\u88c5 pam_mysql \u8ba4\u8bc1\u6a21\u5757</p> <p>\u67e5\u770b <code>/lib64/security</code> \u76ee\u5f55\u4e0b\u6709\u6ca1\u6709 mysql \u5bf9\u5e94\u7684 pam \u6a21\u5757</p> <pre><code>[root@localhost ~]# ll /lib64/security/ |grep mysql\n[root@localhost ~]#\n</code></pre> <p>\u5b89\u88c5 pam_myslq\uff1a</p> <pre><code>[root@localhost ~]# wget \"ftp://ftp.pbone.net/mirror/archive.fedoraproject.org/fedora-secondary/releases/23/Everything/source/SRPMS/p/pam_mysql-0.7-0.20.rc1.fc23.src.rpm\"\n--2019-07-01 05:41:52--  ftp://ftp.pbone.net/mirror/archive.fedoraproject.org/fedora-secondary/releases/23/Everything/source/SRPMS/p/pam_mysql-0.7-0.20.rc1.fc23.src.rpm\n           =&gt; \u201cpam_mysql-0.7-0.20.rc1.fc23.src.rpm.1\u201d\n\u6b63\u5728\u89e3\u6790\u4e3b\u673a ftp.pbone.net (ftp.pbone.net)... 93.179.225.212\n\u6b63\u5728\u8fde\u63a5 ftp.pbone.net (ftp.pbone.net)|93.179.225.212|:21... \u5df2\u8fde\u63a5\u3002\n\u6b63\u5728\u4ee5 anonymous \u767b\u5f55 ... \u767b\u5f55\u6210\u529f\uff01\n==&gt; SYST ... \u5b8c\u6210\u3002   ==&gt; PWD ... \u5b8c\u6210\u3002\n==&gt; TYPE I ... \u5b8c\u6210\u3002 ==&gt; CWD (1) /mirror/archive.fedoraproject.org/fedora-secondary/releases/23/Everything/source/SRPMS/p ... \u5b8c\u6210\u3002\n==&gt; SIZE pam_mysql-0.7-0.20.rc1.fc23.src.rpm ... 348672\n==&gt; PASV ... \u5b8c\u6210\u3002   ==&gt; RETR pam_mysql-0.7-0.20.rc1.fc23.src.rpm ... \u5b8c\u6210\u3002\n\u957f\u5ea6\uff1a348672 (340K) (\u975e\u6b63\u5f0f\u6570\u636e)\n\n100%[=====================================================================&gt;] 348,672     5.98KB/s \u7528\u65f6 43s\n\n2019-07-01 05:42:40 (7.85 KB/s) - \u201cpam_mysql-0.7-0.20.rc1.fc23.src.rpm.1\u201d \u5df2\u4fdd\u5b58 [348672]\n\n[root@localhost ~]# yum install -y make gcc-c++ autoconf automake libtool rpm-build pam-devel mysql-devel openssl-devel cyrus-sasl-devel\n\u5df2\u52a0\u8f7d\u63d2\u4ef6\uff1afastestmirror\nLoading mirror speeds from cached hostfile\n * base: centos.ustc.edu.cn\n * extras: mirrors.163.com\n * updates: mirrors.163.com\n\u8f6f\u4ef6\u5305 1:make-3.82-23.el7.x86_64 \u5df2\u5b89\u88c5\u5e76\u4e14\u662f\u6700\u65b0\u7248\u672c\n\u8f6f\u4ef6\u5305 gcc-c++-4.8.5-36.el7_6.2.x86_64 \u5df2\u5b89\u88c5\u5e76\u4e14\u662f\u6700\u65b0\u7248\u672c\n\u8f6f\u4ef6\u5305 autoconf-2.69-11.el7.noarch \u5df2\u5b89\u88c5\u5e76\u4e14\u662f\u6700\u65b0\u7248\u672c\n\u8f6f\u4ef6\u5305 automake-1.13.4-3.el7.noarch \u5df2\u5b89\u88c5\u5e76\u4e14\u662f\u6700\u65b0\u7248\u672c\n\u8f6f\u4ef6\u5305 libtool-2.4.2-22.el7_3.x86_64 \u5df2\u5b89\u88c5\u5e76\u4e14\u662f\u6700\u65b0\u7248\u672c\n\u8f6f\u4ef6\u5305 rpm-build-4.11.3-35.el7.x86_64 \u5df2\u5b89\u88c5\u5e76\u4e14\u662f\u6700\u65b0\u7248\u672c\n\u6b63\u5728\u89e3\u51b3\u4f9d\u8d56\u5173\u7cfb\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 cyrus-sasl-devel.x86_64.0.2.1.26-23.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb cyrus-sasl(x86-64) = 2.1.26-23.el7\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 cyrus-sasl-devel-2.1.26-23.el7.x86_64 \u9700\u8981\n---&gt; \u8f6f\u4ef6\u5305 mariadb-devel.x86_64.1.5.5.60-1.el7_5 \u5c06\u88ab \u5b89\u88c5\n---&gt; \u8f6f\u4ef6\u5305 openssl-devel.x86_64.1.1.0.2k-16.el7_6.1 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb zlib-devel(x86-64)\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 1:openssl-devel-1.0.2k-16.el7_6.1.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb krb5-devel(x86-64)\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 1:openssl-devel-1.0.2k-16.el7_6.1.x86_64 \u9700\u8981\n---&gt; \u8f6f\u4ef6\u5305 pam-devel.x86_64.0.1.1.8-22.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 cyrus-sasl.x86_64.0.2.1.26-23.el7 \u5c06\u88ab \u5b89\u88c5\n---&gt; \u8f6f\u4ef6\u5305 krb5-devel.x86_64.0.1.15.1-37.el7_6 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb libkadm5(x86-64) = 1.15.1-37.el7_6\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 krb5-devel-1.15.1-37.el7_6.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb libverto-devel\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 krb5-devel-1.15.1-37.el7_6.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb libselinux-devel\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 krb5-devel-1.15.1-37.el7_6.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb libcom_err-devel\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 krb5-devel-1.15.1-37.el7_6.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb keyutils-libs-devel\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 krb5-devel-1.15.1-37.el7_6.x86_64 \u9700\u8981\n---&gt; \u8f6f\u4ef6\u5305 zlib-devel.x86_64.0.1.2.7-18.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 keyutils-libs-devel.x86_64.0.1.5.8-3.el7 \u5c06\u88ab \u5b89\u88c5\n---&gt; \u8f6f\u4ef6\u5305 libcom_err-devel.x86_64.0.1.42.9-13.el7 \u5c06\u88ab \u5b89\u88c5\n---&gt; \u8f6f\u4ef6\u5305 libkadm5.x86_64.0.1.15.1-37.el7_6 \u5c06\u88ab \u5b89\u88c5\n---&gt; \u8f6f\u4ef6\u5305 libselinux-devel.x86_64.0.2.5-14.1.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb libsepol-devel(x86-64) &gt;= 2.5-10\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 libselinux-devel-2.5-14.1.el7.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb pkgconfig(libsepol)\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 libselinux-devel-2.5-14.1.el7.x86_64 \u9700\u8981\n--&gt; \u6b63\u5728\u5904\u7406\u4f9d\u8d56\u5173\u7cfb pkgconfig(libpcre)\uff0c\u5b83\u88ab\u8f6f\u4ef6\u5305 libselinux-devel-2.5-14.1.el7.x86_64 \u9700\u8981\n---&gt; \u8f6f\u4ef6\u5305 libverto-devel.x86_64.0.0.2.5-4.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 libsepol-devel.x86_64.0.2.5-10.el7 \u5c06\u88ab \u5b89\u88c5\n---&gt; \u8f6f\u4ef6\u5305 pcre-devel.x86_64.0.8.32-17.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u89e3\u51b3\u4f9d\u8d56\u5173\u7cfb\u5b8c\u6210\n\n\u4f9d\u8d56\u5173\u7cfb\u89e3\u51b3\n\n================================================================================================================================================================================\n Package                                         \u67b6\u6784                               \u7248\u672c                                              \u6e90                                   \u5927\u5c0f\n================================================================================================================================================================================\n\u6b63\u5728\u5b89\u88c5:\n cyrus-sasl-devel                                x86_64                             2.1.26-23.el7                                     base                                310 k\n mariadb-devel                                   x86_64                             1:5.5.60-1.el7_5                                  base                                754 k\n openssl-devel                                   x86_64                             1:1.0.2k-16.el7_6.1                               updates                             1.5 M\n pam-devel                                       x86_64                             1.1.8-22.el7                                      base                                184 k\n\u4e3a\u4f9d\u8d56\u800c\u5b89\u88c5:\n cyrus-sasl                                      x86_64                             2.1.26-23.el7                                     base                                 88 k\n keyutils-libs-devel                             x86_64                             1.5.8-3.el7                                       base                                 37 k\n krb5-devel                                      x86_64                             1.15.1-37.el7_6                                   updates                             271 k\n libcom_err-devel                                x86_64                             1.42.9-13.el7                                     base                                 31 k\n libkadm5                                        x86_64                             1.15.1-37.el7_6                                   updates                             178 k\n libselinux-devel                                x86_64                             2.5-14.1.el7                                      base                                187 k\n libsepol-devel                                  x86_64                             2.5-10.el7                                        base                                 77 k\n libverto-devel                                  x86_64                             0.2.5-4.el7                                       base                                 12 k\n pcre-devel                                      x86_64                             8.32-17.el7                                       base                                480 k\n zlib-devel                                      x86_64                             1.2.7-18.el7                                      base                                 50 k\n\n\u4e8b\u52a1\u6982\u8981\n================================================================================================================================================================================\n\u5b89\u88c5  4 \u8f6f\u4ef6\u5305 (+10 \u4f9d\u8d56\u8f6f\u4ef6\u5305)\n\n\u603b\u4e0b\u8f7d\u91cf\uff1a4.1 M\n\u5b89\u88c5\u5927\u5c0f\uff1a11 M\nDownloading packages:\n(1/14): keyutils-libs-devel-1.5.8-3.el7.x86_64.rpm                                                                                                       |  37 kB  00:00:00\n(2/14): libcom_err-devel-1.42.9-13.el7.x86_64.rpm                                                                                                        |  31 kB  00:00:00\n(3/14): cyrus-sasl-2.1.26-23.el7.x86_64.rpm                                                                                                              |  88 kB  00:00:00\n(4/14): libselinux-devel-2.5-14.1.el7.x86_64.rpm                                                                                                         | 187 kB  00:00:00\n(5/14): libverto-devel-0.2.5-4.el7.x86_64.rpm                                                                                                            |  12 kB  00:00:00\n(6/14): cyrus-sasl-devel-2.1.26-23.el7.x86_64.rpm                                                                                                        | 310 kB  00:00:00\n(7/14): mariadb-devel-5.5.60-1.el7_5.x86_64.rpm                                                                                                          | 754 kB  00:00:00\n(8/14): libsepol-devel-2.5-10.el7.x86_64.rpm                                                                                                             |  77 kB  00:00:00\n(9/14): libkadm5-1.15.1-37.el7_6.x86_64.rpm                                                                                                              | 178 kB  00:00:00\n(10/14): zlib-devel-1.2.7-18.el7.x86_64.rpm                                                                                                              |  50 kB  00:00:00\n(11/14): krb5-devel-1.15.1-37.el7_6.x86_64.rpm                                                                                                           | 271 kB  00:00:01\n(12/14): pam-devel-1.1.8-22.el7.x86_64.rpm                                                                                                               | 184 kB  00:00:00\n(13/14): pcre-devel-8.32-17.el7.x86_64.rpm                                                                                                               | 480 kB  00:00:00\n(14/14): openssl-devel-1.0.2k-16.el7_6.1.x86_64.rpm                                                                                                      | 1.5 MB  00:00:01\n--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n\u603b\u8ba1                                                                                                                                            1.9 MB/s | 4.1 MB  00:00:02\nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  \u6b63\u5728\u5b89\u88c5    : libcom_err-devel-1.42.9-13.el7.x86_64                                                                                                                      1/14\n  \u6b63\u5728\u5b89\u88c5    : libsepol-devel-2.5-10.el7.x86_64                                                                                                                           2/14\n  \u6b63\u5728\u5b89\u88c5    : cyrus-sasl-2.1.26-23.el7.x86_64                                                                                                                            3/14\n  \u6b63\u5728\u5b89\u88c5    : pcre-devel-8.32-17.el7.x86_64                                                                                                                              4/14\n  \u6b63\u5728\u5b89\u88c5    : libselinux-devel-2.5-14.1.el7.x86_64                                                                                                                       5/14\n  \u6b63\u5728\u5b89\u88c5    : libkadm5-1.15.1-37.el7_6.x86_64                                                                                                                            6/14\n  \u6b63\u5728\u5b89\u88c5    : zlib-devel-1.2.7-18.el7.x86_64                                                                                                                             7/14\n  \u6b63\u5728\u5b89\u88c5    : libverto-devel-0.2.5-4.el7.x86_64                                                                                                                          8/14\n  \u6b63\u5728\u5b89\u88c5    : keyutils-libs-devel-1.5.8-3.el7.x86_64                                                                                                                     9/14\n  \u6b63\u5728\u5b89\u88c5    : krb5-devel-1.15.1-37.el7_6.x86_64                                                                                                                         10/14\n  \u6b63\u5728\u5b89\u88c5    : 1:openssl-devel-1.0.2k-16.el7_6.1.x86_64                                                                                                                  11/14\n  \u6b63\u5728\u5b89\u88c5    : 1:mariadb-devel-5.5.60-1.el7_5.x86_64                                                                                                                     12/14\n  \u6b63\u5728\u5b89\u88c5    : cyrus-sasl-devel-2.1.26-23.el7.x86_64                                                                                                                     13/14\n  \u6b63\u5728\u5b89\u88c5    : pam-devel-1.1.8-22.el7.x86_64                                                                                                                             14/14\n  \u9a8c\u8bc1\u4e2d      : pam-devel-1.1.8-22.el7.x86_64                                                                                                                              1/14\n  \u9a8c\u8bc1\u4e2d      : keyutils-libs-devel-1.5.8-3.el7.x86_64                                                                                                                     2/14\n  \u9a8c\u8bc1\u4e2d      : libverto-devel-0.2.5-4.el7.x86_64                                                                                                                          3/14\n  \u9a8c\u8bc1\u4e2d      : zlib-devel-1.2.7-18.el7.x86_64                                                                                                                             4/14\n  \u9a8c\u8bc1\u4e2d      : libkadm5-1.15.1-37.el7_6.x86_64                                                                                                                            5/14\n  \u9a8c\u8bc1\u4e2d      : krb5-devel-1.15.1-37.el7_6.x86_64                                                                                                                          6/14\n  \u9a8c\u8bc1\u4e2d      : pcre-devel-8.32-17.el7.x86_64                                                                                                                              7/14\n  \u9a8c\u8bc1\u4e2d      : libselinux-devel-2.5-14.1.el7.x86_64                                                                                                                       8/14\n  \u9a8c\u8bc1\u4e2d      : cyrus-sasl-2.1.26-23.el7.x86_64                                                                                                                            9/14\n  \u9a8c\u8bc1\u4e2d      : cyrus-sasl-devel-2.1.26-23.el7.x86_64                                                                                                                     10/14\n  \u9a8c\u8bc1\u4e2d      : libsepol-devel-2.5-10.el7.x86_64                                                                                                                          11/14\n  \u9a8c\u8bc1\u4e2d      : libcom_err-devel-1.42.9-13.el7.x86_64                                                                                                                     12/14\n  \u9a8c\u8bc1\u4e2d      : 1:openssl-devel-1.0.2k-16.el7_6.1.x86_64                                                                                                                  13/14\n  \u9a8c\u8bc1\u4e2d      : 1:mariadb-devel-5.5.60-1.el7_5.x86_64                                                                                                                     14/14\n\n\u5df2\u5b89\u88c5:\n  cyrus-sasl-devel.x86_64 0:2.1.26-23.el7       mariadb-devel.x86_64 1:5.5.60-1.el7_5       openssl-devel.x86_64 1:1.0.2k-16.el7_6.1       pam-devel.x86_64 0:1.1.8-22.el7\n\n\u4f5c\u4e3a\u4f9d\u8d56\u88ab\u5b89\u88c5:\n  cyrus-sasl.x86_64 0:2.1.26-23.el7       keyutils-libs-devel.x86_64 0:1.5.8-3.el7       krb5-devel.x86_64 0:1.15.1-37.el7_6       libcom_err-devel.x86_64 0:1.42.9-13.el7\n  libkadm5.x86_64 0:1.15.1-37.el7_6       libselinux-devel.x86_64 0:2.5-14.1.el7         libsepol-devel.x86_64 0:2.5-10.el7        libverto-devel.x86_64 0:0.2.5-4.el7\n  pcre-devel.x86_64 0:8.32-17.el7         zlib-devel.x86_64 0:1.2.7-18.el7\n\n\u5b8c\u6bd5\uff01\n[root@localhost ~]# rpmbuild --rebuild pam_mysql-0.7-0.20.rc1.fc23.src.rpm\n\u6b63\u5728\u5b89\u88c5 pam_mysql-0.7-0.20.rc1.fc23.src.rpm\n\u8b66\u544a\uff1apam_mysql-0.7-0.20.rc1.fc23.src.rpm: \u5934V3 RSA/SHA1 Signature, \u5bc6\u94a5 ID 873529b8: NOKEY\n\u8b66\u544a\uff1a\u7528\u6237mockbuild \u4e0d\u5b58\u5728 - \u4f7f\u7528root\n\u8b66\u544a\uff1a\u7fa4\u7ec4mockbuild \u4e0d\u5b58\u5728 - \u4f7f\u7528root\n\u8b66\u544a\uff1a\u7528\u6237mockbuild \u4e0d\u5b58\u5728 - \u4f7f\u7528root\n\u8b66\u544a\uff1a\u7fa4\u7ec4mockbuild \u4e0d\u5b58\u5728 - \u4f7f\u7528root\n\u8b66\u544a\uff1a\u7528\u6237mockbuild \u4e0d\u5b58\u5728 - \u4f7f\u7528root\n\u8b66\u544a\uff1a\u7fa4\u7ec4mockbuild \u4e0d\u5b58\u5728 - \u4f7f\u7528root\n\u8b66\u544a\uff1a\u7528\u6237mockbuild \u4e0d\u5b58\u5728 - \u4f7f\u7528root\n\u8b66\u544a\uff1a\u7fa4\u7ec4mockbuild \u4e0d\u5b58\u5728 - \u4f7f\u7528root\n\u8b66\u544a\uff1a\u7528\u6237mockbuild \u4e0d\u5b58\u5728 - \u4f7f\u7528root\n\u8b66\u544a\uff1a\u7fa4\u7ec4mockbuild \u4e0d\u5b58\u5728 - \u4f7f\u7528root\n\u8b66\u544a\uff1a%changelog \uff08\u66f4\u65b0\u65e5\u5fd7\uff09\u4e2d\u5b58\u5728\u865a\u5047\u7684\u65e5\u671f\uff1aThu Jan 9 2008 lonely wolf &lt;wolfy at fedoraproject dot org&gt; - 0.7-0.3.rc1.1\n\u8b66\u544a\uff1a%changelog \uff08\u66f4\u65b0\u65e5\u5fd7\uff09\u4e2d\u5b58\u5728\u865a\u5047\u7684\u65e5\u671f\uff1aFri Nov 13 2005 Ignacio Vazquez-Abrams &lt;ivazquez@ivazquez.net&gt; 0.6.2-2\n\u8b66\u544a\uff1a%changelog \uff08\u66f4\u65b0\u65e5\u5fd7\uff09\u4e2d\u5b58\u5728\u865a\u5047\u7684\u65e5\u671f\uff1aFri Nov 13 2005 Ignacio Vazquez-Abrams &lt;ivazquez@ivazquez.net&gt; 0.6.2-1\n\u8b66\u544a\uff1a%changelog \uff08\u66f4\u65b0\u65e5\u5fd7\uff09\u4e2d\u5b58\u5728\u865a\u5047\u7684\u65e5\u671f\uff1aWed Mar 15 2005 Ignacio Vazquez-Abrams &lt;ivazquez@ivazquez.net&gt; 0.50-3\n\u6267\u884c(%prep): /bin/sh -e /var/tmp/rpm-tmp.a2kWEm\n+ umask 022\n+ cd /root/rpmbuild/BUILD\n+ cd /root/rpmbuild/BUILD\n+ rm -rf pam_mysql-0.7RC1\n+ /usr/bin/gzip -dc /root/rpmbuild/SOURCES/pam_mysql-0.7RC1.tar.gz\n+ /usr/bin/tar -xf -\n+ STATUS=0\n+ '[' 0 -ne 0 ']'\n+ cd pam_mysql-0.7RC1\n+ /usr/bin/chmod -Rf a+rX,u+w,g-w,o-w .\n+ echo 'Patch #0 (pam_mysql-0.7RC1-resps-segfault.patch):'\nPatch #0 (pam_mysql-0.7RC1-resps-segfault.patch):\n+ /usr/bin/cat /root/rpmbuild/SOURCES/pam_mysql-0.7RC1-resps-segfault.patch\n+ /usr/bin/patch -p1 --fuzz=0\npatching file pam_mysql.c\n+ echo 'Patch #1 (pam_mysql-0.7RC1-first-pass.patch):'\nPatch #1 (pam_mysql-0.7RC1-first-pass.patch):\n+ /usr/bin/patch -p1 --fuzz=0\n+ /usr/bin/cat /root/rpmbuild/SOURCES/pam_mysql-0.7RC1-first-pass.patch\npatching file pam_mysql.c\n+ echo 'Patch #2 (pam_mysql-0.7RC1-scrambled.patch):'\nPatch #2 (pam_mysql-0.7RC1-scrambled.patch):\n+ /usr/bin/cat /root/rpmbuild/SOURCES/pam_mysql-0.7RC1-scrambled.patch\n+ /usr/bin/patch -p1 --fuzz=0\npatching file pam_mysql.c\n+ mv CREDITS AUTHORS\n+ autoreconf -fiv\nautoreconf: Entering directory `.'\u2019\nautoreconf: configure.in: not using Gettext\nautoreconf: running: aclocal --force\naclocal: warning: autoconf input should be named 'configure.ac', not 'configure.in'\nautoreconf: configure.in: tracing\nautoreconf: running: libtoolize --copy --force\nlibtoolize: putting auxiliary files in `.'.\nlibtoolize: copying file `./ltmain.sh'\nlibtoolize: Consider adding `AC_CONFIG_MACRO_DIR([m4])' to configure.in and\nlibtoolize: rerunning libtoolize, to keep the correct libtool macros in-tree.\nlibtoolize: Consider adding `-I m4' to ACLOCAL_AMFLAGS in Makefile.am.\naclocal: warning: autoconf input should be named 'configure.ac', not 'configure.in'\nautoreconf: running: /usr/bin/autoconf --force\nautoreconf: running: /usr/bin/autoheader --force\nautoreconf: running: automake --add-missing --copy --force-missing\nautomake: warning: autoconf input should be named 'configure.ac', not 'configure.in'\nconfigure.in:6: warning: AM_INIT_AUTOMAKE: two- and three-arguments forms are deprecated.  For more info, see:\nconfigure.in:6: http://www.gnu.org/software/automake/manual/automake.html#Modernize-AM_005fINIT_005fAUTOMAKE-invocation\nMakefile.am:6: warning: 'INCLUDES' is the old name for 'AM_CPPFLAGS' (or '*_CPPFLAGS')\nautomake: warning: autoconf input should be named 'configure.ac', not 'configure.in'\nMakefile.am: installing './depcomp'\nautoreconf: Leaving directory `.'\n+ exit 0\n\u6267\u884c(%build): /bin/sh -e /var/tmp/rpm-tmp.0XdncS\n+ umask 022\n+ cd /root/rpmbuild/BUILD\n+ cd pam_mysql-0.7RC1\n+ CFLAGS='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic'\n+ export CFLAGS\n+ CXXFLAGS='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic'\n+ export CXXFLAGS\n+ FFLAGS='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic -I/usr/lib64/gfortran/modules'\n+ export FFLAGS\n+ FCFLAGS='-O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic -I/usr/lib64/gfortran/modules'\n+ export FCFLAGS\n+ LDFLAGS='-Wl,-z,relro '\n+ export LDFLAGS\n+ '[' 1 == 1 ']'\n+ '[' x86_64 == ppc64le ']'\n++ find . -name config.guess -o -name config.sub\n+ for i in '$(find . -name config.guess -o -name config.sub)'\n++ basename ./config.guess\n+ '[' -f /usr/lib/rpm/redhat/config.guess ']'\n+ /usr/bin/rm -f ./config.guess\n++ basename ./config.guess\n+ /usr/bin/cp -fv /usr/lib/rpm/redhat/config.guess ./config.guess\n\u2018/usr/lib/rpm/redhat/config.guess\u2019 -&gt; \u2018./config.guess\u2019\n+ for i in '$(find . -name config.guess -o -name config.sub)'\n++ basename ./config.sub\n+ '[' -f /usr/lib/rpm/redhat/config.sub ']'\n+ /usr/bin/rm -f ./config.sub\n++ basename ./config.sub\n+ /usr/bin/cp -fv /usr/lib/rpm/redhat/config.sub ./config.sub\n\u2018/usr/lib/rpm/redhat/config.sub\u2019 -&gt; \u2018./config.sub\u2019\n+ ./configure --build=x86_64-redhat-linux-gnu --host=x86_64-redhat-linux-gnu --program-prefix= --disable-dependency-tracking --prefix=/usr --exec-prefix=/usr --bindir=/usr/bin --sbindir=/usr/sbin --sysconfdir=/etc --datadir=/usr/share --includedir=/usr/include --libdir=/usr/lib64 --libexecdir=/usr/libexec --localstatedir=/var --sharedstatedir=/var/lib --mandir=/usr/share/man --infodir=/usr/share/info --with-openssl --with-pam-mods-dir=/lib64/security --enable-static=no --with-cyrus-sasl2\nchecking for a BSD-compatible install... /usr/bin/install -c\nchecking whether build environment is sane... yes\nchecking for a thread-safe mkdir -p... /usr/bin/mkdir -p\nchecking for gawk... gawk\nchecking whether make sets $(MAKE)... yes\nchecking whether make supports nested variables... yes\nchecking whether to enable maintainer-specific portions of Makefiles... no\nchecking for bison... bison -y\nchecking for x86_64-redhat-linux-gnu-g++... no\nchecking for x86_64-redhat-linux-gnu-c++... no\nchecking for x86_64-redhat-linux-gnu-gpp... no\nchecking for x86_64-redhat-linux-gnu-aCC... no\nchecking for x86_64-redhat-linux-gnu-CC... no\nchecking for x86_64-redhat-linux-gnu-cxx... no\nchecking for x86_64-redhat-linux-gnu-cc++... no\nchecking for x86_64-redhat-linux-gnu-cl.exe... no\nchecking for x86_64-redhat-linux-gnu-FCC... no\nchecking for x86_64-redhat-linux-gnu-KCC... no\nchecking for x86_64-redhat-linux-gnu-RCC... no\nchecking for x86_64-redhat-linux-gnu-xlC_r... no\nchecking for x86_64-redhat-linux-gnu-xlC... no\nchecking for g++... g++\nchecking whether the C++ compiler works... yes\nchecking for C++ compiler default output file name... a.out\nchecking for suffix of executables...\nchecking whether we are cross compiling... no\nchecking for suffix of object files... o\nchecking whether we are using the GNU C++ compiler... yes\nchecking whether g++ accepts -g... yes\nchecking for style of include used by make... GNU\nchecking dependency style of g++... none\nchecking for x86_64-redhat-linux-gnu-gcc... no\nchecking for gcc... gcc\nchecking whether we are using the GNU C compiler... yes\nchecking whether gcc accepts -g... yes\nchecking for gcc option to accept ISO C89... none needed\nchecking dependency style of gcc... none\nchecking how to run the C preprocessor... gcc -E\nchecking whether ln -s works... yes\nchecking whether make sets $(MAKE)... (cached) yes\nchecking build system type... x86_64-redhat-linux-gnu\nchecking host system type... x86_64-redhat-linux-gnu\nchecking how to print strings... printf\nchecking for a sed that does not truncate output... /usr/bin/sed\nchecking for grep that handles long lines and -e... /usr/bin/grep\nchecking for egrep... /usr/bin/grep -E\nchecking for fgrep... /usr/bin/grep -F\nchecking for ld used by gcc... /usr/bin/ld\nchecking if the linker (/usr/bin/ld) is GNU ld... yes\nchecking for BSD- or MS-compatible name lister (nm)... /usr/bin/nm -B\nchecking the name lister (/usr/bin/nm -B) interface... BSD nm\nchecking the maximum length of command line arguments... 1572864\nchecking whether the shell understands some XSI constructs... yes\nchecking whether the shell understands \"+=\"... yes\nchecking how to convert x86_64-redhat-linux-gnu file names to x86_64-redhat-linux-gnu format... func_convert_file_noop\nchecking how to convert x86_64-redhat-linux-gnu file names to toolchain format... func_convert_file_noop\nchecking for /usr/bin/ld option to reload object files... -r\nchecking for x86_64-redhat-linux-gnu-objdump... no\nchecking for objdump... objdump\nchecking how to recognize dependent libraries... pass_all\nchecking for x86_64-redhat-linux-gnu-dlltool... no\nchecking for dlltool... no\nchecking how to associate runtime and link libraries... printf %s\\n\nchecking for x86_64-redhat-linux-gnu-ar... no\nchecking for ar... ar\nchecking for archiver @FILE support... @\nchecking for x86_64-redhat-linux-gnu-strip... no\nchecking for strip... strip\nchecking for x86_64-redhat-linux-gnu-ranlib... no\nchecking for ranlib... ranlib\nchecking command to parse /usr/bin/nm -B output from gcc object... ok\nchecking for sysroot... no\nchecking for x86_64-redhat-linux-gnu-mt... no\nchecking for mt... no\nchecking if : is a manifest tool... no\nchecking for ANSI C header files... yes\nchecking for sys/types.h... yes\nchecking for sys/stat.h... yes\nchecking for stdlib.h... yes\nchecking for string.h... yes\nchecking for memory.h... yes\nchecking for strings.h... yes\nchecking for inttypes.h... yes\nchecking for stdint.h... yes\nchecking for unistd.h... yes\nchecking for dlfcn.h... yes\nchecking for objdir... .libs\nchecking if gcc supports -fno-rtti -fno-exceptions... no\nchecking for gcc option to produce PIC... -fPIC -DPIC\nchecking if gcc PIC flag -fPIC -DPIC works... yes\nchecking if gcc static flag -static works... no\nchecking if gcc supports -c -o file.o... yes\nchecking if gcc supports -c -o file.o... (cached) yes\nchecking whether the gcc linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes\nchecking whether -lc should be explicitly linked in... no\nchecking dynamic linker characteristics... GNU/Linux ld.so\nchecking how to hardcode library paths into programs... immediate\nchecking whether stripping libraries is possible... yes\nchecking if libtool supports shared libraries... yes\nchecking whether to build shared libraries... yes\nchecking whether to build static libraries... no\nchecking how to run the C++ preprocessor... g++ -E\nchecking for ld used by g++... /usr/bin/ld -m elf_x86_64\nchecking if the linker (/usr/bin/ld -m elf_x86_64) is GNU ld... yes\nchecking whether the g++ linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes\nchecking for g++ option to produce PIC... -fPIC -DPIC\nchecking if g++ PIC flag -fPIC -DPIC works... yes\nchecking if g++ static flag -static works... no\nchecking if g++ supports -c -o file.o... yes\nchecking if g++ supports -c -o file.o... (cached) yes\nchecking whether the g++ linker (/usr/bin/ld -m elf_x86_64) supports shared libraries... yes\nchecking dynamic linker characteristics... (cached) GNU/Linux ld.so\nchecking how to hardcode library paths into programs... immediate\nchecking for ANSI C header files... (cached) yes\nchecking arpa/inet.h usability... yes\nchecking arpa/inet.h presence... yes\nchecking for arpa/inet.h... yes\nchecking netinet/in.h usability... yes\nchecking netinet/in.h presence... yes\nchecking for netinet/in.h... yes\nchecking netdb.h usability... yes\nchecking netdb.h presence... yes\nchecking for netdb.h... yes\nchecking for string.h... (cached) yes\nchecking for strings.h... (cached) yes\nchecking sys/socket.h usability... yes\nchecking sys/socket.h presence... yes\nchecking for sys/socket.h... yes\nchecking for sys/types.h... (cached) yes\nchecking for sys/stat.h... (cached) yes\nchecking sys/param.h usability... yes\nchecking sys/param.h presence... yes\nchecking for sys/param.h... yes\nchecking fcntl.h usability... yes\nchecking fcntl.h presence... yes\nchecking for fcntl.h... yes\nchecking syslog.h usability... yes\nchecking syslog.h presence... yes\nchecking for syslog.h... yes\nchecking for unistd.h... (cached) yes\nchecking stdarg.h usability... yes\nchecking stdarg.h presence... yes\nchecking for stdarg.h... yes\nchecking errno.h usability... yes\nchecking errno.h presence... yes\nchecking for errno.h... yes\nchecking crypt.h usability... yes\nchecking crypt.h presence... yes\nchecking for crypt.h... yes\nchecking for stdbool.h that conforms to C99... yes\nchecking for _Bool... yes\nchecking for an ANSI C-conforming const... yes\nchecking for inline... inline\nchecking for size_t... yes\nchecking for working volatile... yes\nchecking for preprocessor stringizing operator... yes\nchecking for pid_t... yes\nchecking for working alloca.h... yes\nchecking for alloca... yes\nchecking for stdlib.h... (cached) yes\nchecking for GNU libc compatible malloc... yes\nchecking for working memcmp... yes\nchecking ELOOP availability... yes\nchecking EOVERFLOW availability... yes\nchecking for socket in -lsocket... no\nchecking for gethostbyname... yes\nchecking for gethostbyname in -lnsl... no\nchecking for inet_ntop... yes\nchecking for getaddrinfo... yes\nchecking for freeaddrinfo... yes\nchecking for strcasecmp... yes\nchecking for strdup... yes\nchecking PF_INET6 availability... yes\nchecking for struct sockaddr_in6... yes\nchecking for struct in6_addr... yes\nchecking for gethostbyname_r... yes\nchecking if gethostbyname_r() is part of glibc... yes\nchecking size of char... 1\nchecking size of short... 2\nchecking size of int... 4\nchecking size of long... 8\nchecking if /usr /usr/local /usr/mysql /opt/mysql is a mysql_config script... no\nchecking mysql_config availability in /usr/bin... yes\nchecking for mysql_real_query... yes\nchecking for mysql_real_escape_string... yes\nchecking for make_scrambled_password_323... yes\nchecking for x86_64-redhat-linux-gnu-pkg-config... no\nchecking for pkg-config... /usr/bin/pkg-config\nchecking pkg-config is at least version 0.9.0... yes\nchecking for openssl_CFLAGS...\nchecking for openssl_LIBS... -lssl -lcrypto\nchecking pam_appl.h usability... yes\nchecking pam_appl.h presence... yes\nchecking for pam_appl.h... yes\nchecking pam_modules.h usability... yes\nchecking PAM_CONV_AGAIN availability... yes\nchecking PAM_INCOMPLETE availability... yes\nchecking PAM_NEW_AUTHTOK_REQD availability... yes\nchecking PAM_AUTHTOK_RECOVERY_ERR availability... yes\nchecking if the second argument of pam_get_user() takes const pointer... no\nchecking if the third argument of pam_get_data() takes const pointer... no\nchecking if the third argument of pam_get_item() takes const pointer... no\nchecking if the second argument of pam_conv.conv() takes const pointer... no\nchecking if md5.h is derived from Cyrus SASL Version 1... no\nchecking md5.h usability... no\nchecking md5.h presence... no\nchecking for md5.h... no\nchecking if md5.h is Solaris's... no\nchecking for md5.h... (cached) no\nchecking for MD5Data... no\nchecking for crypt in -lcrypt... yes\nchecking for crypt... yes\nchecking that generated files are newer than configure... done\nconfigure: creating ./config.status\nconfig.status: creating Makefile\nconfig.status: creating pam_mysql.spec\nconfig.status: creating config.h\nconfig.status: executing depfiles commands\nconfig.status: executing libtool commands\n+ make -j4\nmake  all-am\nmake[1]: Entering directory `/root/rpmbuild/BUILD/pam_mysql-0.7RC1'\n/bin/sh ./libtool  --tag=CC   --mode=compile gcc -DHAVE_CONFIG_H -I. -I/usr/include/security -I/usr/include  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic -I/usr/include/mysql     -c -o pam_mysql.lo pam_mysql.c\nlibtool: compile:  gcc -DHAVE_CONFIG_H -I. -I/usr/include/security -I/usr/include -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches -m64 -mtune=generic -I/usr/include/mysql -c pam_mysql.c  -fPIC -DPIC -o .libs/pam_mysql.o\npam_mysql.c: In function 'pam_mysql_retrieve_ctx':\npam_mysql.c:2074:5: warning: passing argument 3 of 'pam_get_data' from incompatible pointer type [enabled by default]\n     (PAM_GET_DATA_CONST void**)pretval)) {\n     ^\nIn file included from pam_mysql.c:156:0:\n/usr/include/security/pam_modules.h:27:1: note: expected 'const void **' but argument is of type 'void **'\n pam_get_data(const pam_handle_t *pamh, const char *module_data_name,\n ^\npam_mysql.c: In function 'pam_mysql_converse':\npam_mysql.c:3153:4: warning: passing argument 3 of 'pam_get_item' from incompatible pointer type [enabled by default]\n    (PAM_GET_ITEM_CONST void **)&amp;conv))) {\n    ^\nIn file included from /usr/include/security/pam_appl.h:18:0,\n                 from pam_mysql.c:155:\n/usr/include/security/_pam_types.h:175:1: note: expected 'const void **' but argument is of type 'void **'\n pam_get_item(const pam_handle_t *pamh, int item_type, const void **item);\n ^\npam_mysql.c:3197:4: warning: passing argument 2 of 'conv-&gt;conv' from incompatible pointer type [enabled by default]\n    conv-&gt;appdata_ptr))) {\n    ^\npam_mysql.c:3197:4: note: expected 'const struct pam_message **' but argument is of type 'struct pam_message **'\npam_mysql.c: In function 'pam_sm_authenticate':\npam_mysql.c:3332:4: warning: passing argument 2 of 'pam_get_user' from incompatible pointer type [enabled by default]\n    NULL))) {\n    ^\nIn file included from pam_mysql.c:156:0:\n/usr/include/security/pam_modules.h:31:1: note: expected 'const char **' but argument is of type 'char **'\n pam_get_user(pam_handle_t *pamh, const char **user, const char *prompt);\n ^\npam_mysql.c:3343:4: warning: passing argument 3 of 'pam_get_item' from incompatible pointer type [enabled by default]\n    (PAM_GET_ITEM_CONST void **)&amp;rhost)) {\n    ^\nIn file included from /usr/include/security/pam_appl.h:18:0,\n                 from pam_mysql.c:155:\n/usr/include/security/_pam_types.h:175:1: note: expected 'const void **' but argument is of type 'void **'\n pam_get_item(const pam_handle_t *pamh, int item_type, const void **item);\n ^\npam_mysql.c:3353:5: warning: passing argument 3 of 'pam_get_item' from incompatible pointer type [enabled by default]\n     (PAM_GET_ITEM_CONST void **)&amp;passwd);\n     ^\nIn file included from /usr/include/security/pam_appl.h:18:0,\n                 from pam_mysql.c:155:\n/usr/include/security/_pam_types.h:175:1: note: expected 'const void **' but argument is of type 'void **'\n pam_get_item(const pam_handle_t *pamh, int item_type, const void **item);\n ^\npam_mysql.c: In function 'pam_sm_acct_mgmt':\npam_mysql.c:3578:4: warning: passing argument 2 of 'pam_get_user' from incompatible pointer type [enabled by default]\n    NULL))) {\n    ^\nIn file included from pam_mysql.c:156:0:\n/usr/include/security/pam_modules.h:31:1: note: expected 'const char **' but argument is of type 'char **'\n pam_get_user(pam_handle_t *pamh, const char **user, const char *prompt);\n ^\npam_mysql.c:3589:4: warning: passing argument 3 of 'pam_get_item' from incompatible pointer type [enabled by default]\n    (PAM_GET_ITEM_CONST void **)&amp;rhost)) {\n    ^\nIn file included from /usr/include/security/pam_appl.h:18:0,\n                 from pam_mysql.c:155:\n/usr/include/security/_pam_types.h:175:1: note: expected 'const void **' but argument is of type 'void **'\n pam_get_item(const pam_handle_t *pamh, int item_type, const void **item);\n ^\npam_mysql.c: In function 'pam_sm_chauthtok':\npam_mysql.c:3739:4: warning: passing argument 2 of 'pam_get_user' from incompatible pointer type [enabled by default]\n    NULL))) {\n    ^\nIn file included from pam_mysql.c:156:0:\n/usr/include/security/pam_modules.h:31:1: note: expected 'const char **' but argument is of type 'char **'\n pam_get_user(pam_handle_t *pamh, const char **user, const char *prompt);\n ^\npam_mysql.c:3750:4: warning: passing argument 3 of 'pam_get_item' from incompatible pointer type [enabled by default]\n    (PAM_GET_ITEM_CONST void **)&amp;rhost)) {\n    ^\nIn file included from /usr/include/security/pam_appl.h:18:0,\n                 from pam_mysql.c:155:\n/usr/include/security/_pam_types.h:175:1: note: expected 'const void **' but argument is of type 'void **'\n pam_get_item(const pam_handle_t *pamh, int item_type, const void **item);\n ^\npam_mysql.c:3850:6: warning: passing argument 3 of 'pam_get_item' from incompatible pointer type [enabled by default]\n      (PAM_GET_ITEM_CONST void **)&amp;old_passwd);\n      ^\nIn file included from /usr/include/security/pam_appl.h:18:0,\n                 from pam_mysql.c:155:\n/usr/include/security/_pam_types.h:175:1: note: expected 'const void **' but argument is of type 'void **'\n pam_get_item(const pam_handle_t *pamh, int item_type, const void **item);\n ^\npam_mysql.c:3950:4: warning: passing argument 3 of 'pam_get_item' from incompatible pointer type [enabled by default]\n    (PAM_GET_ITEM_CONST void **)&amp;new_passwd);\n    ^\nIn file included from /usr/include/security/pam_appl.h:18:0,\n                 from pam_mysql.c:155:\n/usr/include/security/_pam_types.h:175:1: note: expected 'const void **' but argument is of type 'void **'\n pam_get_item(const pam_handle_t *pamh, int item_type, const void **item);\n ^\npam_mysql.c: In function 'pam_sm_open_session':\npam_mysql.c:4112:4: warning: passing argument 2 of 'pam_get_user' from incompatible pointer type [enabled by default]\n    NULL))) {\n    ^\nIn file included from pam_mysql.c:156:0:\n/usr/include/security/pam_modules.h:31:1: note: expected 'const char **' but argument is of type 'char **'\n pam_get_user(pam_handle_t *pamh, const char **user, const char *prompt);\n ^\npam_mysql.c:4123:4: warning: passing argument 3 of 'pam_get_item' from incompatible pointer type [enabled by default]\n    (PAM_GET_ITEM_CONST void **)&amp;rhost)) {\n    ^\nIn file included from /usr/include/security/pam_appl.h:18:0,\n                 from pam_mysql.c:155:\n/usr/include/security/_pam_types.h:175:1: note: expected 'const void **' but argument is of type 'void **'\n pam_get_item(const pam_handle_t *pamh, int item_type, const void **item);\n ^\npam_mysql.c: In function 'pam_sm_close_session':\npam_mysql.c:4215:4: warning: passing argument 2 of 'pam_get_user' from incompatible pointer type [enabled by default]\n    NULL))) {\n    ^\nIn file included from pam_mysql.c:156:0:\n/usr/include/security/pam_modules.h:31:1: note: expected 'const char **' but argument is of type 'char **'\n pam_get_user(pam_handle_t *pamh, const char **user, const char *prompt);\n ^\npam_mysql.c:4226:4: warning: passing argument 3 of 'pam_get_item' from incompatible pointer type [enabled by default]\n    (PAM_GET_ITEM_CONST void **)&amp;rhost)) {\n    ^\nIn file included from /usr/include/security/pam_appl.h:18:0,\n                 from pam_mysql.c:155:\n/usr/include/security/_pam_types.h:175:1: note: expected 'const void **' but argument is of type 'void **'\n pam_get_item(const pam_handle_t *pamh, int item_type, const void **item);\n ^\n/bin/sh ./libtool  --tag=CC   --mode=link gcc  -O2 -g -pipe -Wall -Wp,-D_FORTIFY_SOURCE=2 -fexceptions -fstack-protector-strong --param=ssp-buffer-size=4 -grecord-gcc-switches   -m64 -mtune=generic -I/usr/include/mysql     -module -avoid-version -Wl,-z,relro  -o pam_mysql.la -rpath /lib64/security pam_mysql.lo  -L/usr/lib64/mysql -lmysqlclient -lpthread -lz -lm -ldl -lssl -lcrypto -lssl -lcrypto     -lcrypt\nlibtool: link: gcc -shared  -fPIC -DPIC  .libs/pam_mysql.o   -L/usr/lib64/mysql -lmysqlclient -lpthread -lz -lm -ldl -lssl -lcrypto -lcrypt  -O2 -m64 -mtune=generic -Wl,-z -Wl,relro   -Wl,-soname -Wl,pam_mysql.so -o .libs/pam_mysql.so\nlibtool: link: ( cd \".libs\" &amp;&amp; rm -f \"pam_mysql.la\" &amp;&amp; ln -s \"../pam_mysql.la\" \"pam_mysql.la\" )\nmake[1]: Leaving directory `/root/rpmbuild/BUILD/pam_mysql-0.7RC1'\n+ mv AUTHORS AUTHORS.lame\n+ iconv -f latin1 -t utf-8 -o AUTHORS AUTHORS.lame\n+ touch -r README AUTHORS\n+ exit 0\n\u6267\u884c(%install): /bin/sh -e /var/tmp/rpm-tmp.NXGtLO\n+ umask 022\n+ cd /root/rpmbuild/BUILD\n+ '[' /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64 '!=' / ']'\n+ rm -rf /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64\n++ dirname /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64\n+ mkdir -p /root/rpmbuild/BUILDROOT\n+ mkdir /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64\n+ cd pam_mysql-0.7RC1\n+ rm -rf /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64\n+ make install DESTDIR=/root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64\nmake[1]: Entering directory `/root/rpmbuild/BUILD/pam_mysql-0.7RC1'\n /usr/bin/mkdir -p '/root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/lib64/security'\n /bin/sh ./libtool   --mode=install /usr/bin/install -c   pam_mysql.la '/root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/lib64/security'\nlibtool: install: /usr/bin/install -c .libs/pam_mysql.so /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/lib64/security/pam_mysql.so\nlibtool: install: /usr/bin/install -c .libs/pam_mysql.lai /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/lib64/security/pam_mysql.la\nlibtool: install: warning: remember to run `libtool --finish /lib64/security'\nmake[1]: Nothing to be done for `install-data-am'.\nmake[1]: Leaving directory `/root/rpmbuild/BUILD/pam_mysql-0.7RC1'\n+ find /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64 -name '*.la' -exec rm '{}' ';'\n+ /usr/lib/rpm/find-debuginfo.sh --strict-build-id -m --run-dwz --dwz-low-mem-die-limit 10000000 --dwz-max-die-limit 110000000 /root/rpmbuild/BUILD/pam_mysql-0.7RC1\nextracting debug info from /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/lib64/security/pam_mysql.so\ndwz: Too few files for multifile optimization\n/usr/lib/rpm/sepdebugcrcfix: Updated 1 CRC32s, 0 CRC32s did match.\n192 blocks\n+ /usr/lib/rpm/check-buildroot\n+ /usr/lib/rpm/redhat/brp-compress\n+ /usr/lib/rpm/redhat/brp-strip-static-archive /usr/bin/strip\n+ /usr/lib/rpm/brp-python-bytecompile /usr/bin/python 1\n+ /usr/lib/rpm/redhat/brp-python-hardlink\n+ /usr/lib/rpm/redhat/brp-java-repack-jars\n\u5904\u7406\u6587\u4ef6\uff1apam_mysql-0.7-0.20.rc1.el7.x86_64\n\u6267\u884c(%doc): /bin/sh -e /var/tmp/rpm-tmp.dKygeM\n+ umask 022\n+ cd /root/rpmbuild/BUILD\n+ cd pam_mysql-0.7RC1\n+ DOCDIR=/root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/usr/share/doc/pam_mysql-0.7\n+ export DOCDIR\n+ /usr/bin/mkdir -p /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/usr/share/doc/pam_mysql-0.7\n+ cp -pr ChangeLog /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/usr/share/doc/pam_mysql-0.7\n+ cp -pr COPYING /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/usr/share/doc/pam_mysql-0.7\n+ cp -pr AUTHORS /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/usr/share/doc/pam_mysql-0.7\n+ cp -pr NEWS /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/usr/share/doc/pam_mysql-0.7\n+ cp -pr README /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64/usr/share/doc/pam_mysql-0.7\n+ exit 0\nProvides: pam_mysql = 1:0.7-0.20.rc1.el7 pam_mysql(x86-64) = 1:0.7-0.20.rc1.el7\nRequires(rpmlib): rpmlib(CompressedFileNames) &lt;= 3.0.4-1 rpmlib(FileDigests) &lt;= 4.6.0-1 rpmlib(PayloadFilesHavePrefix) &lt;= 4.0-1\nRequires: libc.so.6()(64bit) libc.so.6(GLIBC_2.14)(64bit) libc.so.6(GLIBC_2.2.5)(64bit) libc.so.6(GLIBC_2.3.4)(64bit) libc.so.6(GLIBC_2.4)(64bit) libcrypt.so.1()(64bit) libcrypt.so.1(GLIBC_2.2.5)(64bit) libcrypto.so.10()(64bit) libcrypto.so.10(libcrypto.so.10)(64bit) libdl.so.2()(64bit) libm.so.6()(64bit) libmysqlclient.so.18()(64bit) libmysqlclient.so.18(libmysqlclient_18)(64bit) libpthread.so.0()(64bit) libpthread.so.0(GLIBC_2.2.5)(64bit) libssl.so.10()(64bit) libz.so.1()(64bit) rtld(GNU_HASH)\n\u5904\u7406\u6587\u4ef6\uff1apam_mysql-debuginfo-0.7-0.20.rc1.el7.x86_64\nProvides: pam_mysql-debuginfo = 1:0.7-0.20.rc1.el7 pam_mysql-debuginfo(x86-64) = 1:0.7-0.20.rc1.el7\nRequires(rpmlib): rpmlib(FileDigests) &lt;= 4.6.0-1 rpmlib(PayloadFilesHavePrefix) &lt;= 4.0-1 rpmlib(CompressedFileNames) &lt;= 3.0.4-1\n\u68c0\u67e5\u672a\u6253\u5305\u6587\u4ef6\uff1a/usr/lib/rpm/check-files /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64\n\u5199\u9053:/root/rpmbuild/RPMS/x86_64/pam_mysql-0.7-0.20.rc1.el7.x86_64.rpm\n\u5199\u9053:/root/rpmbuild/RPMS/x86_64/pam_mysql-debuginfo-0.7-0.20.rc1.el7.x86_64.rpm\n\u6267\u884c(%clean): /bin/sh -e /var/tmp/rpm-tmp.niS4CF\n+ umask 022\n+ cd /root/rpmbuild/BUILD\n+ cd pam_mysql-0.7RC1\n+ rm -rf /root/rpmbuild/BUILDROOT/pam_mysql-0.7-0.20.rc1.fc23.x86_64\n+ exit 0\n\u6267\u884c(--clean): /bin/sh -e /var/tmp/rpm-tmp.nNs3vD\n+ umask 022\n+ cd /root/rpmbuild/BUILD\n+ rm -rf pam_mysql-0.7RC1\n+ exit 0\n[root@localhost ~]# yum localinstall -y rpmbuild/RPMS/x86_64/pam_mysql-0.7-0.20.rc1.el7.x86_64.rpm\n\u5df2\u52a0\u8f7d\u63d2\u4ef6\uff1afastestmirror\n\u6b63\u5728\u68c0\u67e5 rpmbuild/RPMS/x86_64/pam_mysql-0.7-0.20.rc1.el7.x86_64.rpm: 1:pam_mysql-0.7-0.20.rc1.el7.x86_64\nrpmbuild/RPMS/x86_64/pam_mysql-0.7-0.20.rc1.el7.x86_64.rpm \u5c06\u88ab\u5b89\u88c5\n\u6b63\u5728\u89e3\u51b3\u4f9d\u8d56\u5173\u7cfb\n--&gt; \u6b63\u5728\u68c0\u67e5\u4e8b\u52a1\n---&gt; \u8f6f\u4ef6\u5305 pam_mysql.x86_64.1.0.7-0.20.rc1.el7 \u5c06\u88ab \u5b89\u88c5\n--&gt; \u89e3\u51b3\u4f9d\u8d56\u5173\u7cfb\u5b8c\u6210\n\n\u4f9d\u8d56\u5173\u7cfb\u89e3\u51b3\n\n================================================================================================================================================================================\n Package                           \u67b6\u6784                           \u7248\u672c                                         \u6e90                                                          \u5927\u5c0f\n================================================================================================================================================================================\n\u6b63\u5728\u5b89\u88c5:\n pam_mysql                         x86_64                         1:0.7-0.20.rc1.el7                           /pam_mysql-0.7-0.20.rc1.el7.x86_64                          92 k\n\n\u4e8b\u52a1\u6982\u8981\n================================================================================================================================================================================\n\u5b89\u88c5  1 \u8f6f\u4ef6\u5305\n\n\u603b\u8ba1\uff1a92 k\n\u5b89\u88c5\u5927\u5c0f\uff1a92 k\nDownloading packages:\nRunning transaction check\nRunning transaction test\nTransaction test succeeded\nRunning transaction\n  \u6b63\u5728\u5b89\u88c5    : 1:pam_mysql-0.7-0.20.rc1.el7.x86_64                                                                                                                         1/1\n  \u9a8c\u8bc1\u4e2d      : 1:pam_mysql-0.7-0.20.rc1.el7.x86_64                                                                                                                         1/1\n\n\u5df2\u5b89\u88c5:\n  pam_mysql.x86_64 1:0.7-0.20.rc1.el7\n\n\u5b8c\u6bd5\uff01\n[root@localhost ~]#\n</code></pre> <p>4\u3001 \u5efa\u7acb\u672c\u5730\u6620\u5c04\u7528\u6237\u5e76\u8bbe\u7f6e\u5bbf\u4e3b\u76ee\u5f55\u6743\u9650</p> <pre><code>[root@localhost ~]# useradd -s /sbin/nologin vsftpuser\n[root@localhost ~]# chmod -R 755 /home/vsftpuser\n[root@localhost ~]#\n</code></pre> <p>5\u3001 \u914d\u7f6e pam \u8ba4\u771f\u6587\u4ef6</p> <pre><code>[root@localhost ~]# cat &lt;&lt;end&gt; /etc/pam.d/vsftpd.db\n&gt; auth required pam_mysql.so user=vsftpuser passwd=vsftppasswd host=192.168.11.130 db=vsftpuser table=users usercolumn=name passwdcolumn=passwd crypt=2\n&gt; account required pam_mysql.so user=vsftpuser passwd=vsftppasswd host=192.168.11.130 db=vsftpuser table=users usercolumn=name passwdcolumn=passwd crypt=2\n&gt; end\n[root@localhost ~]#\n</code></pre> <p>crypt=0\uff1a\u8868\u793a\u53e3\u4ee4\u4f7f\u7528\u660e\u6587\u65b9\u5f0f\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d</p> <p>crypt=1\uff1a\u8868\u793a\u53e3\u4ee4\u4f7f\u7528UNIX\u7684DES\u52a0\u5bc6\u65b9\u5f0f\u52a0\u5bc6\u540e\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d</p> <p>crypt=2\uff1a\u8868\u793a\u53e3\u4ee4\u4f7f\u7528MySQL\u7684password()\u51fd\u6570\u52a0\u5bc6\u540e\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d</p> <p>crypt=3\uff1a\u8868\u793a\u53e3\u4ee4\u4f7f\u7528MD5\u6563\u5217\u503c\u7684\u65b9\u5f0f\u4fdd\u5b58\u5728\u6570\u636e\u5e93\u4e2d</p> <p>6\u3001 \u914d\u7f6e\u865a\u62df\u7528\u6237\u8ba4\u8bc1</p> <pre><code>[root@localhost ~]# cat &lt;&lt;end&gt; /etc/vsftpd/vsftpd.conf\n&gt; anonymous_enable=NO\n&gt; local_enable=YES\n&gt; guest_enable=YES\n&gt; guest_username=vsftpuser\n&gt; allow_writeable_chroot=YES\n&gt; write_enable=YES\n&gt; local_umask=022\n&gt; dirmessage_enable=YES\n&gt; xferlog_enable=YES\n&gt; connect_from_port_20=YES\n&gt; xferlog_std_format=YES\n&gt; listen=NO\n&gt; listen_ipv6=YES\n&gt; pam_service_name=vsftpd.db\n&gt; userlist_enable=YES\n&gt; tcp_wrappers=YES\n&gt; end\n[root@localhost ~]# systemctl restart vsftpd\n[root@localhost ~]# firewall-cmd --add-service=ftp --permanent\nsuccess\n[root@localhost ~]# firewall-cmd --reload\nsuccess\n[root@localhost ~]# getenforce\nEnforcing\n[root@localhost ~]# setenforce 0\n[root@localhost ~]#\n</code></pre> <p>7\u3001 \u4e3a\u865a\u62df\u7528\u6237\u8bbe\u7f6e\u4e0d\u540c\u7684\u8bbf\u95ee\u6743\u9650</p> <pre><code>[root@localhost ~]# mkdir -p /etc/vsftpd/vusers_config\n[root@localhost ~]# cat &lt;&lt;end&gt; /etc/vsftpd/vusers_config/userone\n&gt; anon_upload_enable=YES\n&gt; anon_mkdir_write_enable=YES\n&gt; anon_other_write_enable=YES\n&gt; end\n[root@localhost ~]# echo \"user_config_dir=/etc/vsftpd/vusers_config\" &gt;&gt; /etc/vsftpd/vsftpd.conf\n[root@localhost ~]# systemctl restart vsftpd\n[root@localhost ~]#\n</code></pre> <p>8\u3001 \u5ba2\u6237\u7aef\u6d4b\u8bd5</p> <pre><code>[root@client ~]# ftp 192.168.11.130\nConnected to 192.168.11.130 (192.168.11.130).\n220 (vsFTPd 3.0.2)\nName (192.168.11.130:root): userone\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp&gt; ls\n227 Entering Passive Mode (192,168,11,130,93,245).\n150 Here comes the directory listing.\n226 Directory send OK.\nftp&gt; mkdir 123\n257 \"/123\" created\nftp&gt; ls\n227 Entering Passive Mode (192,168,11,130,155,20).\n150 Here comes the directory listing.\ndrwx------    2 1001     1001            6 Jun 30 20:45 123\n226 Directory send OK.\nftp&gt; exit\n221 Goodbye.\n[root@client ~]#\n</code></pre>"},{"location":"linux/service/iscsi/","title":"Iscsi","text":""},{"location":"linux/service/iscsi/#iscsi","title":"iSCSI \u7f51\u7edc\u5b58\u50a8\u670d\u52a1","text":"<p>iSCSI \u662f\u4e00\u79cd\u5c06 SCSI \u63a5\u53e3\u4e0e\u4ee5\u592a\u7f51\u6280\u672f\u76f8\u7ed3\u5408\u7684\u65b0\u578b\u5b58\u50a8\u6280\u672f\uff0c\u53ef\u4ee5\u7528\u6765\u5728\u7f51\u7edc\u4e2d\u4f20\u8f93 SCSI \u63a5\u53e3\u7684\u547d\u4ee4\u548c\u6570\u636e\u3002\u4e0d\u4ec5\u514b\u670d\u4e86\u4f20\u7edf SCSI \u63a5\u53e3\u8bbe\u5907\u7684\u7269\u7406\u5c40\u9650\u6027\uff0c\u5b9e\u73b0\u4e86\u8de8\u533a\u57df\u7684\u5b58\u50a8\u8d44\u6e90\u5171\u4eab\uff0c\u8fd8\u53ef\u4ee5\u5728\u4e0d\u505c\u673a\u7684\u72b6\u6001\u4e0b\u6269\u5c55\u5b58\u50a8\u5bb9\u91cf\u3002</p> <p>IDE\u662f\u4e00\u79cd\u6210\u719f\u7a33\u5b9a\u3001\u4ef7\u683c\u4fbf\u5b9c\u7684\u5e76\u884c\u4f20\u8f93\u63a5\u53e3\u3002</p> <p>SATA\u662f\u4e00\u79cd\u4f20\u8f93\u901f\u5ea6\u66f4\u5feb\u3001\u6570\u636e\u6821\u9a8c\u66f4\u5b8c\u6574\u7684\u4e32\u884c\u4f20\u8f93\u63a5\u53e3\u3002</p> <p>SCSI\u662f\u4e00\u79cd\u7528\u4e8e\u8ba1\u7b97\u673a\u548c\u786c\u76d8\u3001\u5149\u9a71\u7b49\u8bbe\u5907\u4e4b\u95f4\u7cfb\u7edf\u7ea7\u63a5\u53e3\u7684\u901a\u7528\u6807\u51c6\uff0c\u5177\u6709\u7cfb\u7edf\u8d44\u6e90\u5360\u7528\u7387\u4f4e\u3001\u8f6c\u901f\u9ad8\u3001\u4f20\u8f93\u901f\u5ea6\u5feb\u7b49\u4f18\u70b9\u3002</p> <p>iSCSI \u6280\u672f\u5728\u5de5\u4f5c\u5f62\u5f0f\u4e0a\u5206\u4e3a\u670d\u52a1\u7aef\uff08target\uff09\u4e0e\u5ba2\u6237\u7aef\uff08initiator\uff09\u3002</p> <ul> <li> <p><code>iSCSI \u670d\u52a1\u7aef</code>: \u5373\u7528\u4e8e\u5b58\u653e\u786c\u76d8\u5b58\u50a8\u8d44\u6e90\u7684\u670d\u52a1\u5668\uff0c\u80fd\u591f\u4e3a\u7528\u6237\u63d0\u4f9b\u53ef\u7528\u7684\u5b58\u50a8\u8d44\u6e90\u3002</p> </li> <li> <p><code>iSCSI \u5ba2\u6237\u7aef</code>: \u5219\u662f\u7528\u6237\u4f7f\u7528\u7684\u8f6f\u4ef6\uff0c\u7528\u4e8e\u8bbf\u95ee\u8fdc\u7a0b\u670d\u52a1\u7aef\u7684\u5b58\u50a8\u8d44\u6e90\u3002</p> </li> </ul> <p>\u865a\u62df\u673a\u6a21\u62df\u914d\u7f6e iSCSI \u670d\u52a1\u7aef IP (192.168.10.10)\u3001\u5ba2\u6237\u7aef IP (192.168.10.20)\u3002</p>"},{"location":"linux/service/iscsi/#iscsi_1","title":"iSCSI \u670d\u52a1\u7aef\u914d\u7f6e","text":"<ol> <li>\u78c1\u76d8\u51c6\u5907</li> </ol> <p>\u6dfb\u52a0\u56db\u5757\u786c\u76d8\u7ed3\u5408 RAID \u9635\u5217\u4f5c\u4e3a iSCSI \u8d44\u6e90\u6c60\u3002</p> <pre><code>ll /dev/sd*\nbrw-rw----. 1 root disk 8,  0 8\u6708  25 22:23 /dev/sda\nbrw-rw----. 1 root disk 8,  1 8\u6708  25 22:23 /dev/sda1\nbrw-rw----. 1 root disk 8,  2 8\u6708  25 22:23 /dev/sda2\nbrw-rw----. 1 root disk 8, 16 8\u6708  25 22:23 /dev/sdb\nbrw-rw----. 1 root disk 8, 32 8\u6708  25 22:23 /dev/sdc\nbrw-rw----. 1 root disk 8, 48 8\u6708  25 22:23 /dev/sdd\nbrw-rw----. 1 root disk 8, 64 8\u6708  25 22:23 /dev/sde\n\nyum install -y mdadm\nmdadm -Cv /dev/md0 -n 3 -l 5 -x 1 /dev/sd[b-e]\nmdadm -D /dev/md0\n</code></pre> <ol> <li>\u5b89\u88c5 iSCSI \u670d\u52a1\u7aef\u53ca\u914d\u7f6e\u5de5\u5177</li> </ol> <pre><code>yum install -y targetd targetcli\nsystemctl enable targetd\nsystemctl start targetd\n</code></pre> <ol> <li>\u914d\u7f6e\u5171\u4eab\u8d44\u6e90\u6c60</li> </ol> <p>\u52a0\u5165 <code>/dev/md0</code> \u5230 iSCSI \u8d44\u6e90\u6c60\u3002</p> <pre><code>targetcli ls\ntargetcli /backstores/block create disk0 /dev/md5\ntargetcli ls\n</code></pre> <ol> <li>\u521b\u5efa\u5171\u4eab\u8d44\u6e90</li> </ol> <pre><code>targetcli /iscsi ls\niscsiname=`targetcli /iscsi create|grep \"iqn\"|awk '{print $3}'`\niscsiname=${iscsiname%.*}\necho $iscsiname &gt; ~/iscsi.name\ntargetcli /iscsi/${}/tpg1/luns create /backstores/block/disk0\n</code></pre> <p>${iscsiname%.*}: \u5220\u9664\u6700\u540e\u4e00\u4e2a<code>.</code>\u53ca\u5176\u53f3\u8fb9\u7684\u5b57\u7b26\u4e32\u3002</p> <ol> <li>\u8bbe\u7f6e\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08ACL)</li> </ol> <p>iSCSI\u534f\u8bae\u662f\u901a\u8fc7\u5ba2\u6237\u7aef\u540d\u79f0\u8fdb\u884c\u9a8c\u8bc1\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u8bbf\u95ee\u5b58\u50a8\u5171\u4eab\u8d44\u6e90\u65f6\u4e0d\u9700\u8981\u8f93\u5165\u5bc6\u7801\uff0c\u53ea\u8981iSCSI\u5ba2\u6237\u7aef\u7684\u540d\u79f0\u4e0e\u670d\u52a1\u7aef\u4e2d\u8bbe\u7f6e\u7684\u8bbf\u95ee\u63a7\u5236\u5217\u8868\u4e2d\u67d0\u4e00\u540d\u79f0\u6761\u76ee\u4e00\u81f4\u5373\u53ef\uff0c\u56e0\u6b64\u9700\u8981\u5728iSCSI\u670d\u52a1\u7aef\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u5199\u5165\u4e00\u4e32\u80fd\u591f\u9a8c\u8bc1\u7528\u6237\u4fe1\u606f\u7684\u540d\u79f0\u3002</p> <p><code>acls</code> \u76ee\u5f55\u7528\u4e8e\u5b58\u653e\u80fd\u591f\u8bbf\u95eeiSCSI\u670d\u52a1\u7aef\u5171\u4eab\u5b58\u50a8\u8d44\u6e90\u7684\u5ba2\u6237\u7aef\u540d\u79f0\u3002</p> <pre><code>targetcli /iscsi/${iscsiname}/tpg1/acls create ${iscsiname}:client\ntargetcli /iscsi ls\n</code></pre> <ol> <li>\u8bbe\u7f6e\u76d1\u542c ip \u5730\u5740\u548c\u7aef\u53e3\u53f7</li> </ol> <pre><code>targetcli /iscsi/${iscsiname}/tpg1/portals create 192.168.10.10\n\nsystemctl restart targetd\nfirewall-cmd --permanent --add-service=iscsi-target\nfirewall-cmd --reload\n</code></pre>"},{"location":"linux/service/iscsi/#iscsi_2","title":"iSCSI \u5ba2\u6237\u7aef\u914d\u7f6e","text":"<pre><code>yum install -y iscsi-initiator-utils\n\niscsiname=`ssh root@192.168.10.10 echo iscsi.name`\nsed -i \"s,InitiatorName=.*,InitiatorName=$iscsiname:client,g\" /etc/iscsi/initiatorname.iscsi\n\nsystemctl start iscsid\nsystemctl enable iscsid\n\niscsiadm -m discovery -t st -p 192.168.10.10\n\nfdisk -l\n\niscsiadm -m node -T $iscsiname -p 192.168.10.10 --login\n\nfdisk -l\nll /dev/sd*\n</code></pre> <p>\u53c2\u6570 <code>--login</code>: \u8fde\u63a5\u5171\u4eab\u8d44\u6e90\uff0c<code>-u</code>: \u9000\u51fa\u8fde\u63a5\u5171\u4eab\u8d44\u6e90</p>"},{"location":"linux/service/iscsi/#_1","title":"\u6302\u8f7d","text":"<pre><code>mkfs.xfs /dev/sdb\nmkdir /iscsi\n\nuuid=`blkid|grep /dev/sdb|awk '{print $2}'|sed 's,\\\",,g'`\necho \"$uuid /iscsi xfs defaults,_netdev 0 0\" &gt;&gt; /etc/fstab\nmount -a\n\ndf -Th\n</code></pre>"},{"location":"linux/service/ldap/","title":"Ldap","text":""},{"location":"linux/service/ldap/#ldap","title":"LDAP \u8f7b\u91cf\u7ea7\u76ee\u5f55\u670d\u52a1","text":"<p>\u4e00\u4e2a\u4e3a\u67e5\u8be2\u3001\u6d4f\u89c8\u548c\u641c\u7d22\u800c\u4f18\u5316\u7684\u4e13\u4e1a\u5206\u5e03\u5f0f\u6570\u636e\u5e93\uff0c\u5b83\u5448\u6811\u72b6\u7ed3\u6784\u7ec4\u7ec7\u6570\u636e\uff0c\u548c\u5173\u7cfb\u6570\u636e\u5e93\u4e0d\u540c\uff0c\u5b83\u6709\u4f18\u5f02\u7684\u8bfb\u6027\u80fd\uff0c\u4f46\u5199\u6027\u80fd\u5dee\uff0c\u5e76\u4e14\u6ca1\u6709\u4e8b\u52a1\u5904\u7406\u3001\u56de\u6eda\u7b49\u590d\u6742\u529f\u80fd\uff0c\u4e0d\u9002\u4e8e\u5b58\u50a8\u4fee\u6539\u9891\u7e41\u7684\u6570\u636e\uff0c\u6240\u4ee5\u5927\u591a\u6570\u662f\u7528\u6765\u67e5\u8be2\u7684\u3002</p> <p>LDAP \u91c7\u7528\u6811\u72b6\u7ed3\u6784\u5b58\u50a8\u6570\u636e\uff08\u7c7b\u4f3c\u4e8e DNS \u670d\u52a1\u7a0b\u5e8f\uff09\uff0c\u7528\u4e8e\u5728IP \u7f51\u7edc\u5c42\u9762\u5b9e\u73b0\u5bf9\u5206\u5e03\u5f0f\u76ee\u5f55\u7684\u8bbf\u95ee\u548c\u7ba1\u7406\u64cd\u4f5c\uff0c\u6761\u76ee\u662f LDAP \u534f\u8bae\u4e2d\u6700\u57fa\u672c\u7684\u5143\u7d20\uff0c\u53ef\u4ee5\u60f3\u8c61\u6210\u5b57\u5178\u4e2d\u7684\u5355\u8bcd\u6216\u8005\u6570\u636e\u5e93\u4e2d\u7684\u8bb0\u5f55\uff0c\u901a\u5e38\u5bf9 LDAP \u670d\u52a1\u7a0b\u5e8f\u7684\u6dfb\u52a0\u3001\u5220\u9664\u3001\u66f4\u6539\u3001\u641c\u7d22\u90fd\u662f\u4ee5\u6761\u76ee\u4e3a\u57fa\u672c\u5bf9\u8c61\u7684\u3002</p> <p></p> <ul> <li><code>dn</code>: \u6bcf\u4e2a\u6761\u76ee\u7684\u552f\u4e00\u6807\u8bc6\u7b26</li> <li><code>dc</code>: \u57df\u540d</li> <li><code>ou</code>: \u5355\u4f4d\uff08\u90e8\u95e8\uff09\u540d\u79f0</li> <li><code>cn</code>: \u540d\u5b57</li> <li><code>sn</code>: \u59d3\u6c0f</li> <li><code>o</code>: \u7ec4\u7ec7\uff08\u516c\u53f8\uff09\u540d\u79f0</li> <li><code>c</code>: \u56fd\u5bb6</li> </ul> <p>\u6bcf\u4e2a\u6761\u76ee\u53ef\u4ee5\u6709\u591a\u4e2a\u5c5e\u6027\uff08\u5982\u59d3\u540d\u3001\u5730\u5740\u3001\u7535\u8bdd\u7b49\uff09\uff0c\u6bcf\u4e2a\u5c5e\u6027\u4e2d\u4f1a\u4fdd\u5b58\u7740\u5bf9\u8c61\u540d\u79f0\u4e0e\u5bf9\u5e94\u503c\u3002</p>"},{"location":"linux/service/ldap/#_1","title":"\u5b9e\u9a8c\u73af\u5883","text":"\u4e3b\u673a\u540d\u79f0 ip \u5730\u5740 \u64cd\u4f5c\u7cfb\u7edf server.linuxprobe.com 192.168.10.10 CentOS 7 client.linuxprobe.com 192.168.10.20 CentOS 7"},{"location":"linux/service/ldap/#_2","title":"\u670d\u52a1\u7aef\u914d\u7f6e","text":"<p>OpenLDAP \u662f\u63d0\u4f9b\u7ba1\u7406\u76ee\u5f55\u6570\u636e\u7684\u670d\u52a1\u7684\u8f6f\u4ef6\u4ea7\u54c1\uff0c\u591a\u6570\u573a\u666f\u7528\u6765\u505a\u7edf\u4e00\u767b\u5f55\u8ba4\u8bc1\u3002</p> <ol> <li>\u5b89\u88c5 openldap \u76f8\u5173\u8f6f\u4ef6\u5305</li> </ol> <pre><code>yum install -y openldap openldap-clients openldap-servers migrationtools\n</code></pre> <ol> <li>\u751f\u6210\u79d8\u94a5\u6587\u4ef6</li> </ol> <pre><code>slappasswd -s linuxprobe -n &gt; /etc/openldap/passwd\nopenldappasswd=`cat /etc/openldap/passwd`\n\necho $openldappasswd\necho \"192.168.10.10 server.linuxprobe.com\" &gt;&gt; /etc/hosts\n</code></pre> <ol> <li>TLS \u52a0\u5bc6\u6570\u636e\u4f20\u8f93</li> </ol> <p>LDAP \u670d\u52a1\u9ed8\u8ba4\u4ee5\u660e\u6587\u65b9\u5f0f\u5728\u7f51\u7edc\u4e2d\u4f20\u8f93\u6570\u636e\uff08\u5305\u62ec\u5bc6\u7801\uff09\u3002</p> <pre><code>openssl req -new -x509 -nodes -out /etc/openldap/certs/cert.pem -keyout /etc/openldap/certs/priv.pem -days 365\n\nls -al /etc/openldap/certs/\nchown -R ldap.ldap /etc/openldap/certs\nchmod -R 600 /etc/openldap/certs/priv.pem\n</code></pre> <p>\u4e00\u8def\u56de\u8f66\u5373\u53ef\u3002</p> <ol> <li>\u751f\u6210\u6570\u636e\u5e93\u6587\u4ef6</li> </ol> <pre><code>cp /usr/share/openldap-servers/DB_CONFIG.example /var/lib/ldap/DB_CONFIG\n\nslaptest\n\nchown -R ldap.ldap /var/lib/ldap\n\nsystemctl restart slapd\n</code></pre> <ol> <li>\u6dfb\u52a0\u6a21\u5757</li> </ol> <p>\u5728 LDAP \u76ee\u5f55\u670d\u52a1\u4e2d\u4f7f\u7528 LDIF (LDAP Interchange Format)\u683c\u5f0f\u6765\u4fdd\u5b58\u4fe1\u606f\uff0c\u800c LDIF \u662f\u4e00\u79cd\u6807\u51c6\u7684\u6587\u672c\u6587\u4ef6\u4e14\u53ef\u4ee5\u968f\u610f\u7684\u5bfc\u5165\u5bfc\u51fa\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u6709\u4e00\u79cd\u201c\u683c\u5f0f\u201d\u6807\u51c6\u5316 LDIF \u6587\u4ef6\u7684\u5199\u6cd5\uff0c\u8fd9\u4e2d\u683c\u5f0f\u53eb\u505a\u201cschema\u201d\u3002</p> <p>schema \u7528\u4e8e\u6307\u5b9a\u4e00\u4e2a\u76ee\u5f55\u4e2d\u6240\u5305\u542b\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u4ee5\u53ca\u6bcf\u4e00\u4e2a\u7c7b\u578b\u4e2d\u7684\u53ef\u9009\u5c5e\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06 schema \u7406\u89e3\u4e3a\u9762\u5411\u5bf9\u8c61\u7a0b\u5e8f\u8bbe\u8ba1\u4e2d\u7684\u201c\u7c7b\u201d\uff0c\u901a\u8fc7\u201c\u7c7b\u201d\u5b9a\u4e49\u51fa\u5177\u4f53\u7684\u5bf9\u8c61\uff0c\u56e0\u6b64\u5176\u5b9e LDIF \u6570\u636e\u6761\u76ee\u5219\u90fd\u662f\u901a\u8fc7 schema \u6570\u636e\u6a21\u578b\u521b\u5efa\u51fa\u6765\u7684\u5177\u4f53\u5bf9\u8c61\u3002</p> <ul> <li><code>ldapadd</code>: \u7528\u4e8e\u5c06 LDIF \u6587\u4ef6\u5bfc\u5165\u76ee\u5f55\u670d\u52a1\u6570\u636e\u5e93\u4e2d\u3002</li> <li><code>-x</code>: \u8fdb\u884c\u7b80\u5355\u8ba4\u8bc1\u3002</li> <li><code>-D</code>: \u7528\u4e8e\u7ed1\u5b9a\u670d\u52a1\u5668\u7684 dn\u3002</li> <li><code>-h</code>: \u6307\u5b9a\u76ee\u5f55\u670d\u52a1\u5668\u7684\u5730\u5740\u3002</li> <li><code>-w</code>: \u7ed1\u5b9a dn \u7684\u5bc6\u7801\u3002</li> <li><code>-f</code>: \u6307\u5b9a ldif \u6587\u4ef6\u8fdb\u884c\u6761\u76ee\u6dfb\u52a0\u7684\u6587\u4ef6\u3002</li> </ul> <p>\u6dfb\u52a0 cosine \u548c nis \u6a21\u5757\uff1a</p> <pre><code>ldapadd -Y EXTERNAL -H ldapi:/// -D \"cn=config\" -f /etc/openldap/schema/cosine.ldif\n\ncat &lt;&lt;EOF&gt; /etc/openldap/changes.ldif\ndn: olcDatabase={2}hdb,cn=config\nchangetype: modify\nreplace: olcSuffix\nolcSuffix: dc=linuxprobe,dc=com\n\ndn: olcDatabase={2}hdb,cn=config\nchangetype:modify\nreplace: olcRootDN\nolcRootDN: cn=Manager,dc=linuxprobe,dc=com\n\ndn: olcDatabase={2}hdb,cn=config\nchangetype: modify\nreplace: olcRootPW\nolcRootPW: $openldappasswd\n\ndn: cn=config\nchangetype: modify\nreplace: olcTLSCertificateFile\nolcTLSCertificateFile: /etc/openldap/certs/cert.pem\n\ndn: cn=config\nchangetype: modify\nreplace: olcTLSCertificateKeyFile\nolcTLSCertificateKeyFile: /etc/openldap/certs/priv.pem\n\ndn: cn=config\nchangetype: modify\nreplace: olcLogLevel\nolcLogLevel: -1\n\ndn: olcDatabase={1}monitor,cn=config\nchangetype: modify\nreplace: olcAccess\nolcAccess: {0}to * by dn.base=\"gidNumber=0+uidNumber=0,cn=peercred,cn=external,cn=auth\" read by dn.base=\"cn=Manager,dc=linuxprobe,dc=com\" read by * none\nEOF\n\nldapmodify -Y EXTERNAL -H ldapi:/// -f /etc/openldap/changes.ldif\n</code></pre> <ol> <li>\u521d\u59cb\u5316 openldap \u670d\u52a1\u7ba1\u7406\u6743\u9650</li> </ol> <pre><code>slappasswd -s linuxprobe -n /etc/openldap/passwd\nopenldappasswd=`cat /etc/openldap/passwd`\n\nsed -i 's/dc=my-domain,dc=com/dc=linuxprobe,dc=com,dc=cn/g'  /etc/openldap/slapd.d/cn\\=config/olcDatabase\\=\\{2\\}hdb.ldif\nsed -i \"/olcRootDN/a\\oclRootPW: $openldappasswd\" /etc/openldap/slapd.d/cn\\=config/olcDatabase\\=\\{2\\}hdb.ldif\n\nslaptest -u\n</code></pre> <ol> <li>\u914d\u7f6e Openldap \u6570\u636e\u5e93</li> </ol> <pre><code>cp /usr/share/openldap-servers/DB_CONFIG.example /var/lib/ldap/DB_CONFIG\n\nchown ldap.ldap -R /var/lib/ldap/\nchmod 700 -R /var/lib/ldap/\nls -al /var/lib/ldap/\n\nldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/cosine.ldif\n\nldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/nis.ldif\n\nldapadd -Y EXTERNAL -H ldapi:/// -f /etc/openldap/schema/inetorgperson.ldif\n</code></pre> <ol> <li>\u521d\u59cb\u5316\u7ec4\u7ec7\u67b6\u6784\u53ca\u6dfb\u52a0\u521d\u59cb\u7528\u6237\u548c\u7ec4</li> </ol> <pre><code>sed -i 's,$DEFAULT_MAIL_DOMAIN =.*,$DEFAULT_MAIL_DOMAIN = \"linuxprobe.com\";,' /usr/share/migrationtools/migrate_common.ph\n\nsed -i 's,$DEFAULT_BASE =.*,$DEFAULT_BASE = \"dc=linuxprobe\\,dc=com\";,' /usr/share/migrationtools/migrate_common.ph\n\nsed -i 's,$EXTENDED_SCHEMA =.*,$EXTENDED_SCHEMA = 1;,' /usr/share/migrationtools/migrate_common.ph\n\ngroupadd OPS\ngroupadd HR\nuseradd -g OPS charles\nuseradd -g HR fiona\necho \"123456\" | passwd --stdin charles\necho \"123456\" | passwd --stdin fiona\ngrep \"OPS\" /etc/group &gt; groups\ngrep \"HR\" /etc/group &gt;&gt; groups\ngrep \"charles\" /etc/passwd &gt; users\ngrep \"fiona\" /etc/passwd &gt;&gt; users\n/usr/share/migrationtools/migrate_passwd.pl users &gt; users.ldif\n/usr/share/migrationtools/migrate_group.pl groups &gt; groups.ldif\n\ncat &lt;&lt;EOF&gt; base.ldif\ndn: dc=linuxprobe,dc=com\no: linuxprobe.com\ndc: linuxprobe\nobjectClass: top\nobjectClass: domain\n\ndn: ou=People,dc=linuxprobe,dc=com\nou: People\nobjectClass: top\nobjectClass: organizationalUnit\n\ndn: ou=Group,dc=linuxprobe,dc=com\nou: Group\nobjectClass: top\nobjectClass: organizationalUnit\nEOF\n\nldapadd -x -w \"linuxprobe\" -D \"cn=Manager,dc=linuxprobe,dc=com\" -f base.ldif\n\nldapadd -x -w \"linuxprobe\" -D cn=Manager,dc=linuxprobe,dc=com -f users.ldif\n\nldapadd -x -w \"linuxprobe\" -D cn=Manager,dc=linuxprobe,dc=com -f groups.ldif\n</code></pre>"},{"location":"linux/service/lvm/","title":"Lvm","text":""},{"location":"linux/service/lvm/#lvm","title":"LVM \u903b\u8f91\u5377\u7ba1\u7406\u5668","text":"<p>LVM(Logical Volume Manager)\u903b\u8f91\u5377\u7ba1\u7406\u662f\u5728Linux 2.4 \u5185\u6838\u4ee5\u4e0a\u5b9e\u73b0\u7684\u78c1\u76d8\u7ba1\u7406\u6280\u672f\u3002\u5b83\u662f Linux \u73af\u5883\u4e0b\u5bf9\u78c1\u76d8\u5206\u533a\u8fdb\u884c\u7ba1\u7406\u7684\u4e00\u79cd\u673a\u5236\u3002</p> <p>\u5f53\u9047\u5230\u67d0\u4e2a\u5206\u533a\u7a7a\u95f4\u8017\u5c3d\u65f6\uff0c\u89e3\u51b3\u7684\u65b9\u6cd5\u901a\u5e38\u662f\u4f7f\u7528\u7b26\u53f7\u94fe\u63a5\uff0c\u6216\u8005\u4f7f\u7528\u8c03\u6574\u5206\u533a\u5927\u5c0f\u7684\u5de5\u5177\uff0c\u4f46\u8fd9\u53ea\u662f\u6682\u65f6\u89e3\u51b3\u529e\u6cd5\uff0c\u6ca1\u6709\u4ece\u6839\u672c\u4e0a\u89e3\u51b3\u95ee\u9898\u3002\u968f\u7740Linux \u7684\u903b\u8f91\u5377\u7ba1\u7406\u529f\u80fd\u7684\u51fa\u73b0\uff0c\u8fd9\u4e9b\u95ee\u9898\u90fd\u8fce\u5203\u800c\u89e3\uff0c\u7528\u6237\u5728\u65e0\u9700\u505c\u673a\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u65b9\u4fbf\u5730\u8c03\u6574\u5404\u4e2a\u5206\u533a\u5927\u5c0f\u3002</p> <p>LVM \u6280\u672f\u662f\u5728\u786c\u76d8\u5206\u533a\u548c\u6587\u4ef6\u7cfb\u7edf\u4e4b\u95f4\u6dfb\u52a0\u4e86\u4e00\u4e2a\u903b\u8f91\u5c42\uff0c\u5b83\u63d0\u4f9b\u4e86\u4e00\u4e2a\u62bd\u8c61\u7684\u5377\u7ec4\uff0c\u53ef\u4ee5\u628a\u591a\u5757\u786c\u76d8\u8fdb\u884c\u5377\u7ec4\u5408\u5e76\u3002\u7528\u6237\u4e0d\u5fc5\u5173\u5fc3\u7269\u7406\u786c\u76d8\u8bbe\u5907\u7684\u5e95\u5c42\u67b6\u6784\u548c\u5e03\u5c40\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5bf9\u786c\u76d8\u5206\u533a\u7684\u52a8\u6001\u8c03\u6574\u3002</p> <p></p> <ul> <li>\u547d\u4ee4</li> </ul> \u529f\u80fd \u7269\u7406\u5377 PV \u5377\u7ec4 VG \u903b\u8f91\u5377 LV \u626b\u63cf pvscan vgscan lvscan \u521b\u5efa pvcreate vgcreate lvcreate \u67e5\u770b pvdisplay vgdisplay lvdisplay \u5220\u9664 pvremove vgremove lvremove \u6269\u5c55 vgextend lvextend \u7f29\u5c0f vgreduce lvreduce"},{"location":"linux/service/lvm/#_1","title":"\u521b\u5efa\u7269\u7406\u5377","text":"<p>\u51c6\u5907\u51e0\u5757\u78c1\u76d8</p> <pre><code>[root@localhost ~]# ll /dev/sd*\nbrw-rw----. 1 root disk 8,  0 7\u6708  31 06:52 /dev/sda\nbrw-rw----. 1 root disk 8,  1 7\u6708  31 06:52 /dev/sda1\nbrw-rw----. 1 root disk 8,  2 7\u6708  31 06:52 /dev/sda2\nbrw-rw----. 1 root disk 8, 16 7\u6708  31 07:41 /dev/sdb\nbrw-rw----. 1 root disk 8, 32 7\u6708  31 07:41 /dev/sdc\n</code></pre> <p>\u8ba9 <code>/dev/sdb</code>\u3001<code>/dev/sdc</code> \u652f\u6301 LVM</p> <pre><code>[root@localhost ~]# pvcreate /dev/sdb /dev/sdc\n  Physical volume \"/dev/sdb\" successfully created.\n  Physical volume \"/dev/sdc\" successfully created.\n[root@localhost ~]#\n</code></pre>"},{"location":"linux/service/lvm/#_2","title":"\u521b\u5efa\u5377\u7ec4","text":"<p>\u521b\u5efa\u4e00\u4e2a\u5377\u7ec4\uff0c\u5e76\u628a <code>/dev/sdb</code>\u3001<code>/dev/sdc</code> \u52a0\u5165\u5230\u5377\u7ec4</p> <pre><code>[root@localhost ~]# vgcreate vg1 /dev/sdb /dev/sdc\n  Volume group \"vg1\" successfully created\n[root@localhost ~]# vgs\n  VG     #PV #LV #SN Attr   VSize  VFree\n  centos   1   2   0 wz--n- &lt;9.00g    0\n  vg1      2   0   0 wz--n-  9.99g 9.99g\n[root@localhost ~]# vgdisplay\n  --- Volume group ---\n  VG Name               vg1\n  System ID\n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  1\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                0\n  Open LV               0\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               9.99 GiB\n  PE Size               4.00 MiB\n  Total PE              2558\n  Alloc PE / Size       0 / 0\n  Free  PE / Size       2558 / 9.99 GiB\n  VG UUID               LESM13-wmSU-sTAN-RFi3-qbsn-WEdg-LSay6x\n\n  --- Volume group ---\n  VG Name               centos\n  System ID\n  Format                lvm2\n  Metadata Areas        1\n  Metadata Sequence No  3\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                2\n  Open LV               2\n  Max PV                0\n  Cur PV                1\n  Act PV                1\n  VG Size               &lt;9.00 GiB\n  PE Size               4.00 MiB\n  Total PE              2303\n  Alloc PE / Size       2303 / &lt;9.00 GiB\n  Free  PE / Size       0 / 0\n  VG UUID               13hZJW-bqaq-SWSX-dA7U-xjT3-AiBE-4jwgDt\n\n[root@localhost ~]#\n</code></pre> <ul> <li>PE \u5927\u5c0f\u8c03\u6574</li> </ul> <p>PE \u9ed8\u8ba4\u5927\u5c0f 4m</p> <ol> <li>\u521b\u5efa\u5377\u7ec4\u65f6\u8c03\u6574\u9ed8\u8ba4 PE \u5927\u5c0f: <code>vgcreate -s 16m vg1 /dev/sdb /dev/sdc</code></li> <li>vgchange \u547d\u4ee4\u8c03\u6574: <code>vgchange vg1 -s 4m</code></li> </ol>"},{"location":"linux/service/lvm/#_3","title":"\u5207\u5272\u903b\u8f91\u5377","text":"<p>\u5728\u5bf9\u903b\u8f91\u5377\u8fdb\u884c\u5207\u5272\u65f6\u6709\u4e24\u79cd\u8ba1\u91cf\u5355\u4f4d\u3002</p> <p>\u7b2c\u4e00\u79cd\u662f\u4ee5\u5bb9\u91cf\u4e3a\u5355\u4f4d\uff0c\u6240\u4f7f\u7528\u7684\u53c2\u6570\u4e3a-L\u3002\u4f8b\u5982\uff0c\u4f7f\u7528-L 150M\u751f\u6210\u4e00\u4e2a\u5927\u5c0f\u4e3a150MB\u7684\u903b\u8f91\u5377\u3002</p> <pre><code>[root@localhost ~]# lvs\n  LV   VG     Attr       LSize  Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert\n  root centos -wi-ao---- &lt;8.00g\n  swap centos -wi-ao----  1.00g\n[root@localhost ~]# lvcreate -n lv1 -L 300m vg1\n  Logical volume \"lv1\" created.\n[root@localhost ~]# lvs\n  LV   VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert\n  root centos -wi-ao----  &lt;8.00g\n  swap centos -wi-ao----   1.00g\n  lv1  vg1    -wi-a----- 300.00m\n[root@localhost ~]# lvdisplay vg1/lv1\n  --- Logical volume ---\n  LV Path                /dev/vg1/lv1\n  LV Name                lv1\n  VG Name                vg1\n  LV UUID                PYFQkX-MBIr-Edd2-aeJu-QSkk-c56U-3NMR1v\n  LV Write Access        read/write\n  LV Creation host, time localhost.localdomain, 2019-08-01 07:59:01 +0800\n  LV Status              available\n  # open                 0\n  LV Size                300.00 MiB\n  Current LE             75\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     8192\n  Block device           253:2\n\n[root@localhost ~]#\n</code></pre> <p>\u53e6\u5916\u4e00\u79cd\u662f\u4ee5\u57fa\u672c\u5355\u5143\u7684\u4e2a\u6570\u4e3a\u5355\u4f4d\uff0c\u6240\u4f7f\u7528\u7684\u53c2\u6570\u4e3a-l\u3002\u6bcf\u4e2a\u57fa\u672c\u5355\u5143\u7684\u5927\u5c0f\u9ed8\u8ba4\u4e3a4MB\u3002\u4f8b\u5982\uff0c\u4f7f\u7528-l 37\u53ef\u4ee5\u751f\u6210\u4e00\u4e2a\u5927\u5c0f\u4e3a37\u00d74MB=148MB\u7684\u903b\u8f91\u5377\u3002</p> <pre><code>[root@localhost ~]# lvcreate -n lv2 -l 37 vg1\n  Logical volume \"lv2\" created.\n[root@localhost ~]# lvs\n  LV   VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert\n  root centos -wi-ao----  &lt;8.00g\n  swap centos -wi-ao----   1.00g\n  lv1  vg1    -wi-a----- 148.00m\n  lv2  vg1    -wi-a----- 148.00m\n[root@localhost ~]# lvdisplay /dev/vg1/lv\n/dev/vg1/lv1  /dev/vg1/lv2\n[root@localhost ~]# lvdisplay /dev/vg1/lv2\n  --- Logical volume ---\n  LV Path                /dev/vg1/lv2\n  LV Name                lv2\n  VG Name                vg1\n  LV UUID                QbKDQ8-ieSy-ThbL-Z2YI-K23k-hm77-ZdEaWb\n  LV Write Access        read/write\n  LV Creation host, time localhost.localdomain, 2019-08-01 07:55:52 +0800\n  LV Status              available\n  # open                 0\n  LV Size                148.00 MiB\n  Current LE             37\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     8192\n  Block device           253:3\n\n[root@localhost ~]#\n</code></pre>"},{"location":"linux/service/lvm/#_4","title":"\u683c\u5f0f\u5316\u903b\u8f91\u5377","text":"<pre><code>[root@localhost ~]# mkfs.xfs /dev/vg1/lv1\nmeta-data=/dev/vg1/lv1           isize=512    agcount=4, agsize=19200 blks\n         =                       sectsz=512   attr=2, projid32bit=1\n         =                       crc=1        finobt=0, sparse=0\ndata     =                       bsize=4096   blocks=76800, imaxpct=25\n         =                       sunit=0      swidth=0 blks\nnaming   =version 2              bsize=4096   ascii-ci=0 ftype=1\nlog      =internal log           bsize=4096   blocks=855, version=2\n         =                       sectsz=512   sunit=0 blks, lazy-count=1\nrealtime =none                   extsz=4096   blocks=0, rtextents=0\n[root@localhost ~]# mkdir /test1\n[root@localhost ~]# cat &lt;&lt;end&gt;&gt; /etc/fstab\n&gt; /dev/vg1/lv1 /test1 xfs defaults 0 0\n&gt; end\n[root@localhost ~]# cat /etc/fstab\n#\n# /etc/fstab\n# Created by anaconda on Wed Jun 12 21:56:17 2019\n#\n# Accessible filesystems, by reference, are maintained under '/dev/disk'\n# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info\n#\n/dev/mapper/centos-root /                       xfs     defaults        0 0\nUUID=b9d39bf8-743f-4a01-b856-33688690ada4 /boot                   xfs     defaults        0 0\n/dev/mapper/centos-swap swap                    swap    defaults        0 0\n/dev/vg1/lv1 /test1 xfs defaults 0 0\n[root@localhost ~]# mount -a\n[root@localhost ~]# df -h\n\u6587\u4ef6\u7cfb\u7edf                 \u5bb9\u91cf  \u5df2\u7528  \u53ef\u7528 \u5df2\u7528% \u6302\u8f7d\u70b9\n/dev/mapper/centos-root  8.0G  2.0G  6.1G   24% /\ndevtmpfs                 475M     0  475M    0% /dev\ntmpfs                    487M     0  487M    0% /dev/shm\ntmpfs                    487M  7.5M  479M    2% /run\ntmpfs                    487M     0  487M    0% /sys/fs/cgroup\n/dev/sda1               1014M  194M  821M   20% /boot\ntmpfs                     98M     0   98M    0% /run/user/0\n/dev/mapper/vg1-lv1      297M   16M  282M    6% /test1\n[root@localhost ~]#\n</code></pre>"},{"location":"linux/service/lvm/#_5","title":"\u6269\u5bb9\u903b\u8f91\u5377","text":"<ul> <li>xfs \u683c\u5f0f</li> </ul> <pre><code>[root@localhost ~]# vgdisplay vg1\n  --- Volume group ---\n  VG Name               vg1\n  System ID\n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  6\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                1\n  Open LV               1\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               9.99 GiB\n  PE Size               4.00 MiB\n  Total PE              2558\n  Alloc PE / Size       75 / 300.00 MiB\n  Free  PE / Size       2483 / &lt;9.70 GiB\n  VG UUID               o1xUxv-U8yj-EDEw-YYz8-PTSl-XfmW-w0CMe5\n\n[root@localhost ~]# lvextend -L 500m /dev/vg1/lv1\n  Size of logical volume vg1/lv1 changed from 300.00 MiB (75 extents) to 500.00 MiB (125 extents).\n  Logical volume vg1/lv1 successfully resized.\n[root@localhost ~]# xfs_growfs /dev/vg1/lv1\nmeta-data=/dev/mapper/vg1-lv1    isize=512    agcount=4, agsize=19200 blks\n         =                       sectsz=512   attr=2, projid32bit=1\n         =                       crc=1        finobt=0 spinodes=0\ndata     =                       bsize=4096   blocks=76800, imaxpct=25\n         =                       sunit=0      swidth=0 blks\nnaming   =version 2              bsize=4096   ascii-ci=0 ftype=1\nlog      =internal               bsize=4096   blocks=855, version=2\n         =                       sectsz=512   sunit=0 blks, lazy-count=1\nrealtime =none                   extsz=4096   blocks=0, rtextents=0\ndata blocks changed from 76800 to 128000\n[root@localhost ~]# df -h\n\u6587\u4ef6\u7cfb\u7edf                 \u5bb9\u91cf  \u5df2\u7528  \u53ef\u7528 \u5df2\u7528% \u6302\u8f7d\u70b9\n/dev/mapper/centos-root  8.0G  2.0G  6.1G   24% /\ndevtmpfs                 475M     0  475M    0% /dev\ntmpfs                    487M     0  487M    0% /dev/shm\ntmpfs                    487M  7.5M  479M    2% /run\ntmpfs                    487M     0  487M    0% /sys/fs/cgroup\n/dev/sda1               1014M  194M  821M   20% /boot\ntmpfs                     98M     0   98M    0% /run/user/0\n/dev/mapper/vg1-lv1      497M   16M  482M    4% /test1\n[root@localhost ~]#\n</code></pre> <ul> <li>ext* \u683c\u5f0f</li> </ul> <pre><code>[root@localhost ~]# lvs\n  LV   VG     Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert\n  root centos -wi-ao----  &lt;8.00g\n  swap centos -wi-ao----   1.00g\n  lv1  vg1    -wi-ao---- 500.00m\n  lv2  vg1    -wi-a----- 148.00m\n[root@localhost ~]# mkfs.ext4 /dev/vg1/lv2\nmke2fs 1.42.9 (28-Dec-2013)\n\u6587\u4ef6\u7cfb\u7edf\u6807\u7b7e=\nOS type: Linux\n\u5757\u5927\u5c0f=1024 (log=0)\n\u5206\u5757\u5927\u5c0f=1024 (log=0)\nStride=0 blocks, Stripe width=0 blocks\n38000 inodes, 151552 blocks\n7577 blocks (5.00%) reserved for the super user\n\u7b2c\u4e00\u4e2a\u6570\u636e\u5757=1\nMaximum filesystem blocks=33816576\n19 block groups\n8192 blocks per group, 8192 fragments per group\n2000 inodes per group\nSuperblock backups stored on blocks:\n    8193, 24577, 40961, 57345, 73729\n\nAllocating group tables: \u5b8c\u6210\n\u6b63\u5728\u5199\u5165inode\u8868: \u5b8c\u6210\nCreating journal (4096 blocks): \u5b8c\u6210\nWriting superblocks and filesystem accounting information: \u5b8c\u6210\n\n[root@localhost ~]# mkdir /test2\n[root@localhost ~]# cat &lt;&lt;end&gt;&gt; /etc/fstab\n&gt; /dev/vg1/lv2 /test2 ext4 defaults 0 0\n&gt; end\n[root@localhost ~]# mount -a\n[root@localhost ~]# df -h\n\u6587\u4ef6\u7cfb\u7edf                 \u5bb9\u91cf  \u5df2\u7528  \u53ef\u7528 \u5df2\u7528% \u6302\u8f7d\u70b9\n/dev/mapper/centos-root  8.0G  2.0G  6.1G   24% /\ndevtmpfs                 475M     0  475M    0% /dev\ntmpfs                    487M     0  487M    0% /dev/shm\ntmpfs                    487M  7.5M  479M    2% /run\ntmpfs                    487M     0  487M    0% /sys/fs/cgroup\n/dev/sda1               1014M  194M  821M   20% /boot\ntmpfs                     98M     0   98M    0% /run/user/0\n/dev/mapper/vg1-lv1      497M   16M  482M    4% /test1\n/dev/mapper/vg1-lv2      140M  1.6M  128M    2% /test2\n[root@localhost ~]# lvextend -L 300m vg1/lv2\n  Size of logical volume vg1/lv2 changed from 148.00 MiB (37 extents) to 300.00 MiB (75 extents).\n  Logical volume vg1/lv2 successfully resized.\n[root@localhost ~]# resize2fs /dev/vg1/lv2\nresize2fs 1.42.9 (28-Dec-2013)\nFilesystem at /dev/vg1/lv2 is mounted on /test2; on-line resizing required\nold_desc_blocks = 2, new_desc_blocks = 3\nThe filesystem on /dev/vg1/lv2 is now 307200 blocks long.\n\n[root@localhost ~]# df -h\n\u6587\u4ef6\u7cfb\u7edf                 \u5bb9\u91cf  \u5df2\u7528  \u53ef\u7528 \u5df2\u7528% \u6302\u8f7d\u70b9\n/dev/mapper/centos-root  8.0G  2.0G  6.1G   24% /\ndevtmpfs                 475M     0  475M    0% /dev\ntmpfs                    487M     0  487M    0% /dev/shm\ntmpfs                    487M  7.5M  479M    2% /run\ntmpfs                    487M     0  487M    0% /sys/fs/cgroup\n/dev/sda1               1014M  194M  821M   20% /boot\ntmpfs                     98M     0   98M    0% /run/user/0\n/dev/mapper/vg1-lv1      497M   16M  482M    4% /test1\n/dev/mapper/vg1-lv2      287M  2.1M  269M    1% /test2\n[root@localhost ~]#\n</code></pre>"},{"location":"linux/service/lvm/#_6","title":"\u7f29\u5bb9\u903b\u8f91\u5377","text":"<p>\u7f29\u5bb9\u64cd\u4f5c\u524d\u8bb0\u5f97\u5148\u5907\u4efd\u597d\u6570\u636e\uff0c\u5e76\u5378\u8f7d\u6302\u8f7d\u70b9\u3002</p> <p>xfs \u683c\u5f0f \u4e0d\u652f\u6301\u7f29\u5bb9\u3002</p> <pre><code>[root@localhost ~]# df -h\n\u6587\u4ef6\u7cfb\u7edf                 \u5bb9\u91cf  \u5df2\u7528  \u53ef\u7528 \u5df2\u7528% \u6302\u8f7d\u70b9\n/dev/mapper/centos-root  8.0G  2.0G  6.1G   24% /\ndevtmpfs                 475M     0  475M    0% /dev\ntmpfs                    487M     0  487M    0% /dev/shm\ntmpfs                    487M  7.5M  479M    2% /run\ntmpfs                    487M     0  487M    0% /sys/fs/cgroup\n/dev/sda1               1014M  194M  821M   20% /boot\ntmpfs                     98M     0   98M    0% /run/user/0\n/dev/mapper/vg1-lv1      497M   16M  482M    4% /test1\n/dev/mapper/vg1-lv2      287M  2.1M  269M    1% /test2\n[root@localhost ~]# resize2fs /dev/vg1/lv2 100m\nresize2fs 1.42.9 (28-Dec-2013)\nFilesystem at /dev/vg1/lv2 is mounted on /test2; on-line resizing required\nresize2fs: On-line shrinking not supported\n[root@localhost ~]# df -h\n\u6587\u4ef6\u7cfb\u7edf                 \u5bb9\u91cf  \u5df2\u7528  \u53ef\u7528 \u5df2\u7528% \u6302\u8f7d\u70b9\n/dev/mapper/centos-root  8.0G  2.0G  6.1G   24% /\ndevtmpfs                 475M     0  475M    0% /dev\ntmpfs                    487M     0  487M    0% /dev/shm\ntmpfs                    487M  7.5M  479M    2% /run\ntmpfs                    487M     0  487M    0% /sys/fs/cgroup\n/dev/sda1               1014M  194M  821M   20% /boot\ntmpfs                     98M     0   98M    0% /run/user/0\n/dev/mapper/vg1-lv1      497M   16M  482M    4% /test1\n/dev/mapper/vg1-lv2      287M  2.1M  269M    1% /test2\n[root@localhost ~]# umount /test2/\n[root@localhost ~]# resize2fs /dev/vg1/lv2 100m\nresize2fs 1.42.9 (28-Dec-2013)\n\u8bf7\u5148\u8fd0\u884c 'e2fsck -f /dev/vg1/lv2'.\n\n[root@localhost ~]# e2fsck -f .\n./             ../            .bash_history  .bash_logout   .bash_profile  .bashrc        .cshrc         .pki/          .ssh/          .tcshrc        .viminfo\n[root@localhost ~]# e2fsck -f /dev/vg1/lv2\ne2fsck 1.42.9 (28-Dec-2013)\n\u7b2c\u4e00\u6b65: \u68c0\u67e5inode,\u5757,\u548c\u5927\u5c0f\n\u7b2c\u4e8c\u6b65: \u68c0\u67e5\u76ee\u5f55\u7ed3\u6784\n\u7b2c3\u6b65: \u68c0\u67e5\u76ee\u5f55\u8fde\u63a5\u6027\nPass 4: Checking reference counts\n\u7b2c5\u6b65: \u68c0\u67e5\u7c07\u6982\u8981\u4fe1\u606f\n/dev/vg1/lv2: 11/76000 files (0.0% non-contiguous), 15759/307200 blocks\n[root@localhost ~]# resize2fs /dev/vg1/lv2 100m\nresize2fs 1.42.9 (28-Dec-2013)\nResizing the filesystem on /dev/vg1/lv2 to 102400 (1k) blocks.\nThe filesystem on /dev/vg1/lv2 is now 102400 blocks long.\n\n[root@localhost ~]# mount -a\n[root@localhost ~]# df -h\n\u6587\u4ef6\u7cfb\u7edf                 \u5bb9\u91cf  \u5df2\u7528  \u53ef\u7528 \u5df2\u7528% \u6302\u8f7d\u70b9\n/dev/mapper/centos-root  8.0G  2.0G  6.1G   24% /\ndevtmpfs                 475M     0  475M    0% /dev\ntmpfs                    487M     0  487M    0% /dev/shm\ntmpfs                    487M  7.5M  479M    2% /run\ntmpfs                    487M     0  487M    0% /sys/fs/cgroup\n/dev/sda1               1014M  194M  821M   20% /boot\ntmpfs                     98M     0   98M    0% /run/user/0\n/dev/mapper/vg1-lv1      497M   16M  482M    4% /test1\n/dev/mapper/vg1-lv2       93M  1.6M   85M    2% /test2\n[root@localhost ~]#\n</code></pre>"},{"location":"linux/service/lvm/#_7","title":"\u903b\u8f91\u5377\u5feb\u7167","text":"<p>LVM\u8fd8\u5177\u5907\u6709\u201c\u5feb\u7167\u5377\u201d\u529f\u80fd\uff0c\u8be5\u529f\u80fd\u7c7b\u4f3c\u4e8e\u865a\u62df\u673a\u8f6f\u4ef6\u7684\u8fd8\u539f\u65f6\u95f4\u70b9\u529f\u80fd\u3002</p> <p>\u5feb\u7167\u5377\u7684\u5bb9\u91cf\u5fc5\u987b\u7b49\u540c\u4e8e\u903b\u8f91\u5377\u7684\u5bb9\u91cf\uff1b</p> <p>\u6240\u5728\u5377\u7ec4\u6709\u8db3\u591f\u5bb9\u91cf\uff1b</p> <p>\u5feb\u7167\u5377\u4ec5\u4e00\u6b21\u6709\u6548\uff0c\u4e00\u65e6\u6267\u884c\u8fd8\u539f\u64cd\u4f5c\u540e\u5219\u4f1a\u88ab\u7acb\u5373\u81ea\u52a8\u5220\u9664\u3002</p> <ul> <li>\u521b\u5efa\u5feb\u7167</li> </ul> <pre><code>[root@localhost ~]# vgdisplay vg1\n  --- Volume group ---\n  VG Name               vg1\n  System ID\n  Format                lvm2\n  Metadata Areas        2\n  Metadata Sequence No  9\n  VG Access             read/write\n  VG Status             resizable\n  MAX LV                0\n  Cur LV                2\n  Open LV               2\n  Max PV                0\n  Cur PV                2\n  Act PV                2\n  VG Size               9.99 GiB\n  PE Size               4.00 MiB\n  Total PE              2558\n  Alloc PE / Size       200 / 800.00 MiB\n  Free  PE / Size       2358 / 9.21 GiB\n  VG UUID               o1xUxv-U8yj-EDEw-YYz8-PTSl-XfmW-w0CMe5\n\n[root@localhost ~]# df -h\n\u6587\u4ef6\u7cfb\u7edf                 \u5bb9\u91cf  \u5df2\u7528  \u53ef\u7528 \u5df2\u7528% \u6302\u8f7d\u70b9\n/dev/mapper/centos-root  8.0G  2.0G  6.1G   24% /\ndevtmpfs                 475M     0  475M    0% /dev\ntmpfs                    487M     0  487M    0% /dev/shm\ntmpfs                    487M  7.5M  479M    2% /run\ntmpfs                    487M     0  487M    0% /sys/fs/cgroup\n/dev/sda1               1014M  194M  821M   20% /boot\ntmpfs                     98M     0   98M    0% /run/user/0\n/dev/mapper/vg1-lv1      497M   16M  482M    4% /test1\n/dev/mapper/vg1-lv2       93M  1.6M   85M    2% /test2\n[root@localhost ~]# ll /test1\n\u603b\u7528\u91cf 0\n[root@localhost ~]# cat &lt;&lt;end&gt; /test1/hello.txt\n&gt; hello test1\n&gt; ssssssssss\n&gt; ssssssssss\n&gt; ssssssssss\n&gt; hello test1\n&gt; end\n[root@localhost ~]# ll /test1/\n\u603b\u7528\u91cf 4\n-rw-r--r--. 1 root root 57 8\u6708   1 08:35 hello.txt\n[root@localhost ~]# lvdisplay /dev/vg1/lv1\n  --- Logical volume ---\n  LV Path                /dev/vg1/lv1\n  LV Name                lv1\n  VG Name                vg1\n  LV UUID                PYFQkX-MBIr-Edd2-aeJu-QSkk-c56U-3NMR1v\n  LV Write Access        read/write\n  LV Creation host, time localhost.localdomain, 2019-08-01 07:59:01 +0800\n  LV Status              available\n  # open                 1\n  LV Size                500.00 MiB\n  Current LE             125\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     8192\n  Block device           253:2\n\n[root@localhost ~]# lvcreate -L 500m -s -n backup-lv1 /dev/vg1/lv1\n  Logical volume \"backup-lv1\" created.\n[root@localhost ~]# lvdisplay /dev/vg1/lv1\n  --- Logical volume ---\n  LV Path                /dev/vg1/lv1\n  LV Name                lv1\n  VG Name                vg1\n  LV UUID                PYFQkX-MBIr-Edd2-aeJu-QSkk-c56U-3NMR1v\n  LV Write Access        read/write\n  LV Creation host, time localhost.localdomain, 2019-08-01 07:59:01 +0800\n  LV snapshot status     source of\n                         backup-lv1 [active]\n  LV Status              available\n  # open                 1\n  LV Size                500.00 MiB\n  Current LE             125\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     8192\n  Block device           253:2\n\n[root@localhost ~]#\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u591a\u4e86\u4e00\u7ec4 LV snapshot status \u4fe1\u606f\u3002</p> <p>\u5728\u903b\u8f91\u5377\u6240\u6302\u8f7d\u7684\u76ee\u5f55\u4e2d\u521b\u5efa\u4e00\u4e2a100MB\u7684\u6587\u4ef6\u7528\u4e8e\u6d4b\u8bd5</p> <pre><code>[root@localhost ~]# dd if=/dev/zero of=/test1/file count=1 bs=100M\n\u8bb0\u5f55\u4e861+0 \u7684\u8bfb\u5165\n\u8bb0\u5f55\u4e861+0 \u7684\u5199\u51fa\n104857600\u5b57\u8282(105 MB)\u5df2\u590d\u5236\uff0c0.0740664 \u79d2\uff0c1.4 GB/\u79d2\n[root@localhost ~]# ll -h /test1\n\u603b\u7528\u91cf 101M\n-rw-r--r--. 1 root root 100M 8\u6708   1 08:49 file\n-rw-r--r--. 1 root root   57 8\u6708   1 08:35 hello.txt\n[root@localhost ~]#\n</code></pre> <ul> <li>\u5feb\u7167\u56de\u9000</li> </ul> <p>\u5feb\u7167\u5377\u4f1a\u88ab\u81ea\u52a8\u5220\u9664\u6389\uff0c\u5e76\u4e14\u521a\u521a\u5728\u903b\u8f91\u5377\u8bbe\u5907\u88ab\u6267\u884c\u5feb\u7167\u64cd\u4f5c\u540e\u518d\u521b\u5efa\u51fa\u6765\u7684100MB\u7684\u5783\u573e\u6587\u4ef6\u4e5f\u88ab\u6e05\u9664\u4e86\u3002</p> <pre><code>[root@localhost ~]# lvconvert --merge /dev/vg1/backup-lv1\n  Merging of volume vg1/backup-lv1 started.\n  vg1/lv1: Merged: 4.43%\n  vg1/lv1: Merged: 100.00%\n[root@localhost ~]# ll /test1/\n\u603b\u7528\u91cf 4\n-rw-r--r--. 1 root root 57 8\u6708   1 08:35 hello.txt\n[root@localhost ~]#\n</code></pre>"},{"location":"linux/service/lvm/#_8","title":"\u5220\u9664\u903b\u8f91\u5377","text":"<p>\u53d6\u6d88\u903b\u8f91\u5377\u4e0e\u76ee\u5f55\u7684\u6302\u8f7d\u5173\u8054\uff0c\u5220\u9664\u914d\u7f6e\u6587\u4ef6\u4e2d\u6c38\u4e45\u751f\u6548\u7684\u8bbe\u5907\u53c2\u6570\u3002</p> <ul> <li>\u5220\u9664\u903b\u8f91\u5377</li> </ul> <pre><code>[root@localhost ~]# umount /test1\n[root@localhost ~]# lvremove /dev/vg1/lv1 -f\n  Logical volume \"lv1\" successfully removed\n[root@localhost ~]#\n</code></pre> <ul> <li>\u5220\u9664\u5377\u7ec4</li> </ul> <pre><code>[root@localhost ~]# vgs\n  VG     #PV #LV #SN Attr   VSize  VFree\n  centos   1   2   0 wz--n- &lt;9.00g    0\n  vg1      2   0   0 wz--n-  9.99g 9.99g\n[root@localhost ~]# vgremove vg1 -f\n  Volume group \"vg1\" successfully removed\n</code></pre> <ul> <li>\u5220\u9664\u7269\u7406\u5377</li> </ul> <pre><code>[root@localhost ~]# pvs\n  PV         VG     Fmt  Attr PSize  PFree\n  /dev/sda2  centos lvm2 a--  &lt;9.00g    0\n  /dev/sdb          lvm2 ---   5.00g 5.00g\n  /dev/sdc          lvm2 ---   5.00g 5.00g\n[root@localhost ~]# pvremove /dev/sdb /dev/sdc\n  Labels on physical volume \"/dev/sdb\" successfully wiped.\n  Labels on physical volume \"/dev/sdc\" successfully wiped.\n[root@localhost ~]#\n</code></pre>"},{"location":"linux/service/nfs/","title":"Nfs","text":""},{"location":"linux/service/nfs/#nfs","title":"NFS \u6587\u4ef6\u5171\u4eab\u670d\u52a1","text":"<p>NFS\uff08Network File System\uff09\u5373\u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf\uff0c\u5141\u8bb8\u7f51\u7edc\u4e2d\u7684\u8ba1\u7b97\u673a\u4e4b\u95f4\u5171\u4eab\u8d44\u6e90\u3002\u53ef\u4ee5\u900f\u660e\u5730\u8bfb\u5199\u8fdc\u7aef NFS \u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\uff0c\u5c31\u50cf\u8bbf\u95ee\u672c\u5730\u6587\u4ef6\u4e00\u6837\u3002</p>"},{"location":"linux/service/nfs/#_1","title":"\u5b89\u88c5","text":"<p>\u8003\u8651\u8303\u56f4\uff1a \u9632\u706b\u5899\u3001\u5171\u4eab\u70b9\u3001\u6743\u9650</p> <pre><code>yum install -y nfs-utils\n\nfirewall-cmd --permanent --add-service=nfs --add-service=nfs3 --add-service=rpc-bind\nfirewall-cmd --reload\n\nmkdir -p /home/nfsfiles\nchmod 777 /home/nfsfiles\necho \"this is nfs share home\" &gt;&gt; /home/nfsfiles/hello.txt\n</code></pre>"},{"location":"linux/service/nfs/#_2","title":"\u914d\u7f6e","text":"<p>NFS\u670d\u52a1\u7a0b\u5e8f\u7684\u914d\u7f6e\u6587\u4ef6\u4e3a/etc/exports\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u91cc\u9762\u6ca1\u6709\u4efb\u4f55\u5185\u5bb9\u3002</p> <p>\u914d\u7f6eNFS\u670d\u52a1\u7a0b\u5e8f\u914d\u7f6e\u6587\u4ef6\u7684\u53c2\u6570\uff1a</p> \u53c2\u6570 \u4f5c\u7528 <code>ro</code> \u53ea\u8bfb <code>rw</code> \u8bfb\u5199 <code>root_squash</code> \u5f53NFS\u5ba2\u6237\u7aef\u4ee5root\u7ba1\u7406\u5458\u8bbf\u95ee\u65f6\uff0c\u6620\u5c04\u4e3aNFS\u670d\u52a1\u5668\u7684\u533f\u540d\u7528\u6237 <code>no_root_squash</code> \u5f53NFS\u5ba2\u6237\u7aef\u4ee5root\u7ba1\u7406\u5458\u8bbf\u95ee\u65f6\uff0c\u6620\u5c04\u4e3aNFS\u670d\u52a1\u5668\u7684root\u7ba1\u7406\u5458 <code>all_squash</code> \u65e0\u8bbaNFS\u5ba2\u6237\u7aef\u4f7f\u7528\u4ec0\u4e48\u8d26\u6237\u8bbf\u95ee\uff0c\u5747\u6620\u5c04\u4e3aNFS\u670d\u52a1\u5668\u7684\u533f\u540d\u7528\u6237 <code>sync</code> \u540c\u65f6\u5c06\u6570\u636e\u5199\u5165\u5230\u5185\u5b58\u4e0e\u786c\u76d8\u4e2d\uff0c\u4fdd\u8bc1\u4e0d\u4e22\u5931\u6570\u636e <code>async</code> \u4f18\u5148\u5c06\u6570\u636e\u4fdd\u5b58\u5230\u5185\u5b58\uff0c\u7136\u540e\u518d\u5199\u5165\u786c\u76d8\uff1b\u8fd9\u6837\u6548\u7387\u66f4\u9ad8\uff0c\u4f46\u53ef\u80fd\u4f1a\u4e22\u5931\u6570\u636e <p>\u683c\u5f0f\uff1a <code>\u5171\u4eab\u76ee\u5f55</code> + <code>\u5141\u8bb8 ip \u8303\u56f4</code> + <code>(\u53c2\u6570)</code></p> <pre><code>cat &lt;&lt;EOF&gt; /etc/exports\n/home/nfsfiles 192.168.11.*(rw,sync,root_squash)\nEOF\n\nsystemctl restart nfs-server\nsystemctl enable nfs-server\n</code></pre> <p>\u8003\u8651\u8303\u56f4\uff1a \u5f00\u673a\u542f\u52a8</p>"},{"location":"linux/service/nfs/#_3","title":"\u6302\u8f7d","text":"<p>\u5728 NFS \u5ba2\u6237\u7aef\u521b\u5efa\u6302\u8f7d\u76ee\u5f55\u5e76\u6302\u8f7d\u3002</p> <pre><code>mkdir /home/mnt\n\nyum install -y nfs-utils\n\ncat &lt;&lt;EOF&gt;&gt; /etc/fstab\n192.168.11.130:/home/nfsfiles /home/mnt nfs defaults 0 0\nEOF\n\nmount -a\ncat /home/mnt/hello.txt\n</code></pre>"},{"location":"linux/service/postfix-and-dovecot-deploy-mail-system/","title":"Postfix and dovecot deploy mail system","text":""},{"location":"linux/service/postfix-and-dovecot-deploy-mail-system/#postfix-dovecot","title":"Postfix \u4e0e Dovecot \u90e8\u7f72\u90ae\u4ef6\u7cfb\u7edf","text":""},{"location":"linux/service/postfix-and-dovecot-deploy-mail-system/#dns","title":"\u90ae\u4ef6\u7cfb\u7edf\u4e0e DNS \u4e4b\u95f4\u7684\u5173\u7cfb","text":""},{"location":"linux/service/postfix-and-dovecot-deploy-mail-system/#_1","title":"\u5408\u6cd5\u7684\u4e3b\u673a\u540d","text":"<p>\u901a\u5e38\u63a5\u6536\u5230\u7684 email \u90fd\u662f\u4f7f\u7528<code>\u8d26\u53f7@\u4e3b\u673a\u540d</code>\u7684\u65b9\u5f0f\u6765\u5904\u7406\u7684\uff0c \u6240\u4ee5\u8bf4\uff0c\u90ae\u4ef6\u670d\u52a1\u5668\u8981\u6709\u4e00\u4e2a\u300e\u5408\u6cd5\u6ce8\u518c\u8fc7\u7684\u4e3b\u673a\u540d\u300f\u3002</p> <p>\u5728 DNS \u67e5\u8be2\u7cfb\u7edf\u5f53\u4e2d<code>\u4e3b\u673a\u540d</code>\u62e5\u6709\u4e00\u4e2a A \u8bb0\u5f55\uff0c \u7406\u8bba\u4e0a mail server \u5c31\u53ef\u4ee5\u67b6\u8bbe\u6210\u529f\u3002\u53ea\u4e0d\u8fc7\u7531\u4e8e\u76ee\u524d\u4e92\u8054\u7f51\u7f51\u4e0a\u9762\u7684\u5e7f\u544a\u4fe1\u3001 \u5783\u573e\u4fe1\u4e0e\u75c5\u6bd2\u4fe1\u7b49\u5360\u7528\u4e86\u592a\u591a\u7684\u5e26\u5bbd\uff0c\u5bfc\u81f4\u6574\u4e2a\u7f51\u7edc\u793e\u4f1a\u82b1\u8d39\u8fc7\u591a\u7684\u6210\u672c\u5728\u6d88\u8017\u8fd9\u4e9b\u5783\u573e\u8d44\u6599\u3002 \u6240\u4ee5\u4e3a\u4e86\u675c\u7edd\u53ef\u6076\u7684\u5783\u573e\u4fe1\u4ef6\uff0c\u76ee\u524d\u7684\u5927\u578b\u7f51\u7edc\u4f9b\u8d27\u5546 (ISP) \u90fd\u4f1a\u9488\u5bf9\u4e0d\u660e\u6765\u6e90\u7684\u90ae\u4ef6\u52a0\u4ee5\u9650\u5236\u3002</p>"},{"location":"linux/service/postfix-and-dovecot-deploy-mail-system/#dns-mx","title":"DNS \u7684 MX \u6807\u5fd7","text":"<p>\u5f53\u4e00\u5c01\u90ae\u4ef6\u8981\u4f20\u9001\u51fa\u53bb\u65f6\uff0c\u90ae\u4ef6\u4e3b\u673a\u4f1a\u5148\u5206\u6790\u90ae\u4ef6\u7684\u300e\u76ee\u6807\u4e3b\u673a\u7684 DNS \u300f\uff0c\u5148\u53d6\u5f97 MX \u6807\u5fd7\uff0c\u7136\u540e\u4ee5\u6700\u4f18\u5148 MX \u4e3b\u673a\u4e3a\u51c6\u5c06\u4fe1\u53d1\u9001\u51fa\u53bb\u3002</p> <p>\u6ce8\u610f\uff0cMX \u6807\u5fd7\u53ef\u80fd\u4f1a\u6709\u591a\u90e8\u4e3b\u673a\u3002</p> <p>MX \u6709\u5565\u597d\u5904\u554a\uff1f\u4e00\u822c\u6765\u8bf4\uff0c\u5982\u679c\u76ee\u6807\u4e3b\u673a\u5b95\u673a\u65f6\uff0c\u90ae\u4ef6\u901a\u5e38\u4f1a\u76f4\u63a5\u9000\u8fd8\u7ed9\u539f\u53d1\u4fe1\u8005\uff0c \u4f46\u5982\u679c\u6709 MX \u4e3b\u673a\u65f6\uff0c\u8fd9\u90e8 MX \u4e3b\u673a\u4f1a\u5148\u5c06\u90ae\u4ef6\u653e\u5728\u961f\u5217 (queue) \u5f53\u4e2d\uff0c\u7b49\u5230\u76ee\u6807\u4e3b\u673a\u91cd\u65b0\u63d0\u4f9b\u90ae\u4ef6\u670d\u52a1\u540e\uff0c MX \u4e3b\u673a\u4f1a\u5c06\u961f\u5217\u91cc\u7684\u90ae\u4ef6\u4f20\u9001\u7ed9\u76ee\u6807\u4e3b\u673a\u3002</p>"},{"location":"linux/service/postfix-and-dovecot-deploy-mail-system/#_2","title":"\u5e38\u89c1\u7684\u90ae\u4ef6\u534f\u8bae","text":"<ul> <li> <p><code>SMTP</code>: \u7b80\u5355\u90ae\u4ef6\u4f20\u8f93\u534f\u8bae\uff08Simple Mail Transfer Protocol\uff09\uff0c\u7528\u4e8e\u53d1\u9001\u548c\u4e2d\u8f6c\u53d1\u51fa\u7684\u7535\u5b50\u90ae\u4ef6\uff0c\u5360\u7528\u670d\u52a1\u5668\u768425/TCP\u7aef\u53e3\u3002</p> </li> <li> <p><code>POP3</code>: \u90ae\u5c40\u534f\u8bae\u7248\u672c3\uff08Post Office Protocol 3\uff09\uff0c\u7528\u4e8e\u5c06\u7535\u5b50\u90ae\u4ef6\u5b58\u50a8\u5230\u672c\u5730\u4e3b\u673a\uff0c\u5360\u7528\u670d\u52a1\u5668\u7684110/TCP\u7aef\u53e3\u3002</p> </li> <li> <p><code>IMAP</code>: Internet\u6d88\u606f\u8bbf\u95ee\u534f\u8bae\u7248\u672c4\uff08Internet Message Access Protocol 4\uff09\uff0c\u7528\u4e8e\u5728\u672c\u5730\u4e3b\u673a\u4e0a\u8bbf\u95ee\u90ae\u4ef6\uff0c\u5360\u7528\u670d\u52a1\u5668\u7684143/TCP\u7aef\u53e3\u3002</p> </li> </ul> <p>\u5728\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\u4e2d\uff0c\u4e3a\u7528\u6237\u6536\u53d1\u90ae\u4ef6\u7684\u670d\u52a1\u5668\u540d\u4e3a\u90ae\u4ef6\u7528\u6237\u4ee3\u7406\uff08Mail User Agent\uff0cMUA\uff09\u3002\u53e6\u5916\uff0c\u65e2\u7136\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\u80fd\u591f\u8ba9\u7528\u6237\u5728\u79bb\u7ebf\u7684\u60c5\u51b5\u4e0b\u4f9d\u7136\u53ef\u4ee5\u5b8c\u6210\u6570\u636e\u7684\u63a5\u6536\uff0c\u80af\u5b9a\u5f97\u6709\u4e00\u4e2a\u7528\u4e8e\u4fdd\u5b58\u7528\u6237\u90ae\u4ef6\u7684\u201c\u4fe1\u7bb1\u201d\u670d\u52a1\u5668\uff0c\u8fd9\u4e2a\u670d\u52a1\u5668\u7684\u540d\u5b57\u4e3a\u90ae\u4ef6\u6295\u9012\u4ee3\u7406\uff08Mail Delivery Agent\uff0cMDA\uff09\uff0c\u5176\u5de5\u4f5c\u804c\u8d23\u662f\u628a\u6765\u81ea\u4e8e\u90ae\u4ef6\u4f20\u8f93\u4ee3\u7406\uff08Mail Transfer Agent\uff0cMTA\uff09\u7684\u90ae\u4ef6\u4fdd\u5b58\u5230\u672c\u5730\u7684\u6536\u4ef6\u7bb1\u4e2d\u3002\u5176\u4e2d\uff0c\u8fd9\u4e2aMTA\u7684\u5de5\u4f5c\u804c\u8d23\u662f\u8f6c\u53d1\u5904\u7406\u4e0d\u540c\u7535\u5b50\u90ae\u4ef6\u670d\u52a1\u4f9b\u5e94\u5546\u4e4b\u95f4\u7684\u90ae\u4ef6\uff0c\u628a\u6765\u81ea\u4e8eMUA\u7684\u90ae\u4ef6\u8f6c\u53d1\u5230\u5408\u9002\u7684MTA\u670d\u52a1\u5668\u3002</p> <p>\u4f8b\u5982\uff0c\u6211\u4eec\u4ece\u65b0\u6d6a\u4fe1\u7bb1\u5411\u8c37\u6b4c\u4fe1\u7bb1\u53d1\u9001\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u8fd9\u5c01\u7535\u5b50\u90ae\u4ef6\u7684\u4f20\u8f93\u8fc7\u7a0b\u5982\u56fe\u6240\u793a\u3002</p> <p></p>"},{"location":"linux/service/postfix-and-dovecot-deploy-mail-system/#_3","title":"\u90e8\u7f72\u90ae\u4ef6\u7cfb\u7edf","text":"<p>\u4e00\u4e2a\u6700\u57fa\u7840\u7684\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\u80af\u5b9a\u8981\u80fd\u63d0\u4f9b\u53d1\u4ef6\u670d\u52a1\u548c\u6536\u4ef6\u670d\u52a1\uff0c\u4e3a\u6b64\u9700\u8981\u4f7f\u7528\u57fa\u4e8e SMTP \u534f\u8bae\u7684 Postfix \u670d\u52a1\u7a0b\u5e8f\u63d0\u4f9b\u53d1\u4ef6\u670d\u52a1\u529f\u80fd\uff0c\u5e76\u4f7f\u7528\u57fa\u4e8e POP3 \u534f\u8bae\u7684 Dovecot \u670d\u52a1\u7a0b\u5e8f\u63d0\u4f9b\u6536\u4ef6\u670d\u52a1\u529f\u80fd\u3002\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\u7684\u5de5\u4f5c\u6d41\u7a0b\u5982\u56fe\u6240\u793a\u3002</p> <p></p>"},{"location":"linux/service/postfix-and-dovecot-deploy-mail-system/#dns_1","title":"DNS \u89e3\u6790","text":"<pre><code>yum install -y bind-chroot bind-utils\nsystemctl start bind\nsystemctl enable bind\n\nfirewall-cmd --permanent --add-service=dns\nfirewall-cmd --reload\n\nsed -i -e 's,127.0.0.1;,any;,g' -e 's,localhost;,any;,g' -e 's,::1;,any;,g' /etc/named.conf\nsed -i '/recursion yes/a\\\\tforwarders { 114.114.114.114; 8.8.8.8; };' /etc/named.conf\n\ncat &lt;&lt;EOF&gt; /etc/named.rfc1912.zones\nzone \"linuxprobe.com\" IN {\n    type master;\n    file \"linuxprobe.com.zone\";\n    allow-update { none; };\n};\nEOF\n\ncat &lt;&lt;EOF&gt; /var/named/linuxprobe.com.zone\n\\$TTL 1D\n@       IN SOA  linuxprobe.com. root.linuxprobe.com (0 1D 1H 1W 3H);\n        NS      ns.linuxprobe.com.\nns      A       192.168.10.10\n@       MX 10   mail.linuxprobe.com.\nmail    A       192.168.10.10\nEOF\n\nnmcli con show\nnmcli con mod ens32 ipv4.dns 192.168.10.10\nnmcli con up ens32\n\nsystemctl restart named\n\nnslookup mail.linuxprobe.com\n</code></pre>"},{"location":"linux/service/postfix-and-dovecot-deploy-mail-system/#postfix","title":"\u90e8\u7f72 Postfix","text":"<ol> <li>\u5b89\u88c5 Postfix\u3002</li> </ol> <pre><code>yum install -y postfix\n\nsystemctl start postfix\nsystemctl enable postfix\n\nfirewall-cmd --permanent --add-service=smtp --add-service=smtps\nfirewall-cmd --reload\n</code></pre> <p>Postfix \u670d\u52a1\u7a0b\u5e8f\u4e3b\u914d\u7f6e\u6587\u4ef6</p> <pre><code>cp /etc/postfix/main.cf /etc/postfix/main.cf.bak\ncat /etc/postfix/main.cf\n</code></pre> <pre><code>#soft_bounce = no\nqueue_directory = /var/spool/postfix\ncommand_directory = /usr/sbin\ndaemon_directory = /usr/libexec/postfix\ndata_directory = /var/lib/postfix\nmail_owner = postfix\n#default_privs = nobody\n#myhostname = host.domain.tld\n#myhostname = virtual.domain.tld\n# \u90ae\u5c40\u7cfb\u7edf\u7684\u4e3b\u673a\u540d\n#mydomain = domain.tld\n# \u90ae\u5c40\u7cfb\u7edf\u7684\u57df\u540d\n#myorigin = $myhostname\n#myorigin = $mydomain\n# \u4ece\u672c\u673a\u53d1\u51fa\u90ae\u4ef6\u7684\u57df\u540d\u540d\u79f0\n#inet_interfaces = all\n#inet_interfaces = $myhostname\n#inet_interfaces = $myhostname, localhost\ninet_interfaces = localhost\n# \u76d1\u542c\u7684\u7f51\u5361\u63a5\u53e3\ninet_protocols = all\n#proxy_interfaces =\n#proxy_interfaces = 1.2.3.4\nmydestination = $myhostname, localhost.$mydomain, localhost\n#mydestination = $myhostname, localhost.$mydomain, localhost, $mydomain\n#mydestination = $myhostname, localhost.$mydomain, localhost, $mydomain, mail.$mydomain, www.$mydomain, ftp.$mydomain\n# \u53ef\u63a5\u6536\u90ae\u4ef6\u7684\u4e3b\u673a\u540d\u6216\u57df\u540d\n#local_recipient_maps = unix:passwd.byname $alias_maps\n#local_recipient_maps = proxy:unix:passwd.byname $alias_maps\n#local_recipient_maps =\nunknown_local_recipient_reject_code = 550\n#mynetworks_style = class\n#mynetworks_style = subnet\n#mynetworks_style = host\n# \u8bbe\u7f6e\u53ef\u8f6c\u53d1\u54ea\u4e9b\u4e3b\u673a\u7684\u90ae\u4ef6\n#relay_domains = $mydestination\n# \u8bbe\u7f6e\u53ef\u8f6c\u53d1\u54ea\u4e9b\u7f51\u57df\u7684\u90ae\u4ef6\n#relayhost = $mydomain\n#relayhost = [gateway.my.domain]\n#relayhost = [mailserver.isp.tld]\n#relayhost = uucphost\n#relayhost = [an.ip.add.ress]\n#relay_recipient_maps = hash:/etc/postfix/relay_recipients\n#in_flow_delay = 1s\n#alias_maps = dbm:/etc/aliases\nalias_maps = hash:/etc/aliases\n#alias_maps = hash:/etc/aliases, nis:mail.aliases\n#alias_maps = netinfo:/aliases\n#alias_database = dbm:/etc/aliases\n#alias_database = dbm:/etc/mail/aliases\nalias_database = hash:/etc/aliases\n#alias_database = hash:/etc/aliases, hash:/opt/majordomo/aliases\n#recipient_delimiter = +\n#home_mailbox = Mailbox\n#home_mailbox = Maildir/\n#mail_spool_directory = /var/mail\n#mail_spool_directory = /var/spool/mail\n#mailbox_command = /some/where/procmail\n#mailbox_command = /some/where/procmail -a \"$EXTENSION\"\n#mailbox_transport = lmtp:unix:/var/lib/imap/socket/lmtp\n#mailbox_transport = cyrus\n#fallback_transport = lmtp:unix:/var/lib/imap/socket/lmtp\n#fallback_transport =\n#luser_relay = $user@other.host\n#luser_relay = $local@other.host\n#luser_relay = admin+$local\n#header_checks = regexp:/etc/postfix/header_checks\n#fast_flush_domains = $relay_domains\n#smtpd_banner = $myhostname ESMTP $mail_name\n#smtpd_banner = $myhostname ESMTP $mail_name ($mail_version)\n#local_destination_concurrency_limit = 2\n#default_destination_concurrency_limit = 20\ndebug_peer_level = 2\n#debug_peer_list = 127.0.0.1\n#debug_peer_list = some.domain\ndebugger_command =\n     PATH=/bin:/usr/bin:/usr/local/bin:/usr/X11R6/bin\n     ddd $daemon_directory/$process_name $process_id &amp; sleep 5\nsendmail_path = /usr/sbin/sendmail.postfix\nnewaliases_path = /usr/bin/newaliases.postfix\nmailq_path = /usr/bin/mailq.postfix\nsetgid_group = postdrop\nhtml_directory = no\nmanpage_directory = /usr/share/man\nsample_directory = /usr/share/doc/postfix-2.10.1/samples\nreadme_directory = /usr/share/doc/postfix-2.10.1/README_FILES\n</code></pre> <ol> <li>\u4fee\u6539\u914d\u7f6e\u3002</li> </ol> <pre><code>sed -i '1i myhostname = mail.linuxprobe.com\\nmydomain = linuxprobe.com\\nmyorigin = \\$mydomain' /etc/postfix/main.cf\nsed -i 's,^inet_interfaces =.*,inet_interfaces = all,' /etc/postfix/main.cf\nsed -i 's,^mydestination =.*,mydestination = \\$myhostname\\, \\$mydomain,' /etc/postfix/main.cf\n\nsystemctl restart postfix\n</code></pre> <p>sed \u9996\u884c\u6dfb\u52a0: <code>sed '1i \u8981\u6dfb\u52a0\u7684\u5185\u5bb9 file</code></p> <p>sed \u5c3e\u884c\u6dfb\u52a0: <code>sed '$a \u8981\u6dfb\u52a0\u7684\u5185\u5bb9 file</code></p> <ol> <li>\u521b\u5efa\u7535\u5b50\u90ae\u4ef6\u7cfb\u7edf\u767b\u5f55\u7528\u6237\u3002</li> </ol> <p>Postfix \u53ef\u4ee5\u8c03\u7528\u672c\u5730\u7cfb\u7edf\u7684\u8d26\u6237\u548c\u5bc6\u7801\uff0c\u56e0\u6b64\u5728\u672c\u5730\u7cfb\u7edf\u521b\u5efa\u5e38\u89c4\u8d26\u6237\u5373\u53ef\u3002</p> <pre><code>useradd boss\necho 'boss'|passwd --stdin boss\n\nchmod 0600 /var/spool/mail/*\n</code></pre>"},{"location":"linux/service/postfix-and-dovecot-deploy-mail-system/#dovecot","title":"\u90e8\u7f72 Dovecot","text":"<ol> <li>\u5b89\u88c5 Dovecot\u3002</li> </ol> <pre><code>yum install -y dovecot\nsystemctl start dovecot\nsystemctl enable dovecot\n\nfirewall-cmd --permanent --add-service=pop3 --add-service=pop3s --add-service=imap --add-service=imaps\nfirewall-cmd --reload\n</code></pre> <p>Dovecot \u4e3b\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>cp /etc/dovecot/dovecot.conf /etc/dovecot/dovecot.conf.bak\ncat /etc/dovecot/dovecot.conf\n</code></pre> <pre><code>#protocols = imap pop3 lmtp\n# \u4f7f\u7528\u7684\u534f\u8bae\n#disable_plaintext_auth=no\n# \u662f\u5426\u5141\u8bb8\u660e\u6587\u5bc6\u7801\u9a8c\u8bc1\uff0c\u9ed8\u8ba4\u4e3a yes\n#listen = *, ::\n#base_dir = /var/run/dovecot/^[[?12;4$y\n#instance_name = dovecot\n#login_greeting = Dovecot ready.\n#login_trusted_networks =\n# \u8bbe\u7f6e\u5141\u8bb8\u8fde\u63a5\u7684\u5730\u5740 \n#login_access_sockets =\n#auth_proxy_self =\n#verbose_proctitle = no\n#shutdown_clients = yes\n#doveadm_worker_count = 0\n#doveadm_socket_path = doveadm-server\n#import_environment = TZ\ndict {\n}\n!include conf.d/*.conf\n# \u8bf4\u660e conf.d \u76ee\u5f55\u4e0b\u7684\u6240\u4ee5 .conf \u7ed3\u5c3e\u7684\u6587\u4ef6\u5747\u6709\u6548\n!include_try local.conf\n</code></pre> <ol> <li>\u914d\u7f6e Dovecot\u3002</li> </ol> <pre><code>sed -i '1i protocols = imap pop3 lmtp\\ndisable_plaintext_auth = no\\nlogin_trusted_networks = 192.168.10.0/24' /etc/dovecot/dovecot.conf\n\nsystemctl restart dovecot\n</code></pre> <ol> <li>\u5ba2\u6237\u7aef\u6d4b\u8bd5\u3002</li> </ol> <pre><code>yum install -y mailx\n\necho \"\u6211\u662f boos \uff01\u6d4b\u8bd5\u90ae\u4ef6\u5185\u5bb9\uff0c\u6210\u529f\u5566\uff01\" | mail -s \"\u90ae\u4ef6\u6807\u9898\uff0cboss \u6d4b\u8bd5\" -r root@linuxprobe.com root@linuxprobe.com\necho \"boos \u60a8\u597d \uff01\u6d4b\u8bd5\u90ae\u4ef6\u5185\u5bb9\uff0c\u6210\u529f\u5566\uff01\" | mail -s \"\u90ae\u4ef6\u6807\u9898\uff0cboss \u6d4b\u8bd5\" -r root@linuxprobe.com boss@linuxprobe.com\ncat /var/spool/mail/root\ncat /var/spool/mail/boss\n</code></pre> <p><code>mail</code> \u6a21\u62df\u7528\u6237\u53d1\u9001\u90ae\u4ef6\uff1a </p> <p>centos 7: <code>-r xxx@xxx.com</code></p> <p>centos 6: <code>-- -f xxx@xxx.com</code></p>"},{"location":"linux/service/postfix-and-dovecot-deploy-mail-system/#_4","title":"\u8bbe\u7f6e\u7528\u6237\u522b\u540d\u90ae\u7bb1","text":"<p>\u7528\u6237\u522b\u540d\u53ef\u4ee5\u662fLinux\u7cfb\u7edf\u5185\u7684\u672c\u5730\u7528\u6237\uff0c\u4e5f\u53ef\u4ee5\u662f\u5b8c\u5168\u865a\u6784\u7684\u7528\u6237\u540d\u5b57\u3002</p> <pre><code>cat /etc/aliases|grep -Ev '^$|#'\nmailer-daemon:  postmaster\npostmaster: root\nbin:        root\ndaemon:     root\nadm:        root\nlp:         root\nsync:       root\nshutdown:   root\nhalt:       root\nmail:       root\nnews:       root\nuucp:       root\noperator:   root\ngames:      root\ngopher:     root\nftp:        root\nnobody:     root\nradiusd:    root\nnut:        root\ndbus:       root\nvcsa:       root\ncanna:      root\nwnn:        root\nrpm:        root\nnscd:       root\npcap:       root\napache:     root\nwebalizer:  root\ndovecot:    root\nfax:        root\nquagga:     root\nradvd:      root\npvm:        root\namandabackup:       root\nprivoxy:    root\nident:      root\nnamed:      root\nxfs:        root\ngdm:        root\nmailnull:   root\npostgres:   root\nsshd:       root\nsmmsp:      root\npostfix:    root\nnetdump:    root\nldap:       root\nsquid:      root\nntp:        root\nmysql:      root\ndesktop:    root\nrpcuser:    root\nrpc:        root\nnfsnobody:  root\ningres:     root\nsystem:     root\ntoor:       root\nmanager:    root\ndumper:     root\nabuse:      root\nnewsadm:    news\nnewsadmin:  news\nusenet:     news\nftpadm:     ftp\nftpadmin:   ftp\nftp-adm:    ftp\nftp-admin:  ftp\nwww:        webmaster\nwebmaster:  root\nnoc:        root\nsecurity:   root\nhostmaster: root\ninfo:       postmaster\nmarketing:  postmaster\nsales:      postmaster\nsupport:    postmaster\ndecode:     root\n</code></pre> <p>\u6dfb\u52a0\u65b0\u522b\u540d\uff1a</p> <pre><code>echo \"zhangsan: root\" &gt;&gt; /etc/aliases\nnewaliases\ntail -n 4 /etc/aliases\n\necho \"\u6211\u662f\u5f20\u4e09\uff0c\u6d4b\u8bd5\u90ae\u4ef6\" | mail -s \"\u5f20\u4e09\" -r zhangsan@linuxprobe.com postmaster@linuxprobe.com\ncat /var/spool/mail/root\n</code></pre>"},{"location":"linux/service/pxe-and-kickstart-unattended-installation-service/","title":"Pxe and kickstart unattended installation service","text":""},{"location":"linux/service/pxe-and-kickstart-unattended-installation-service/#pxe-kickstart","title":"PXE + Kickstart \u90e8\u7f72\u65e0\u4eba\u503c\u5b88\u5b89\u88c5\u670d\u52a1","text":""},{"location":"linux/service/pxe-and-kickstart-unattended-installation-service/#pxe","title":"PXE \u7b80\u4ecb","text":"<p>PXE \u4e0d\u662f\u4e00\u79cd\u5b89\u88c5\u65b9\u5f0f\uff0c\u662f\u4e00\u79cd\u5f15\u5bfc\u7684\u65b9\u5f0f\u3002</p> <p>PXE \u5f15\u5bfc\u65b9\u5f0f\u8981\u6c42\u5b89\u88c5\u7684\u8ba1\u7b97\u673a\u4e2d\u5fc5\u987b\u5305\u542b\u4e00\u4e2a \u652f\u6301 PXE \u7684\u7f51\u5361\uff0c\u4e14\u4e3b\u677f\u652f\u6301\u7f51\u7edc\u5f15\u5bfc\uff0cPXE\uff08Pre-boot Execution Environment\uff09\u534f\u8bae\u4f7f\u8ba1\u7b97\u673a\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u542f\u52a8\u3002</p> <p>PXE \u534f\u8bae\u5206\u4e3a client \u548c server \u7aef\uff0cPXE client \u5728\u7f51\u5361 Rom \u4e2d\uff0c\u5f53\u8ba1\u7b97\u673a\u5f15\u5bfc\u65f6\uff0ccpu \u901a\u8fc7\u52a0\u8f7d bios \u6620\u5c04\u5230\u5185\u5b58\u4e2d\u7684\u7247\u6bb5\uff0c\u7136\u540e\u68c0\u67e5\u8ba1\u7b97\u673a\u7684\u5065\u5eb7\u72b6\u51b5\uff08\u5982cpu\u98ce\u6247\uff0c\u7f51\u5361\u7b49\uff09\u7ee7\u800c \u628a\u7f51\u5361 Rom \u4e2d\u7684 PXE client \u8c03\u5165\u5185\u5b58\u5f15\u5bfc\u6267\u884c\uff0c\u7531 PXE client \u5c06\u653e\u7f6e\u5728\u8fdc\u7aef\u7684\u6587\u4ef6\u901a\u8fc7\u7f51\u7edc\u4e0b\u8f7d\u5230\u672c\u5730\u8fd0\u884c\u3002</p> <p>PXE \u534f\u8bae\u9700\u8981 DHCP \u670d\u52a1 \u548c TFTP/MTFTP \u670d\u52a1\u914d\u5408\u4f7f\u7528\u3002</p> <p>DHCP \u670d\u52a1\u5668\u7528\u6765\u7ed9 PXE client \u5206\u914d\u4e00\u4e2a IP \u5730\u5740\uff0c\u7531\u4e8e\u662f\u7ed9 PXE client \u5206\u914d IP \u5730\u5740\uff0c\u6240\u4ee5\u5728\u914d\u7f6e DHCP \u670d\u52a1\u5668\u65f6\u9700\u8981\u589e\u52a0\u76f8\u5e94\u7684\u8bbe\u7f6e\u3002</p> <p>PXE Client \u901a\u8fc7 TFTP \u534f\u8bae\u5230 TFTP Server \u4e0a\u4e0b\u8f7d\u6240\u9700\u7684\u6587\u4ef6\u3002\u5728 PXE client \u7684 ROM \u4e2d\uff0c\u5df2\u7ecf\u5b58\u5728\u4e86 TFTP Client\u3002</p>"},{"location":"linux/service/pxe-and-kickstart-unattended-installation-service/#kickstart","title":"Kickstart \u7b80\u4ecb","text":"<p>kickstart \u662f\u4e00\u4e2a\u5229\u7528 Anconda \u5de5\u5177\u5b9e\u73b0\u670d\u52a1\u5668\u81ea\u52a8\u5316\u5b89\u88c5\u7684\u65b9\u6cd5\uff1b\u901a\u8fc7\u751f\u6210\u7684 kickstart \u914d\u7f6e\u6587\u4ef6 ks.cfg\uff0c\u670d\u52a1\u5668\u5b89\u88c5\u53ef\u4ee5\u5b9e\u73b0\u4ece\u88f8\u673a\u5230\u5168\u529f\u80fd\u670d\u52a1\u7684\u7684\u975e\u4ea4\u4e92\u5f0f\uff08\u65e0\u4eba\u503c\u5b88\u5f0f\uff09\u5b89\u88c5\u914d\u7f6e\u3002</p> <p>\u6574\u4f53\u5b89\u88c5\u601d\u8def\uff1a</p> <ul> <li><code>dhcp</code>: \u63d0\u4f9b\u5ba2\u6237\u7aef ip \u81ea\u52a8\u5206\u914d</li> <li><code>tftp</code>: \u63d0\u4f9b\u5f15\u5bfc\u6587\u4ef6\u4f20\u8f93</li> <li><code>syslinux</code>: \u63d0\u4f9b\u5f15\u5bfc\u6587\u4ef6</li> <li><code>httpd</code>: \u63d0\u4f9b\u955c\u50cf\u6587\u4ef6\u4f20\u8f93</li> <li><code>kickstart</code>: \u5b9e\u73b0\u81ea\u52a8\u5b89\u88c5</li> </ul>"},{"location":"linux/service/pxe-and-kickstart-unattended-installation-service/#dhcp","title":"DHCP \u670d\u52a1","text":"<p>\u670d\u52a1\u7aef\u4e3b\u673a ip\uff1a192.168.10.10</p> <pre><code>yum install -y dhcp\nsystemctl start dhcpd\nsystemctl enable dhcpd\n\ncat &lt;&lt;EOF&gt; /etc/dhcp/dhcpd.conf\nallow booting;\nallow bootp;\nddns-update-style interim;\nignore client-updates;\nsubnet 192.168.10.0 netmask 255.255.255.0 {\n    option subnet-mask  255.255.255.0;\n    option domain-name-servers  192.168.10.10;\n    range dynamic-bootp 192.168.10.100  192.168.10.200;\n    default-lease-time  21600;\n    max-lease-time      43200;\n    next-server         192.168.10.10;\n    filename            \"pxelinux.0\";\n}\nEOF\n\nsystemctl restart dhcpd\nfirewall-cmd --permanent --add-service=dhcp\nfirewall-cmd --reload\n</code></pre>"},{"location":"linux/service/pxe-and-kickstart-unattended-installation-service/#tftp","title":"TFTP \u670d\u52a1","text":"<pre><code>yum install -y tftp-server xinetd\nsystemctl start xinetd\nsystemctl enable xinetd\nfirewall-cmd --permanent --add-service=tftp\nfirewall-cmd --reload\n\nsed -i 's,disable.*,disable \\t\\t= no,' /etc/xinetd.d/tftp\n\nsystemctl restart xinetd tftp\n</code></pre>"},{"location":"linux/service/pxe-and-kickstart-unattended-installation-service/#syslinux","title":"SYSLinux \u670d\u52a1","text":"<p>SYSLinux \u662f\u4e00\u4e2a\u7528\u4e8e\u63d0\u4f9b\u5f15\u5bfc\u52a0\u8f7d\u7684\u670d\u52a1\u7a0b\u5e8f\u3002\u4e0e\u5176\u8bf4 SYSLinux \u662f\u4e00\u4e2a\u670d\u52a1\u7a0b\u5e8f\uff0c\u4e0d\u5982\u8bf4\u66f4\u9700\u8981\u91cc\u9762\u7684\u5f15\u5bfc\u6587\u4ef6\uff0c\u5728\u5b89\u88c5\u597d SYSLinux \u670d\u52a1\u7a0b\u5e8f\u8f6f\u4ef6\u5305\u540e\uff0c<code>/usr/share/syslinux</code> \u76ee\u5f55\u4e2d\u6709\u5f88\u591a\u5f15\u5bfc\u6587\u4ef6\u3002</p> <p>\u9996\u5148\u9700\u8981\u628a SYSLinux \u63d0\u4f9b\u7684\u5f15\u5bfc\u6587\u4ef6\u590d\u5236\u5230 TFTP \u670d\u52a1\u7a0b\u5e8f\u7684\u9ed8\u8ba4\u76ee\u5f55\u4e2d\uff0c\u4e5f\u5c31\u662f <code>pxelinux.0</code> \u6587\u4ef6\uff0c\u8fd9\u6837\u5ba2\u6237\u7aef\u4e3b\u673a\u5c31\u80fd\u591f\u987a\u5229\u5730\u83b7\u53d6\u5230\u5f15\u5bfc\u6587\u4ef6\u4e86\u3002\u53e6\u5916\u5728\u5e38\u89c1 linux \u7cfb\u7edf\u53d1\u884c\u7248\u5149\u76d8\u955c\u50cf\u4e2d\u4e5f\u6709\u4e00\u4e9b\u6211\u4eec\u9700\u8981\u8c03\u53d6\u7684\u5f15\u5bfc\u6587\u4ef6\u3002</p> <p>centos 7\uff1a</p> <pre><code>yum install -y syslinux\n\nmkdir /media/cdrom /var/lib/tftpboot/pxelinux.cfg\nmount /dev/cdrom /media/cdrom\n\n/usr/bin/cp -r /usr/share/syslinux/pxelinux.0 /var/lib/tftpboot\n/usr/bin/cp -r /media/cdrom/images/pxeboot/{vmlinuz,initrd.img} /var/lib/tftpboot\n/usr/bin/cp -r /media/cdrom/isolinux/{vesamenu.c32,boot.msg} /var/lib/tftpboot\n/usr/bin/cp -r /media/cdrom/isolinux/isolinux.cfg /var/lib/tftpboot/pxelinux.cfg/default\n\nsed -i '/label linux/i\\label linux by kickstart' /var/lib/tftpboot/pxelinux.cfg/default\nsed -i '/kickstart/a\\  append initrd=initrd.img inst.ks=http:\\/\\/192.168.10.10\\/ks.cfg' /var/lib/tftpboot/pxelinux.cfg/default\nsed -i '/kickstart/a\\  kernel vmlinuz' /var/lib/tftpboot/pxelinux.cfg/default\nsed -i '/kickstart/a\\  menu label ^Install CentOS 7 By Kickstart' /var/lib/tftpboot/pxelinux.cfg/default\n</code></pre>"},{"location":"linux/service/pxe-and-kickstart-unattended-installation-service/#httpd","title":"httpd \u670d\u52a1","text":"<p>httpd \u670d\u52a1\u7528\u6765\u63d0\u4f9b linux \u7cfb\u7edf\u53d1\u884c\u7248\u955c\u50cf\u4ee5 web \u8bbf\u95ee\u65b9\u5f0f\u4f20\u8f93\u3002</p> <p>httpd \u670d\u52a1\u53ef\u7528 ftp\u3001tftp\u3001nfs \u670d\u52a1\u4ee3\u66ff\u3002</p> <pre><code>yum install -y httpd\nsystemctl enable httpd\nsystemctl start httpd\nfirewall-cmd --permanent --add-service=http\nfirewall-cmd --reload\n\nmkdir /var/www/html/centos7\nmount --bind /media/cdrom /var/www/html/centos7\n</code></pre>"},{"location":"linux/service/pxe-and-kickstart-unattended-installation-service/#kickstart_1","title":"Kickstart \u5e94\u7b54\u6587\u4ef6","text":"<p>system-config-kickstart \u4e00\u6b3e\u56fe\u5f62\u5316 Kickstart \u5e94\u7b54\u6587\u4ef6\u751f\u6210\u5de5\u5177\u3002</p> <pre><code>cat &lt;&lt;EOF&gt; /var/www/html/ks.cfg\nauth --enableshadow --passalgo=sha512\nurl --url=\"http://192.168.10.10/centos7\"\ngraphical\nfirstboot --enable\nignoredisk --only-use=sda\nkeyboard --vckeymap=cn --xlayouts='cn'\nlang zh_CN.UTF-8\n\nnetwork  --bootproto=dhcp --device=ens32 --ipv6=auto --activate\nnetwork  --hostname=localhost.localdomain\n\nrootpw --iscrypted $6$1FGZRaMsWbxtVX36$izfoLF3TuXDFkYJoFTd2.c1NGSn5gfydIr.PthlqRkuhbdIgODB4esi3QatJTxpFm8ChMgJ3qn029UT25Q1t0.\nservices --disabled=\"chronyd\"\ntimezone Asia/Shanghai --isUtc --nontp\nbootloader --location=mbr --boot-drive=sda\nautopart --type=lvm\nclearpart --all --initlabel\n\n%packages --ignoremissing --multilib\n@^minimal\n@development-tools\n@core\nnet-tools\nwget\nvim\ngit\n%end\n\ninstall\nreboot\nEOF\n</code></pre> <p>\u53c2\u8003\uff1ahttps://access.redhat.com/documentation/zh-cn/red_hat_enterprise_linux/7/html/installation_guide/sect-kickstart-syntax</p> <p>sha512 \u52a0\u5bc6\uff1a<code>python -c 'import crypt; print(crypt.crypt(\"My Password\"))'</code></p>"},{"location":"linux/service/pxe-and-kickstart-unattended-installation-service/#_1","title":"\u5ba2\u6237\u7aef","text":"<p>\u865a\u62df\u673a\u6a21\u62df\u73af\u5883\uff1a\u65b0\u5efa <code>\u81ea\u5b9a\u4e49\u865a\u62df\u673a</code> &gt;&gt; <code>Linux</code> &gt;&gt; <code>Centos7 64\u4f4d</code> &gt;&gt; <code>\u81ea\u5b9a\u4e49\u8bbe\u7f6e</code> &gt;&gt; <code>\u7f51\u7edc\u6a21\u5f0f\u4e0e\u670d\u52a1\u7aef\u76f8\u540c</code></p> <p>\u6b63\u5e38\u83b7\u53d6\u83b7\u53d6 ks \u6587\u4ef6\u4e4b\u540e\uff0c\u82e5\u6b63\u5e38\u8fdb\u5165\u81ea\u52a8\u5b89\u88c5\u754c\u9762\uff0c\u7b49\u5f85\u7cfb\u7edf\u5b89\u88c5\u5b8c\u6210\u5373\u53ef\u3002</p>"},{"location":"linux/service/pxe-and-kickstart-unattended-installation-service/#_2","title":"\u95ee\u9898","text":"<ul> <li>\u5ba2\u6237\u7aef\u5185\u5b58\u4e0d\u8db3</li> </ul> <p><code>\u89e3\u51b3\u65b9\u6cd5</code>\uff1a\u5ba2\u6237\u7aef\u589e\u52a0\u8db3\u591f\u5185\u5b58\u3002</p> <p>\u53c2\u8003\uff1ahttps://github.com/cobbler/cobbler/issues/1477</p> <ul> <li>\u91cd\u542f\u518d\u6b21\u8fdb\u5165 PXE \u5f15\u5bfc\u6a21\u5f0f</li> </ul> <p>\u7269\u7406\u673a\u5e94\u8bbe\u7f6e\u7f51\u7edc\u5f15\u5bfc\u5728\u786c\u76d8\u5f15\u5bfc\u4e4b\u540e\u3002</p>"},{"location":"linux/service/raid/","title":"Raid","text":""},{"location":"linux/service/raid/#raid","title":"RAID \u78c1\u76d8\u5197\u4f59\u9635\u5217","text":""},{"location":"linux/service/raid/#raid_1","title":"\u4ec0\u4e48\u662f RAID","text":"<p>RAID \u5168\u79f0\u662f\u72ec\u7acb\u78c1\u76d8\u5197\u4f59\u9635\u5217\uff08Redundant Array of Independent Disks\uff09\uff0c\u57fa\u672c\u601d\u60f3\u662f\u628a\u591a\u4e2a\u78c1\u76d8\u7ec4\u5408\u8d77\u6765\uff0c\u7ec4\u5408\u4e00\u4e2a\u78c1\u76d8\u9635\u5217\u7ec4\uff0c\u4f7f\u5f97\u6027\u80fd\u5927\u5e45\u63d0\u9ad8\u3002</p> <p>\u6700\u5e38\u7528\u7684\u56db\u79cd RAID \u4e3a RAID 0\u3001RAID 1\u3001RAID 5\u3001RAID 10\u3002</p>"},{"location":"linux/service/raid/#raid_2","title":"RAID \u5b9e\u73b0\u65b9\u5f0f","text":"<ul> <li>\u5916\u63a5\u5f0f\u78c1\u76d8\u9635\u5217\uff1a\u901a\u8fc7\u6269\u5c55\u5361\u63d0\u4f9b\u9002\u914d\u80fd\u529b</li> <li>\u5185\u63a5\u5f0f RAID\uff1a\u4e3b\u677f\u96c6\u6210 RAID \u63a7\u5236\u5668\u5b89\u88c5 OS \u524d\u5728 BIOS \u91cc\u914d\u7f6e</li> <li>\u8f6f\u4ef6 RAID\uff1a\u901a\u8fc7 OS \u5b9e\u73b0</li> </ul>"},{"location":"linux/service/raid/#raid_3","title":"\u6807\u51c6 RAID","text":""},{"location":"linux/service/raid/#raid-0","title":"RAID 0","text":"<p>RAID 0 \u6280\u672f\u628a\u591a\u5757\u7269\u7406\u786c\u76d8\u8bbe\u5907\uff08\u81f3\u5c11\u4e24\u5757\uff09\u901a\u8fc7\u786c\u4ef6\u6216\u8f6f\u4ef6\u7684\u65b9\u5f0f\u4e32\u8054\u5728\u4e00\u8d77\uff0c\u7ec4\u6210\u4e00\u4e2a\u5927\u7684\u5377\u7ec4\uff0c\u5e76\u5c06\u6570\u636e\u4f9d\u6b21\u5199\u5165\u5230\u5404\u4e2a\u7269\u7406\u786c\u76d8\u4e2d\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u5728\u6700\u7406\u60f3\u7684\u72b6\u6001\u4e0b\uff0c\u786c\u76d8\u8bbe\u5907\u7684\u8bfb\u5199\u6027\u80fd\u4f1a\u63d0\u5347\u6570\u500d\uff0c\u4f46\u662f\u82e5\u4efb\u610f\u4e00\u5757\u786c\u76d8\u53d1\u751f\u6545\u969c\u5c06\u5bfc\u81f4\u6574\u4e2a\u7cfb\u7edf\u7684\u6570\u636e\u90fd\u53d7\u5230\u7834\u574f\u3002\u901a\u4fd7\u6765\u8bf4\uff0cRAID 0 \u6280\u672f\u80fd\u591f\u6709\u6548\u5730\u63d0\u5347\u786c\u76d8\u6570\u636e\u7684\u541e\u5410\u901f\u5ea6\uff0c\u4f46\u662f\u4e0d\u5177\u5907\u6570\u636e\u5907\u4efd\u548c\u9519\u8bef\u4fee\u590d\u80fd\u529b\u3002\u6570\u636e\u88ab\u5206\u522b\u5199\u5165\u5230\u4e0d\u540c\u7684\u786c\u76d8\u8bbe\u5907\u4e2d\uff0c\u5373 disk1 \u548c disk2 \u786c\u76d8\u8bbe\u5907\u4f1a\u5206\u522b\u4fdd\u5b58\u6570\u636e\u8d44\u6599\uff0c\u6700\u7ec8\u5b9e\u73b0\u63d0\u5347\u8bfb\u53d6\u3001\u5199\u5165\u901f\u5ea6\u7684\u6548\u679c\u3002</p> <p></p>"},{"location":"linux/service/raid/#raid-1","title":"RAID 1","text":"<p>\u5c3d\u7ba1 RAID 0 \u6280\u672f\u63d0\u5347\u4e86\u786c\u76d8\u8bbe\u5907\u7684\u8bfb\u5199\u901f\u5ea6\uff0c\u4f46\u662f\u5b83\u662f\u5c06\u6570\u636e\u4f9d\u6b21\u5199\u5165\u5230\u5404\u4e2a\u7269\u7406\u786c\u76d8\u4e2d\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u7684\u6570\u636e\u662f\u5206\u5f00\u5b58\u653e\u7684\uff0c\u5176\u4e2d\u4efb\u4f55\u4e00\u5757\u786c\u76d8\u53d1\u751f\u6545\u969c\u90fd\u4f1a\u635f\u574f\u6574\u4e2a\u7cfb\u7edf\u7684\u6570\u636e\u3002\u56e0\u6b64\uff0c\u5982\u679c\u751f\u4ea7\u73af\u5883\u5bf9\u786c\u76d8\u8bbe\u5907\u7684\u8bfb\u5199\u901f\u5ea6\u6ca1\u6709\u8981\u6c42\uff0c\u800c\u662f\u5e0c\u671b\u589e\u52a0\u6570\u636e\u7684\u5b89\u5168\u6027\u65f6\uff0c\u5c31\u9700\u8981\u7528\u5230 RAID 1 \u6280\u672f\u4e86\u3002</p> <p>RAID 1 \u6280\u672f\u793a\u610f\u56fe\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u5b83\u662f\u628a\u4e24\u5757\u4ee5\u4e0a\u7684\u786c\u76d8\u8bbe\u5907\u8fdb\u884c\u7ed1\u5b9a\uff0c\u5728\u5199\u5165\u6570\u636e\u65f6\uff0c\u662f\u5c06\u6570\u636e\u540c\u65f6\u5199\u5165\u5230\u591a\u5757\u786c\u76d8\u8bbe\u5907\u4e0a\uff08\u53ef\u4ee5\u5c06\u5176\u89c6\u4e3a\u6570\u636e\u7684\u955c\u50cf\u6216\u5907\u4efd\uff09\u3002\u5f53\u5176\u4e2d\u67d0\u4e00\u5757\u786c\u76d8\u53d1\u751f\u6545\u969c\u540e\uff0c\u4e00\u822c\u4f1a\u7acb\u5373\u81ea\u52a8\u4ee5\u70ed\u4ea4\u6362\u7684\u65b9\u5f0f\u6765\u6062\u590d\u6570\u636e\u7684\u6b63\u5e38\u4f7f\u7528\u3002</p> <p></p> <p>RAID 1 \u6280\u672f\u867d\u7136\u5341\u5206\u6ce8\u91cd\u6570\u636e\u7684\u5b89\u5168\u6027\uff0c\u4f46\u662f\u56e0\u4e3a\u662f\u5728\u591a\u5757\u786c\u76d8\u8bbe\u5907\u4e2d\u5199\u5165\u4e86\u76f8\u540c\u7684\u6570\u636e\uff0c\u56e0\u6b64\u786c\u76d8\u8bbe\u5907\u7684\u5229\u7528\u7387\u5f97\u4ee5\u4e0b\u964d\uff0c\u4ece\u7406\u8bba\u4e0a\u6765\u8bf4\uff0c\u786c\u76d8\u7a7a\u95f4\u7684\u771f\u5b9e\u53ef\u7528\u7387\u53ea\u670950%\uff0c\u7531\u4e09\u5757\u786c\u76d8\u8bbe\u5907\u7ec4\u6210\u7684 RAID 1 \u78c1\u76d8\u9635\u5217\u7684\u53ef\u7528\u7387\u53ea\u6709 33% \u5de6\u53f3\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u800c\u4e14\uff0c\u7531\u4e8e\u9700\u8981\u628a\u6570\u636e\u540c\u65f6\u5199\u5165\u5230\u4e24\u5757\u4ee5\u4e0a\u7684\u786c\u76d8\u8bbe\u5907\uff0c\u8fd9\u65e0\u7591\u4e5f\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u589e\u5927\u4e86\u7cfb\u7edf\u8ba1\u7b97\u529f\u80fd\u7684\u8d1f\u8f7d\u3002</p>"},{"location":"linux/service/raid/#raid-5","title":"RAID 5","text":"<p>RAID5 \u6280\u672f\u662f\u628a\u786c\u76d8\u8bbe\u5907\u7684\u6570\u636e\u5947\u5076\u6821\u9a8c\u4fe1\u606f\u4fdd\u5b58\u5230\u5176\u4ed6\u786c\u76d8\u8bbe\u5907\u4e2d\u3002RAID 5 \u78c1\u76d8\u9635\u5217\u7ec4\u4e2d\u6570\u636e\u7684\u5947\u5076\u6821\u9a8c\u4fe1\u606f\u5e76\u4e0d\u662f\u5355\u72ec\u4fdd\u5b58\u5230\u67d0\u4e00\u5757\u786c\u76d8\u8bbe\u5907\u4e2d\uff0c\u800c\u662f\u5b58\u50a8\u5230\u9664\u81ea\u8eab\u4ee5\u5916\u7684\u5176\u4ed6\u6bcf\u4e00\u5757\u786c\u76d8\u8bbe\u5907\u4e0a\uff0c\u8fd9\u6837\u7684\u597d\u5904\u662f\u5176\u4e2d\u4efb\u4f55\u4e00\u8bbe\u5907\u635f\u574f\u540e\u4e0d\u81f3\u4e8e\u51fa\u73b0\u81f4\u547d\u7f3a\u9677\uff1bparity \u90e8\u5206\u5b58\u653e\u7684\u5c31\u662f\u6570\u636e\u7684\u5947\u5076\u6821\u9a8c\u4fe1\u606f\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u5c31\u662f RAID 5 \u6280\u672f\u5b9e\u9645\u4e0a\u6ca1\u6709\u5907\u4efd\u786c\u76d8\u4e2d\u7684\u771f\u5b9e\u6570\u636e\u4fe1\u606f\uff0c\u800c\u662f\u5f53\u786c\u76d8\u8bbe\u5907\u51fa\u73b0\u95ee\u9898\u540e\u901a\u8fc7\u5947\u5076\u6821\u9a8c\u4fe1\u606f\u6765\u5c1d\u8bd5\u91cd\u5efa\u635f\u574f\u7684\u6570\u636e\u3002RAID \u8fd9\u6837\u7684\u6280\u672f\u7279\u6027\u201c\u59a5\u534f\u201d\u5730\u517c\u987e\u4e86\u786c\u76d8\u8bbe\u5907\u7684\u8bfb\u5199\u901f\u5ea6\u3001\u6570\u636e\u5b89\u5168\u6027\u4e0e\u5b58\u50a8\u6210\u672c\u95ee\u9898\u3002</p> <p></p>"},{"location":"linux/service/raid/#raid-10","title":"RAID 10","text":"<p>\u9274\u4e8e RAID 5 \u6280\u672f\u662f\u56e0\u4e3a\u786c\u76d8\u8bbe\u5907\u7684\u6210\u672c\u95ee\u9898\u5bf9\u8bfb\u5199\u901f\u5ea6\u548c\u6570\u636e\u7684\u5b89\u5168\u6027\u80fd\u800c\u6709\u4e86\u4e00\u5b9a\u7684\u59a5\u534f\uff0c\u4f46\u662f\u5927\u90e8\u5206\u4f01\u4e1a\u66f4\u5728\u4e4e\u7684\u662f\u6570\u636e\u672c\u8eab\u7684\u4ef7\u503c\u800c\u975e\u786c\u76d8\u4ef7\u683c\uff0c\u56e0\u6b64\u751f\u4ea7\u73af\u5883\u4e2d\u4e3b\u8981\u4f7f\u7528 RAID 10 \u6280\u672f\u3002</p> <p>\u987e\u540d\u601d\u4e49\uff0cRAID 10 \u6280\u672f\u662f RAID 1+RAID 0 \u6280\u672f\u7684\u4e00\u4e2a\u201c\u7ec4\u5408\u4f53\u201d\u3002RAID 10 \u6280\u672f\u9700\u8981\u81f3\u5c11 4 \u5757\u786c\u76d8\u6765\u7ec4\u5efa\uff0c\u5176\u4e2d\u5148\u5206\u522b\u4e24\u4e24\u5236\u4f5c\u6210 RAID 1 \u78c1\u76d8\u9635\u5217\uff0c\u4ee5\u4fdd\u8bc1\u6570\u636e\u7684\u5b89\u5168\u6027\uff1b\u7136\u540e\u518d\u5bf9\u4e24\u4e2a RAID 1 \u78c1\u76d8\u9635\u5217\u5b9e\u65bd RAID 0 \u6280\u672f\uff0c\u8fdb\u4e00\u6b65\u63d0\u9ad8\u786c\u76d8\u8bbe\u5907\u7684\u8bfb\u5199\u901f\u5ea6\u3002\u8fd9\u6837\u4ece\u7406\u8bba\u4e0a\u6765\u8bb2\uff0c\u53ea\u8981\u574f\u7684\u4e0d\u662f\u540c\u4e00\u7ec4\u4e2d\u7684\u6240\u6709\u786c\u76d8\uff0c\u90a3\u4e48\u6700\u591a\u53ef\u4ee5\u635f\u574f 50% \u7684\u786c\u76d8\u8bbe\u5907\u800c\u4e0d\u4e22\u5931\u6570\u636e\u3002\u7531\u4e8e RAID 10 \u6280\u672f\u7ee7\u627f\u4e86 RAID 0 \u7684\u9ad8\u8bfb\u5199\u901f\u5ea6\u548c RAID 1 \u7684\u6570\u636e\u5b89\u5168\u6027\uff0c\u5728\u4e0d\u8003\u8651\u6210\u672c\u7684\u60c5\u51b5\u4e0b RAID 10 \u7684\u6027\u80fd\u90fd\u8d85\u8fc7\u4e86 RAID 5\uff0c\u56e0\u6b64\u5f53\u524d\u6210\u4e3a\u5e7f\u6cdb\u4f7f\u7528\u7684\u4e00\u79cd\u5b58\u50a8\u6280\u672f\u3002</p> <p></p>"},{"location":"linux/service/raid/#_1","title":"\u90e8\u7f72\u78c1\u76d8\u5217\u9635","text":"<p>\u78c1\u76d8\u51c6\u5907\uff1a</p> <p><code>mdadm</code> \u547d\u4ee4\u7528\u4e8e\u7ba1\u7406 Linux \u7cfb\u7edf\u4e2d\u7684\u8f6f\u4ef6 RAID \u786c\u76d8\u9635\u5217\uff0c\u683c\u5f0f\u4e3a: <code>mdadm [\u6a21\u5f0f] &lt;RAID\u8bbe\u5907\u540d\u79f0&gt; [\u9009\u9879] [\u6210\u5458\u8bbe\u5907\u540d\u79f0]</code>\u3002</p> <p>mdadm\u547d\u4ee4\u7684\u5e38\u7528\u53c2\u6570\u4ee5\u53ca\u4f5c\u7528\uff1a</p> <ul> <li>-a  \u68c0\u6d4b\u8bbe\u5907\u540d\u79f0</li> <li>-n  \u6307\u5b9a\u8bbe\u5907\u6570\u91cf</li> <li>-l  \u6307\u5b9aRAID\u7ea7\u522b</li> <li>-C  \u521b\u5efa</li> <li>-v  \u663e\u793a\u8fc7\u7a0b</li> <li>-f  \u6a21\u62df\u8bbe\u5907\u635f\u574f</li> <li>-r  \u79fb\u9664\u8bbe\u5907</li> <li>-Q  \u67e5\u770b\u6458\u8981\u4fe1\u606f</li> <li>-D  \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f</li> <li>-S  \u505c\u6b62RAID\u78c1\u76d8\u9635\u5217</li> </ul> <pre><code>[root@localhost ~]# ls -l /dev/sd*\nbrw-rw----. 1 root disk 8,  0 7\u6708  31 06:12 /dev/sda\nbrw-rw----. 1 root disk 8,  1 7\u6708  31 06:12 /dev/sda1\nbrw-rw----. 1 root disk 8,  2 7\u6708  31 06:12 /dev/sda2\nbrw-rw----. 1 root disk 8, 16 7\u6708  31 06:12 /dev/sdb\nbrw-rw----. 1 root disk 8, 32 7\u6708  31 06:12 /dev/sdc\nbrw-rw----. 1 root disk 8, 48 7\u6708  31 06:12 /dev/sdd\nbrw-rw----. 1 root disk 8, 64 7\u6708  31 06:12 /dev/sde\n</code></pre> <p>\u4ee5 RAID 10 \u4e3a\u4f8b\uff1a</p> <p>\u751f\u4ea7\u73af\u5883\u4e2d\u7528\u5230\u7684\u670d\u52a1\u5668\u4e00\u822c\u90fd\u914d\u5907RAID\u9635\u5217\u5361\u3002</p> <p>\u7528 sdb-sde \u56db\u5757\u786c\u76d8\u7ec4\u6210 RAID 10 \u78c1\u76d8\u9635\u5217\uff0c\u540d\u79f0\u4e3a <code>/dev/md0</code>\u3002</p> <pre><code>[root@localhost ~]# yum install -y mdadm\n[root@localhost ~]# mdadm -Cv /dev/md0 -a yes -n 4 -l 10 /dev/sd[b:e]\nmdadm: layout defaults to n2\nmdadm: layout defaults to n2\nmdadm: chunk size defaults to 512K\nmdadm: size set to 5237760K\nmdadm: Defaulting to version 1.2 metadata\nmdadm: array /dev/md0 started.\n</code></pre> <p>\u683c\u5f0f\u5316\uff1a</p> <pre><code>[root@localhost ~]# mkfs.xfs /dev/md0\nmeta-data=/dev/md0               isize=512    agcount=16, agsize=163712 blks\n         =                       sectsz=512   attr=2, projid32bit=1\n         =                       crc=1        finobt=0, sparse=0\ndata     =                       bsize=4096   blocks=2618880, imaxpct=25\n         =                       sunit=128    swidth=256 blks\nnaming   =version 2              bsize=4096   ascii-ci=0 ftype=1\nlog      =internal log           bsize=4096   blocks=2560, version=2\n         =                       sectsz=512   sunit=8 blks, lazy-count=1\nrealtime =none                   extsz=4096   blocks=0, rtextents=0\n</code></pre> <p>\u521b\u5efa\u6302\u8f7d\u76ee\u5f55\uff1a</p> <pre><code>[root@localhost ~]# mkdir /raid10\n[root@localhost ~]# mount /dev/md0 /raid10\n[root@localhost ~]# df -h\n\u6587\u4ef6\u7cfb\u7edf                 \u5bb9\u91cf  \u5df2\u7528  \u53ef\u7528 \u5df2\u7528% \u6302\u8f7d\u70b9\n/dev/mapper/centos-root  8.0G  1.9G  6.1G   24% /\ndevtmpfs                 475M     0  475M    0% /dev\ntmpfs                    487M     0  487M    0% /dev/shm\ntmpfs                    487M  7.5M  479M    2% /run\ntmpfs                    487M     0  487M    0% /sys/fs/cgroup\n/dev/sda1               1014M  194M  821M   20% /boot\ntmpfs                     98M     0   98M    0% /run/user/0\n/dev/md0                  10G   33M   10G    1% /raid10\n</code></pre> <p>\u67e5\u770b <code>/dev/md0</code> \u8be6\u7ec6\u4fe1\u606f\uff0c\u5e76\u4f7f\u5176\u6c38\u4e45\u751f\u6548\uff1a</p> <pre><code>[root@localhost ~]# mdadm -D /dev/md0\n/dev/md0:\n           Version : 1.2\n     Creation Time : Wed Jul 31 06:30:37 2019\n        Raid Level : raid10\n        Array Size : 10475520 (9.99 GiB 10.73 GB)\n     Used Dev Size : 5237760 (5.00 GiB 5.36 GB)\n      Raid Devices : 4\n     Total Devices : 4\n       Persistence : Superblock is persistent\n\n       Update Time : Wed Jul 31 06:35:47 2019\n             State : clean\n    Active Devices : 4\n   Working Devices : 4\n    Failed Devices : 0\n     Spare Devices : 0\n\n            Layout : near=2\n        Chunk Size : 512K\n\nConsistency Policy : resync\n\n              Name : localhost.localdomain:0  (local to host localhost.localdomain)\n              UUID : 79005a6f:d8ca3e08:05cea84f:de2cff6b\n            Events : 17\n\n    Number   Major   Minor   RaidDevice State\n       0       8       16        0      active sync set-A   /dev/sdb\n       1       8       32        1      active sync set-B   /dev/sdc\n       2       8       48        2      active sync set-A   /dev/sdd\n       3       8       64        3      active sync set-B   /dev/sde\n[root@localhost ~]# cat &lt;&lt;EOF&gt; /etc/fstab\n/dev/md0 /raid10 xfs defaults 0 0\nEOF\n</code></pre>"},{"location":"linux/service/raid/#_2","title":"\u78c1\u76d8\u9635\u5217\u635f\u574f\u53ca\u4fee\u590d","text":"<p>\u4f7f\u7528 <code>mdadm</code> \u547d\u4ee4\u79fb\u9664\u635f\u574f\u8bbe\u5907\uff0c\u68c0\u67e5 RAID \u9635\u5217\u72b6\u6001\u3002</p> <pre><code>[root@localhost ~]# mdadm /dev/md0 -f /dev/sdb\nmdadm: set /dev/sdb faulty in /dev/md0\n[root@localhost ~]# mdadm -D /dev/md0\n/dev/md0:\n           Version : 1.2\n     Creation Time : Wed Jul 31 06:30:37 2019\n        Raid Level : raid10\n        Array Size : 10475520 (9.99 GiB 10.73 GB)\n     Used Dev Size : 5237760 (5.00 GiB 5.36 GB)\n      Raid Devices : 4\n     Total Devices : 4\n       Persistence : Superblock is persistent\n\n       Update Time : Wed Jul 31 06:49:20 2019\n             State : clean, degraded\n    Active Devices : 3\n   Working Devices : 3\n    Failed Devices : 1\n     Spare Devices : 0\n\n            Layout : near=2\n        Chunk Size : 512K\n\nConsistency Policy : resync\n\n              Name : localhost.localdomain:0  (local to host localhost.localdomain)\n              UUID : 79005a6f:d8ca3e08:05cea84f:de2cff6b\n            Events : 19\n\n    Number   Major   Minor   RaidDevice State\n       -       0        0        0      removed\n       1       8       32        1      active sync set-B   /dev/sdc\n       2       8       48        2      active sync set-A   /dev/sdd\n       3       8       64        3      active sync set-B   /dev/sde\n\n       0       8       16        -      faulty   /dev/sdb\n[root@localhost ~]#\n</code></pre> <p>\u5728RAID 10\u7ea7\u522b\u7684\u78c1\u76d8\u9635\u5217\u4e2d\uff0c\u5f53RAID 1\u78c1\u76d8\u9635\u5217\u4e2d\u5b58\u5728\u4e00\u4e2a\u6545\u969c\u76d8\u65f6\u5e76\u4e0d\u5f71\u54cdRAID 10\u78c1\u76d8\u9635\u5217\u7684\u4f7f\u7528\u3002\u6dfb\u52a0\u65b0\u786c\u76d8\u8bbe\u5907\u540e\u518d\u4f7f\u7528mdadm\u547d\u4ee4\u6765\u4e88\u4ee5\u66ff\u6362\u5373\u53ef\u3002</p> <p>\u66ff\u6362\u65b0\u786c\u76d8\uff1a</p> <pre><code>[root@localhost ~]# umount /dev/md0\n[root@localhost ~]# mdadm /dev/md0 -a /dev/sdf\nmdadm: added /dev/sdf\n[root@localhost ~]# mdadm /dev/md0 -r /dev/sdb\nmdadm: hot removed /dev/sdb from /dev/md0\n[root@localhost ~]# mdadm -D /dev/md0\n/dev/md0:\n           Version : 1.2\n     Creation Time : Wed Jul 31 06:30:37 2019\n        Raid Level : raid10\n        Array Size : 10475520 (9.99 GiB 10.73 GB)\n     Used Dev Size : 5237760 (5.00 GiB 5.36 GB)\n      Raid Devices : 4\n     Total Devices : 4\n       Persistence : Superblock is persistent\n\n       Update Time : Wed Jul 31 06:59:30 2019\n             State : clean\n    Active Devices : 4\n   Working Devices : 4\n    Failed Devices : 0\n     Spare Devices : 0\n\n            Layout : near=2\n        Chunk Size : 512K\n\nConsistency Policy : resync\n\n              Name : localhost.localdomain:0  (local to host localhost.localdomain)\n              UUID : 79005a6f:d8ca3e08:05cea84f:de2cff6b\n            Events : 74\n\n    Number   Major   Minor   RaidDevice State\n       5       8       80        0      active sync set-A   /dev/sdf\n       1       8       32        1      active sync set-B   /dev/sdc\n       2       8       48        2      active sync set-A   /dev/sdd\n       3       8       64        3      active sync set-B   /dev/sde\n[root@localhost ~]#\n</code></pre>"},{"location":"linux/service/raid/#_3","title":"\u78c1\u76d8\u9635\u5217+\u5907\u4efd\u76d8","text":"<p>\u4f7f\u7528 RAID \u5907\u4efd\u76d8\u6280\u672f\u53ef\u4ee5\u9884\u9632\u67d0\u5757\u786c\u76d8\u51fa\u73b0\u6545\u969c\u65f6\u81ea\u52a8\u9876\u66ff\uff0c\u4ece\u800c\u4fdd\u969c\u6b63\u5e38\u5de5\u4f5c\uff0c\u4e0d\u81f3\u4e8e\u4e22\u6389\u996d\u7897\u3002</p> <p>\u8be5\u6280\u672f\u7684\u6838\u5fc3\u7406\u5ff5\u5c31\u662f\u51c6\u5907\u4e00\u5757\u8db3\u591f\u5927\u7684\u786c\u76d8\uff0c\u8fd9\u5757\u786c\u76d8\u5e73\u65f6\u5904\u4e8e\u95f2\u7f6e\u72b6\u6001\uff0c\u4e00\u65e6 RAID \u78c1\u76d8\u9635\u5217\u4e2d\u6709\u786c\u76d8\u51fa\u73b0\u6545\u969c\u540e\u5219\u4f1a\u9a6c\u4e0a\u81ea\u52a8\u9876\u66ff\u4e0a\u53bb\u3002</p> <p>\u6dfb\u52a0\u5907\u4efd\u786c\u76d8\u5e76\u6a21\u62df\u786c\u76d8\u635f\u574f\u540e\u81ea\u52a8\u66ff\u6362\uff1a</p> <pre><code>mdadm /dev/md0 -a /dev/sdb\n[root@localhost ~]# mdadm -D /dev/md0\n/dev/md0:\n           Version : 1.2\n     Creation Time : Wed Jul 31 06:30:37 2019\n        Raid Level : raid10\n        Array Size : 10475520 (9.99 GiB 10.73 GB)\n     Used Dev Size : 5237760 (5.00 GiB 5.36 GB)\n      Raid Devices : 4\n     Total Devices : 5\n       Persistence : Superblock is persistent\n\n       Update Time : Wed Jul 31 07:23:57 2019\n             State : clean\n    Active Devices : 4\n   Working Devices : 5\n    Failed Devices : 0\n     Spare Devices : 1\n\n            Layout : near=2\n        Chunk Size : 512K\n\nConsistency Policy : resync\n\n              Name : localhost.localdomain:0  (local to host localhost.localdomain)\n              UUID : 79005a6f:d8ca3e08:05cea84f:de2cff6b\n            Events : 228\n\n    Number   Major   Minor   RaidDevice State\n       6       8       32        0      active sync set-A   /dev/sdf\n       8       8       64        1      active sync set-B   /dev/sdc\n       5       8       80        2      active sync set-A   /dev/sdd\n       7       8       48        3      active sync set-B   /dev/sde\n\n       4       8       16        -      spare   /dev/sdb\n[root@localhost ~]# mdadm /dev/md0 -f /dev/sdc\nmdadm: set /dev/sdc faulty in /dev/md0\n[root@localhost ~]# mdadm -D /dev/md0\n/dev/md0:\n           Version : 1.2\n     Creation Time : Wed Jul 31 06:30:37 2019\n        Raid Level : raid10\n        Array Size : 10475520 (9.99 GiB 10.73 GB)\n     Used Dev Size : 5237760 (5.00 GiB 5.36 GB)\n      Raid Devices : 4\n     Total Devices : 5\n       Persistence : Superblock is persistent\n\n       Update Time : Wed Jul 31 07:26:56 2019\n             State : clean, degraded, recovering\n    Active Devices : 3\n   Working Devices : 4\n    Failed Devices : 1\n     Spare Devices : 1\n\n            Layout : near=2\n        Chunk Size : 512K\n\nConsistency Policy : resync\n\n    Rebuild Status : 8% complete\n\n              Name : localhost.localdomain:0  (local to host localhost.localdomain)\n              UUID : 79005a6f:d8ca3e08:05cea84f:de2cff6b\n            Events : 252\n\n    Number   Major   Minor   RaidDevice State\n       5       8       80        0      spare rebuilding   /dev/sdb\n       8       8       64        1      active sync set-B   /dev/sdf\n       4       8       16        2      active sync set-A   /dev/sdd\n       7       8       48        3      active sync set-B   /dev/sde\n\n       6       8       32        -      faulty   /dev/sdc\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 <code>Rebuild Status : 8% complete</code> \u6b63\u5728\u81ea\u52a8\u540c\u6b65\u3002</p> <p>\u540c\u6b65\u5b8c\u540e\uff1a</p> <pre><code>[root@localhost ~]# mdadm -D /dev/md0\n/dev/md0:\n           Version : 1.2\n     Creation Time : Wed Jul 31 06:30:37 2019\n        Raid Level : raid10\n        Array Size : 10475520 (9.99 GiB 10.73 GB)\n     Used Dev Size : 5237760 (5.00 GiB 5.36 GB)\n      Raid Devices : 4\n     Total Devices : 5\n       Persistence : Superblock is persistent\n\n       Update Time : Wed Jul 31 07:27:20 2019\n             State : clean\n    Active Devices : 4\n   Working Devices : 4\n    Failed Devices : 1\n     Spare Devices : 0\n\n            Layout : near=2\n        Chunk Size : 512K\n\nConsistency Policy : resync\n\n              Name : localhost.localdomain:0  (local to host localhost.localdomain)\n              UUID : 79005a6f:d8ca3e08:05cea84f:de2cff6b\n            Events : 268\n\n    Number   Major   Minor   RaidDevice State\n       5       8       80        0      active sync set-A   /dev/sdb\n       8       8       64        1      active sync set-B   /dev/sdf\n       4       8       16        2      active sync set-A   /dev/sdd\n       7       8       48        3      active sync set-B   /dev/sde\n\n       6       8       32        -      faulty   /dev/sdc\n[root@localhost ~]#\n</code></pre> <p>\u521b\u5efa RAID \u9635\u5217\u65f6\u6dfb\u52a0\u5907\u4efd\u786c\u76d8\uff1a</p> <pre><code>[root@localhost ~]# mdadm -S /dev/md0\nmdadm: stopped /dev/md0\n[root@localhost ~]# mdadm -Cv /dev/md10 -n4 -x 1 -l 10 /dev/sd[b-f]\nmdadm: layout defaults to n2\nmdadm: layout defaults to n2\nmdadm: chunk size defaults to 512K\nmdadm: /dev/sdb appears to be part of a raid array:\n       level=raid10 devices=4 ctime=Wed Jul 31 07:39:17 2019\nmdadm: /dev/sdc appears to be part of a raid array:\n       level=raid10 devices=4 ctime=Wed Jul 31 07:39:17 2019\nmdadm: /dev/sdd appears to be part of a raid array:\n       level=raid10 devices=4 ctime=Wed Jul 31 07:39:17 2019\nmdadm: /dev/sde appears to be part of a raid array:\n       level=raid10 devices=4 ctime=Wed Jul 31 07:39:17 2019\nmdadm: /dev/sdf appears to be part of a raid array:\n       level=raid10 devices=4 ctime=Wed Jul 31 07:39:17 2019\nmdadm: size set to 5237760K\nContinue creating array? y\nmdadm: Defaulting to version 1.2 metadata\nmdadm: array /dev/md10 started.\n[root@localhost ~]# mdadm -D /dev/md10\n/dev/md10:\n           Version : 1.2\n     Creation Time : Wed Jul 31 07:41:59 2019\n        Raid Level : raid10\n        Array Size : 10475520 (9.99 GiB 10.73 GB)\n     Used Dev Size : 5237760 (5.00 GiB 5.36 GB)\n      Raid Devices : 4\n     Total Devices : 5\n       Persistence : Superblock is persistent\n\n       Update Time : Wed Jul 31 07:42:28 2019\n             State : clean, resyncing\n    Active Devices : 4\n   Working Devices : 5\n    Failed Devices : 0\n     Spare Devices : 1\n\n            Layout : near=2\n        Chunk Size : 512K\n\nConsistency Policy : resync\n\n     Resync Status : 59% complete\n\n              Name : localhost.localdomain:10  (local to host localhost.localdomain)\n              UUID : e256bfe1:a59ef9d6:90f5da16:4cfe0ca3\n            Events : 9\n\n    Number   Major   Minor   RaidDevice State\n       0       8       16        0      active sync set-A   /dev/sdb\n       1       8       32        1      active sync set-B   /dev/sdc\n       2       8       48        2      active sync set-A   /dev/sdd\n       3       8       64        3      active sync set-B   /dev/sde\n\n       4       8       80        -      spare   /dev/sdf\n[root@localhost ~]#\n</code></pre>"},{"location":"linux/service/raid/#_4","title":"\u89e3\u6563\u9635\u5217","text":"<pre><code>[root@localhost ~]# mdadm -S /dev/md10\nmdadm: stopped /dev/md10\n[root@localhost ~]# ls -al /dev/md10\nls: \u65e0\u6cd5\u8bbf\u95ee/dev/md10: \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\n</code></pre>"},{"location":"linux/service/raid/#_5","title":"\u53c2\u8003","text":"<p>\u4f7f\u7528 RAID \u4e0e LVM \u78c1\u76d8\u9635\u5217\u6280\u672f</p>"},{"location":"linux/service/squid-proxy-server/","title":"Squid proxy server","text":""},{"location":"linux/service/squid-proxy-server/#squid","title":"Squid \u4ee3\u7406\u670d\u52a1\u5668","text":"<p>\u4ee3\u7406\u670d\u52a1\u5668\uff08Proxy Server\uff09\u4e3b\u8981\u7528\u4e8e\u8f6c\u53d1\u5ba2\u6237\u7cfb\u7edf\u7684\u7f51\u7edc\u8bbf\u95ee\u8bf7\u6c42\u3002</p> <p>\u4f46\u662f\uff0c\u4ee3\u7406\u670d\u52a1\u5668\u4e0d\u53ea\u662f\u7b80\u5355\u5730\u5411\u771f\u6b63\u7684\u56e0\u7279\u7f51\u670d\u52a1\u5668\u8f6c\u53d1\u8bf7\u6c42\uff0c\u5b83\u8fd8\u53ef\u4ee5\u63a7\u5236\u7528\u6237\u7684\u884c\u4e3a\uff0c\u5bf9\u63a5\u6536\u5230\u7684\u5ba2\u6237\u8bf7\u6c42\u8fdb\u884c\u51b3\u7b56\uff0c\u5e76\u6839\u636e\u8fc7\u6ee4\u89c4\u5219\u5bf9\u7528\u6237\u8bf7\u6c42\u8fdb\u884c\u8fc7\u6ee4\u3002</p> <p>\u4ece\u4ee3\u7406\u670d\u52a1\u5668\u5de5\u4f5c\u7684\u5c42\u6b21\u89d2\u5ea6\u6765\u8bf4\u53ef\u4ee5\u5206\u4e3a\u3010\u5e94\u7528\u5c42\u4ee3\u7406\u3011\u3001\u3010\u4f20\u8f93\u5c42\u4ee3\u7406\u3011\u548c\u3010SOCKS\u4ee3\u7406\u3011\u3002</p> <ul> <li><code>\u5e94\u7528\u5c42\u4ee3\u7406</code>: \u5de5\u4f5c\u5728TCP/IP\u6a21\u578b\u7684\u5e94\u7528\u5c42\u4e4b\u4e0a\uff0c\u5b83\u53ea\u80fd\u7528\u4e8e\u652f\u6301\u4ee3\u7406\u7684\u5e94\u7528\u5c42\u534f\u8bae\uff08\u5982HTTP\uff0cFTP\uff09\u3002\u5b83\u63d0\u4f9b\u7684\u63a7\u5236\u6700\u591a\uff0c\u4f46\u662f\u4e0d\u7075\u6d3b\uff0c\u5fc5\u987b\u8981\u6709\u76f8\u5e94\u7684\u534f\u8bae\u652f\u6301\u3002</li> <li><code>\u4f20\u8f93\u5c42\u4ee3\u7406</code>: \u76f4\u63a5\u4e0eTCP\u5c42\u4ea4\u4e92\uff0c\u66f4\u52a0\u7075\u6d3b\u3002\u8981\u6c42\u4ee3\u7406\u670d\u52a1\u5668\u5177\u6709\u90e8\u5206\u771f\u6b63\u670d\u52a1\u5668\u7684\u529f\u80fd\uff1a\u76d1\u542c\u7279\u5b9aTCP\u6216UDP\u7aef\u53e3\uff0c\u63a5\u6536\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\u540c\u65f6\u5411\u5ba2\u6237\u7aef\u53d1\u51fa\u76f8\u5e94\u7684\u54cd\u5e94\u3002</li> <li><code>Socks</code>: \u662f\u4e00\u4e2a c/s \u67b6\u6784\u7684\u4ee3\u7406\u534f\u8bae\u3002\u5b83\u5305\u62ec\u4e24\u4e2a\u4e3b\u8981\u7684\u7ec4\u4ef6\uff0cSocks \u670d\u52a1\u7aef\u548c Socks \u5ba2\u6237\u7aef\u3002Socks \u670d\u52a1\u7aef\u5b9e\u73b0\u5728\u5e94\u7528\u5c42\uff0cSocks \u5ba2\u6237\u7aef\u5b9e\u73b0\u5728\u5e94\u7528\u5c42\u4e0e\u4f20\u8f93\u5c42\u4e4b\u95f4\u3002\u5f53\u5ba2\u6237\u60f3\u7acb\u5230\u5e94\u7528\u670d\u52a1\u5668\u7684\u8fde\u63a5\u65f6\uff0c\u5148\u8fde\u63a5\u5230\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u4ee3\u7406\u670d\u52a1\u5668\u518d\u8fde\u63a5\u5230\u5e94\u7528\u670d\u52a1\u5668\u3002\u4ee3\u7406\u670d\u52a1\u5668\u5728\u5ba2\u6237\u7aef\u4e0e\u5e94\u7528\u670d\u52a1\u5668\u4e4b\u95f4\u4e2d\u8f6c\u6570\u636e\u3002</li> </ul>"},{"location":"linux/service/squid-proxy-server/#squid_1","title":"Squid","text":"<p>Squid \u662f Linux \u7cfb\u7edf\u4e2d\u6700\u4e3a\u6d41\u884c\u7684\u4e00\u6b3e\u9ad8\u6027\u80fd\u4ee3\u7406\u670d\u52a1\u8f6f\u4ef6\uff0c\u5de5\u4f5c\u5728\u5e94\u7528\u5c42\uff0c\u901a\u5e38\u7528\u4f5c Web \u7f51\u7ad9\u7684\u524d\u7f6e\u7f13\u5b58\u670d\u52a1\uff0c\u80fd\u591f\u4ee3\u66ff\u7528\u6237\u5411\u7f51\u7ad9\u670d\u52a1\u5668\u8bf7\u6c42\u9875\u9762\u6570\u636e\u5e76\u8fdb\u884c\u7f13\u5b58\u3002</p> <p>\u7b80\u5355\u6765\u8bf4\uff0cSquid \u670d\u52a1\u7a0b\u5e8f\u4f1a\u6309\u7167\u6536\u5230\u7684\u7528\u6237\u8bf7\u6c42\u5411\u7f51\u7ad9\u6e90\u670d\u52a1\u5668\u8bf7\u6c42\u9875\u9762\u3001\u56fe\u7247\u7b49\u6240\u9700\u7684\u6570\u636e\uff0c\u5e76\u5c06\u670d\u52a1\u5668\u8fd4\u56de\u7684\u6570\u636e\u5b58\u50a8\u5728\u8fd0\u884c Squid \u670d\u52a1\u7a0b\u5e8f\u7684\u670d\u52a1\u5668\u4e0a\u3002\u5f53\u6709\u7528\u6237\u518d\u8bf7\u6c42\u76f8\u540c\u7684\u6570\u636e\u65f6\uff0c\u5219\u53ef\u4ee5\u76f4\u63a5\u5c06\u5b58\u50a8\u670d\u52a1\u5668\u672c\u5730\u7684\u6570\u636e\u4ea4\u4ed8\u7ed9\u7528\u6237\uff0c\u8fd9\u6837\u4e0d\u4ec5\u51cf\u5c11\u4e86\u7528\u6237\u7684\u7b49\u5f85\u65f6\u95f4\uff0c\u8fd8\u7f13\u89e3\u4e86\u7f51\u7ad9\u670d\u52a1\u5668\u7684\u8d1f\u8f7d\u538b\u529b\u3002</p> <p>Squid\u670d\u52a1\u7a0b\u5e8f\u5177\u6709\u914d\u7f6e\u7b80\u5355\u3001\u6548\u7387\u9ad8\u3001\u529f\u80fd\u4e30\u5bcc\u7b49\u7279\u70b9\uff0c\u5b83\u80fd\u652f\u6301HTTP\u3001FTP\u3001SSL\u7b49\u591a\u79cd\u534f\u8bae\u7684\u6570\u636e\u7f13\u5b58\uff0c\u53ef\u4ee5\u57fa\u4e8e\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08ACL\uff09\u548c\u8bbf\u95ee\u6743\u9650\u5217\u8868\uff08ARL\uff09\u6267\u884c\u5185\u5bb9\u8fc7\u6ee4\u4e0e\u6743\u9650\u7ba1\u7406\u529f\u80fd\uff0c\u8fd8\u53ef\u4ee5\u57fa\u4e8e\u591a\u79cd\u6761\u4ef6\u7981\u6b62\u7528\u6237\u8bbf\u95ee\u5b58\u5728\u5a01\u80c1\u6216\u4e0d\u9002\u5b9c\u7684\u7f51\u7ad9\u8d44\u6e90\uff0c\u56e0\u6b64\u53ef\u4ee5\u4fdd\u62a4\u4f01\u4e1a\u5185\u7f51\u7684\u5b89\u5168\uff0c\u63d0\u5347\u7528\u6237\u7684\u7f51\u7edc\u4f53\u9a8c\uff0c\u5e2e\u52a9\u8282\u7701\u7f51\u7edc\u5e26\u5bbd\u3002</p>"},{"location":"linux/service/squid-proxy-server/#_1","title":"\u4ee3\u7406\u6a21\u5f0f","text":"<ul> <li> <p><code>\u6b63\u5411\u4ee3\u7406\u6a21\u5f0f</code>: \u662f\u6307\u8ba9\u7528\u6237\u901a\u8fc7Squid\u670d\u52a1\u7a0b\u5e8f\u83b7\u53d6\u7f51\u7ad9\u9875\u9762\u7b49\u8d44\u6e90\uff0c\u4ee5\u53ca\u57fa\u4e8e\u8bbf\u95ee\u63a7\u5236\u5217\u8868\uff08ACL\uff09\u529f\u80fd\u5bf9\u7528\u6237\u8bbf\u95ee\u7f51\u7ad9\u884c\u4e3a\u8fdb\u884c\u9650\u5236\uff0c\u5728\u5177\u4f53\u7684\u670d\u52a1\u65b9\u5f0f\u4e0a\u53c8\u5206\u4e3a\u6807\u51c6\u4ee3\u7406\u6a21\u5f0f\u4e0e\u900f\u660e\u4ee3\u7406\u6a21\u5f0f\u3002</p> </li> <li> <p><code>\u6807\u51c6\u6b63\u5411\u4ee3\u7406\u6a21\u5f0f</code>: \u662f\u628a\u7f51\u7ad9\u6570\u636e\u7f13\u5b58\u5230\u670d\u52a1\u5668\u672c\u5730\uff0c\u63d0\u9ad8\u6570\u636e\u8d44\u6e90\u88ab\u518d\u6b21\u8bbf\u95ee\u65f6\u7684\u6548\u7387\uff0c\u7528\u6237\u5728\u4e0a\u7f51\u65f6\u5fc5\u987b\u901a\u8fc7\u4ee3\u7406\u670d\u52a1\u5668\u7684 IP \u5730\u5740\u4e0e\u7aef\u53e3\u53f7\u8bbf\u95ee\uff0c\u5426\u5219\u9ed8\u8ba4\u4e0d\u4f7f\u7528\u4ee3\u7406\u670d\u52a1\u3002</p> </li> <li> <p><code>\u900f\u660e\u6b63\u5411\u4ee3\u7406\u6a21\u5f0f</code>: \u4f5c\u7528\u4e0e\u6807\u51c6\u6b63\u5411\u4ee3\u7406\u6a21\u5f0f\u57fa\u672c\u76f8\u540c\uff0c\u533a\u522b\u662f\u7528\u6237\u4e0d\u9700\u8981\u624b\u52a8\u6307\u5b9a\u4ee3\u7406\u670d\u52a1\u5668\u7684IP\u5730\u5740\u4e0e\u7aef\u53e3\u53f7\uff0c\u5bf9\u4e8e\u7528\u6237\u6765\u8bb2\u662f\u76f8\u5bf9\u900f\u660e\u7684\u3002</p> </li> <li> <p><code>\u53cd\u5411\u4ee3\u7406\u6a21\u5f0f</code>: \u662f\u6307\u8ba9\u591a\u53f0\u8282\u70b9\u4e3b\u673a\u53cd\u5411\u7f13\u5b58\u7f51\u7ad9\u6570\u636e\uff0c\u53ef\u4ee5\u5c31\u8fd1\u4e3a\u7528\u6237\u5206\u914d\u8282\u70b9\u5e76\u4f20\u8f93\u8d44\u6e90\uff0c\u4ece\u800c\u52a0\u5feb\u7528\u6237\u8bbf\u95ee\u901f\u5ea6\u3002</p> </li> </ul>"},{"location":"linux/service/squid-proxy-server/#_2","title":"\u90e8\u7f72","text":"<pre><code>yum install -y squid\nsystemctl start squid\nsystemctl enable squid\n\nfirewall-cmd --permanent --add-service=squid\nfirewall-cmd --reload\n</code></pre> <p>\u4e3b\u914d\u7f6e\u6587\u4ef6<code>/etc/squid/squid.conf</code>\u53c2\u6570\u8bf4\u660e\uff1a</p> <pre><code># \u4fe1\u4efb\u7528\u6237\u4e0e\u76ee\u6807\u63a7\u5236\uff0c\u5b9a\u4e49\u53ef\u80fd\u4f7f\u7528 proxy \u7684\u5916\u90e8\u7528\u6237(\u5185\u7f51)\nacl localnet src 10.0.0.0/8 # RFC1918 possible internal network\nacl localnet src 172.16.0.0/12  # RFC1918 possible internal network\nacl localnet src 192.168.0.0/16 # RFC1918 possible internal network\nacl localnet src fc00::/7       # RFC 4193 local private network range\nacl localnet src fe80::/10      # RFC 4291 link-local (directly plugged) machines\n\n# \u5b9a\u4e49\u53ef\u83b7\u53d6\u5230\u6570\u636e\u7684\u7aef\u53e3\nacl SSL_ports port 443\nacl Safe_ports port 80      # http\nacl Safe_ports port 21      # ftp\nacl Safe_ports port 443     # https\nacl Safe_ports port 70      # gopher\nacl Safe_ports port 210     # wais\nacl Safe_ports port 1025-65535  # unregistered ports\nacl Safe_ports port 280     # http-mgmt\nacl Safe_ports port 488     # gss-http\nacl Safe_ports port 591     # filemaker\nacl Safe_ports port 777     # multiling http\n\nacl CONNECT method CONNECT\n\n# \u5b9a\u4e49\u53ef\u653e\u884c\u7684\u6807\u51c6\u4f9d\u636e(\u6709\u987a\u5e8f)\n# \u62d2\u7edd\u975e\u6b63\u89c4\u7684\u7aef\u53e3\u8bbf\u95ee\u8981\u6c42\nhttp_access deny !Safe_ports\n# \u62d2\u7edd\u975e\u6b63\u89c4\u7684\u52a0\u5bc6\u7aef\u53e3\u8bbf\u95ee\u8981\u6c42\nhttp_access deny CONNECT !SSL_ports\n# \u653e\u884c\u672c\u673a\u7ba1\u7406\nhttp_access allow localhost manager\n# \u62d2\u7edd\u5176\u4ed6\u7ba1\u7406\u6765\u6e90\nhttp_access deny manager\n# \u653e\u884c\u5185\u90e8\u7f51\u7edc\u7684\u7528\u6237\u6765\u6e90\nhttp_access allow localnet\n# \u653e\u884c\u672c\u673a\u7684\u4f7f\u7528\nhttp_access allow localhost\n# \u5168\u90e8\u90fd\u4e88\u4ee5\u62d2\u7edd\nhttp_access deny all\n\n# \u76d1\u542c\u7684\u7aef\u53e3\u53f7\nhttp_port 3128\n# \u900f\u660e\u4ee3\u7406\n#http_port 3128 transparent\n\n# \u9ed8\u8ba4\u7684 squid \u5feb\u53d6\u653e\u7f6e\u7684\u76ee\u5f55\ncoredump_dir /var/spool/squid\n# \u78c1\u76d8\u4e2d\u5feb\u53d6\u7684\u5b58\u5728\u65f6\u95f4\nrefresh_pattern ^ftp:       1440    20% 10080\nrefresh_pattern ^gopher:    1440    0%  1440\nrefresh_pattern -i (/cgi-bin/|\\?) 0 0%  0\nrefresh_pattern .       0   20% 4320\n</code></pre>"},{"location":"linux/service/squid-proxy-server/#_3","title":"\u6b63\u5411\u4ee3\u7406","text":"<p>\u9ed8\u8ba4\u914d\u7f6e\u5c31\u53ef\u4ee5\u63d0\u4f9b\u6807\u51c6\u6b63\u5411\u4ee3\u7406\u3002</p> <p>\u865a\u62df\u673a\u6a21\u62df\u6b63\u5411\u4ee3\u7406\u8bbf\u95ee:</p> <pre><code>curl www.linuxprobe.com\n\nsystemctl stop squid\n\ncurl www.linuxprobe.com -x localhost:3128\n\nsystemctl start squid\n\ncurl www.linuxprobe.com -x localhost:3128\n</code></pre>"},{"location":"linux/service/squid-proxy-server/#acl","title":"ACL \u8bbf\u95ee\u63a7\u5236","text":"<ol> <li>\u53ea\u5141\u8bb8 ip \u5730\u5740\u4e3a 192.168.10.20 \u7684\u5ba2\u6237\u7aef\u8bbf\u95ee\u4ee3\u7406\u670d\u52a1\uff0c\u7981\u6b62\u5176\u4f59\u6240\u6709\u4e3b\u673a\u4ee3\u7406\u8bf7\u6c42\u3002</li> </ol> <pre><code>sed -i '/acl CONNECT method CONNECT/a\\acl client src 192.168.10.20' /etc/squid/squid.conf\nsed -i '/!Safe_ports/i\\http_access allow client\\nhttp_access deny all' /etc/squid/squid.conf\n\nsystemctl restart squid\n</code></pre> <p>\u865a\u62df\u673a\u6a21\u62df\u6d4b\u8bd5\uff0c\u672c\u5730 ip\uff1a192.168.10.10</p> <pre><code>nmcli show\nnmcli con mod ens32 ipv4.addr 192.168.10.20/24\nnmcli con up ens32\ncurl www.linuxprobe.com -x 192.168.10.20:3128\n\nnmcli con mod ens32 ipv4.addr 192.168.10.10/24\nnmcli con up ens32\ncurl www.linuxprobe.com -x 192.168.10.10:3128\ncurl www.linuxprobe.com\n</code></pre> <ol> <li>\u7981\u6b62\u6240\u6709\u5ba2\u6237\u7aef\u8bbf\u95ee\u7f51\u5740\u4e2d\u5305\u542b linux \u5173\u952e\u8bcd\u7684\u7f51\u7ad9\u3002</li> </ol> <pre><code>cat /etc/squid/squid.conf.default &gt; /etc/squid/squid.conf\nsed -i '/acl CONNECT method CONNECT/a\\acl deny_keyword url_regex -i linux' /etc/squid/squid.conf\nsed -i '/!Safe_ports/i\\http_access deny deny_keyword' /etc/squid/squid.conf\n\nsystemctl restart squid\n\ncurl www.linuxprobe.com\ncurl www.linuxprobe.com -x localhost:3128\n</code></pre> <ol> <li>\u7981\u6b62\u6240\u6709\u7528\u6237\u8bbf\u95ee\u67d0\u4e2a\u7279\u5b9a\u7684\u7f51\u7ad9\u3002</li> </ol> <pre><code>cat /etc/squid/squid.conf.default &gt; /etc/squid/squid.conf\nsed -i '/acl CONNECT method CONNECT/a\\acl deny_url url_regex www.linuxprobe.com' /etc/squid/squid.conf\nsed -i '/!Safe_ports/i\\http_access deny deny_url' /etc/squid/squid.conf\n\nsystemctl restart squid\n\ncurl www.linuxprobe.com\ncurl www.linuxprobe.com -x localhost:3128\n</code></pre> <ol> <li>\u7981\u6b62\u4e0b\u8f7d\u5e26\u6709\u67d0\u4e9b\u540e\u7f00\u7684\u6587\u4ef6\u3002</li> </ol> <pre><code>cat /etc/squid/squid.conf.default &gt; /etc/squid/squid.conf\nsed -i '/acl CONNECT method CONNECT/a\\acl badfile urlpath_regex -i \\.png$' /etc/squid/squid.conf\nsed -i '/!Safe_ports/i\\http_access deny badfile' /etc/squid/squid.conf\n\nsystemctl restart squid\n\ncurl www.linuxprobe.com/linux.png\ncurl www.linuxprobe.com/linux.png -x localhost:3128\n</code></pre>"},{"location":"linux/service/squid-proxy-server/#_4","title":"\u53cd\u5411\u4ee3\u7406","text":"<pre><code>yum install -y httpd\nsystemctl start httpd\n\nnmcli con show ens32 |grep ipv4.addr\nnmcli con mod ens32 +ipv4.addr 192.168.10.50/24\nnmcli con up ens32\n\nping -I 192.168.10.50 www.linuxprobe.com\n\necho \"192.168.10.50 www.example.com\" &gt;&gt; /etc/hosts\ncurl www.example.com\n\ncat /etc/squid/squid.conf.default &gt; /etc/squid/squid.conf\nsed -i 's,http_port 3128,&amp; 192.168.10.10:8080 vhost,' /etc/squid/squid.conf\nsed -i '/http_port/a\\cache_peer 192.168.10.50 parent 80 0 originserver' /etc/squid/squid.conf\n\nsystemctl restart squid\n\ncurl www.example.com -x 192.168.10.10:8080\n</code></pre>"},{"location":"linux/service/squid-proxy-server/#_5","title":"\u533f\u540d\u4ee3\u7406","text":"<ul> <li>\u900f\u660e\u4ee3\u7406(Transparent Proxy)</li> <li><code>REMOTE_ADDR</code> = Proxy IP</li> <li><code>HTTP_VIA</code> = Proxy IP</li> <li><code>HTTP_X_FORWARDED_FOR</code> = Your IP</li> <li> <p>\u900f\u660e\u4ee3\u7406\u867d\u7136\u53ef\u4ee5\u76f4\u63a5\u201c\u9690\u85cf\u201d\u4f60\u7684IP\u5730\u5740\uff0c\u4f46\u662f\u8fd8\u662f\u53ef\u4ee5\u4eceHTTP_X_FORWARDED_FOR\u6765\u67e5\u5230\u4f60\u662f\u8c01\u3002</p> </li> <li> <p>\u533f\u540d\u4ee3\u7406(Anonymous Proxy)</p> </li> <li><code>REMOTE_ADDR</code> = Proxy IP</li> <li><code>HTTP_VIA</code> = Proxy IP</li> <li><code>HTTP_X_FORWARDED_FOR</code> = proxy IP</li> <li> <p>\u533f\u540d\u4ee3\u7406\u6bd4\u900f\u660e\u4ee3\u7406\u8fdb\u6b65\u4e86\u4e00\u70b9\uff1a\u522b\u4eba\u53ea\u80fd\u77e5\u9053\u4f60\u7528\u4e86\u4ee3\u7406\uff0c\u65e0\u6cd5\u77e5\u9053\u4f60\u662f\u8c01\u3002</p> </li> <li> <p>\u6df7\u6dc6\u4ee3\u7406(Distorting Proxies)</p> </li> <li><code>REMOTE_ADDR</code> = Proxy IP</li> <li><code>HTTP_VIA</code> = Proxy IP</li> <li><code>HTTP_X_FORWARDED_FOR</code> = Random IP address</li> <li> <p>\u4e0e\u533f\u540d\u4ee3\u7406\u76f8\u540c\uff0c\u5982\u679c\u4f7f\u7528\u4e86\u6df7\u6dc6\u4ee3\u7406\uff0c\u522b\u4eba\u8fd8\u662f\u80fd\u77e5\u9053\u4f60\u5728\u7528\u4ee3\u7406\uff0c\u4f46\u662f\u4f1a\u5f97\u5230\u4e00\u4e2a\u5047\u7684IP\u5730\u5740\uff0c\u4f2a\u88c5\u7684\u66f4\u903c\u771f</p> </li> <li> <p>\u9ad8\u533f\u4ee3\u7406(Elite proxy\u6216High Anonymity Proxy)</p> </li> <li><code>REMOTE_ADDR</code> = Proxy IP</li> <li><code>HTTP_VIA</code> = not determined</li> <li><code>HTTP_X_FORWARDED_FOR</code> = not determined</li> <li>\u9ad8\u533f\u4ee3\u7406\u8ba9\u522b\u4eba\u6839\u672c\u65e0\u6cd5\u53d1\u73b0\u4f60\u662f\u5728\u7528\u4ee3\u7406\uff0c\u6240\u4ee5\u662f\u6700\u597d\u7684\u9009\u62e9\u3002</li> </ul> <p>\u865a\u62df\u673a\u6a21\u62df\u6d4b\u8bd5\uff1a</p> <pre><code>nmcli con show ens32|grep ipv4.addr\nnmcli con mod ens32 +ipv4.addr 192.168.10.20/24\nnmcli con up ens32\n\necho \"192.168.10.20 www.example.com\" &gt;&gt; /etc/hosts\n\nyum install -y nginx\nsystemctl start nginx\n\ncat /etc/squid/squid.conf.default &gt; /etc/squid/squid.conf\nsed -i 's,http_port 3128,http_port 192.168.10.20:3128,' /etc/squid/squid.conf\n\nsystemctl restart squid\nsquid -k parse\nsquid -z\ncurl -I www.example.com\ncurl -I www.example.com -x 192.168.10.20:3128\n\n# \u9ad8\u533f\u540d\nsed -i '/http_port/i\\forwarded_for delete' /etc/squid/squid.conf\nsed -i '/http_port/i\\follow_x_forwarded_for deny all' /etc/squid/squid.conf\nsed -i '/http_port/i\\request_header_access Via deny all' /etc/squid/squid.conf\nsed -i '/http_port/i\\request_header_access X-Forwarded-For deny all' /etc/squid/squid.conf\nsed -i '/http_port/i\\request_header_access From deny all' /etc/squid/squid.conf\n# \u7981\u7528\u7f13\u5b58\nsed -i '/#cache_dir/a\\cache_dir ufs \\/var\\/spool\\/squid 100 16 256 no-store' /etc/squid/squid.conf\nsed -i '/#cache_dir/i\\acl NCACHE method GET' /etc/squid/squid.conf\nsed -i '/#cache_dir/i\\no_cache deny NCACHE' /etc/squid/squid.conf\n\nsystemctl restart squid\nsquid -k parse\nsquid -z\n\ncurl -I www.example.com  -H \"X-Forwarded-For: 1.1.1.1\" -H \"Host: www.linuxprobe.com\"\ncurl -I www.example.com  -H \"X-Forwarded-For: 1.1.1.1\" -H \"Host: www.linuxprobe.com\" -x 192.168.10.20:3128\ncat /var/log/nginx/access.log\n</code></pre>"},{"location":"linux/service/ssh/","title":"Ssh","text":""},{"location":"linux/service/ssh/#ssh","title":"SSH \u8fdc\u7a0b\u7ba1\u7406\u4e3b\u673a\u670d\u52a1","text":"<p>SSH (Secure Shell) \u662f\u57fa\u4e8e SSH \u534f\u8bae\u5f00\u53d1\u7684\u4e00\u6b3e\u8fdc\u7a0b\u7ba1\u7406\u670d\u52a1\u7a0b\u5e8f \u80fd\u591f\u4ee5\u5b89\u5168\u7684\u65b9\u5f0f\u63d0\u4f9b\u8fdc\u7a0b\u767b\u5f55\u7684\u534f\u8bae\uff0c\u4e5f\u662f\u76ee\u524d\u8fdc\u7a0b\u7ba1\u7406Linux\u7cfb\u7edf\u7684\u9996\u9009\u65b9\u5f0f\u3002</p> <p>sshd \u63d0\u4f9b\u4e24\u79cd\u5b89\u5168\u9a8c\u8bc1\u7684\u65b9\u6cd5\uff1a</p> <ul> <li>\u57fa\u4e8e\u53e3\u4ee4\u7684\u9a8c\u8bc1:</li> <li>\u7528\u8d26\u6237\u548c\u5bc6\u7801\u6765\u9a8c\u8bc1\u767b\u5f55\uff1b</li> <li>\u57fa\u4e8e\u5bc6\u94a5\u7684\u9a8c\u8bc1:</li> <li>\u672c\u5730\u79c1\u94a5\u4e0e\u670d\u52a1\u5668\u4e2d\u7684\u516c\u94a5\u8fdb\u884c\u6bd4\u8f83\uff1b\u8be5\u65b9\u5f0f\u76f8\u8f83\u6765\u8bf4\u66f4\u5b89\u5168\u3002</li> </ul>"},{"location":"linux/service/ssh/#_1","title":"\u914d\u7f6e","text":"<p>\u51e0\u4e4e\u6240\u6709\u7684 linux \u53d1\u884c\u7248\u90fd\u9ed8\u8ba4\u5b89\u88c5\u4e86 sshd \u670d\u52a1\u3002</p> <p>sshd \u670d\u52a1\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\uff1a</p> <pre><code>cat /etc/ssh/sshd_config |grep -Ev '^$|#'\nHostKey /etc/ssh/ssh_host_rsa_key\nHostKey /etc/ssh/ssh_host_ecdsa_key\nHostKey /etc/ssh/ssh_host_ed25519_key\nSyslogFacility AUTHPRIV\nAuthorizedKeysFile    .ssh/authorized_keys\nPasswordAuthentication yes\nChallengeResponseAuthentication no\nGSSAPIAuthentication yes\nGSSAPICleanupCredentials no\nUsePAM yes\nX11Forwarding yes\nAcceptEnv LANG LC_CTYPE LC_NUMERIC LC_TIME LC_COLLATE LC_MONETARY LC_MESSAGES\nAcceptEnv LC_PAPER LC_NAME LC_ADDRESS LC_TELEPHONE LC_MEASUREMENT\nAcceptEnv LC_IDENTIFICATION LC_ALL LANGUAGE\nAcceptEnv XMODIFIERS\nSubsystem    sftp    /usr/libexec/openssh/sftp-server\n</code></pre> <p>sshd \u670d\u52a1\u914d\u7f6e\u6587\u4ef6\u5e38\u7528\u53c2\u6570\u4ee5\u53ca\u4f5c\u7528:</p> \u53c2\u6570 \u4f5c\u7528 <code>Port 22</code> \u9ed8\u8ba4\u7684sshd\u670d\u52a1\u7aef\u53e3 <code>ListenAddress 0.0.0.0</code> \u8bbe\u5b9asshd\u670d\u52a1\u5668\u76d1\u542c\u7684IP\u5730\u5740 <code>Protocol 2</code> SSH\u534f\u8bae\u7684\u7248\u672c\u53f7 <code>HostKey /tc/ssh/ssh_host_key</code> SSH\u534f\u8bae\u7248\u672c\u4e3a1\u65f6\uff0cDES\u79c1\u94a5\u5b58\u653e\u7684\u4f4d\u7f6e <code>HostKey /etc/ssh/ssh_host_rsa_key</code> SSH\u534f\u8bae\u7248\u672c\u4e3a2\u65f6\uff0cRSA\u79c1\u94a5\u5b58\u653e\u7684\u4f4d\u7f6e <code>HostKey /etc/ssh/ssh_host_dsa_key</code> SSH\u534f\u8bae\u7248\u672c\u4e3a2\u65f6\uff0cDSA\u79c1\u94a5\u5b58\u653e\u7684\u4f4d\u7f6e <code>PermitRootLogin yes</code> \u8bbe\u5b9a\u662f\u5426\u5141\u8bb8root\u7ba1\u7406\u5458\u76f4\u63a5\u767b\u5f55 <code>StrictModes yes</code> \u5f53\u8fdc\u7a0b\u7528\u6237\u7684\u79c1\u94a5\u6539\u53d8\u65f6\u76f4\u63a5\u62d2\u7edd\u8fde\u63a5 <code>MaxAuthTries 6</code> \u6700\u5927\u5bc6\u7801\u5c1d\u8bd5\u6b21\u6570 <code>MaxSessions 10</code> \u6700\u5927\u7ec8\u7aef\u6570 <code>PasswordAuthentication yes</code> \u662f\u5426\u5141\u8bb8\u5bc6\u7801\u9a8c\u8bc1 <code>PermitEmptyPasswords no</code> \u662f\u5426\u5141\u8bb8\u7a7a\u5bc6\u7801\u767b\u5f55\uff08\u5f88\u4e0d\u5b89\u5168\uff09 <code>ClientAliveInterval 420</code> \u670d\u52a1\u5668\u7aef\u5411\u5ba2\u6237\u7aef\u8bf7\u6c42\u6d88\u606f\u95f4\u9694\u65f6\u95f4,\u9ed8\u8ba4\u662f0,\u4e0d\u53d1\u9001 <code>ClientAliveCountMax 3</code> \u670d\u52a1\u5668\u53d1\u51fa\u8bf7\u6c42\u540e\u5ba2\u6237\u7aef\u6ca1\u6709\u54cd\u5e94\u7684\u6b21\u6570\u8fbe\u5230\u4e00\u5b9a\u503c,\u81ea\u52a8\u65ad\u5f00 <code>UseDNS</code> \u8fdb\u884cDNS\u6b63\u5411A\u8bb0\u5f55\u67e5\u8be2,\u9632\u6b62\u5ba2\u6237\u7aef\u6b3a\u9a97,\u5173\u95ed\u53ef\u52a0\u5feb\u8fde\u63a5\u901f\u5ea6 <p>\u672c\u5730\u751f\u6210\u79d8\u94a5\u5e76\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\u3002</p> <pre><code>ssh-keygen # \u53ef\u4e00\u8def\u56de\u8f66\nssh-copy-id 192.168.11.130\n</code></pre>"},{"location":"linux/service/ssh/#_2","title":"\u5fc5\u8981\u7684\u5b89\u5168\u63aa\u65bd","text":"<p>\u8003\u8651\u8303\u56f4: \u66f4\u6539\u670d\u52a1\u7aef\u53e3 ==&gt; \u62d2\u7edd\u53e3\u4ee4\u8ba4\u8bc1 ==&gt; \u62d2\u7edd\u4ee5 root \u76f4\u63a5\u767b\u5f55</p> <pre><code>sed -i 's,#Port 22,Port 2222,g' /etc/ssh/sshd_config\nsed -i 's,#PermitRootLogin yes,PermitRootLogin no,g' /etc/ssh/sshd_config\nsed -i 's,#UseDNS yes,UseDNS no,g' /etc/ssh/sshd_config\nsed -i 's,PasswordAuthentication yes,PasswordAuthentication no,g' /etc/ssh/sshd_config\n\nsystemctl restart sshd\n</code></pre> <p>\u5efa\u8bae\uff1a \u4fee\u6539 sshd \u914d\u7f6e\u65f6\u591a\u5f00\u4e00\u4e2a ssh \u8fde\u63a5\u7a97\u53e3\uff0c\u4ee5\u9632\u81ea\u5df1\u88ab\u62d2\u4e4b\u95e8\u5916\u3002</p>"},{"location":"macos/brew%20%E6%9B%B4%E6%8D%A2%E6%B8%85%E5%8D%8E%E5%A4%A7%E5%AD%A6%E9%95%9C%E5%83%8F%E6%BA%90/","title":"brew \u66f4\u6362\u6e05\u534e\u5927\u5b66\u955c\u50cf\u6e90","text":""},{"location":"macos/brew%20%E6%9B%B4%E6%8D%A2%E6%B8%85%E5%8D%8E%E5%A4%A7%E5%AD%A6%E9%95%9C%E5%83%8F%E6%BA%90/#homebrew","title":"\u9996\u6b21\u5b89\u88c5 Homebrew","text":"<p>\u5bf9\u4e8e macOS \u7528\u6237\u9700\u989d\u5916\u8981\u6c42\u5b89\u88c5 Command Line Tools (CLT) for Xcode\u3002</p> <pre><code>xcode-select --install\n</code></pre> <p>\u63a5\u7740\uff0c\u5728\u7ec8\u7aef\u8f93\u5165\u4ee5\u4e0b\u51e0\u884c\u547d\u4ee4\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\uff1a</p> <pre><code>export HOMEBREW_BREW_GIT_REMOTE=\"https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/brew.git\"\nexport HOMEBREW_CORE_GIT_REMOTE=\"https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.git\"\nexport HOMEBREW_BOTTLE_DOMAIN=\"https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles\"\n</code></pre> <p>\u6700\u540e\uff0c\u5728\u7ec8\u7aef\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u4ee5\u5b89\u88c5 Homebrew\uff1a</p> <pre><code>git clone --depth=1 https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/install.git brew-install\n/bin/bash brew-install/install.sh\nrm -rf brew-install\n</code></pre> <p>\u4e5f\u53ef\u4ece GitHub \u83b7\u53d6\u5b98\u65b9\u5b89\u88c5\u811a\u672c\u5b89\u88c5 Homebrew / Linuxbrew</p> <pre><code>/bin/bash -c \"$(curl -fsSL https://github.com/Homebrew/install/raw/master/install.sh)\"\n</code></pre>"},{"location":"macos/brew%20%E6%9B%B4%E6%8D%A2%E6%B8%85%E5%8D%8E%E5%A4%A7%E5%AD%A6%E9%95%9C%E5%83%8F%E6%BA%90/#_1","title":"\u66ff\u6362\u73b0\u6709\u4ed3\u5e93\u4e0a\u6e38","text":"<pre><code>sed -i '/HOMEBREW_BREW_GIT_REMOTE/d' ~/.zshrc ~/.bashrc ~/.bash_profile\nsed -i '/HOMEBREW_CORE_GIT_REMOTE/d' ~/.zshrc ~/.bashrc ~/.bash_profile\nsed -i '/HOMEBREW_BOTTLE_DOMAIN/d' ~/.zshrc ~/.bashrc ~/.bash_profile\n\ncat &gt; ~/.zshrc &lt;&lt;-'EOF'\nexport HOMEBREW_BREW_GIT_REMOTE=\"https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/brew.git\"\nexport HOMEBREW_CORE_GIT_REMOTE=\"https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.git\"\nexport HOMEBREW_BOTTLE_DOMAIN=\"https://mirrors.tuna.tsinghua.edu.cn/homebrew-bottles\"\nEOF\n\nbrew tap --custom-remote --force-auto-update homebrew/core https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-core.git\nbrew tap --custom-remote --force-auto-update homebrew/cask https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask.git\nbrew tap --custom-remote --force-auto-update homebrew/cask-fonts https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask-fonts.git\nbrew tap --custom-remote --force-auto-update homebrew/cask-drivers https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask-drivers.git\nbrew tap --custom-remote --force-auto-update homebrew/cask-versions https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-cask-versions.git\nbrew tap --custom-remote --force-auto-update homebrew/command-not-found https://mirrors.tuna.tsinghua.edu.cn/git/homebrew/homebrew-command-not-found.git\n\nbrew update\n</code></pre>"},{"location":"macos/brew%20%E6%9B%B4%E6%8D%A2%E6%B8%85%E5%8D%8E%E5%A4%A7%E5%AD%A6%E9%95%9C%E5%83%8F%E6%BA%90/#_2","title":"\u590d\u539f\u4ed3\u5e93\u4e0a\u6e38","text":"<pre><code>sed -i '/HOMEBREW_BREW_GIT_REMOTE/d' ~/.zshrc ~/.bashrc ~/.bash_profile\nsed -i '/HOMEBREW_CORE_GIT_REMOTE/d' ~/.zshrc ~/.bashrc ~/.bash_profile\nsed -i '/HOMEBREW_BOTTLE_DOMAIN/d' ~/.zshrc ~/.bashrc ~/.bash_profile\n\nunset HOMEBREW_BREW_GIT_REMOTE\ngit -C \"$(brew --repo)\" remote set-url origin https://github.com/Homebrew/brew\n\n# \u4ee5\u4e0b\u9488\u5bf9 macOS \u7cfb\u7edf\u4e0a\u7684 Homebrew\nunset HOMEBREW_CORE_GIT_REMOTE\nBREW_TAPS=\"$(BREW_TAPS=\"$(brew tap 2&gt;/dev/null)\"; echo -n \"${BREW_TAPS//$'\\n'/:}\")\"\nfor tap in core cask{,-fonts,-drivers,-versions} command-not-found; do\n    if [[ \":${BREW_TAPS}:\" == *\":homebrew/${tap}:\"* ]]; then  # \u53ea\u590d\u539f\u5df2\u5b89\u88c5\u7684 Tap\n        brew tap --custom-remote \"homebrew/${tap}\" \"https://github.com/Homebrew/homebrew-${tap}\"\n    fi\ndone\n\nbrew update\n</code></pre>"},{"location":"macos/macOS%20Big%20Sur%20%E6%97%A0%E6%B3%95%E4%BF%AE%E6%94%B9%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6/","title":"macOS Big Sur \u65e0\u6cd5\u4fee\u6539\u7cfb\u7edf\u6587\u4ef6","text":""},{"location":"macos/macOS%20Big%20Sur%20%E6%97%A0%E6%B3%95%E4%BF%AE%E6%94%B9%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6/#_1","title":"\u95ee\u9898\u63cf\u8ff0","text":"<p>macOS Big Sur \u7cfb\u7edf\u81ea\u5e26 Python@3.8\uff0c\u7528 brew \u5b89\u88c5\u4e86 Python@3.9\uff0c\u5b89\u88c5\u8def\u5f84\u5728 <code>/usr/local/bin/python@3.9</code>\uff0c\u505a\u8f6f\u8fde\u63a5\u65f6\u53d1\u73b0\u4e0d\u80fd\u4fee\u6539\u7cfb\u7edf\u6587\u4ef6\u3002</p> <pre><code>~ sudo ln -sf /usr/local/bin/python3 /usr/bin/python3\nPassword:\nln: /usr/bin/python3: Operation not permitted\n</code></pre>"},{"location":"macos/macOS%20Big%20Sur%20%E6%97%A0%E6%B3%95%E4%BF%AE%E6%94%B9%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6/#_2","title":"\u89e3\u51b3\u65b9\u6cd5","text":""},{"location":"macos/macOS%20Big%20Sur%20%E6%97%A0%E6%B3%95%E4%BF%AE%E6%94%B9%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6/#sip","title":"\u5173\u95ed SIP","text":"<p>\u8fdb\u5165\u7cfb\u7edf Recovery \u6a21\u5f0f\uff0c\u5173\u6389 SIP\u3002</p> <p>SIP: \u7cfb\u7edf\u5b8c\u6574\u6027\u4fdd\u62a4\uff0c\u662f OS X El Capitan \u53ca\u66f4\u9ad8\u7248\u672c\u6240\u91c7\u7528\u7684\u4e00\u9879\u5b89\u5168\u6280\u672f\uff0c\u65e8\u5728\u5e2e\u52a9\u9632\u6b62\u6f5c\u5728\u6076\u610f\u8f6f\u4ef6\u4fee\u6539 Mac \u4e0a\u53d7\u4fdd\u62a4\u7684\u6587\u4ef6\u548c\u6587\u4ef6\u5939\u3002\u7cfb\u7edf\u5b8c\u6574\u6027\u4fdd\u62a4\u53ef\u4ee5\u9650\u5236 root \u7528\u6237\u5e10\u6237\uff0c\u4ee5\u53ca root \u7528\u6237\u80fd\u591f\u5728 Mac \u64cd\u4f5c\u7cfb\u7edf\u7684\u53d7\u4fdd\u62a4\u90e8\u5206\u5b8c\u6210\u7684\u64cd\u4f5c\u3002</p> <pre><code>csrutils disable\ncsrutils authenticated-root disable\nreboot\n</code></pre>"},{"location":"macos/macOS%20Big%20Sur%20%E6%97%A0%E6%B3%95%E4%BF%AE%E6%94%B9%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6/#_3","title":"\u6302\u8f7d\u7cfb\u7edf\u76d8","text":"<p>\u6253\u5f00\u78c1\u76d8\u7ba1\u7406\u5de5\u5177\uff0c\u67e5\u770b\u8bbe\u5907\u540d\u3002</p> <pre><code>mkdir ~/Desktop/macos\nsudo mount -o nobrowse -t apfs /dev/disk1s5 ~/Desktop/macos\n</code></pre>"},{"location":"macos/macOS%20Big%20Sur%20%E6%97%A0%E6%B3%95%E4%BF%AE%E6%94%B9%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6/#_4","title":"\u5220\u9664\u76ee\u6807\u6587\u4ef6","text":"<pre><code>sudo rm -rf ~/Desktop/macos/usr/bin/python3 ~/Desktop/macos/usr/bin/pip3\n</code></pre>"},{"location":"macos/macOS%20Big%20Sur%20%E6%97%A0%E6%B3%95%E4%BF%AE%E6%94%B9%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6/#_5","title":"\u91cd\u5efa\u7cfb\u7edf\u5feb\u7167","text":"<pre><code>sudo bless --folder ~/Desktop/macos/System/Library/CoreServices --bootefi --create-snapshot\nsudo reboot\n</code></pre>"},{"location":"macos/macOS%20Big%20Sur%20%E6%97%A0%E6%B3%95%E4%BF%AE%E6%94%B9%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6/#_6","title":"\u91cd\u65b0\u8f6f\u8fde\u63a5","text":"<pre><code>brew unlink python@3.9\nbrew link python@3.9\n</code></pre>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/","title":"MacOS \u81ea\u7528\u8f6f\u4ef6","text":""},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#_1","title":"\u5f00\u53d1\u5de5\u5177","text":""},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#iterm2","title":"iTerm2","text":"<p>iTerm2 \u662f Terminal \u7684\u66ff\u4ee3\u54c1\uff0c\u662f iTerm \u7684\u7ee7\u627f\u8005\u3002</p> <pre><code>brew install iterm2\n</code></pre> <p>https://iterm2.com</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#docker","title":"Docker","text":"<pre><code>brew install docker\n</code></pre> <p>https://www.docker.com/get-started</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#virtualbox","title":"Virtualbox","text":"<pre><code>brew install virtualbox virtualbox-extension-pack\n</code></pre> <p>https://www.virtualbox.org</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#vagrant","title":"Vagrant","text":"<pre><code>brew install vagrant vagrant-manager vagrant-vmware-utility\nbrew install vagrant-completion\n</code></pre> <p>https://www.vagrantup.com</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#visual-studio-code","title":"Visual Studio Code","text":"<pre><code>brew install visual-studio-code\n</code></pre> <p>https://code.visualstudio.com/</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#azure-data-studio","title":"Azure Data Studio","text":"<p>\u5fae\u8f6f\u5f00\u6e90\u7684\u6570\u636e\u5e93\u684c\u9762\u7ba1\u7406\u5de5\u5177\u3002\u8be5\u5de5\u5177\u652f\u6301 SQL Server\u3001Azure SQL DB \u548c SQL DW \u6570\u636e\u5e93\uff0cWindows \u4e0b\u7684\u5b89\u88c5\u5305\u4ec5\u4e0d\u5230 100 MB\uff0c\u8fd8\u652f\u6301\u53e6\u5916\u4e24\u5927\u64cd\u4f5c\u7cfb\u7edf macOS \u548c Linux\u3002</p> <pre><code>brew install azure-data-studio\n</code></pre> <p>https://github.com/microsoft/azuredatastudio</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#beekeeper-studio","title":"Beekeeper Studio","text":"<p>Beekeeper Studio \u662f\u4e00\u4e2a\u8de8\u5e73\u53f0\u7684 SQL \u7f16\u8f91\u5668\u548c\u6570\u636e\u5e93\u7ba1\u7406\u5668\uff0c\u53ef\u7528\u4e8e Linux\uff0cMac \u548c Windows\u3002\u9002\u7528\u4e8e MySQL\uff0cPostgres\uff0cSQLite\uff0cSQL Server \u7b49\u7684\u73b0\u4ee3\u4e14\u6613\u4e8e\u4f7f\u7528\u7684 SQL \u5ba2\u6237\u7aef\u3002</p> <pre><code>brew install beekeeper-studio\n</code></pre>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#dbeaver","title":"DBeaver","text":"<p>\u9002\u7528\u4e8e\u5f00\u53d1\u4eba\u5458\uff0c\u6570\u636e\u5e93\u7ba1\u7406\u5458\uff0c\u5206\u6790\u5e08\u548c\u6240\u6709\u9700\u8981\u4f7f\u7528\u6570\u636e\u5e93\u7684\u4eba\u5458\u7684\u514d\u8d39\u7684\u591a\u5e73\u53f0\u6570\u636e\u5e93\u5de5\u5177\u3002\u652f\u6301\u6240\u6709\u6d41\u884c\u7684\u6570\u636e\u5e93\u3002</p> <pre><code>brew install dbeaver-community\n</code></pre> <p>https://dbeaver.io/</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#act","title":"Act","text":"<p>\u8ba9\u4f60\u5728\u672c\u5730\u8c03\u8bd5 GitHub Actions \u811a\u672c\u3002GitHub Actions \u662f GitHub \u63d0\u4f9b\u7684\u4ed3\u5e93\u81ea\u52a8\u5de5\u4f5c\u6d41\u7a0b\u529f\u80fd\uff0c\u7528\u6237\u53ef\u4ee5\u5229\u7528 GitHub \u63d0\u4f9b\u7684\u514d\u8d39\u8ba1\u7b97\u673a\u8d44\u6e90\u8f7b\u677e\u5b9e\u73b0 CI/CD\uff0c\u8fd8\u53ef\u4ee5\u7528\u6765\u505a\u5f88\u591a\u6709\u610f\u601d\u7684\u4e8b\u60c5\u3002\u4f46\u662f\u5728\u7f16\u5199 actions \u811a\u672c\u65f6\uff0c\u60f3\u8c03\u8bd5\u811a\u672c\u6216\u5f97\u5230\u8fd0\u884c\u7ed3\u679c\uff0c\u53ea\u80fd push \u5230\u8fdc\u7a0b\u4ed3\u5e93\u7b49\u5f85\u8fd0\u884c\u7ed3\u675f\uff0c\u6ca1\u6709\u529e\u6cd5\u5728\u672c\u5730\u8c03\u8bd5\u548c\u67e5\u770b\u7ed3\u679c\u3002\u6709\u4e86 act \u8fd9\u4e2a\u9879\u76ee\uff0c\u5c31\u53ef\u4ee5\u5728\u672c\u5730\u8f7b\u677e\u8c03\u8bd5 actions \u5566\uff0c\u662f\u4e0d\u662f\u5f88\u68d2\u3002</p> <pre><code>brew install act\n</code></pre> <p>https://github.com/nektos/act</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#mysql-cli","title":"MySQL CLI","text":"<p>MyCLI \u662f MySQL\u3001MariaDB \u548c Percona \u7684\u547d\u4ee4\u884c\u754c\u9762\uff0c\u5177\u6709\u81ea\u52a8\u5b8c\u6210\u548c\u8bed\u6cd5\u9ad8\u4eae\u663e\u793a\u529f\u80fd\u3002</p> <pre><code>brew install mycli\n</code></pre> <p>https://www.mycli.net</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#postgres-cli","title":"Postgres CLI","text":"<p>Pgcli \u662f Postgres \u7684\u547d\u4ee4\u884c\u754c\u9762\uff0c\u5177\u6709\u81ea\u52a8\u5b8c\u6210\u548c\u8bed\u6cd5\u9ad8\u4eae\u663e\u793a\u529f\u80fd\u3002</p> <pre><code>brew install pgcli\n</code></pre> <p>https://www.pgcli.com</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#filezilla","title":"FileZilla","text":"<p>\u514d\u8d39\u7684 FTP \u89e3\u51b3\u65b9\u6848\u3002</p> <pre><code>brew install filezilla\n</code></pre> <p>https://filezilla-project.org</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#_2","title":"\u7cfb\u7edf\u8f85\u52a9","text":""},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#lulu","title":"Lulu","text":"<p>\u514d\u8d39\u5f00\u6e90\u7684 macOS \u9632\u706b\u5899\u8f6f\u4ef6\u3002</p> <pre><code>brew install lulu\n</code></pre> <p>https://github.com/objective-see/LuLu</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#maczip","title":"MacZip","text":"<p>\u514d\u8d39\u5f00\u6e90\u7684 macOS \u89e3\u538b\u7f29\u8f6f\u4ef6\u3002</p> <pre><code>brew install maczip\n</code></pre> <p>https://ezip.awehunt.com</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#snipaste","title":"Snipaste","text":"<p>Snipaste \u662f\u4e00\u4e2a\u7b80\u5355\u4f46\u5f3a\u5927\u7684\u622a\u56fe\u5de5\u5177\uff0c\u4e5f\u53ef\u4ee5\u8ba9\u4f60\u5c06\u622a\u56fe\u8d34\u56de\u5230\u5c4f\u5e55\u4e0a\uff01\u4e0b\u8f7d\u5e76\u6253\u5f00 Snipaste\uff0c\u6309\u4e0b F1 \u6765\u5f00\u59cb\u622a\u56fe\uff0c\u518d\u6309 F3\uff0c\u622a\u56fe\u5c31\u5728\u684c\u9762\u7f6e\u9876\u663e\u793a\u4e86\u3002\u5c31\u8fd9\u4e48\u7b80\u5355\uff01</p> <pre><code>brew install snipaste\n</code></pre> <p>https://snipaste.com</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#alt-tab","title":"alt-tab","text":"<p>Windows alt-tab on macOS\u3002</p> <pre><code>brew install alt-tab\n</code></pre> <p>https://github.com/lwouis/alt-tab-macos</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#rectangle","title":"Rectangle","text":"<p>\u4f7f\u7528\u952e\u76d8\u5feb\u6377\u952e\u548c\u6355\u6349\u533a\u57df\u5728 macOS \u4e0a\u79fb\u52a8\u548c\u8c03\u6574\u7a97\u53e3\u5927\u5c0f\u3002</p> <pre><code>brew install rectangle\n</code></pre> <p>https://rectangleapp.com/</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#eul","title":"eul","text":"<p>\u7528 SwiftUI \u7f16\u5199\u7684 macOS \u72b6\u6001\u76d1\u89c6\u5e94\u7528\u7a0b\u5e8f\u3002</p> <pre><code>brew install eul\n</code></pre> <p>https://github.com/gao-sun/eul</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#maccy","title":"Maccy","text":"<p>\u9002\u7528\u4e8e macOS \u7684\u526a\u8d34\u677f\u7ba1\u7406\u5668\uff0c\u53ea\u505a\u4e00\u9879\u5de5\u4f5c - \u968f\u65f6\u4fdd\u7559\u60a8\u7684\u590d\u5236\u5386\u53f2\u8bb0\u5f55\u3002</p> <pre><code>brew install maccy\n</code></pre> <p>https://maccy.app</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#quicklook-plugins","title":"QuickLook Plugins","text":"<p>QuickLook \u63d2\u4ef6\u3002</p> <pre><code>brew install qlcolorcode qlstephen qlmarkdown quicklook-json qlimagesize suspicious-package apparency quicklookase qlvideo quicklook-csv\nxattr -r ~/Library/QuickLook\nxattr -d -r com.apple.quarantine ~/Library/QuickLook\n</code></pre> <p>http://www.quicklookplugins.com/</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#_3","title":"\u9605\u8bfb\u5199\u4f5c","text":""},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#drawio","title":"Draw.io","text":"<p>draw.io \u662f\u4e00\u6b3e\u514d\u8d39\u7684\u5728\u7ebf\u56fe\u8868\u7f16\u8f91\u5de5\u5177, \u53ef\u4ee5\u7528\u6765\u7f16\u8f91\u5de5\u4f5c\u6d41, BPM, org charts, UML, ER\u56fe, \u7f51\u7edc\u62d3\u6734\u56fe\u7b49.</p> <pre><code>brew install drawio\n</code></pre> <p>https://www.diagrams.net</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#bob","title":"Bob","text":"<p>Bob \u662f\u4e00\u6b3e Mac \u7aef\u7ffb\u8bd1\u8f6f\u4ef6\uff0c\u652f\u6301\u5212\u8bcd\u7ffb\u8bd1\u3001\u622a\u56fe\u7ffb\u8bd1\u4ee5\u53ca\u624b\u52a8\u8f93\u5165\u7ffb\u8bd1\u3002</p> <pre><code>brew install bob\n</code></pre> <p>https://ripperhe.gitee.io/bob</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#typora","title":"Typora","text":"<pre><code>brew install typora\n</code></pre> <p>https://www.typora.io/#download</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#_4","title":"\u79d1\u5b66\u4e0a\u7f51","text":""},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#clashx-pro","title":"clashx-pro","text":"<pre><code>brew install clash-pro\n</code></pre> <p>https://github.com/Semporia/ClashX-Pro</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#openvpn-connet","title":"OpenVPN Connet","text":"<pre><code>brew install openvpn-connect\n</code></pre>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#_5","title":"\u97f3\u4e50\u89c6\u9891","text":""},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#listen1","title":"Listen1","text":"<p>Listen1 \u53ef\u4ee5\u641c\u7d22\u548c\u64ad\u653e\u6765\u81ea\u7f51\u6613\u4e91\u97f3\u4e50\uff0c\u867e\u7c73\uff0cQQ\u97f3\u4e50\uff0c\u9177\u72d7\u97f3\u4e50\uff0c\u9177\u6211\u97f3\u4e50\uff0cBilibili\uff0c\u54aa\u5495\u97f3\u4e50\u7f51\u7ad9\u7684\u6b4c\u66f2\uff0c\u8ba9\u4f60\u7684\u66f2\u5e93\u66f4\u5168\u9762\u3002</p> <pre><code>brew install listen1\n</code></pre> <p>https://listen1.github.io/listen1</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#iina","title":"IINA","text":"<p>\u4e00\u4e2a\u73b0\u4ee3\u7684\u00a0macOS \u5a92\u4f53\u64ad\u653e\u5668\u3002</p> <pre><code>brew install iina\n</code></pre> <p>https://iina.io</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#handbrake","title":"HandBrake","text":"<p>HandBrake \u662f\u4e00\u6b3e\u514d\u8d39\u5f00\u6e90\u7684\u4e07\u80fd\u683c\u5f0f\u8f6c\u6362\u5de5\u5177\uff0c\u8fd9\u6b3e\u8f6f\u4ef6\u80fd\u591f\u652f\u6301\u76ee\u524d\u5e02\u9762\u4e0a\u6240\u6709\u7684\u89c6\u9891\u683c\u5f0f\u6587\u4ef6\u3002</p> <pre><code>brew install handbrake\n</code></pre> <p>https://handbrake.fr</p>"},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#_6","title":"\u9ed1\u82f9\u679c","text":""},{"location":"macos/macos%20%E8%87%AA%E7%94%A8%E8%BD%AF%E4%BB%B6/#opencore-configuration","title":"OpenCore Configuration","text":"<p>OpenCore Configurator \u901a\u8fc7\u7b80\u5316\u7684\u56fe\u5f62\u754c\u9762\u4e3a OpenCore EFI \u5f15\u5bfc\u52a0\u8f7d\u7a0b\u5e8f\u521b\u5efa\u81ea\u5b9a\u4e49\u914d\u7f6e\u6587\u4ef6\u3002</p> <pre><code>brew install opencore-configurator\n</code></pre> <p>http://mackie100projects.altervista.org</p>"},{"location":"macos/%E5%A4%84%E7%90%86%E7%83%A6%E4%BA%BA%E7%9A%84%20.DS_Store%20%E6%96%87%E4%BB%B6/","title":"\u5904\u7406\u70e6\u4eba\u7684 .DS_Store \u6587\u4ef6","text":""},{"location":"macos/%E5%A4%84%E7%90%86%E7%83%A6%E4%BA%BA%E7%9A%84%20.DS_Store%20%E6%96%87%E4%BB%B6/#ds_store_1","title":"DS_Store \u7684\u4f5c\u7528","text":"<p>DS_Store \u662f\u7528\u6765\u5b58\u50a8\u8fd9\u4e2a\u6587\u4ef6\u5939\u7684\u663e\u793a\u5c5e\u6027\u7684\uff1a\u6bd4\u5982\u6587\u4ef6\u56fe\u6807\u7684\u6446\u653e\u4f4d\u7f6e\u3002\u5220\u9664\u4ee5\u540e\u7684\u526f\u4f5c\u7528\u5c31\u662f\u8fd9\u4e9b\u4fe1\u606f\u7684\u5931\u53bb\u3002\uff08\u5f53\u7136\uff0c\u8fd9\u70b9\u526f\u4f5c\u7528\u5176\u5b9e\u4e0d\u662f\u592a\u5927\uff09</p>"},{"location":"macos/%E5%A4%84%E7%90%86%E7%83%A6%E4%BA%BA%E7%9A%84%20.DS_Store%20%E6%96%87%E4%BB%B6/#_1","title":"\u4ece\u6307\u5b9a\u76ee\u5f55\u4e0b\u6700\u6df1\u5c42\u7684\u5b50\u76ee\u5f55\u5f00\u59cb\u67e5\u627e\u5e76\u5220\u9664","text":"<pre><code>sudo find / -name \".DS_Store\" -type f -depth -delete\n</code></pre>"},{"location":"macos/%E5%A4%84%E7%90%86%E7%83%A6%E4%BA%BA%E7%9A%84%20.DS_Store%20%E6%96%87%E4%BB%B6/#ds_store_2","title":"\u5173\u95ed DS_Store \u751f\u6210","text":"<pre><code>sudo defaults write com.apple.desktopservices DSDontWriteNetworkStores true\n</code></pre>"},{"location":"macos/%E5%A4%84%E7%90%86%E7%83%A6%E4%BA%BA%E7%9A%84%20.DS_Store%20%E6%96%87%E4%BB%B6/#ds_store_3","title":"\u5220\u9664\u5df2\u7ecf\u751f\u6210\u7684 .DS_Store \u6587\u4ef6","text":"<pre><code>sudo find / -name \".DS_Store\" -type f -delete\n</code></pre>"},{"location":"monitor/promethues/prom-systemd/","title":"PromSQL \u83b7\u53d6\u7cfb\u7edf\u670d\u52a1\u8fd0\u884c\u72b6\u6001","text":""},{"location":"monitor/promethues/prom-systemd/#systemd","title":"\u4f7f\u7528 systemd \u6536\u96c6\u5668","text":"<pre><code>--collector.systemd.unit-whitelist=\".+\"\n# \u4ecesystemd\u4e2d\u5faa\u73af\u6b63\u5219\u5339\u914d\u5355\u5143\n--collector.systemd.unit-whitelist=\"(docker|sshd|nginx).service\"\n# \u767d\u540d\u5355\uff0c\u6536\u96c6\u76ee\u6807\n</code></pre> <p>https://www.cnblogs.com/xiangsikai/p/11289276.htmlss</p>"},{"location":"monitor/promethues/promsql/","title":"PromSQL \u4f7f\u7528","text":""},{"location":"monitor/promethues/promsql/#_1","title":"\u8fd0\u7b97","text":"<ul> <li>\u4e58\uff1a*</li> <li>\u9664\uff1a/</li> <li>\u52a0\uff1a+</li> <li>\u51cf\uff1a-</li> </ul>"},{"location":"monitor/promethues/promsql/#_2","title":"\u51fd\u6570","text":"<ul> <li>sum() \u51fd\u6570\uff1a\u6c42\u51fa\u627e\u5230\u6240\u6709value\u7684\u503c</li> <li>irate() \u51fd\u6570\uff1a\u7edf\u8ba1\u5e73\u5747\u901f\u7387</li> <li>by\uff1a\u6807\u7b7e\u540d</li> </ul>"},{"location":"monitor/promethues/promsql/#_3","title":"\u8303\u56f4\u5339\u914d","text":"<ul> <li>[5m]\uff1a5 \u5206\u949f\u4e4b\u5185</li> </ul>"},{"location":"monitor/promethues/promsql/#_4","title":"\u5176\u5b83\u7528\u6cd5","text":"<ul> <li>\u88ab\u76d1\u63a7\u6307\u6807\u7684\u72b6\u6001\u30011\u4e3a\u6b63\u5e38\u30010\u4e3a\u4e0d\u6b63\u5e38\u3002</li> </ul>"},{"location":"monitor/promethues/promsql/#_5","title":"\u6848\u4f8b","text":"<pre><code>100 - (avg(irate(node_cpu_seconds_total{mode=\"idle\"}[5m])) by (instance) * 100)\n# 5\u5206\u949f\u5185 CPU \u4f7f\u7528\u7387\n\n100 - (node_memory_MemFree_bytes+node_memory_Cached_bytes+node_memory_Buffers_bytes) / node_memory_MemTotal_bytes * 100\n# \u5185\u5b58\u4f7f\u7528\u7387\n\n100 - (node_filesystem_free_bytes{mountpoint=\"/\",fstype=~\"ext4|xfs\"} / node_filesystem_size_bytes{mountpoint=\"/\",fstype=~\"ext4|xfs\"} * 100)\n# \u78c1\u76d8\u4f7f\u7528\u7387\n</code></pre>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/","title":"Linux\u64cd\u4f5c\u7cfb\u7edf\u52a0\u56fa","text":"<p>\u672c\u5e2e\u52a9\u624b\u518c\u65e8\u5728\u6307\u5bfc\u7cfb\u7edf\u7ba1\u7406\u4eba\u5458\u6216\u5b89\u5168\u68c0\u67e5\u4eba\u5458\u8fdb\u884c Linux \u64cd\u4f5c\u7cfb\u7edf\u7684\u5b89\u5168\u5408\u89c4\u6027\u68c0\u67e5\u548c\u52a0\u56fa\u3002</p>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#_1","title":"\u8d26\u53f7\u548c\u53e3\u4ee4","text":""},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#_2","title":"\u7981\u7528\u6216\u5220\u9664\u65e0\u7528\u8d26\u53f7","text":"<p>\u51cf\u5c11\u7cfb\u7edf\u65e0\u7528\u8d26\u53f7\uff0c\u964d\u4f4e\u5b89\u5168\u98ce\u9669\u3002</p> <pre><code># \u5220\u9664\u4e0d\u5fc5\u8981\u7684\u8d26\u53f7\u3002\nuserdel &lt;\u7528\u6237\u540d&gt;\n\n# \u9501\u5b9a\u4e0d\u5fc5\u8981\u7684\u8d26\u53f7\u3002\npasswd -l &lt;\u7528\u6237\u540d&gt;\n\n# \u89e3\u9501\u5fc5\u8981\u7684\u8d26\u53f7\u3002\npasswd -u &lt;\u7528\u6237\u540d&gt;\n</code></pre>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#_3","title":"\u68c0\u67e5\u7279\u6b8a\u8d26\u53f7","text":"<p>\u67e5\u770b\u7a7a\u53e3\u4ee4\u548c root \u6743\u9650\u8d26\u53f7\uff0c\u786e\u8ba4\u662f\u5426\u5b58\u5728\u5f02\u5e38\u8d26\u53f7\uff1a</p> <pre><code># \u67e5\u770b\u7a7a\u53e3\u4ee4\u8d26\u53f7\u3002\nawk -F: '($2==\"\")' /etc/shadow\n\n# \u67e5\u770bUID\u4e3a\u96f6\u7684\u8d26\u53f7\u3002\nawk -F: '($3==0)' /etc/passwd\n</code></pre> <p>\u52a0\u56fa\u7a7a\u53e3\u4ee4\u8d26\u53f7\uff1a</p> <pre><code># \u4e3a\u7a7a\u53e3\u4ee4\u8d26\u53f7\u8bbe\u5b9a\u5bc6\u7801\u3002\npasswd &lt;\u7528\u6237\u540d&gt;\n</code></pre> <p>\u786e\u8ba4 UID \u4e3a\u96f6\u7684\u8d26\u53f7\u53ea\u6709 root \u8d26\u53f7\u3002</p>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#_4","title":"\u6dfb\u52a0\u53e3\u4ee4\u7b56\u7565","text":"<p>\u52a0\u5f3a\u53e3\u4ee4\u7684\u590d\u6742\u5ea6\u7b49\uff0c\u964d\u4f4e\u88ab\u731c\u89e3\u7684\u53ef\u80fd\u6027\u3002</p> <pre><code>#\u65b0\u5efa\u7528\u6237\u7684\u5bc6\u7801\u6700\u957f\u4f7f\u7528\u5929\u6570\nsed -i '/^PASS_MAX_DAYS/d' /etc/login.defs\necho 'PASS_MAX_DAYS 90' &gt;&gt; /etc/login.defs\n\n#\u65b0\u5efa\u7528\u6237\u7684\u5bc6\u7801\u6700\u77ed\u4f7f\u7528\u5929\u6570\nsed -i '/^PASS_MIN_DAYS/d' /etc/login.defs\necho 'PASS_MIN_DAYS 0' &gt;&gt; /etc/login.defs\n\n#\u65b0\u5efa\u7528\u6237\u7684\u5bc6\u7801\u5230\u671f\u63d0\u524d\u63d0\u9192\u5929\u6570\nsed -i '/^PASS_WARN_AGE/d' /etc/login.defs\necho 'PASS_WARN_AGE 7' &gt;&gt; /etc/login.defs\n</code></pre> <p>\u4f7f\u7528 chage \u547d\u4ee4\u4fee\u6539\u7528\u6237\u8bbe\u7f6e\u3002</p> <p>\u4f8b\u5982\uff0c\u5c06\u7528\u6237\u7684\u5bc6\u7801\u6700\u957f\u4f7f\u7528\u5929\u6570\u8bbe\u4e3a 30\uff0c\u6700\u77ed\u4f7f\u7528\u5929\u6570\u8bbe\u4e3a 0\uff0c\u5bc6\u7801 2000 \u5e74 1 \u6708 1 \u65e5\u8fc7\u671f\uff0c\u8fc7\u671f\u524d\u4e03\u5929\u8b66\u544a\u7528\u6237\u3002</p> <pre><code>chage -m 0 -M 30 -E 2000-01-01 -W 7 &lt;\u7528\u6237\u540d&gt;\n</code></pre> <p>\u8bbe\u7f6e\u8fde\u7eed\u8f93\u9519\u4e09\u6b21\u5bc6\u7801\uff0c\u8d26\u53f7\u9501\u5b9a\u4e94\u5206\u949f\u3002\u4f7f\u7528\u547d\u4ee4 <code>vi /etc/pam.d/common-auth</code> \u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff0c\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0\u3002</p> <pre><code>sed -i '/pam_tally.so/d' /etc/pam.d/common-auth\necho 'auth required pam_tally.so onerr=fail deny=3 unlock_time=300' &gt;&gt; /etc/pam.d/common-auth\n</code></pre>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#su-root","title":"\u9650\u5236\u80fd su \u5230 root \u7684\u7528\u6237","text":"<p>\u4f8b\u5982\uff0c\u53ea\u5141\u8bb8 test \u7ec4\u7528\u6237 su \u5230 root.</p> <pre><code>echo 'auth required pam_wheel.so group=test' &gt;&gt; vi /etc/pam.d/su\n</code></pre>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#root","title":"\u7981\u6b62 root \u7528\u6237\u76f4\u63a5\u767b\u5f55","text":"<p>\u521b\u5efa\u666e\u901a\u6743\u9650\u8d26\u53f7\uff0c\u914d\u7f6e\u5bc6\u7801\uff0c\u5e76\u5141\u8bb8 su \u5230 root \u7528\u6237\uff0c\u9632\u6b62\u65e0\u6cd5\u8fdc\u7a0b\u767b\u5f55\uff1b</p> <pre><code>if [[ $(grep PermitRootLogin /etc/ssh/sshd_config|wc -l ) &gt; 0 ]];then\n    sed -i '/^PermitRootLogin/ s|yes|no|g' /etc/ssh/sshd_config\nelse\n    sed -i '1/i\\PermitRootLogin no' /etc/ssh/sshd_config\nfi\n\nservice sshd restart\n</code></pre>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#_5","title":"\u670d\u52a1","text":""},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#_6","title":"\u5173\u95ed\u4e0d\u5fc5\u8981\u7684\u670d\u52a1","text":"<p>\u5173\u95ed\u4e0d\u5fc5\u8981\u7684\u670d\u52a1\uff08\u5982\u666e\u901a\u670d\u52a1\u548cxinetd\u670d\u52a1\uff09\uff0c\u964d\u4f4e\u98ce\u9669\u3002</p> <p>\u8bbe\u7f6e\u670d\u52a1\u5728\u5f00\u673a\u65f6\u4e0d\u81ea\u52a8\u542f\u52a8\u3002</p> <pre><code>systemctl disable &lt;\u670d\u52a1\u540d&gt;\n</code></pre> <p>\u8bf4\u660e\uff1a \u5bf9\u4e8e\u90e8\u5206\u8001\u7248\u672c\u7684 Linux \u64cd\u4f5c\u7cfb\u7edf\uff08\u5982CentOS 6\uff09\uff0c\u53ef\u4ee5\u4f7f\u7528\u547d\u4ee4 <code>chkconfig --level &lt;init\u7ea7\u522b&gt; &lt;\u670d\u52a1\u540d&gt; off</code> \u8bbe\u7f6e\u670d\u52a1\u5728\u6307\u5b9ainit\u7ea7\u522b\u4e0b\u5f00\u673a\u65f6\u4e0d\u81ea\u52a8\u542f\u52a8\u3002</p>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#ssh","title":"SSH\u670d\u52a1\u5b89\u5168","text":"<p>\u5bf9SSH\u670d\u52a1\u8fdb\u884c\u5b89\u5168\u52a0\u56fa\uff0c\u9632\u6b62\u66b4\u529b\u7834\u89e3\u6210\u529f\u3002</p> <pre><code># \u4e0d\u5141\u8bb8 root \u8d26\u53f7\u76f4\u63a5\u767b\u5f55\u7cfb\u7edf\u3002\nif [[ $(grep PermitRootLogin /etc/ssh/sshd_config|wc -l ) &gt; 0 ]];then\n    sed -i '/^PermitRootLogin/ s|yes|no|g' /etc/ssh/sshd_config\nelse\n    sed -i '1/i\\PermitRootLogin no' /etc/ssh/sshd_config\nfi\n# \u4fee\u6539SSH\u4f7f\u7528\u7684\u534f\u8bae\u7248\u672c\u3002\nif [[ $(grep Protocol /etc/ssh/sshd_config|wc -l ) &gt; 0 ]];then\n    sed -i 's|^Protocol.*|Protocol 2|g' /etc/ssh/sshd_config\nelse\n    sed -i '2/i\\Protocol 2' /etc/ssh/sshd_config\nfi\n# \u4fee\u6539\u5141\u8bb8\u5bc6\u7801\u9519\u8bef\u6b21\u6570\uff08\u9ed8\u8ba46\u6b21\uff09\u3002\nif [[ $(grep MaxAuthTries /etc/ssh/sshd_config|wc -l ) &gt; 0 ]];then\n    sed -i '/^MaxAuthTries/ s|[0-9]\\+|3|g' /etc/ssh/sshd_config\nelse\n    sed -i '3/i\\MaxAuthTries 3' /etc/ssh/sshd_config\nfi\n\nservice sshd restart\n</code></pre>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#_7","title":"\u6587\u4ef6\u7cfb\u7edf","text":""},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#umask","title":"\u8bbe\u7f6eumask\u503c","text":"<p>\u8bbe\u7f6e\u9ed8\u8ba4\u7684 umask \u503c\uff0c\u589e\u5f3a\u5b89\u5168\u6027\u3002\u65b0\u521b\u5efa\u7684\u6587\u4ef6\u5c5e\u4e3b\u62e5\u6709\u8bfb\u5199\u6267\u884c\u6743\u9650\uff0c\u540c\u7ec4\u7528\u6237\u62e5\u6709\u8bfb\u548c\u6267\u884c\u6743\u9650\uff0c\u5176\u4ed6\u7528\u6237\u65e0\u6743\u9650\u3002</p> <pre><code>echo 'umask 027' &gt;&gt; /etc/profile\n</code></pre>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#_8","title":"\u8bbe\u7f6e\u767b\u5f55\u8d85\u65f6","text":"<p>\u8bbe\u7f6e\u7cfb\u7edf\u767b\u5f55\u540e\uff0c\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\uff0c\u589e\u5f3a\u5b89\u5168\u6027\u3002</p> <p>\u8bbe\u7f6e\u4e3aTMOUT=180\uff0c\u5373\u8d85\u65f6\u65f6\u95f4\u4e3a\u4e09\u5206\u949f\u3002</p> <pre><code>sed -i '/^TMOUT/d /etc/profile\necho 'TMOUT=180' &gt;&gt; /etc/profile\n</code></pre>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#_9","title":"\u65e5\u5fd7","text":""},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#syslogd","title":"syslogd \u65e5\u5fd7","text":"<p>\u542f\u7528\u65e5\u5fd7\u529f\u80fd\uff0c\u5e76\u914d\u7f6e\u65e5\u5fd7\u8bb0\u5f55\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>Linux \u7cfb\u7edf\u9ed8\u8ba4\u542f\u7528\u4ee5\u4e0b\u7c7b\u578b\u65e5\u5fd7\uff1a</p> <ul> <li>\u7cfb\u7edf\u65e5\u5fd7\uff1a/var/log/messages</li> <li>\u5b9a\u65f6\u65e5\u5fd7\uff1a/var/log/cron</li> <li>\u5b89\u5168\u65e5\u5fd7\uff1a/var/log/secure</li> </ul> <p>\u6ce8\u610f\uff1a\u90e8\u5206\u7cfb\u7edf\u53ef\u80fd\u4f7f\u7528 syslog-ng \u65e5\u5fd7\uff0c\u914d\u7f6e\u6587\u4ef6\u4e3a\uff1a/etc/syslog-ng/syslog-ng.conf\u3002</p> <p>\u53ef\u4ee5\u6839\u636e\u9700\u6c42\u914d\u7f6e\u8be6\u7ec6\u65e5\u5fd7\u3002</p>"},{"location":"security/Linux%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA/#_10","title":"\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u548c\u64cd\u4f5c\u65e5\u5fd7","text":"<p>\u901a\u8fc7\u811a\u672c\u4ee3\u7801\u5b9e\u73b0\u8bb0\u5f55\u6240\u6709\u7528\u6237\u7684\u767b\u5f55\u64cd\u4f5c\u65e5\u5fd7\uff0c\u9632\u6b62\u51fa\u73b0\u5b89\u5168\u4e8b\u4ef6\u540e\u65e0\u636e\u53ef\u67e5\u3002</p> <pre><code>cat &gt; /etc/profile &lt;&lt;-'EOF'\nhistory\nUSER=`whoami`\nUSER_IP=`who -u am i 2&gt;/dev/null| awk '{print $NF}'|sed -e 's/[()]//g'`\nif [ \"$USER_IP\" = \"\" ]; then\nUSER_IP=`hostname`\nfi\nif [ ! -d /var/log/history ]; then\nmkdir /var/log/history\nchmod 777 /var/log/history\nfi\nif [ ! -d /var/log/history/${LOGNAME} ]; then\nmkdir /var/log/history/${LOGNAME}\nchmod 300 /var/log/history/${LOGNAME}\nfi\nexport HISTSIZE=4096\nDT=`date +\"%Y%m%d_%H:%M:%S\"`\nexport HISTFILE=\"/var/log/history/${LOGNAME}/${USER}@${USER_IP}_$DT\"\nchmod 600 /var/log/history/${LOGNAME}/*history* 2&gt;/dev/null\nEOF\n</code></pre> <p>\u8fd0\u884c <code>source /etc/profile</code> \u52a0\u8f7d\u914d\u7f6e\u751f\u6548\u3002</p> <p>\u6ce8\u610f\uff1a /var/log/history \u662f\u8bb0\u5f55\u65e5\u5fd7\u7684\u5b58\u653e\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49\u3002</p> <p>\u901a\u8fc7\u4e0a\u8ff0\u6b65\u9aa4\uff0c\u53ef\u4ee5\u5728 /var/log/history \u76ee\u5f55\u4e0b\u4ee5\u6bcf\u4e2a\u7528\u6237\u4e3a\u540d\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939\uff0c\u6bcf\u6b21\u7528\u6237\u9000\u51fa\u540e\u90fd\u4f1a\u4ea7\u751f\u4ee5\u7528\u6237\u540d\u3001\u767b\u5f55IP\u3001\u65f6\u95f4\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u5305\u542b\u6b64\u7528\u6237\u672c\u6b21\u7684\u6240\u6709\u64cd\u4f5c\uff08root\u7528\u6237\u9664\u5916\uff09\u3002</p>"},{"location":"security/Windows%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/","title":"Windows \u64cd\u4f5c\u7cfb\u7edf\u5b89\u5168\u52a0\u56fa","text":"<p>\u672c\u6587\u6863\u65e8\u5728\u6307\u5bfc\u7cfb\u7edf\u7ba1\u7406\u4eba\u5458\u6216\u5b89\u5168\u68c0\u67e5\u4eba\u5458\u8fdb\u884c Windows \u64cd\u4f5c\u7cfb\u7edf\u7684\u5b89\u5168\u5408\u89c4\u6027\u68c0\u67e5\u548c\u914d\u7f6e\u3002</p>"},{"location":"security/Windows%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/#1","title":"1. \u8d26\u6237\u7ba1\u7406\u548c\u8ba4\u8bc1\u6388\u6743","text":""},{"location":"security/Windows%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/#11","title":"1.1 \u8d26\u6237","text":"<p>\u9ed8\u8ba4\u8d26\u6237\u5b89\u5168</p> <p>\u7981\u7528Guest\u8d26\u6237\u3002</p> <p>\u7981\u7528\u6216\u5220\u9664\u5176\u4ed6\u65e0\u7528\u8d26\u6237\uff08\u5efa\u8bae\u5148\u7981\u7528\u8d26\u6237\u4e09\u4e2a\u6708\uff0c\u5f85\u786e\u8ba4\u6ca1\u6709\u95ee\u9898\u540e\u5220\u9664\u3002\uff09</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u8ba1\u7b97\u673a\u7ba1\u7406\uff0c\u5728 \u7cfb\u7edf\u5de5\u5177 &gt; \u672c\u5730\u7528\u6237\u548c\u7ec4 &gt; \u7528\u6237 \u4e2d\uff0c\u53cc\u51fb Guest \u5e10\u6237\uff0c\u5728\u5c5e\u6027\u4e2d\u9009\u4e2d \u5e10\u6237\u5df2\u7981\u7528\uff0c\u5355\u51fb \u786e\u5b9a\u3002</p> <p>\u6309\u7167\u7528\u6237\u5206\u914d\u5e10\u6237</p> <p>\u6309\u7167\u7528\u6237\u5206\u914d\u5e10\u6237\u3002\u6839\u636e\u4e1a\u52a1\u8981\u6c42\uff0c\u8bbe\u5b9a\u4e0d\u540c\u7684\u7528\u6237\u548c\u7528\u6237\u7ec4\u3002\u4f8b\u5982\uff0c\u7ba1\u7406\u5458\u7528\u6237\uff0c\u6570\u636e\u5e93\u7528\u6237\uff0c\u5ba1\u8ba1\u7528\u6237\uff0c\u6765\u5bbe\u7528\u6237\u7b49\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u8ba1\u7b97\u673a\u7ba1\u7406\uff0c\u5728 \u7cfb\u7edf\u5de5\u5177 &gt; \u672c\u5730\u7528\u6237\u548c\u7ec4 \u4e2d\uff0c\u6839\u636e\u60a8\u7684\u4e1a\u52a1\u8981\u6c42\u8bbe\u5b9a\u4e0d\u540c\u7684\u7528\u6237\u548c\u7528\u6237\u7ec4\uff0c\u5305\u62ec\u7ba1\u7406\u5458\u7528\u6237\u3001\u6570\u636e\u5e93\u7528\u6237\u3001\u5ba1\u8ba1\u7528\u6237\u3001\u6765\u5bbe\u7528\u6237\u7b49\u3002</p> <p>\u5b9a\u671f\u68c0\u67e5\u5e76\u5220\u9664\u4e0e\u65e0\u5173\u5e10\u6237</p> <p>\u5b9a\u671f\u5220\u9664\u6216\u9501\u5b9a\u4e0e\u8bbe\u5907\u8fd0\u884c\u3001\u7ef4\u62a4\u7b49\u4e0e\u5de5\u4f5c\u65e0\u5173\u7684\u5e10\u6237\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u8ba1\u7b97\u673a\u7ba1\u7406\uff0c\u5728 \u7cfb\u7edf\u5de5\u5177 &gt; \u672c\u5730\u7528\u6237\u548c\u7ec4 \u4e2d\uff0c\u5220\u9664\u6216\u9501\u5b9a\u4e0e\u8bbe\u5907\u8fd0\u884c\u3001\u7ef4\u62a4\u7b49\u4e0e\u5de5\u4f5c\u65e0\u5173\u7684\u5e10\u6237\u3002</p> <p>\u4e0d\u663e\u793a\u6700\u540e\u7684\u7528\u6237\u540d</p> <p>\u914d\u7f6e\u767b\u5f55\u767b\u51fa\u540e\uff0c\u4e0d\u663e\u793a\u7528\u6237\u540d\u79f0\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4\uff1a</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5b89\u5168\u9009\u9879 \u4e2d\uff0c\u53cc\u51fb \u4ea4\u4e92\u5f0f\u767b\u5f55\uff1a\u4e0d\u663e\u793a\u6700\u540e\u7684\u7528\u6237\u540d\uff0c\u9009\u62e9 \u5df2\u542f\u7528 \u5e76\u5355\u51fb \u786e\u5b9a\u3002</p> <p></p>"},{"location":"security/Windows%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/#12","title":"1.2 \u53e3\u4ee4","text":"<p>\u5bc6\u7801\u590d\u6742\u5ea6</p> <p>\u5bc6\u7801\u590d\u6742\u5ea6\u8981\u6c42\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u7b56\u7565\uff1a</p> <ul> <li>\u6700\u77ed\u5bc6\u7801\u957f\u5ea6\u8981\u6c42\u516b\u4e2a\u5b57\u7b26\u3002</li> <li>\u542f\u7528\u672c\u673a\u7ec4\u7b56\u7565\u4e2d\u5bc6\u7801\u5fc5\u987b\u7b26\u5408\u590d\u6742\u6027\u8981\u6c42\u7684\u7b56\u7565\u3002\u5373\u5bc6\u7801\u81f3\u5c11\u5305\u542b\u4ee5\u4e0b\u56db\u79cd\u7c7b\u522b\u7684\u5b57\u7b26\u4e2d\u7684\u4e24\u79cd\uff1a</li> <li>\u82f1\u8bed\u5927\u5199\u5b57\u6bcd A, B, C, \u2026 Z</li> <li>\u82f1\u8bed\u5c0f\u5199\u5b57\u6bcd a, b, c, \u2026 z</li> <li>\u897f\u65b9\u963f\u62c9\u4f2f\u6570\u5b57 0, 1, 2, \u2026 9</li> <li>\u975e\u5b57\u6bcd\u6570\u5b57\u5b57\u7b26\uff0c\u5982\u6807\u70b9\u7b26\u53f7\uff0c@, #, $, %, &amp;, *\u7b49</li> </ul> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u5e10\u6237\u7b56\u7565 &gt; \u5bc6\u7801\u7b56\u7565 \u4e2d\uff0c\u786e\u8ba4 \u5bc6\u7801\u5fc5\u987b\u7b26\u5408\u590d\u6742\u6027\u8981\u6c42 \u7b56\u7565\u5df2\u542f\u7528\u3002</p>"},{"location":"security/Windows%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/#_1","title":"\u5bc6\u7801\u6700\u957f\u7559\u5b58\u671f","text":"<p>\u5bf9\u4e8e\u91c7\u7528\u9759\u6001\u53e3\u4ee4\u8ba4\u8bc1\u6280\u672f\u7684\u8bbe\u5907\uff0c\u5e10\u6237\u53e3\u4ee4\u7684\u7559\u5b58\u671f\u4e0d\u5e94\u957f\u4e8e90\u5929\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u5e10\u6237\u7b56\u7565 &gt; \u5bc6\u7801\u7b56\u7565 \u4e2d\uff0c\u914d\u7f6e \u5bc6\u7801\u6700\u957f\u4f7f\u7528\u671f\u9650 \u4e0d\u5927\u4e8e90\u5929\u3002pwd</p> <p>\u5e10\u6237\u9501\u5b9a\u7b56\u7565 \u5bf9\u4e8e\u91c7\u7528\u9759\u6001\u53e3\u4ee4\u8ba4\u8bc1\u6280\u672f\u7684\u8bbe\u5907\uff0c\u5e94\u914d\u7f6e\u5f53\u7528\u6237\u8fde\u7eed\u8ba4\u8bc1\u5931\u8d25\u6b21\u6570\u8d85\u8fc710\u6b21\u540e\uff0c\u9501\u5b9a\u8be5\u7528\u6237\u4f7f\u7528\u7684\u5e10\u6237\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u5e10\u6237\u7b56\u7565 &gt; \u5e10\u6237\u9501\u5b9a\u7b56\u7565 \u4e2d\uff0c\u914d\u7f6e \u5e10\u6237\u9501\u5b9a\u9608\u503c \u4e0d\u5927\u4e8e10\u6b21\u3002</p> <p>\u914d\u7f6e\u6837\u4f8b\uff1a</p> <p>con</p> <p>1.3 \u6388\u6743 \u8fdc\u7a0b\u5173\u673a \u5728\u672c\u5730\u5b89\u5168\u8bbe\u7f6e\u4e2d\uff0c\u4ece\u8fdc\u7aef\u7cfb\u7edf\u5f3a\u5236\u5173\u673a\u6743\u9650\u53ea\u5206\u914d\u7ed9Administrators\u7ec4\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u7528\u6237\u6743\u9650\u5206\u914d \u4e2d\uff0c\u914d\u7f6e \u4ece\u8fdc\u7aef\u7cfb\u7edf\u5f3a\u5236\u5173\u673a \u6743\u9650\u53ea\u5206\u914d\u7ed9Administrators\u7ec4\u3002</p> <p>\u672c\u5730\u5173\u673a \u5728\u672c\u5730\u5b89\u5168\u8bbe\u7f6e\u4e2d\u5173\u95ed\u7cfb\u7edf\u6743\u9650\u53ea\u5206\u914d\u7ed9Administrators\u7ec4\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u7528\u6237\u6743\u9650\u5206\u914d \u4e2d\uff0c\u914d\u7f6e \u5173\u95ed\u7cfb\u7edf \u6743\u9650\u53ea\u5206\u914d\u7ed9Administrators\u7ec4\u3002</p> <p>\u7528\u6237\u6743\u9650\u6307\u6d3e \u5728\u672c\u5730\u5b89\u5168\u8bbe\u7f6e\u4e2d\uff0c\u53d6\u5f97\u6587\u4ef6\u6216\u5176\u5b83\u5bf9\u8c61\u7684\u6240\u6709\u6743\u6743\u9650\u53ea\u5206\u914d\u7ed9Administrators\u7ec4\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u7528\u6237\u6743\u9650\u5206\u914d \u4e2d\uff0c\u914d\u7f6e \u53d6\u5f97\u6587\u4ef6\u6216\u5176\u5b83\u5bf9\u8c61\u7684\u6240\u6709\u6743 \u6743\u9650\u53ea\u5206\u914d\u7ed9Administrators\u7ec4\u3002</p> <p>\u6388\u6743\u5e10\u6237\u767b\u5f55 \u5728\u672c\u5730\u5b89\u5168\u8bbe\u7f6e\u4e2d\uff0c\u914d\u7f6e\u6307\u5b9a\u6388\u6743\u7528\u6237\u5141\u8bb8\u672c\u5730\u767b\u5f55\u6b64\u8ba1\u7b97\u673a\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u7528\u6237\u6743\u9650\u5206\u914d \u4e2d\uff0c\u914d\u7f6e \u5141\u8bb8\u672c\u5730\u767b\u5f55 \u6743\u9650\u7ed9\u6307\u5b9a\u6388\u6743\u7528\u6237\u3002</p> <p>\u6388\u6743\u5e10\u6237\u4ece\u7f51\u7edc\u8bbf\u95ee \u5728\u672c\u5730\u5b89\u5168\u8bbe\u7f6e\u4e2d\uff0c\u53ea\u5141\u8bb8\u6388\u6743\u5e10\u53f7\u4ece\u7f51\u7edc\u8bbf\u95ee\uff08\u5305\u62ec\u7f51\u7edc\u5171\u4eab\u7b49\uff0c\u4f46\u4e0d\u5305\u62ec\u7ec8\u7aef\u670d\u52a1\uff09\u6b64\u8ba1\u7b97\u673a\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u7528\u6237\u6743\u9650\u5206\u914d \u4e2d\uff0c\u914d\u7f6e \u4ece\u7f51\u7edc\u8bbf\u95ee\u6b64\u8ba1\u7b97\u673a \u6743\u9650\u7ed9\u6307\u5b9a\u6388\u6743\u7528\u6237\u3002</p> <p>au1</p> <ol> <li>\u65e5\u5fd7\u914d\u7f6e\u64cd\u4f5c 2.1 \u65e5\u5fd7\u914d\u7f6e \u5ba1\u6838\u767b\u5f55 \u8bbe\u5907\u5e94\u914d\u7f6e\u65e5\u5fd7\u529f\u80fd\uff0c\u5bf9\u7528\u6237\u767b\u5f55\u8fdb\u884c\u8bb0\u5f55\u3002\u8bb0\u5f55\u5185\u5bb9\u5305\u62ec\u7528\u6237\u767b\u5f55\u4f7f\u7528\u7684\u5e10\u6237\u3001\u767b\u5f55\u662f\u5426\u6210\u529f\u3001\u767b\u5f55\u65f6\u95f4\u3001\u4ee5\u53ca\u8fdc\u7a0b\u767b\u5f55\u65f6\u3001\u53ca\u7528\u6237\u4f7f\u7528\u7684IP\u5730\u5740\u3002</li> </ol> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5ba1\u6838\u7b56\u7565 \u4e2d\uff0c\u8bbe\u7f6e \u5ba1\u6838\u767b\u5f55\u4e8b\u4ef6\u3002</p> <p>\u5ba1\u6838\u7b56\u7565 \u542f\u7528\u672c\u5730\u5b89\u5168\u7b56\u7565\u4e2d\u5bf9Windows\u7cfb\u7edf\u7684\u5ba1\u6838\u7b56\u7565\u66f4\u6539\uff0c\u6210\u529f\u548c\u5931\u8d25\u64cd\u4f5c\u90fd\u9700\u8981\u5ba1\u6838\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5ba1\u6838\u7b56\u7565 \u4e2d\uff0c\u8bbe\u7f6e \u5ba1\u6838\u7b56\u7565\u66f4\u6539\u3002</p> <p>\u5ba1\u6838\u5bf9\u8c61\u8bbf\u95ee \u542f\u7528\u672c\u5730\u5b89\u5168\u7b56\u7565\u4e2d\u5bf9Windows\u7cfb\u7edf\u7684\u5ba1\u6838\u5bf9\u8c61\u8bbf\u95ee\uff0c\u6210\u529f\u548c\u5931\u8d25\u64cd\u4f5c\u90fd\u9700\u8981\u5ba1\u6838\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5ba1\u6838\u7b56\u7565 \u4e2d\uff0c\u8bbe\u7f6e \u5ba1\u6838\u5bf9\u8c61\u8bbf\u95ee\u3002</p> <p>\u5ba1\u6838\u4e8b\u4ef6\u76ee\u5f55\u670d\u52a1\u8bbf\u95ee \u542f\u7528\u672c\u5730\u5b89\u5168\u7b56\u7565\u4e2d\u5bf9Windows\u7cfb\u7edf\u7684\u5ba1\u6838\u76ee\u5f55\u670d\u52a1\u8bbf\u95ee\uff0c\u4ec5\u9700\u8981\u5ba1\u6838\u5931\u8d25\u64cd\u4f5c\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5ba1\u6838\u7b56\u7565 \u4e2d\uff0c\u8bbe\u7f6e \u5ba1\u6838\u76ee\u5f55\u670d\u52a1\u5668\u8bbf\u95ee\u3002</p> <p>\u5ba1\u6838\u7279\u6743\u4f7f\u7528 \u542f\u7528\u672c\u5730\u5b89\u5168\u7b56\u7565\u4e2d\u5bf9Windows\u7cfb\u7edf\u7684\u5ba1\u6838\u7279\u6743\u4f7f\u7528\uff0c\u6210\u529f\u548c\u5931\u8d25\u64cd\u4f5c\u90fd\u9700\u8981\u5ba1\u6838\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5ba1\u6838\u7b56\u7565 \u4e2d\uff0c\u8bbe\u7f6e \u5ba1\u6838\u7279\u6743\u4f7f\u7528\u3002</p> <p>\u5ba1\u6838\u7cfb\u7edf\u4e8b\u4ef6 \u542f\u7528\u672c\u5730\u5b89\u5168\u7b56\u7565\u4e2d\u5bf9Windows\u7cfb\u7edf\u7684\u5ba1\u6838\u7cfb\u7edf\u4e8b\u4ef6\uff0c\u6210\u529f\u548c\u5931\u8d25\u64cd\u4f5c\u90fd\u9700\u8981\u5ba1\u6838\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5ba1\u6838\u7b56\u7565 \u4e2d\uff0c\u8bbe\u7f6e \u5ba1\u6838\u7cfb\u7edf\u4e8b\u4ef6\u3002</p> <p>\u5ba1\u6838\u5e10\u6237\u7ba1\u7406 \u542f\u7528\u672c\u5730\u5b89\u5168\u7b56\u7565\u4e2d\u5bf9Windows\u7cfb\u7edf\u7684\u5ba1\u6838\u5e10\u6237\u7ba1\u7406\uff0c\u6210\u529f\u548c\u5931\u8d25\u64cd\u4f5c\u90fd\u8981\u5ba1\u6838\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5ba1\u6838\u7b56\u7565 \u4e2d\uff0c\u8bbe\u7f6e \u5ba1\u6838\u5e10\u6237\u7ba1\u7406\u3002</p> <p>\u5ba1\u6838\u8fc7\u7a0b\u8ffd\u8e2a \u542f\u7528\u672c\u5730\u5b89\u5168\u7b56\u7565\u4e2d\u5bf9Windows\u7cfb\u7edf\u7684\u5ba1\u6838\u8fdb\u7a0b\u8ffd\u8e2a\uff0c\u4ec5\u5931\u8d25\u64cd\u4f5c\u9700\u8981\u5ba1\u6838\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5ba1\u6838\u7b56\u7565 \u4e2d\uff0c\u8bbe\u7f6e \u5ba1\u6838\u8fdb\u7a0b\u8ffd\u8e2a\u3002au</p> <p>\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f \u8bbe\u7f6e\u5e94\u7528\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f\u81f3\u5c11\u4e3a 8192 KB\uff0c\u53ef\u6839\u636e\u78c1\u76d8\u7a7a\u95f4\u914d\u7f6e\u65e5\u5fd7\u6587\u4ef6\u5927\u5c0f\uff0c\u8bb0\u5f55\u7684\u65e5\u5fd7\u8d8a\u591a\u8d8a\u597d\u3002\u5e76\u8bbe\u7f6e\u5f53\u8fbe\u5230\u6700\u5927\u7684\u65e5\u5fd7\u5c3a\u5bf8\u65f6\uff0c\u6309\u9700\u8981\u8f6e\u8be2\u8bb0\u5f55\u65e5\u5fd7\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u4e8b\u4ef6\u67e5\u770b\u5668\uff0c\u914d\u7f6e\u5e94\u7528\u65e5\u5fd7\u3001\u7cfb\u7edf\u65e5\u5fd7\u3001\u5b89\u5168\u65e5\u5fd7\u5c5e\u6027\u4e2d\u7684\u65e5\u5fd7\u5927\u5c0f\uff0c\u4ee5\u53ca\u8bbe\u7f6e\u5f53\u8fbe\u5230\u6700\u5927\u7684\u65e5\u5fd7\u5c3a\u5bf8\u65f6\u7684\u76f8\u5e94\u7b56\u7565\u3002 log</p> <ol> <li>IP\u534f\u8bae\u5b89\u5168\u914d\u7f6e 3.1 IP\u534f\u8bae\u5b89\u5168 \u542f\u7528SYN\u653b\u51fb\u4fdd\u62a4 \u542f\u7528SYN\u653b\u51fb\u4fdd\u62a4\u3002</li> </ol> <p>\u6307\u5b9a\u89e6\u53d1SYN\u6d2a\u6c34\u653b\u51fb\u4fdd\u62a4\u6240\u5fc5\u987b\u8d85\u8fc7\u7684TCP\u8fde\u63a5\u8bf7\u6c42\u6570\u9608\u503c\u4e3a5\u3002 \u6307\u5b9a\u5904\u4e8e SYN_RCVD \u72b6\u6001\u7684 TCP \u8fde\u63a5\u6570\u7684\u9608\u503c\u4e3a500\u3002 \u6307\u5b9a\u5904\u4e8e\u81f3\u5c11\u5df2\u53d1\u9001\u4e00\u6b21\u91cd\u4f20\u7684 SYN_RCVD \u72b6\u6001\u4e2d\u7684 TCP \u8fde\u63a5\u6570\u7684\u9608\u503c\u4e3a400\u3002 \u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u6ce8\u518c\u8868\u7f16\u8f91\u5668\uff0c\u6839\u636e\u63a8\u8350\u503c\u4fee\u6539\u6ce8\u518c\u8868\u952e\u503c\u3002</p> <p>Windows Server 2012</p> <p>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\SynAttackProtect \u63a8\u8350\u503c\uff1a2 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\\TcpMaxHalfOpen \u63a8\u8350\u503c\uff1a500 Windows Server 2008</p> <p>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\SynAttackProtect \u63a8\u8350\u503c\uff1a2 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TcpMaxPortsExhausted \u63a8\u8350\u503c\uff1a5 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TcpMaxHalfOpen \u63a8\u8350\u503c\uff1a500 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\TcpMaxHalfOpenRetried \u63a8\u8350\u503c\uff1a400 4. \u6587\u4ef6\u6743\u9650 4.1 \u5171\u4eab\u6587\u4ef6\u5939\u53ca\u8bbf\u95ee\u6743\u9650 \u5173\u95ed\u9ed8\u8ba4\u5171\u4eab \u975e\u57df\u73af\u5883\u4e2d\uff0c\u5173\u95edWindows\u786c\u76d8\u9ed8\u8ba4\u5171\u4eab\uff0c\u4f8b\u5982C\\(\uff0cD\\)\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u6ce8\u518c\u8868\u7f16\u8f91\u5668\uff0c\u6839\u636e\u63a8\u8350\u503c\u4fee\u6539\u6ce8\u518c\u8868\u952e\u503c\u3002</p> <p>\u6ce8\u610f\uff1a Windows Server 2012\u7248\u672c\u5df2\u9ed8\u8ba4\u5173\u95edWindows\u786c\u76d8\u9ed8\u8ba4\u5171\u4eab\uff0c\u4e14\u6ca1\u6709\u8be5\u6ce8\u518c\u8868\u952e\u503c\u3002</p> <p>HKLM\\System\\CurrentControlSet\\Services\\LanmanServer\\Parameters\\AutoShareServer \u63a8\u8350\u503c\uff1a 0 \u5171\u4eab\u6587\u4ef6\u5939\u6388\u6743\u8bbf\u95ee \u6bcf\u4e2a\u5171\u4eab\u6587\u4ef6\u5939\u7684\u5171\u4eab\u6743\u9650\uff0c\u53ea\u5141\u8bb8\u6388\u6743\u7684\u5e10\u6237\u62e5\u6709\u5171\u4eab\u6b64\u6587\u4ef6\u5939\u7684\u6743\u9650\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6bcf\u4e2a\u5171\u4eab\u6587\u4ef6\u5939\u7684\u5171\u4eab\u6743\u9650\u4ec5\u9650\u4e8e\u4e1a\u52a1\u9700\u8981\uff0c\u4e0d\u8981\u8bbe\u7f6e\u6210\u4e3a Everyone\u3002\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u8ba1\u7b97\u673a\u7ba1\u7406\uff0c\u5728 \u5171\u4eab\u6587\u4ef6\u5939 \u4e2d\uff0c\u67e5\u770b\u6bcf\u4e2a\u5171\u4eab\u6587\u4ef6\u5939\u7684\u5171\u4eab\u6743\u9650\u3002</p> <ol> <li>\u670d\u52a1\u5b89\u5168 5.1 \u7981\u7528TCP/IP\u4e0a\u7684NetBIOS \u7981\u7528TCP/IP\u4e0a\u7684NetBIOS\u534f\u8bae\uff0c\u53ef\u4ee5\u5173\u95ed\u76d1\u542c\u7684 UDP 137\uff08netbios-ns\uff09\u3001UDP 138\uff08netbios-dgm\uff09\u4ee5\u53ca TCP 139\uff08netbios-ssn\uff09\u7aef\u53e3\u3002</li> </ol> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u5728 \u8ba1\u7b97\u673a\u7ba1\u7406 &gt; \u670d\u52a1\u548c\u5e94\u7528\u7a0b\u5e8f &gt; \u670d\u52a1 \u4e2d\u7981\u7528 TCP/IP NetBIOS Helper \u670d\u52a1\u3002 \u5728\u7f51\u7edc\u8fde\u63a5\u5c5e\u6027\u4e2d\uff0c\u53cc\u51fb Internet\u534f\u8bae\u7248\u672c4\uff08TCP/IPv4\uff09\uff0c\u5355\u51fb \u9ad8\u7ea7\u3002\u5728 WINS \u9875\u7b7e\u4e2d\uff0c\u8fdb\u884c\u5982\u4e0b\u8bbe\u7f6e\uff1a bios \u7981\u7528\u4e0d\u5fc5\u8981\u7684\u670d\u52a1 \u7981\u7528\u4e0d\u5fc5\u8981\u7684\u670d\u52a1\uff0c\u8bf7\u53c2\u8003\uff1a ser</p> <p>6.\u5b89\u5168\u9009\u9879 6.1 \u542f\u7528\u5b89\u5168\u9009\u9879 \u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5b89\u5168\u9009\u9879 \u4e2d\uff0c\u8fdb\u884c\u5982\u4e0b\u8bbe\u7f6e\uff1a audit</p> <p>6.2 \u7981\u7528\u672a\u767b\u5f55\u524d\u5173\u673a \u670d\u52a1\u5668\u9ed8\u8ba4\u662f\u7981\u6b62\u5728\u672a\u767b\u5f55\u7cfb\u7edf\u524d\u5173\u673a\u7684\u3002\u5982\u679c\u542f\u7528\u6b64\u8bbe\u7f6e\uff0c\u670d\u52a1\u5668\u5b89\u5168\u6027\u5c06\u4f1a\u5927\u5927\u964d\u4f4e\uff0c\u7ed9\u8fdc\u7a0b\u8fde\u63a5\u7684\u9ed1\u5ba2\u9020\u6210\u53ef\u4e58\u4e4b\u673a\uff0c\u5f3a\u70c8\u5efa\u8bae\u7981\u7528\u672a\u767b\u5f55\u524d\u5173\u673a\u529f\u80fd\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5b89\u5168\u9009\u9879 \u4e2d\uff0c\u7981\u7528 \u5173\u673a\uff1a\u5141\u8bb8\u7cfb\u7edf\u5728\u672a\u767b\u5f55\u524d\u5173\u673a \u7b56\u7565\u3002 sg</p> <ol> <li>\u5176\u4ed6\u5b89\u5168\u914d\u7f6e 7.1 \u9632\u75c5\u6bd2\u7ba1\u7406 Windows\u7cfb\u7edf\u9700\u8981\u5b89\u88c5\u9632\u75c5\u6bd2\u8f6f\u4ef6\u3002</li> </ol> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u5b89\u88c5\u4f01\u4e1a\u7ea7\u9632\u75c5\u6bd2\u8f6f\u4ef6\uff0c\u5e76\u5f00\u542f\u75c5\u6bd2\u5e93\u66f4\u65b0\u53ca\u5b9e\u65f6\u9632\u5fa1\u529f\u80fd\u3002</p> <p>7.2 \u8bbe\u7f6e\u5c4f\u5e55\u4fdd\u62a4\u5bc6\u7801\u548c\u5f00\u542f\u65f6\u95f4 \u8bbe\u7f6e\u4ece\u5c4f\u5e55\u4fdd\u62a4\u6062\u590d\u65f6\u9700\u8981\u8f93\u5165\u5bc6\u7801\uff0c\u5e76\u5c06\u5c4f\u5e55\u4fdd\u62a4\u81ea\u52a8\u5f00\u542f\u65f6\u95f4\u8bbe\u5b9a\u4e3a\u4e94\u5206\u949f\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u542f\u7528\u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f\uff0c\u8bbe\u7f6e\u7b49\u5f85\u65f6\u95f4\u4e3a 5\u5206\u949f\uff0c\u5e76\u542f\u7528 \u5728\u6062\u590d\u65f6\u4f7f\u7528\u5bc6\u7801\u4fdd\u62a4\u3002</p> <p>7.3 \u9650\u5236\u8fdc\u7a0b\u767b\u5f55\u7a7a\u95f2\u65ad\u5f00\u65f6\u95f4 \u5bf9\u4e8e\u8fdc\u7a0b\u767b\u5f55\u7684\u5e10\u6237\uff0c\u8bbe\u7f6e\u4e0d\u6d3b\u52a8\u8d85\u8fc7\u65f6\u95f415\u5206\u949f\u81ea\u52a8\u65ad\u5f00\u8fde\u63a5\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u6253\u5f00 \u63a7\u5236\u9762\u677f &gt; \u7ba1\u7406\u5de5\u5177 &gt; \u672c\u5730\u5b89\u5168\u7b56\u7565\uff0c\u5728 \u672c\u5730\u7b56\u7565 &gt; \u5b89\u5168\u9009\u9879 \u4e2d\uff0c\u8bbe\u7f6e Microsoft\u7f51\u7edc\u670d\u52a1\u5668\uff1a\u6682\u505c\u4f1a\u8bdd\u524d\u6240\u9700\u7684\u7a7a\u95f2\u65f6\u95f4\u6570\u91cf \u5c5e\u6027\u4e3a15\u5206\u949f\u3002</p> <p>7.4 \u64cd\u4f5c\u7cfb\u7edf\u8865\u4e01\u7ba1\u7406 \u5b89\u88c5\u6700\u65b0\u7684\u64cd\u4f5c\u7cfb\u7edfHotfix\u8865\u4e01\u3002\u5b89\u88c5\u8865\u4e01\u65f6\uff0c\u5e94\u5148\u5bf9\u670d\u52a1\u5668\u7cfb\u7edf\u8fdb\u884c\u517c\u5bb9\u6027\u6d4b\u8bd5\u3002</p> <p>\u64cd\u4f5c\u6b65\u9aa4</p> <p>\u5b89\u88c5\u6700\u65b0\u7684\u64cd\u4f5c\u7cfb\u7edfHotfix\u8865\u4e01\u3002\u5b89\u88c5\u8865\u4e01\u65f6\uff0c\u5e94\u5148\u5bf9\u670d\u52a1\u5668\u7cfb\u7edf\u8fdb\u884c\u517c\u5bb9\u6027\u6d4b\u8bd5\u3002</p> <p>\u6ce8\u610f\uff1a\u5bf9\u4e8e\u5b9e\u9645\u4e1a\u52a1\u73af\u5883\u670d\u52a1\u5668\uff0c\u5efa\u8bae\u4f7f\u7528\u901a\u77e5\u5e76\u81ea\u52a8\u4e0b\u8f7d\u66f4\u65b0\uff0c\u4f46\u7531\u7ba1\u7406\u5458\u9009\u62e9\u662f\u5426\u5b89\u88c5\u66f4\u65b0\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u81ea\u52a8\u5b89\u88c5\u66f4\u65b0\uff0c\u9632\u6b62\u81ea\u52a8\u66f4\u65b0\u8865\u4e01\u5bf9\u5b9e\u9645\u4e1a\u52a1\u73af\u5883\u4ea7\u751f\u5f71\u54cd\u3002 update</p>"},{"location":"security/%E5%AE%89%E5%85%A8%E8%BF%90%E7%BB%B4%E8%A7%84%E8%8C%83/","title":"\u670d\u52a1\u5668\u5b89\u5168\u8fd0\u7ef4\u89c4\u8303","text":""},{"location":"security/%E5%AE%89%E5%85%A8%E8%BF%90%E7%BB%B4%E8%A7%84%E8%8C%83/#_2","title":"\u5b89\u5168\u8fd0\u7ef4\u7684\u4e8b\u524d\u68c0\u67e5\u548c\u76d1\u63a7","text":""},{"location":"security/%E5%AE%89%E5%85%A8%E8%BF%90%E7%BB%B4%E8%A7%84%E8%8C%83/#_3","title":"\u63d0\u524d\u68c0\u67e5","text":"<ul> <li>\u670d\u52a1\u5668\u548c\u7f51\u7ad9\u6f0f\u6d1e\u68c0\u6d4b\uff0c\u5bf9 Web \u6f0f\u6d1e\u3001\u5f31\u53e3\u4ee4\u3001\u6f5c\u5728\u7684\u6076\u610f\u884c\u4e3a\u3001\u8fdd\u6cd5\u4fe1\u606f\u7b49\u8fdb\u884c\u5b9a\u671f\u626b\u63cf\u3002</li> <li>\u4ee3\u7801\u7684\u5b9a\u671f\u68c0\u67e5\uff0c\u5b89\u5168\u68c0\u67e5\uff0c\u6f0f\u6d1e\u68c0\u67e5\u3002</li> <li>\u670d\u52a1\u5668\u5b89\u5168\u52a0\u56fa\uff0c\u5b89\u5168\u57fa\u7ebf\u8bbe\u7f6e\uff0c\u5b89\u5168\u57fa\u7ebf\u68c0\u67e5\u3002</li> <li>\u6570\u636e\u5e93\u6267\u884c\u7684\u547d\u4ee4\uff0c\u6dfb\u52a0\u5b57\u6bb5\u3001\u52a0\u7d22\u5f15\u7b49\uff0c\u5fc5\u987b\u662f\u7ecf\u8fc7\u6d4b\u8bd5\u68c0\u67e5\u7684\u547d\u4ee4\uff0c\u624d\u80fd\u5728\u6b63\u5f0f\u73af\u5883\u8fd0\u884c\u3002</li> </ul>"},{"location":"security/%E5%AE%89%E5%85%A8%E8%BF%90%E7%BB%B4%E8%A7%84%E8%8C%83/#_4","title":"\u6570\u636e\u5907\u4efd","text":"<ul> <li>\u670d\u52a1\u5668\u6570\u636e\u5907\u4efd\uff0c\u5305\u62ec\u7f51\u7ad9\u7a0b\u5e8f\u6587\u4ef6\u5907\u4efd\uff0c\u6570\u636e\u5e93\u6587\u4ef6\u5907\u4efd\u3001\u914d\u7f6e\u6587\u4ef6\u5907\u4efd\uff0c\u5982\u6709\u8d44\u6e90\u6700\u597d\u6bcf\u5c0f\u65f6\u5907\u4efd\u548c\u5f02\u5730\u5907\u4efd\u3002</li> <li>\u5efa\u7acb\u591a\u91cd\u5907\u4efd\u673a\u5236\uff1a\u5e38\u89c4\u5907\u4efd\u3001\u81ea\u52a8\u5907\u4efd\u3001OSS \u540c\u6b65\u3001VM \u5907\u4efd\u3002</li> <li>\u5b9a\u671f\u68c0\u67e5\u5907\u4efd\u6587\u4ef6\u662f\u5426\u53ef\u7528\uff0c\u907f\u514d\u51fa\u6545\u969c\u540e\uff0c\u5907\u4efd\u6570\u636e\u4e0d\u53ef\u7528\u3002</li> <li>\u91cd\u8981\u6570\u636e\u591a\u91cd\u52a0\u5bc6\u7b97\u6cd5\u52a0\u5bc6\u5904\u7406\u3002</li> <li>\u7a0b\u5e8f\u6587\u4ef6\u7248\u672c\u63a7\u5236\uff0c\u6d4b\u8bd5\uff0c\u53d1\u5e03\uff0c\u6545\u969c\u56de\u6eda\u3002</li> </ul>"},{"location":"security/%E5%AE%89%E5%85%A8%E8%BF%90%E7%BB%B4%E8%A7%84%E8%8C%83/#_5","title":"\u5b89\u5168\u76d1\u63a7","text":"<ul> <li>Prometheus \u76d1\u63a7\u670d\u52a1\u5668\u5e38\u89c4\u72b6\u6001 CPU \u8d1f\u8f7d\u3001\u5185\u5b58\u3001\u78c1\u76d8\u3001\u6d41\u91cf\uff0c\u8d85\u8fc7\u9608\u503c\u544a\u8b66\u3002</li> <li>Prometheus \u6216 Zabbix \u76d1\u63a7\u670d\u52a1\u5668\u5e38\u89c4\u72b6\u6001 CPU \u8d1f\u8f7d\u3001\u5185\u5b58\u3001\u78c1\u76d8\u3001\u6d41\u91cf\u7b49\u72b6\u6001\uff0c\u53ef\u4ee5\u663e\u793a\u5386\u53f2\u66f2\u7ebf\uff0c\u65b9\u4fbf\u6392\u67e5\u95ee\u9898\u3002</li> <li>\u76d1\u63a7\u670d\u52a1\u5668 SSH \u767b\u5f55\u8bb0\u5f55\u3001\u9632\u706b\u5899\uff08firewalld \u548c iptables\uff09\u72b6\u6001\u3001\u8fdb\u7a0b\u72b6\u6001\uff0c\u6709\u5f02\u5e38\u8bb0\u5f55\u544a\u8b66\u3002</li> <li>\u76d1\u63a7\u7f51\u7ad9 WEB \u65e5\u5fd7\uff08\u5305\u62ec nginx \u65e5\u5fd7\u7b49\uff09\uff0c\u53ef\u4ee5\u91c7\u7528 ELK \u6765\u6536\u96c6\u7ba1\u7406\uff0c\u6709\u5f02\u5e38\u65e5\u5fd7\u544a\u8b66\u3002</li> <li>\u8fd0\u7ef4\u4eba\u5458\u90fd\u8981\u63a5\u6536\u544a\u8b66\u90ae\u4ef6\u548c\u77ed\u4fe1\uff0c\u81f3\u5c11\u6240\u8d1f\u8d23\u7684\u4e1a\u52a1\u544a\u8b66\u90ae\u4ef6\u548c\u77ed\u4fe1\u5fc5\u987b\u63a5\u6536\u3002</li> </ul>"},{"location":"security/%E5%AE%89%E5%85%A8%E8%BF%90%E7%BB%B4%E8%A7%84%E8%8C%83/#_6","title":"\u6545\u969c\u907f\u514d\u9884\u9632","text":"<ul> <li>\u7f51\u7ad9 WEB \u589e\u52a0 WAF\uff0c\u907f\u514d XSS \u8de8\u7ad9\u811a\u672c\u3001SQL \u6ce8\u5165\u3001\u7f51\u9875\u6302\u9a6c\u7b49\u6f0f\u6d1e\u5a01\u80c1\u3002</li> <li>\u7a0b\u5e8f\u4ee3\u7801\u8fde\u63a5\u6570\u636e\u5e93\u3001memcache\u3001redis \u7b49\uff0c\u53ef\u4ee5\u4f7f\u7528\u57df\u540d\uff08\u57df\u540d HOSTS \u6307\u5b9a IP\uff09\uff0c\u5f53\u51fa\u95ee\u9898\uff0c\u6709\u5907\u7528\u7684\u670d\u52a1\u5668\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539 DNS \u6216\u8005 HOSTS\uff0c\u6062\u590d\u670d\u52a1\u3002</li> <li>\u5efa\u7acb\u5e94\u6025\u9884\u6848\u673a\u5236\uff0c\u5b9a\u671f\u6f14\u7ec3\u4e8b\u6545\u573a\u666f\uff0c\u4f30\u7b97\u4fee\u590d\u65f6\u95f4\u3002</li> <li>\u6709\u80fd\u529b\u60c5\u51b5\u4e0b\uff0c\u90e8\u7f72\u871c\u7f50\u7cfb\u7edf\uff0c\u9632\u8303\u4f01\u4e1a\u548c\u670d\u52a1\u5668\u5185\u7f51 APT \u653b\u51fb\u3002</li> <li>\u5efa\u7acb\u53cc\u6d3b\u96c6\u7fa4\uff0c\u5305\u62ec\u4e1a\u52a1\u670d\u52a1\u7684\u9ad8\u53ef\u7528\uff0c\u907f\u514d\u4e1a\u52a1\u670d\u52a1\u5355\u70b9\u3002</li> <li>\u670d\u52a1\u5668\u96c6\u7fa4\u91c7\u7528\u8df3\u677f\u673a\u6216\u5821\u5792\u673a\u767b\u5f55\uff0c\u907f\u514d\u670d\u52a1\u5668\u96c6\u7fa4\u6bcf\u53f0\u670d\u52a1\u5668\u53ef\u4ee5\u8fdc\u7a0b\u8fde\u63a5\u7ba1\u7406\u3002</li> <li>\u64cd\u4f5c\u91cd\u8981\u4e1a\u52a1\u5347\u7ea7\u3001\u8fc1\u79fb\u3001\u6269\u5bb9\u2026\u2026\u4e4b\u524d\uff0c\u5217\u4e00\u4e0b\u64cd\u4f5c\u6b65\u9aa4\uff0c\u8d8a\u8be6\u7ec6\u8d8a\u597d\uff0c\u5b9e\u9645\u64cd\u4f5c\u6309\u6b65\u9aa4\u64cd\u4f5c\uff0c\u64cd\u4f5c\u5b8c\u505a\u597d\u8bb0\u5f55\u3002</li> </ul>"},{"location":"security/%E5%AE%89%E5%85%A8%E8%BF%90%E7%BB%B4%E8%A7%84%E8%8C%83/#_7","title":"\u5b89\u5168\u8fd0\u7ef4\u7684\u4e8b\u4e2d\u64cd\u4f5c","text":"<ul> <li>\u7f51\u7ad9 WEB \u589e\u52a0 WAF\uff0c\u53d1\u73b0 XSS\u3001SQL \u6ce8\u5165\u3001\u7f51\u9875\u6302\u9a6c\u7b49\u653b\u51fb\uff0c\u8bb0\u5f55\u62e6\u622a\u65e5\u5fd7\uff0c\u5b9a\u671f\u6392\u67e5\u3002</li> <li>\u68c0\u67e5\u670d\u52a1\u5668\u6570\u636e\u5907\u4efd\u662f\u5426\u53ef\u7528\u3002</li> <li>\u5728\u5904\u7406\u9700\u6c42\u548c\u6545\u969c\u65f6\uff0c\u6267\u884c\u98ce\u9669\u547d\u4ee4\uff08\u6bd4\u5982 rm\u3001restart\u3001reboot \u7b49\uff09\u9700\u518d\u4e09\u786e\u8ba4\uff0c\u6267\u884c\u547d\u4ee4\u524d\uff0c\u68c0\u67e5\u6240\u5728\u670d\u52a1\u5668\uff0c\u6240\u5728\u670d\u52a1\u5668\u8def\u5f84\uff0c\u518d\u6267\u884c\uff01</li> <li>\u4e0d\u8981\u75b2\u52b3\u9a7e\u9a76\uff0c\u559d\u9152\u4e0d\u4e0a\u673a\uff0c\u4e0a\u673a\u4e0d\u559d\u9152\uff0c\u5c24\u5176\u522b\u52a8\u6570\u636e\u5e93\uff0c\u907f\u514d\u5728\u4e0d\u6e05\u9192\u7684\u72b6\u6001\u4e0b\uff0c\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4e86\u9519\u8bef\u547d\u4ee4\uff0c\u5bfc\u81f4\u6570\u636e\u4e22\u5931\u6216\u4e1a\u52a1\u6545\u969c\u3002</li> <li>\u5728\u5904\u7406\u4e8b\u6545\u65f6\uff0c\u4e00\u5b9a\u8981\u8003\u8651\u5904\u7406\u63aa\u65bd\u662f\u5426\u4f1a\u5f15\u53d1\u8fde\u9501\u6545\u969c\uff0c\u91cd\u8981\u64cd\u4f5c\u4e09\u601d\u800c\u884c\u3002</li> </ul>"},{"location":"security/%E5%AE%89%E5%85%A8%E8%BF%90%E7%BB%B4%E8%A7%84%E8%8C%83/#_8","title":"\u5b89\u5168\u8fd0\u7ef4\u7684\u4e8b\u540e\u68c0\u67e5\u5206\u6790","text":"<ul> <li>\u5b9e\u73b0\u7f51\u7edc\u5b89\u5168\u53ef\u89c6\u5316\u7ba1\u7406\uff0c\u53ef\u4ee5\u770b\u5230\u6bcf\u5929\u6709\u90a3\u4e9b\u5f02\u5e38 IP \u548c\u5f02\u5e38 URL \u8bf7\u6c42\uff0c\u670d\u52a1\u5668\u96c6\u7fa4\u5f00\u653e\u7aef\u53e3\u5217\u8868\u7b49\u3002</li> <li>\u80fd\u5bf9\u5168\u7f51\u8fdb\u884c\u5b89\u5168\u7b56\u7565\u96c6\u4e2d\u7ba1\u7406\u3002</li> <li>\u7edf\u4e00\u65e5\u5fd7\u6536\u96c6\u548c\u5206\u6790\u3002</li> <li>\u5907\u4efd\u53ca\u7be1\u6539\u6062\u590d\u529f\u80fd\uff0c\u7a0b\u5e8f\u6587\u4ef6\u3001\u56fe\u7247\u3001\u6570\u636e\u6587\u4ef6\u3001\u914d\u7f6e\u6587\u4ef6\u7684\u5907\u4efd\uff0c\u6545\u969c\u56de\u6eda\u673a\u5236\u3002</li> <li>\u5bf9\u653b\u51fb\u65e5\u5fd7\u8fdb\u884c\u6df1\u5ea6\u5206\u6790\uff0c\u5c55\u73b0\u653b\u51fb\u8def\u5f84\u3001\u653b\u51fb\u6e90\uff0c\u534f\u52a9\u7ba1\u7406\u5458\u6eaf\u6e90\u3002</li> <li>\u8df5\u884c DevOps \u7684\u65e0\u6307\u8d23\u6587\u5316\uff0c\u5c24\u5176\u662f\u5728\u505a\u4e8b\u6545\u5206\u6790\u65f6\u3002\u4e8b\u6545\u5206\u6790\u91cd\u5728\u5b9a\u4f4d\u539f\u56e0\uff0c\u5236\u5b9a\u6539\u8fdb\u63aa\u65bd\u3002</li> </ul>"},{"location":"security/%E6%95%85%E9%9A%9C%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E9%81%BF%E5%85%8D/","title":"\u6545\u969c\u7684\u5b9a\u4e49\u548c\u907f\u514d","text":""},{"location":"security/%E6%95%85%E9%9A%9C%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E9%81%BF%E5%85%8D/#_2","title":"\u6545\u969c\u7b49\u7ea7\u7684\u5b9a\u4e49","text":"<p>\u53ef\u4ee5\u53c2\u7167\u4e92\u8054\u7f51\u7f51\u7edc\u6545\u969c\u6807\u51c6\u6765\u5b9a\u4e49\uff0c\u4e00\u822c\u516c\u53f8\u6545\u969c\u5b9a\u7ea7\u662f\u5206\u56db\u7ea7\uff0c\u6bd4\u5982\uff1aP1 \u662f\u6700\u4e25\u91cd\u7684\u6545\u969c\uff0cP4 \u662f\u6700\u8f7b\u5fae\u7684\u6545\u969c\u3002</p> <ul> <li><code>P1</code>\uff1a\u670d\u52a1\u6216\u529f\u80fd\u4e00\u6bb5\u65f6\u95f4\u6216\u8005\u957f\u65f6\u95f4\u4e0d\u53ef\u7528\uff0c\u9020\u6210\u516c\u53f8\u8d44\u4ea7\u635f\u5931\uff0c\u6216\u8005\u4e25\u91cd\u5f71\u54cd\u7528\u6237\u6b63\u5e38\u4f7f\u7528\u3002</li> <li><code>P2</code>\uff1a\u670d\u52a1\u6216\u529f\u80fd\u4e00\u6bb5\u65f6\u95f4\u4e0d\u53ef\u7528\uff0c\u5f71\u54cd\u5916\u90e8\u7528\u6237\u6b63\u5e38\u4f7f\u7528\uff0c\u5e76\u9020\u6210\u4e00\u5b9a\u5f71\u54cd\u3002</li> <li><code>P3</code>\uff1a\u670d\u52a1\u6216\u529f\u80fd\u4e00\u6bb5\u65f6\u95f4\u4e0d\u53ef\u7528\uff0c\u5f71\u54cd\u5185\u90e8\u6b63\u5e38\u8fd0\u8425\u5de5\u4f5c\uff0c\u5916\u90e8\u7528\u6237\u65e0\u611f\u77e5\uff0c\u6216\u8005\u5f71\u54cd\u8f7b\u5fae\u3002</li> <li><code>P4</code>\uff1a\u77ed\u6682\u505c\u670d\uff0c\u5185\u5916\u7528\u6237\u90fd\u65e0\u660e\u663e\u611f\u77e5\uff0c\u5f71\u54cd\u8f7b\u5fae\u3002</li> </ul> <p>\u9ad8\u53ef\u7528 SLA \u8bf4\u660e\uff1a</p> <p></p>"},{"location":"security/%E6%95%85%E9%9A%9C%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E9%81%BF%E5%85%8D/#_3","title":"\u4e3a\u4ec0\u4e48\u4f1a\u6545\u969c\uff1f\u6545\u969c\u5bfc\u81f4\u7684\u4e09\u5927\u7c7b\u539f\u56e0","text":"<ol> <li>\u53d8\u66f4\uff08\u4fee\u6539\u914d\u7f6e\u51fa\u95ee\u9898\uff0c\u7a0b\u5e8f\u53d1\u5e03\u6709BUG\uff0c\u91cd\u542f\u5e94\u7528\uff09\uff1b</li> <li>\u7528\u6237\u884c\u4e3a\uff08\u5ba2\u6237\u5927\u4fc3\u9500\uff0c\u7528\u6237\u5f02\u5e38\u51fa\u53d1BUG\uff0c\u9ed1\u5ba2\u653b\u51fb\uff09\uff1b</li> <li>\u8bbe\u5907\u786c\u4ef6\u6545\u969c\uff08\u78c1\u76d8\u6545\u969c\uff0c\u7f51\u7edc\u7ebf\u8def\u6545\u969c\uff0c\u673a\u623f\u6545\u969c\uff0c\u81ea\u7136\u707e\u5bb3\u5730\u9707\uff09\uff1b</li> </ol>"},{"location":"security/%E6%95%85%E9%9A%9C%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E9%81%BF%E5%85%8D/#_4","title":"\u600e\u4e48\u505a\u907f\u514d\u6545\u969c\uff1f","text":""},{"location":"security/%E6%95%85%E9%9A%9C%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E9%81%BF%E5%85%8D/#_5","title":"\u6545\u969c\u524d","text":"<p>\u64cd\u4f5c\u89c4\u8303\uff0c\u5b89\u5168\u68c0\u6d4b\uff0c\u76d1\u63a7\uff0c\u6570\u636e\u5907\u4efd\uff0c\u6545\u969c\u56de\u6eda\u65b9\u6848\uff0c\u67b6\u6784\u9ad8\u53ef\u7528\u65b9\u6848\uff0c\u6545\u969c\u5207\u6362\u65b9\u6848\uff0c\u6545\u969c\u81ea\u6108\u65b9\u6848\u3002</p>"},{"location":"security/%E6%95%85%E9%9A%9C%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E9%81%BF%E5%85%8D/#_6","title":"\u6545\u969c\u4e2d","text":"<ul> <li>\u8bc4\u4f30\u6545\u969c\uff0c\u662f\u5426\u6267\u884c\u56de\u6eda\uff0c\u662f\u5426\u6267\u884c\u5207\u6362\u65b9\u6848\u7b49\uff1b</li> <li>\u91cd\u8981\u64cd\u4f5c\u4e09\u601d\u800c\u884c\uff1b</li> <li>\u4e0d\u8981\u75b2\u52b3\u9a7e\u9a76\uff0c\u559d\u9152\u4e0d\u4e0a\u673a\uff0c\u4e0a\u673a\u4e0d\u559d\u9152\uff1b</li> </ul>"},{"location":"security/%E6%95%85%E9%9A%9C%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E9%81%BF%E5%85%8D/#_7","title":"\u6545\u969c\u540e","text":"<ul> <li>\u68c0\u67e5\u662f\u5426\u5168\u90e8\u4e1a\u52a1\u90fd\u6062\u590d\u6b63\u5e38\uff1b</li> <li>\u5206\u6790\u65e5\u5fd7\uff1b</li> <li>\u590d\u76d8\u5206\u6790\uff1b</li> <li>\u603b\u7ed3\u65b9\u6cd5\u907f\u514d\u7c7b\u4f3c\u6545\u969c\uff1b</li> </ul>"}]}